(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[422],{33226:function(t){let e="ศูนย์บาทถ้วน",r=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],n=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];function o(t){let e="",a=t.length;if(a>7){let e=a-7+1,r=t.slice(0,e),n=t.slice(e);return o(r)+"ล้าน"+o(n)}for(let o=0;o<a;o++){let i=t[o];i>0&&(e+=r[i]+n[a-o-1])}return e}function a(t){let e=t;return(e=(e=e.replace("หนึ่งสิบ","สิบ")).replace("สองสิบ","ยี่สิบ")).length>5&&e.length-e.lastIndexOf("หนึ่ง")==5&&(e=e.substr(0,e.length-5)+"เอ็ด"),e}null!=t.exports&&(t.exports=function(t){var r,n;let i=e;if(isNaN(t)||t>=Number.MAX_SAFE_INTEGER)return i;let c=Math.floor(t).toString(),u=Math.round(t%1*100).toString(),s=Array.from(c).map(Number),l=Array.from(u).map(Number),f=o(s),h=o(l);return f=a(f),h=a(h),r=f,n=h,i=""===r&&""===n?e:""!==r&&""===n?r+"บาทถ้วน":""===r&&""!==n?n+"สตางค์":r+"บาท"+n+"สตางค์"})},67218:function(t,e){var r;r=function(t){t.version="1.0.2";var e,r,n,o,a,i,c,u,s,l,f,h,p,d,m,g,v=Math;function E(t,e){for(var r=0,n=0;r<t.length;++r)n=e*n+t[r];return n}function y(t,e,r,n,o){if(0===e)return r;if(1===e)return n;for(var a=2/t,i=n,c=1;c<e;++c)i=n*c*a+o*r,r=n,n=i;return i}function N(t,e,r,n,o){return function(r,a){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}if(0===a)return t(r);if(1===a)return e(r);if(a<0)return NaN;a|=0;var i=t(r),c=e(r);return y(r,a,i,c,o)}}var R=function(){var t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),e=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-.000002073370639,2093887211e-16].reverse(),n=[-.01562499995,1430488765e-13,-.000006911147651,7621095161e-16,-.0000000934935152].reverse();function o(o){var a=0,i=0,c=0,u=o*o;if(o<8)a=(i=E(t,u))/(c=E(e,u));else{var s=o-.785398164;i=E(r,u=64/u),c=E(n,u),a=v.sqrt(.636619772/o)*(v.cos(s)*i-v.sin(s)*c*8/o)}return a}var a=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),i=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),c=[1,.00183105,-.00003516396496,2457520174e-15,-.000000240337019].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-.00000088228987,105787412e-15].reverse();function s(t){var e=0,r=0,n=0,o=t*t,s=v.abs(t)-2.356194491;return 8>Math.abs(t)?e=(r=t*E(a,o))/(n=E(i,o)):(r=E(c,o=64/o),n=E(u,o),e=v.sqrt(.636619772/v.abs(t))*(v.cos(s)*r-v.sin(s)*n*8/v.abs(t)),t<0&&(e=-e)),e}return function t(e,r){if(r=Math.round(r),!isFinite(e))return isNaN(e)?e:0;if(r<0)return(r%2?-1:1)*t(e,-r);if(e<0)return(r%2?-1:1)*t(-e,r);if(0===r)return o(e);if(1===r)return s(e);if(0===e)return 0;var n=0;if(e>r)n=y(e,r,o(e),s(e),-1);else{for(var a=2*v.floor((r+v.floor(v.sqrt(40*r)))/2),i=!1,c=0,u=0,l=1,f=0,h=2/e,p=a;p>0;p--)f=p*h*l-c,c=l,l=f,v.abs(l)>1e10&&(l*=1e-10,c*=1e-10,n*=1e-10,u*=1e-10),i&&(u+=l),i=!i,p==r&&(n=c);n/=u=2*u-l}return n}}(),T=(e=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),r=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-.000002073370639,2093887211e-16].reverse(),o=[-.01562499995,1430488765e-13,-.000006911147651,7621095161e-16,-.0000000934945152].reverse(),a=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),i=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),c=[1,.00183105,-.00003516396496,2457520174e-15,-.000000240337019].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-.00000088228987,105787412e-15].reverse(),N(function(t){var a=0,i=0,c=0,u=t*t,s=t-.785398164;return t<8?a=(i=E(e,u))/(c=E(r,u))+.636619772*R(t,0)*v.log(t):(i=E(n,u=64/u),c=E(o,u),a=v.sqrt(.636619772/t)*(v.sin(s)*i+v.cos(s)*c*8/t)),a},function(t){var e=0,r=0,n=0,o=t*t,s=t-2.356194491;return t<8?e=(r=t*E(a,o))/(n=E(i,o))+.636619772*(R(t,1)*v.log(t)-1/t):(r=E(c,o=64/o),n=E(u,o),e=v.sqrt(.636619772/t)*(v.sin(s)*r+v.cos(s)*n*8/t)),e},"BESSELY",1,-1)),A=(s=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),l=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),f=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),h=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function t(e,r){if(0===(r=Math.round(r)))return e<=3.75?E(s,e*e/14.0625):v.exp(v.abs(e))/v.sqrt(v.abs(e))*E(l,3.75/v.abs(e));if(1===r)return e<3.75?e*E(f,e*e/14.0625):(e<0?-1:1)*v.exp(v.abs(e))/v.sqrt(v.abs(e))*E(h,3.75/v.abs(e));if(r<0)return NaN;if(0===v.abs(e))return 0;if(e==1/0)return 1/0;var n,o=0,a=2/v.abs(e),i=0,c=1,u=0;for(n=2*v.round((r+v.round(v.sqrt(40*r)))/2);n>0;n--)u=n*a*c+i,i=c,c=u,v.abs(c)>1e10&&(c*=1e-10,i*=1e-10,o*=1e-10),n==r&&(o=i);return o*=t(e,0)/c,e<0&&r%2?-o:o}),M=(p=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),d=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),m=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-.00004686].reverse(),g=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-.00068245].reverse(),N(function(t){return t<=2?-v.log(t/2)*A(t,0)+E(p,t*t/4):v.exp(-t)/v.sqrt(t)*E(d,2/t)},function(t){return t<=2?v.log(t/2)*A(t,1)+1/t*E(m,t*t/4):v.exp(-t)/v.sqrt(t)*E(g,2/t)},"BESSELK",2,1));t.besselj=R,t.bessely=T,t.besseli=A,t.besselk=M},"undefined"==typeof DO_NOT_EXPORT_BESSEL?r(e):r({})},89560:function(t,e,r){"use strict";r.r(e),r.d(e,{Alternation:function(){return tk},Alternative:function(){return tS},CstParser:function(){return rn},EMPTY_ALT:function(){return re},EOF:function(){return tT},EarlyExitException:function(){return eU},EmbeddedActionsParser:function(){return ro},GAstVisitor:function(){return tG},Lexer:function(){return tu},LexerDefinitionErrorType:function(){return E},MismatchedTokenException:function(){return eC},NoViableAltException:function(){return eS},NonTerminal:function(){return tI},NotAllInputParsedException:function(){return eb},Option:function(){return tb},Parser:function(){return rd},ParserDefinitionErrorType:function(){return R},Repetition:function(){return tL},RepetitionMandatory:function(){return tU},RepetitionMandatoryWithSeparator:function(){return tx},RepetitionWithSeparator:function(){return t_},Rule:function(){return tC},Terminal:function(){return tP},VERSION:function(){return T},assignOccurrenceIndices:function(){return ey},clearCache:function(){return rp},createSyntaxDiagramsCode:function(){return ra},createToken:function(){return tN},createTokenInstance:function(){return tA},defaultGrammarResolverErrorProvider:function(){return tZ},defaultGrammarValidatorErrorProvider:function(){return tJ},defaultLexerErrorProvider:function(){return ti},defaultParserErrorProvider:function(){return tQ},generateParserFactory:function(){return rf},generateParserModule:function(){return rh},isRecognitionException:function(){return eO},resolveGrammar:function(){return ev},serializeGrammar:function(){return tB},serializeProduction:function(){return tD},tokenLabel:function(){return ts},tokenMatcher:function(){return tM},tokenName:function(){return tl},validateGrammar:function(){return eE}});var n,o,a,i,c,u,s,l,f,h,p,d,m,g,v,E,y,N,R,T="7.1.2",A=r(71570),M=r(63511),w={},O=new M.RegExpParser;function I(t){var e=t.toString();if(w.hasOwnProperty(e))return w[e];var r=O.pattern(e);return w[e]=r,r}var C=(n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),S="Complement Sets are not supported for first char optimization",b='Unable to use "first char" lexer optimizations:\n';function U(t,e,r){var n=X(t);e[n]=n,!0===r&&function(t,e){var r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){var o=X(n.charCodeAt(0));e[o]=o}else{var a=r.toLowerCase();if(a!==r){var o=X(a.charCodeAt(0));e[o]=o}}}(t,e)}function x(t,e){return(0,A.sE)(t.value,function(t){return"number"==typeof t?(0,A.r3)(e,t):void 0!==(0,A.sE)(e,function(e){return t.from<=e&&e<=t.to})})}var L=function(t){function e(e){var r=t.call(this)||this;return r.targetCharCodes=e,r.found=!1,r}return C(e,t),e.prototype.visitChildren=function(e){if(!0!==this.found){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}t.prototype.visitChildren.call(this,e)}},e.prototype.visitCharacter=function(t){(0,A.r3)(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?void 0===x(t,this.targetCharCodes)&&(this.found=!0):void 0!==x(t,this.targetCharCodes)&&(this.found=!0)},e}(M.BaseRegExpVisitor);function _(t,e){if(!(e instanceof RegExp))return void 0!==(0,A.sE)(e,function(e){return(0,A.r3)(t,e.charCodeAt(0))});var r=I(e),n=new L(t);return n.visit(r),n.found}var k=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),P="PATTERN",B="defaultMode",D="modes",F="boolean"==typeof RegExp("(?:)").sticky,V=/[^\\][\$]/,G=/[^\\[][\^]|^\^/;function j(t){var e=t.ignoreCase?"i":"";return RegExp("^(?:"+t.source+")",e)}function $(t){var e=t.ignoreCase?"iy":"y";return RegExp(""+t.source,e)}function H(t){var e=t.PATTERN;if((0,A.Kj)(e))return!1;if((0,A.mf)(e)||(0,A.e$)(e,"exec"))return!0;if((0,A.HD)(e))return!1;throw Error("non exhaustive match")}function W(t){return!!(0,A.HD)(t)&&1===t.length&&t.charCodeAt(0)}var Y={test:function(t){for(var e=t.length,r=this.lastIndex;r<e;r++){var n=t.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===t.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function K(t,e){if((0,A.e$)(t,"LINE_BREAKS"))return!1;if((0,A.Kj)(t.PATTERN)){try{_(e,t.PATTERN)}catch(t){return{issue:E.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}if((0,A.HD)(t.PATTERN))return!1;if(H(t))return{issue:E.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function q(t){return(0,A.UI)(t,function(t){return(0,A.HD)(t)&&t.length>0?t.charCodeAt(0):t})}function z(t,e,r){void 0===t[e]?t[e]=[r]:t[e].push(r)}function X(t){return t<256?t:Q[t]}var Q=[];function Z(t,e){var r=t.tokenTypeIdx;return r===e.tokenTypeIdx||!0===e.isParent&&!0===e.categoryMatchesMap[r]}function J(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var tt=1,te={};function tr(t){var e=function(t){for(var e=(0,A.Qw)(t),r=t,n=!0;n;){r=(0,A.oA)((0,A.xH)((0,A.UI)(r,function(t){return t.CATEGORIES})));var o=(0,A.e5)(r,e);e=e.concat(o),(0,A.xb)(o)?n=!1:r=o}return e}(t);(0,A.Ed)(e,function(t){tn(t)||(te[tt]=t,t.tokenTypeIdx=tt++),to(t)&&!(0,A.kJ)(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),to(t)||(t.CATEGORIES=[]),(0,A.e$)(t,"categoryMatches")||(t.categoryMatches=[]),(0,A.e$)(t,"categoryMatchesMap")||(t.categoryMatchesMap={})}),(0,A.Ed)(e,function(t){(function t(e,r){(0,A.Ed)(e,function(t){r.categoryMatchesMap[t.tokenTypeIdx]=!0}),(0,A.Ed)(r.CATEGORIES,function(n){var o=e.concat(r);(0,A.r3)(o,n)||t(o,n)})})([],t)}),(0,A.Ed)(e,function(t){t.categoryMatches=[],(0,A.Ed)(t.categoryMatchesMap,function(e,r){t.categoryMatches.push(te[r].tokenTypeIdx)})}),(0,A.Ed)(e,function(t){t.isParent=t.categoryMatches.length>0})}function tn(t){return(0,A.e$)(t,"tokenTypeIdx")}function to(t){return(0,A.e$)(t,"CATEGORIES")}function ta(t){return(0,A.e$)(t,"tokenTypeIdx")}var ti={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,r,n,o){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+", skipped "+r+" characters."}};(a=E||(E={}))[a.MISSING_PATTERN=0]="MISSING_PATTERN",a[a.INVALID_PATTERN=1]="INVALID_PATTERN",a[a.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",a[a.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",a[a.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",a[a.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",a[a.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",a[a.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",a[a.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",a[a.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",a[a.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",a[a.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",a[a.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",a[a.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",a[a.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",a[a.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",a[a.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK";var tc={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:ti,traceInitPerf:!1,skipValidations:!1};Object.freeze(tc);var tu=function(){function t(t,e){var r=this;if(void 0===e&&(e=tc),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof e)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,A.TS)(tc,e);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var n,o=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===tc.lineTerminatorsPattern)r.config.lineTerminatorsPattern=Y;else if(r.config.lineTerminatorCharacters===tc.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),(0,A.kJ)(t)?((n={modes:{}}).modes[B]=(0,A.Qw)(t),n[B]=B):(o=!1,n=(0,A.Cl)(t))}),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",function(){var t,e;r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat((t=n,r.trackStartLines,r.config.lineTerminatorCharacters,e=[],(0,A.e$)(t,B)||e.push({message:"A MultiMode Lexer cannot be initialized without a <"+B+"> property in its definition\n",type:E.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,A.e$)(t,D)||e.push({message:"A MultiMode Lexer cannot be initialized without a <"+D+"> property in its definition\n",type:E.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,A.e$)(t,D)&&(0,A.e$)(t,B)&&!(0,A.e$)(t.modes,t.defaultMode)&&e.push({message:"A MultiMode Lexer cannot be initialized with a "+B+": <"+t.defaultMode+">which does not exist\n",type:E.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,A.e$)(t,D)&&(0,A.Ed)(t.modes,function(t,r){(0,A.Ed)(t,function(t,n){(0,A.o8)(t)&&e.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+r+"> at index: <"+n+">\n",type:E.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),e))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){var t,e,o,a,i,c,u,s;r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat((t=n,e=r.trackStartLines,o=r.config.lineTerminatorCharacters,a=[],i=!1,c=(0,A.oA)((0,A.xH)((0,A.Q8)(t.modes,function(t){return t}))),u=(0,A.d1)(c,function(t){return t[P]===tu.NA}),s=q(o),e&&(0,A.Ed)(u,function(t){var e=K(t,s);if(!1!==e){var r={message:function(t,e){if(e.issue===E.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n	The problem is in the <"+t.name+"> Token Type\n	 Root cause: "+e.errMsg+".\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===E.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n	The problem is in the <"+t.name+"> Token Type\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(t,e),type:e.issue,tokenType:t};a.push(r)}else(0,A.e$)(t,"LINE_BREAKS")?!0===t.LINE_BREAKS&&(i=!0):_(s,t.PATTERN)&&(i=!0)}),e&&!i&&a.push({message:"Warning: No LINE_BREAKS Found.\n	This Lexer has been defined to track line and column information,\n	But none of the Token Types can be identified as matching a line terminator.\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n	for details.",type:E.NO_LINE_BREAKS_FLAGS}),a))})),n.modes=n.modes?n.modes:{},(0,A.Ed)(n.modes,function(t,e){n.modes[e]=(0,A.d1)(t,function(t){return(0,A.o8)(t)})});var a=(0,A.XP)(n.modes);if((0,A.Ed)(n.modes,function(t,n){r.TRACE_INIT("Mode: <"+n+"> processing",function(){if(r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",function(){var e,n,o,i,c,u,s,l,f,h,p,d,m,g,v,y,N,R,T,w,O,C;r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat((e=[],c=(0,A.hX)(t,function(t){return!(0,A.e$)(t,P)}),n={errors:(0,A.UI)(c,function(t){return{message:"Token Type: ->"+t.name+"<- missing static 'PATTERN' property",type:E.MISSING_PATTERN,tokenTypes:[t]}}),valid:(0,A.e5)(t,c)},e=e.concat(n.errors),i=(u=n.valid,s=(0,A.hX)(u,function(t){var e=t[P];return!(0,A.Kj)(e)&&!(0,A.mf)(e)&&!(0,A.e$)(e,"exec")&&!(0,A.HD)(e)}),o={errors:(0,A.UI)(s,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:E.INVALID_PATTERN,tokenTypes:[t]}}),valid:(0,A.e5)(u,s)}).valid,e=(e=(e=(e=(e=e.concat(o.errors)).concat((l=[],f=(0,A.hX)(i,function(t){return(0,A.Kj)(t[P])}),(l=(l=(l=(l=l.concat((h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return k(e,t),e.prototype.visitEndAnchor=function(t){this.found=!0},e}(M.BaseRegExpVisitor),p=(0,A.hX)(f,function(t){var e=t[P];try{var r=I(e),n=new h;return n.visit(r),n.found}catch(t){return V.test(e.source)}}),(0,A.UI)(p,function(t){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+t.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:E.EOI_ANCHOR_FOUND,tokenTypes:[t]}})))).concat((d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return k(e,t),e.prototype.visitStartAnchor=function(t){this.found=!0},e}(M.BaseRegExpVisitor),m=(0,A.hX)(f,function(t){var e=t[P];try{var r=I(e),n=new d;return n.visit(r),n.found}catch(t){return G.test(e.source)}}),(0,A.UI)(m,function(t){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+t.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:E.SOI_ANCHOR_FOUND,tokenTypes:[t]}})))).concat((g=(0,A.hX)(f,function(t){var e=t[P];return e instanceof RegExp&&(e.multiline||e.global)}),(0,A.UI)(g,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:E.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[t]}})))).concat((v=[],y=(0,A.UI)(f,function(t){return(0,A.u4)(f,function(e,r){return t.PATTERN.source!==r.PATTERN.source||(0,A.r3)(v,r)||r.PATTERN===tu.NA||(v.push(r),e.push(r)),e},[])}),y=(0,A.oA)(y),N=(0,A.hX)(y,function(t){return t.length>1}),(0,A.UI)(N,function(t){var e=(0,A.UI)(t,function(t){return t.name});return{message:"The same RegExp pattern ->"+(0,A.Ps)(t).PATTERN+"<-has been used in all of the following Token Types: "+e.join(", ")+" <-",type:E.DUPLICATE_PATTERNS_FOUND,tokenTypes:t}})))).concat((R=(0,A.hX)(f,function(t){return t[P].test("")}),(0,A.UI)(R,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' must not match an empty string",type:E.EMPTY_MATCH_PATTERN,tokenTypes:[t]}})))))).concat((T=(0,A.hX)(i,function(t){if(!(0,A.e$)(t,"GROUP"))return!1;var e=t.GROUP;return e!==tu.SKIPPED&&e!==tu.NA&&!(0,A.HD)(e)}),(0,A.UI)(T,function(t){return{message:"Token Type: ->"+t.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:E.INVALID_GROUP_TYPE_FOUND,tokenTypes:[t]}})))).concat((w=(0,A.hX)(i,function(t){return void 0!==t.PUSH_MODE&&!(0,A.r3)(a,t.PUSH_MODE)}),(0,A.UI)(w,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist",type:E.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[t]}})))).concat((O=[],C=(0,A.u4)(i,function(t,e,r){var n=e.PATTERN;return n===tu.NA||((0,A.HD)(n)?t.push({str:n,idx:r,tokenType:e}):(0,A.Kj)(n)&&void 0===(0,A.sE)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],function(t){return -1!==n.source.indexOf(t)})&&t.push({str:n.source,idx:r,tokenType:e})),t},[]),(0,A.Ed)(i,function(t,e){(0,A.Ed)(C,function(r){var n=r.str,o=r.idx,a=r.tokenType;if(e<o&&function(t,e){if((0,A.Kj)(e)){var r=e.exec(t);return null!==r&&0===r.index}if((0,A.mf)(e))return e(t,0,[],{});if((0,A.e$)(e,"exec"))return e.exec(t,0,[],{});if("string"==typeof e)return e===t;throw Error("non exhaustive match")}(n,t.PATTERN)){var i="Token: ->"+a.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+t.name+"<-in the lexer's definition.\nSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE";O.push({message:i,type:E.UNREACHABLE_PATTERN,tokenTypes:[t,a]})}})}),O))))}),(0,A.xb)(r.lexerDefinitionErrors)){var o;tr(t),r.TRACE_INIT("analyzeTokenTypes",function(){var n,a,i,c,u,s,l,f,h,p,d,m,g,v,E,y,N;n={lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:r.TRACE_INIT.bind(r)},(v=(n=(0,A.ce)(n,{useSticky:F,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(t,e){return e()}})).tracer)("initCharCodeToOptimizedIndexMap",function(){(function(){if((0,A.xb)(Q)){Q=Array(65536);for(var t=0;t<65536;t++)Q[t]=t>255?255+~~(t/255):t}})()}),v("Reject Lexer.NA",function(){a=(0,A.d1)(t,function(t){return t[P]===tu.NA})}),E=!1,v("Transform Patterns",function(){E=!1,i=(0,A.UI)(a,function(t){var e=t[P];if((0,A.Kj)(e)){var r=e.source;return 1!==r.length||"^"===r||"$"===r||"."===r||e.ignoreCase?2!==r.length||"\\"!==r[0]||(0,A.r3)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?n.useSticky?$(e):j(e):r[1]:r}if((0,A.mf)(e))return E=!0,{exec:e};if((0,A.e$)(e,"exec"))return E=!0,e;if("string"==typeof e){if(1===e.length)return e;var o=new RegExp(e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"));return n.useSticky?$(o):j(o)}throw Error("non exhaustive match")})}),v("misc mapping",function(){c=(0,A.UI)(a,function(t){return t.tokenTypeIdx}),u=(0,A.UI)(a,function(t){var e=t.GROUP;if(e!==tu.SKIPPED){if((0,A.HD)(e))return e;if((0,A.o8)(e))return!1;throw Error("non exhaustive match")}}),s=(0,A.UI)(a,function(t){var e=t.LONGER_ALT;if(e)return(0,A.cq)(a,e)}),l=(0,A.UI)(a,function(t){return t.PUSH_MODE}),f=(0,A.UI)(a,function(t){return(0,A.e$)(t,"POP_MODE")})}),v("Line Terminator Handling",function(){var t=q(n.lineTerminatorCharacters);h=(0,A.UI)(a,function(t){return!1}),"onlyOffset"!==n.positionTracking&&(h=(0,A.UI)(a,function(e){return(0,A.e$)(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===K(e,t)?_(t,e.PATTERN):void 0}))}),v("Misc Mapping #2",function(){p=(0,A.UI)(a,H),d=(0,A.UI)(i,W),m=(0,A.u4)(a,function(t,e){var r=e.GROUP;return(0,A.HD)(r)&&r!==tu.SKIPPED&&(t[r]=[]),t},{}),g=(0,A.UI)(i,function(t,e){return{pattern:i[e],longerAlt:s[e],canLineTerminator:h[e],isCustom:p[e],short:d[e],group:u[e],push:l[e],pop:f[e],tokenTypeIdx:c[e],tokenType:a[e]}})}),y=!0,N=[],n.safeMode||v("First Char Optimization",function(){N=(0,A.u4)(a,function(t,e,r){if("string"==typeof e.PATTERN){var o;z(t,X(e.PATTERN.charCodeAt(0)),g[r])}else if((0,A.kJ)(e.START_CHARS_HINT))(0,A.Ed)(e.START_CHARS_HINT,function(e){var n=X("string"==typeof e?e.charCodeAt(0):e);o!==n&&(o=n,z(t,n,g[r]))});else if((0,A.Kj)(e.PATTERN)){if(e.PATTERN.unicode)y=!1,n.ensureOptimizations&&(0,A.WB)(""+b+"	Unable to analyze < "+e.PATTERN.toString()+" > pattern.\n	The regexp unicode flag is not currently supported by the regexp-to-ast library.\n	This will disable the lexer's first char optimizations.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var a=function(t,e){void 0===e&&(e=!1);try{var r=I(t);return function t(e,r,n){switch(e.type){case"Disjunction":for(var o=0;o<e.value.length;o++)t(e.value[o],r,n);break;case"Alternative":for(var a=e.value,o=0;o<a.length;o++){var i=a[o];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}switch(i.type){case"Character":U(i.value,r,n);break;case"Set":if(!0===i.complement)throw Error(S);(0,A.Ed)(i.value,function(t){if("number"==typeof t)U(t,r,n);else if(!0===n)for(var e=t.from;e<=t.to;e++)U(e,r,n);else{for(var e=t.from;e<=t.to&&e<256;e++)U(e,r,n);if(t.to>=256)for(var o=t.from>=256?t.from:256,a=t.to,i=X(o),c=X(a),u=i;u<=c;u++)r[u]=u}});break;case"Group":t(i.value,r,n);break;default:throw Error("Non Exhaustive Match")}var c=void 0!==i.quantifier&&0===i.quantifier.atLeast;if("Group"===i.type&&!1===function t(e){return!!e.quantifier&&0===e.quantifier.atLeast||!!e.value&&((0,A.kJ)(e.value)?(0,A.yW)(e.value,t):t(e.value))}(i)||"Group"!==i.type&&!1===c)break}break;default:throw Error("non exhaustive match!")}return(0,A.VO)(r)}(r.value,{},r.flags.ignoreCase)}catch(r){if(r.message===S)e&&(0,A.rr)(""+b+"	Unable to optimize: < "+t.toString()+" >\n	Complement Sets cannot be automatically optimized.\n	This will disable the lexer's first char optimizations.\n	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";e&&(n="\n	This will disable the lexer's first char optimizations.\n	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),(0,A.WB)(b+"\n	Failed parsing: < "+t.toString()+" >\n	Using the regexp-to-ast library version: "+M.VERSION+"\n	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}(e.PATTERN,n.ensureOptimizations);(0,A.xb)(a)&&(y=!1),(0,A.Ed)(a,function(e){z(t,e,g[r])})}}else n.ensureOptimizations&&(0,A.WB)(""+b+"	TokenType: <"+e.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n	This will disable the lexer's first char optimizations.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),y=!1;return t},[])}),v("ArrayPacking",function(){N=(0,A.X0)(N)}),o={emptyGroups:m,patternIdxToConfig:g,charCodeToPatternIdxToConfig:N,hasCustom:E,canBeOptimized:y}}),r.patternIdxToConfig[n]=o.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=o.charCodeToPatternIdxToConfig,r.emptyGroups=(0,A.TS)(r.emptyGroups,o.emptyGroups),r.hasCustom=o.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=o.canBeOptimized}})}),r.defaultMode=n.defaultMode,!(0,A.xb)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling)throw Error("Errors detected in definition of Lexer:\n"+(0,A.UI)(r.lexerDefinitionErrors,function(t){return t.message}).join("-----------------------\n"));(0,A.Ed)(r.lexerDefinitionWarning,function(t){(0,A.rr)(t.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(F?(r.chopInput=A.Wd,r.match=r.matchWithTest):(r.updateLastIndex=A.dG,r.match=r.matchWithExec),o&&(r.handleModes=A.dG),!1===r.trackStartLines&&(r.computeNewColumn=A.Wd),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=A.dG),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var t=(0,A.u4)(r.canModeBeOptimized,function(t,e,r){return!1===e&&t.push(r),t},[]);if(e.ensureOptimizations&&!(0,A.xb)(t))throw Error("Lexer Modes: < "+t.join(", ")+' > cannot be optimized.\n	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n	 Or inspect the console log for details on how to resolve these issues.')}),r.TRACE_INIT("clearRegExpParserCache",function(){w={}}),r.TRACE_INIT("toFastProperties",function(){(0,A.SV)(r)})})}return t.prototype.tokenize=function(t,e){if(void 0===e&&(e=this.defaultMode),!(0,A.xb)(this.lexerDefinitionErrors))throw Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+(0,A.UI)(this.lexerDefinitionErrors,function(t){return t.message}).join("-----------------------\n"));return this.tokenizeInternal(t,e)},t.prototype.tokenizeInternal=function(t,e){var r,n,o,a,i,c,u,s,l,f,h,p,d,m,g,v,E,y,N=this,R=t,T=R.length,M=0,w=0,O=Array(this.hasCustom?0:Math.floor(t.length/10)),I=[],C=this.trackStartLines?1:void 0,S=this.trackStartLines?1:void 0,b=(r=this.emptyGroups,n={},o=(0,A.XP)(r),(0,A.Ed)(o,function(t){var e=r[t];if((0,A.kJ)(e))n[t]=[];else throw Error("non exhaustive match")}),n),U=this.trackStartLines,x=this.config.lineTerminatorsPattern,L=0,_=[],k=[],P=[],B=[];Object.freeze(B);var D=void 0;function F(){return _}function V(t){var e=k[X(t)];return void 0===e?B:e}var G=function(t){if(1===P.length&&void 0===t.tokenType.PUSH_MODE){var e=N.config.errorMessageProvider.buildUnableToPopLexerModeMessage(t);I.push({offset:t.startOffset,line:void 0!==t.startLine?t.startLine:void 0,column:void 0!==t.startColumn?t.startColumn:void 0,length:t.image.length,message:e})}else{P.pop();var r=(0,A.Z$)(P);_=N.patternIdxToConfig[r],k=N.charCodeToPatternIdxToConfig[r],L=_.length;var n=N.canModeBeOptimized[r]&&!1===N.config.safeMode;D=k&&n?V:F}};function j(t){P.push(t),k=this.charCodeToPatternIdxToConfig[t],L=(_=this.patternIdxToConfig[t]).length,L=_.length;var e=this.canModeBeOptimized[t]&&!1===this.config.safeMode;D=k&&e?V:F}for(j.call(this,e);M<T;){s=null;var $=R.charCodeAt(M),H=D($),W=H.length;for(a=0;a<W;a++){var Y=(y=H[a]).pattern;l=null;var K=y.short;if(!1!==K?$===K&&(s=Y):!0===y.isCustom?null!==(E=Y.exec(R,M,O,b))?(s=E[0],void 0!==E.payload&&(l=E.payload)):s=null:(this.updateLastIndex(Y,M),s=this.match(Y,t,M)),null!==s){if(void 0!==(u=y.longerAlt)){var q=_[u],z=q.pattern;f=null,!0===q.isCustom?null!==(E=z.exec(R,M,O,b))?(c=E[0],void 0!==E.payload&&(f=E.payload)):c=null:(this.updateLastIndex(z,M),c=this.match(z,t,M)),c&&c.length>s.length&&(s=c,l=f,y=q)}break}}if(null!==s){if(h=s.length,void 0!==(p=y.group)&&(d=y.tokenTypeIdx,m=this.createTokenInstance(s,M,d,y.tokenType,C,S,h),this.handlePayload(m,l),!1===p?w=this.addToken(O,w,m):b[p].push(m)),t=this.chopInput(t,h),M+=h,S=this.computeNewColumn(S,h),!0===U&&!0===y.canLineTerminator){var Q=0,Z=void 0,J=void 0;x.lastIndex=0;do!0===(Z=x.test(s))&&(J=x.lastIndex-1,Q++);while(!0===Z);0!==Q&&(C+=Q,S=h-J,this.updateTokenEndLineColumnLocation(m,p,J,Q,C,S,h))}this.handleModes(y,G,j,m)}else{for(var tt=M,te=C,tr=S,tn=!1;!tn&&M<T;)for(R.charCodeAt(M),t=this.chopInput(t,1),M++,i=0;i<L;i++){var to=_[i],Y=to.pattern,K=to.short;if(!1!==K?R.charCodeAt(M)===K&&(tn=!0):!0===to.isCustom?tn=null!==Y.exec(R,M,O,b):(this.updateLastIndex(Y,M),tn=null!==Y.exec(t)),!0===tn)break}g=M-tt,v=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(R,tt,g,te,tr),I.push({offset:tt,line:te,column:tr,length:g,message:v})}}return this.hasCustom||(O.length=w),{tokens:O,groups:b,errors:I}},t.prototype.handleModes=function(t,e,r,n){if(!0===t.pop){var o=t.push;e(n),void 0!==o&&r.call(this,o)}else void 0!==t.push&&r.call(this,t.push)},t.prototype.chopInput=function(t,e){return t.substring(e)},t.prototype.updateLastIndex=function(t,e){t.lastIndex=e},t.prototype.updateTokenEndLineColumnLocation=function(t,e,r,n,o,a,i){var c,u;void 0===e||(u=(c=r===i-1)?-1:0,1===n&&!0===c||(t.endLine=o+u,t.endColumn=a-1+-u))},t.prototype.computeNewColumn=function(t,e){return t+e},t.prototype.createTokenInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},t.prototype.createOffsetOnlyToken=function(t,e,r,n){return{image:t,startOffset:e,tokenTypeIdx:r,tokenType:n}},t.prototype.createStartOnlyToken=function(t,e,r,n,o,a){return{image:t,startOffset:e,startLine:o,startColumn:a,tokenTypeIdx:r,tokenType:n}},t.prototype.createFullToken=function(t,e,r,n,o,a,i){return{image:t,startOffset:e,endOffset:e+i-1,startLine:o,endLine:o,startColumn:a,endColumn:a+i-1,tokenTypeIdx:r,tokenType:n}},t.prototype.addToken=function(t,e,r){return 666},t.prototype.addTokenUsingPush=function(t,e,r){return t.push(r),e},t.prototype.addTokenUsingMemberAccess=function(t,e,r){return t[e]=r,++e},t.prototype.handlePayload=function(t,e){},t.prototype.handlePayloadNoCustom=function(t,e){},t.prototype.handlePayloadWithCustom=function(t,e){null!==e&&(t.payload=e)},t.prototype.match=function(t,e,r){return null},t.prototype.matchWithTest=function(t,e,r){return!0===t.test(e)?e.substring(r,t.lastIndex):null},t.prototype.matchWithExec=function(t,e){var r=t.exec(e);return null!==r?r[0]:r},t.prototype.TRACE_INIT=function(t,e){if(!0!==this.traceInitPerf)return e();this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var n=(0,A.HT)(e),o=n.time,a=n.value,i=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&i(r+"<-- <"+t+"> time: "+o+"ms"),this.traceInitIndent--,a},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function ts(t){return tf(t)?t.LABEL:t.name}function tl(t){return t.name}function tf(t){return(0,A.HD)(t.LABEL)&&""!==t.LABEL}var th="categories",tp="label",td="group",tm="push_mode",tg="pop_mode",tv="longer_alt",tE="line_breaks",ty="start_chars_hint";function tN(t){return tR(t)}function tR(t){var e=t.pattern,r={};if(r.name=t.name,(0,A.o8)(e)||(r.PATTERN=e),(0,A.e$)(t,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,A.e$)(t,th)&&(r.CATEGORIES=t[th]),tr([r]),(0,A.e$)(t,tp)&&(r.LABEL=t[tp]),(0,A.e$)(t,td)&&(r.GROUP=t[td]),(0,A.e$)(t,tg)&&(r.POP_MODE=t[tg]),(0,A.e$)(t,tm)&&(r.PUSH_MODE=t[tm]),(0,A.e$)(t,tv)&&(r.LONGER_ALT=t[tv]),(0,A.e$)(t,tE)&&(r.LINE_BREAKS=t[tE]),(0,A.e$)(t,ty)&&(r.START_CHARS_HINT=t[ty]),r}var tT=tR({name:"EOF",pattern:tu.NA});function tA(t,e,r,n,o,a,i,c){return{image:e,startOffset:r,endOffset:n,startLine:o,endLine:a,startColumn:i,endColumn:c,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function tM(t,e){return Z(t,e)}tr([tT]);var tw=(i=function(t,e){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),tO=function(){function t(t){this._definition=t}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),t.prototype.accept=function(t){t.visit(this),(0,A.Ed)(this.definition,function(e){e.accept(t)})},t}(),tI=function(t){function e(e){var r=t.call(this,[])||this;return r.idx=1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(tO),tC=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.orgText="",(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),e}(tO),tS=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.ignoreAmbiguities=!1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),e}(tO),tb=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),e}(tO),tU=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),e}(tO),tx=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),e}(tO),tL=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),e}(tO),t_=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),e}(tO),tk=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,(0,A.f0)(r,(0,A.ei)(e,function(t){return void 0!==t})),r}return tw(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),e}(tO),tP=function(){function t(t){this.idx=1,(0,A.f0)(this,(0,A.ei)(t,function(t){return void 0!==t}))}return t.prototype.accept=function(t){t.visit(this)},t}();function tB(t){return(0,A.UI)(t,tD)}function tD(t){function e(t){return(0,A.UI)(t,tD)}if(t instanceof tI)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof tS)return{type:"Alternative",definition:e(t.definition)};if(t instanceof tb)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof tU)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof tx)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:tD(new tP({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof t_)return{type:"RepetitionWithSeparator",idx:t.idx,separator:tD(new tP({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof tL)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};else if(t instanceof tk)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};else if(t instanceof tP){var r={type:"Terminal",name:t.terminalType.name,label:ts(t.terminalType),idx:t.idx},n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=(0,A.Kj)(n)?n.source:n),r}else if(t instanceof tC)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};else throw Error("non exhaustive match")}var tF=function(){function t(){}return t.prototype.walk=function(t,e){var r=this;void 0===e&&(e=[]),(0,A.Ed)(t.definition,function(n,o){var a=(0,A.Cw)(t.definition,o+1);if(n instanceof tI)r.walkProdRef(n,a,e);else if(n instanceof tP)r.walkTerminal(n,a,e);else if(n instanceof tS)r.walkFlat(n,a,e);else if(n instanceof tb)r.walkOption(n,a,e);else if(n instanceof tU)r.walkAtLeastOne(n,a,e);else if(n instanceof tx)r.walkAtLeastOneSep(n,a,e);else if(n instanceof t_)r.walkManySep(n,a,e);else if(n instanceof tL)r.walkMany(n,a,e);else if(n instanceof tk)r.walkOr(n,a,e);else throw Error("non exhaustive match")})},t.prototype.walkTerminal=function(t,e,r){},t.prototype.walkProdRef=function(t,e,r){},t.prototype.walkFlat=function(t,e,r){var n=e.concat(r);this.walk(t,n)},t.prototype.walkOption=function(t,e,r){var n=e.concat(r);this.walk(t,n)},t.prototype.walkAtLeastOne=function(t,e,r){var n=[new tb({definition:t.definition})].concat(e,r);this.walk(t,n)},t.prototype.walkAtLeastOneSep=function(t,e,r){var n=tV(t,e,r);this.walk(t,n)},t.prototype.walkMany=function(t,e,r){var n=[new tb({definition:t.definition})].concat(e,r);this.walk(t,n)},t.prototype.walkManySep=function(t,e,r){var n=tV(t,e,r);this.walk(t,n)},t.prototype.walkOr=function(t,e,r){var n=this,o=e.concat(r);(0,A.Ed)(t.definition,function(t){var e=new tS({definition:[t]});n.walk(e,o)})},t}();function tV(t,e,r){return[new tb({definition:[new tP({terminalType:t.separator})].concat(t.definition)})].concat(e,r)}var tG=function(){function t(){}return t.prototype.visit=function(t){switch(t.constructor){case tI:return this.visitNonTerminal(t);case tS:return this.visitAlternative(t);case tb:return this.visitOption(t);case tU:return this.visitRepetitionMandatory(t);case tx:return this.visitRepetitionMandatoryWithSeparator(t);case t_:return this.visitRepetitionWithSeparator(t);case tL:return this.visitRepetition(t);case tk:return this.visitAlternation(t);case tP:return this.visitTerminal(t);case tC:return this.visitRule(t);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(t){},t.prototype.visitAlternative=function(t){},t.prototype.visitOption=function(t){},t.prototype.visitRepetition=function(t){},t.prototype.visitRepetitionMandatory=function(t){},t.prototype.visitRepetitionMandatoryWithSeparator=function(t){},t.prototype.visitRepetitionWithSeparator=function(t){},t.prototype.visitAlternation=function(t){},t.prototype.visitTerminal=function(t){},t.prototype.visitRule=function(t){},t}(),tj=(c=function(t,e){return(c=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});function t$(t,e){return void 0===e&&(e=[]),t instanceof tb||t instanceof tL||t instanceof t_||(t instanceof tk?(0,A.G)(t.definition,function(t){return t$(t,e)}):!(t instanceof tI&&(0,A.r3)(e,t))&&t instanceof tO&&(t instanceof tI&&e.push(t),(0,A.yW)(t.definition,function(t){return t$(t,e)})))}function tH(t){if(t instanceof tI)return"SUBRULE";if(t instanceof tb)return"OPTION";if(t instanceof tk)return"OR";if(t instanceof tU)return"AT_LEAST_ONE";if(t instanceof tx)return"AT_LEAST_ONE_SEP";if(t instanceof t_)return"MANY_SEP";if(t instanceof tL)return"MANY";else if(t instanceof tP)return"CONSUME";else throw Error("non exhaustive match")}var tW=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}return tj(e,t),e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var e=t.terminalType.name+this.separator+"Terminal";(0,A.e$)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitNonTerminal=function(t){var e=t.nonTerminalName+this.separator+"Terminal";(0,A.e$)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(tG),tY=new tW;function tK(t){if(t instanceof tI)return tK(t.referencedRule);if(t instanceof tP)return[t.terminalType];if(t instanceof tS||t instanceof tb||t instanceof tL||t instanceof tU||t instanceof tx||t instanceof t_||t instanceof tP||t instanceof tC)return function(t){for(var e,r=[],n=t.definition,o=0,a=n.length>o,i=!0;a&&i;)i=t$(e=n[o]),r=r.concat(tK(e)),o+=1,a=n.length>o;return(0,A.jj)(r)}(t);if(t instanceof tk){var e;return e=(0,A.UI)(t.definition,function(t){return tK(t)}),(0,A.jj)((0,A.xH)(e))}throw Error("non exhaustive match")}var tq="_~IN~_",tz=(u=function(t,e){return(u=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),tX=function(t){function e(e){var r=t.call(this)||this;return r.topProd=e,r.follows={},r}return tz(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,e,r){},e.prototype.walkProdRef=function(t,e,r){var n,o,a=(n=t.referencedRule,o=t.idx,n.name+o+tq+this.topProd.name),i=tK(new tS({definition:e.concat(r)}));this.follows[a]=i},e}(tF),tQ={buildMismatchTokenMessage:function(t){var e=t.expected,r=t.actual;return t.previous,t.ruleName,"Expecting "+(tf(e)?"--> "+ts(e)+" <--":"token of type --> "+e.name+" <--")+" but found --> '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;return t.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,r=t.actual,n=(t.previous,t.customUserDescription);t.ruleName;var o="Expecting: ",a="\nbut found: '"+(0,A.Ps)(r).image+"'";if(n)return o+n+a;var i=(0,A.u4)(e,function(t,e){return t.concat(e)},[]),c=(0,A.UI)(i,function(t){return"["+(0,A.UI)(t,function(t){return ts(t)}).join(", ")+"]"});return o+"one of these possible Token sequences:\n"+(0,A.UI)(c,function(t,e){return"  "+(e+1)+". "+t}).join("\n")+a},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,r=t.actual,n=t.customUserDescription;t.ruleName;var o="Expecting: ",a="\nbut found: '"+(0,A.Ps)(r).image+"'";return n?o+n+a:o+"expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+(0,A.UI)(e,function(t){return"["+(0,A.UI)(t,function(t){return ts(t)}).join(",")+"]"}).join(" ,")+">"+a}};Object.freeze(tQ);var tZ={buildRuleNotFoundError:function(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+"<-\ninside top level rule: ->"+t.name+"<-"}},tJ={buildDuplicateFoundError:function(t,e){var r=t.name,n=(0,A.Ps)(e),o=n.idx,a=tH(n),i=n instanceof tP?n.terminalType.name:n instanceof tI?n.nonTerminalName:"",c="->"+a+(o>0?o:"")+"<- "+(i?"with argument: ->"+i+"<-":"")+"\n                  appears more than once ("+e.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return(c=c.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildNamespaceConflictError:function(t){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(t){var e=(0,A.UI)(t.prefixPath,function(t){return ts(t)}).join(", "),r=0===t.alternation.idx?"":t.alternation.idx;return"Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\n"+("in <OR"+r)+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(t){var e=(0,A.UI)(t.prefixPath,function(t){return ts(t)}).join(", "),r=0===t.alternation.idx?"":t.alternation.idx;return"Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(t){var e=tH(t.repetition);return 0!==t.repetition.idx&&(e+=t.repetition.idx),"The repetition <"+e+"> within Rule <"+t.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(t){return"deprecated"},buildEmptyAlternationError:function(t){return"Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+">"+(" in <OR"+t.alternation.idx)+"> inside <"+t.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(t){return"An Alternation cannot have more than 256 alternatives:\n"+("<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name)+"> Rule.\n has "+(t.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(t){var e=t.topLevelRule.name,r=e+" --> "+A.UI(t.leftRecursionPath,function(t){return t.name}).concat([e]).join(" --> ");return"Left Recursion found in grammar.\nrule: <"+e+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+r+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(t){return"deprecated"},buildDuplicateRuleNameError:function(t){return"Duplicate definition, rule: ->"+(t.topLevelRule instanceof tC?t.topLevelRule.name:t.topLevelRule)+"<- is already defined in the grammar: ->"+t.grammarName+"<-"}},t0=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),t1=function(t){function e(e,r){var n=t.call(this)||this;return n.nameToTopRule=e,n.errMsgProvider=r,n.errors=[],n}return t0(e,t),e.prototype.resolveRefs=function(){var t=this;(0,A.Ed)((0,A.VO)(this.nameToTopRule),function(e){t.currTopLevel=e,e.accept(t)})},e.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule[t.nonTerminalName];if(e)t.referencedRule=e;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:r,type:R.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(tG),t2=(l=function(t,e){return(l=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),t3=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return t2(e,t),e.prototype.walkTerminal=function(t,e,r){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var n=new tS({definition:e.concat(r)});this.possibleTokTypes=tK(n),this.found=!0}},e}(function(t){function e(e,r){var n=t.call(this)||this;return n.topProd=e,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return t2(e,t),e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,A.Qw)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,A.Qw)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(e,r){void 0===r&&(r=[]),this.found||t.prototype.walk.call(this,e,r)},e.prototype.walkProdRef=function(t,e,r){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var n=e.concat(r);this.updateExpectedNext(),this.walk(t.referencedRule,n)}},e.prototype.updateExpectedNext=function(){(0,A.xb)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(tF)),t4=function(t){function e(e,r){var n=t.call(this)||this;return n.topRule=e,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return t2(e,t),e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(tF),t5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t2(e,t),e.prototype.walkMany=function(e,r,n){if(e.idx===this.occurrence){var o=(0,A.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkMany.call(this,e,r,n)},e}(t4),t6=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t2(e,t),e.prototype.walkManySep=function(e,r,n){if(e.idx===this.occurrence){var o=(0,A.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkManySep.call(this,e,r,n)},e}(t4),t8=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t2(e,t),e.prototype.walkAtLeastOne=function(e,r,n){if(e.idx===this.occurrence){var o=(0,A.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOne.call(this,e,r,n)},e}(t4),t7=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return t2(e,t),e.prototype.walkAtLeastOneSep=function(e,r,n){if(e.idx===this.occurrence){var o=(0,A.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tP&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOneSep.call(this,e,r,n)},e}(t4);function t9(t,e,r){void 0===r&&(r=[]),r=(0,A.Qw)(r);var n=[],o=0;function a(a){var i=t9(a.concat((0,A.Cw)(t,o+1)),e,r);return n.concat(i)}for(;r.length<e&&o<t.length;){var i=t[o];if(i instanceof tS||i instanceof tI)return a(i.definition);if(i instanceof tb)n=a(i.definition);else if(i instanceof tU){var c=i.definition.concat([new tL({definition:i.definition})]);return a(c)}else if(i instanceof tx){var c=[new tS({definition:i.definition}),new tL({definition:[new tP({terminalType:i.separator})].concat(i.definition)})];return a(c)}else if(i instanceof t_){var c=i.definition.concat([new tL({definition:[new tP({terminalType:i.separator})].concat(i.definition)})]);n=a(c)}else if(i instanceof tL){var c=i.definition.concat([new tL({definition:i.definition})]);n=a(c)}else if(i instanceof tk)return(0,A.Ed)(i.definition,function(t){!1===(0,A.xb)(t.definition)&&(n=a(t.definition))}),n;else if(i instanceof tP)r.push(i.terminalType);else throw Error("non exhaustive match");o++}return n.push({partialPath:r,suffixDef:(0,A.Cw)(t,o)}),n}function et(t,e,r,n){var o="EXIT_NONE_TERMINAL",a=[o],i="EXIT_ALTERNATIVE",c=!1,u=e.length,s=u-n-1,l=[],f=[];for(f.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!(0,A.xb)(f);){var h=f.pop();if(h===i){c&&(0,A.Z$)(f).idx<=s&&f.pop();continue}var p=h.def,d=h.idx,m=h.ruleStack,g=h.occurrenceStack;if(!(0,A.xb)(p)){var v=p[0];if(v===o){var E={idx:d,def:(0,A.Cw)(p),ruleStack:(0,A.j7)(m),occurrenceStack:(0,A.j7)(g)};f.push(E)}else if(v instanceof tP){if(d<u-1){var y=d+1;if(r(e[y],v.terminalType)){var E={idx:y,def:(0,A.Cw)(p),ruleStack:m,occurrenceStack:g};f.push(E)}}else if(d===u-1)l.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:m,occurrenceStack:g}),c=!0;else throw Error("non exhaustive match")}else if(v instanceof tI){var N=(0,A.Qw)(m);N.push(v.nonTerminalName);var R=(0,A.Qw)(g);R.push(v.idx);var E={idx:d,def:v.definition.concat(a,(0,A.Cw)(p)),ruleStack:N,occurrenceStack:R};f.push(E)}else if(v instanceof tb){var T={idx:d,def:(0,A.Cw)(p),ruleStack:m,occurrenceStack:g};f.push(T),f.push(i);var M={idx:d,def:v.definition.concat((0,A.Cw)(p)),ruleStack:m,occurrenceStack:g};f.push(M)}else if(v instanceof tU){var w=new tL({definition:v.definition,idx:v.idx}),O=v.definition.concat([w],(0,A.Cw)(p)),E={idx:d,def:O,ruleStack:m,occurrenceStack:g};f.push(E)}else if(v instanceof tx){var I=new tP({terminalType:v.separator}),w=new tL({definition:[I].concat(v.definition),idx:v.idx}),O=v.definition.concat([w],(0,A.Cw)(p)),E={idx:d,def:O,ruleStack:m,occurrenceStack:g};f.push(E)}else if(v instanceof t_){var T={idx:d,def:(0,A.Cw)(p),ruleStack:m,occurrenceStack:g};f.push(T),f.push(i);var I=new tP({terminalType:v.separator}),C=new tL({definition:[I].concat(v.definition),idx:v.idx}),O=v.definition.concat([C],(0,A.Cw)(p)),M={idx:d,def:O,ruleStack:m,occurrenceStack:g};f.push(M)}else if(v instanceof tL){var T={idx:d,def:(0,A.Cw)(p),ruleStack:m,occurrenceStack:g};f.push(T),f.push(i);var C=new tL({definition:v.definition,idx:v.idx}),O=v.definition.concat([C],(0,A.Cw)(p)),M={idx:d,def:O,ruleStack:m,occurrenceStack:g};f.push(M)}else if(v instanceof tk)for(var S=v.definition.length-1;S>=0;S--){var b={idx:d,def:v.definition[S].definition.concat((0,A.Cw)(p)),ruleStack:m,occurrenceStack:g};f.push(b),f.push(i)}else if(v instanceof tS)f.push({idx:d,def:v.definition.concat((0,A.Cw)(p)),ruleStack:m,occurrenceStack:g});else if(v instanceof tC)f.push(function(t,e,r,n){var o=(0,A.Qw)(r);o.push(t.name);var a=(0,A.Qw)(n);return a.push(1),{idx:e,def:t.definition,ruleStack:o,occurrenceStack:a}}(v,d,m,g));else throw Error("non exhaustive match")}}return l}var ee=(f=function(t,e){return(f=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});(h=y||(y={}))[h.OPTION=0]="OPTION",h[h.REPETITION=1]="REPETITION",h[h.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",h[h.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",h[h.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",h[h.ALTERNATION=5]="ALTERNATION";var er=function(t){function e(e,r,n){var o=t.call(this)||this;return o.topProd=e,o.targetOccurrence=r,o.targetProdType=n,o}return ee(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,e,r,n){return t.idx===this.targetOccurrence&&this.targetProdType===e&&(this.restDef=r.concat(n),!0)},e.prototype.walkOption=function(e,r,n){this.checkIsTarget(e,y.OPTION,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkAtLeastOne=function(e,r,n){this.checkIsTarget(e,y.REPETITION_MANDATORY,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkAtLeastOneSep=function(e,r,n){this.checkIsTarget(e,y.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkMany=function(e,r,n){this.checkIsTarget(e,y.REPETITION,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkManySep=function(e,r,n){this.checkIsTarget(e,y.REPETITION_WITH_SEPARATOR,r,n)||t.prototype.walkOption.call(this,e,r,n)},e}(tF),en=function(t){function e(e,r,n){var o=t.call(this)||this;return o.targetOccurrence=e,o.targetProdType=r,o.targetRef=n,o.result=[],o}return ee(e,t),e.prototype.checkIsTarget=function(t,e){t.idx===this.targetOccurrence&&this.targetProdType===e&&(void 0===this.targetRef||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,y.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,y.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,y.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,y.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,y.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,y.ALTERNATION)},e}(tG);function eo(t){for(var e=Array(t),r=0;r<t;r++)e[r]=[];return e}function ea(t){for(var e=[""],r=0;r<t.length;r++){for(var n=t[r],o=[],a=0;a<e.length;a++){var i=e[a];o.push(i+"_"+n.tokenTypeIdx);for(var c=0;c<n.categoryMatches.length;c++){var u="_"+n.categoryMatches[c];o.push(i+u)}}e=o}return e}function ei(t,e){for(var r=(0,A.UI)(t,function(t){return t9([t],1)}),n=eo(r.length),o=(0,A.UI)(r,function(t){var e={};return(0,A.Ed)(t,function(t){var r=ea(t.partialPath);(0,A.Ed)(r,function(t){e[t]=!0})}),e}),a=r,i=1;i<=e;i++){var c=a;a=eo(c.length);for(var u=function(t){for(var r=c[t],u=0;u<r.length;u++){var s=r[u].partialPath,l=r[u].suffixDef,f=ea(s);if(function(t,e,r){for(var n=0;n<t.length;n++)if(n!==r){for(var o=t[n],a=0;a<e.length;a++)if(!0===o[e[a]])return!1}return!0}(o,f,t)||(0,A.xb)(l)||s.length===e){var h=n[t];if(!1===es(h,s)){h.push(s);for(var p=0;p<f.length;p++){var d=f[p];o[t][d]=!0}}}else{var m=t9(l,i+1,s);a[t]=a[t].concat(m),(0,A.Ed)(m,function(e){var r=ea(e.partialPath);(0,A.Ed)(r,function(e){o[t][e]=!0})})}}},s=0;s<c.length;s++)u(s)}return n}function ec(t,e,r,n){var o=new en(t,y.ALTERNATION,n);return e.accept(o),ei(o.result,r)}function eu(t,e,r,n){var o=new en(t,r);e.accept(o);var a=o.result,i=new er(e,t,r).startWalking();return ei([new tS({definition:a}),new tS({definition:i})],n)}function es(t,e){t:for(var r=0;r<t.length;r++){var n=t[r];if(n.length===e.length){for(var o=0;o<n.length;o++){var a=e[o],i=n[o];if(!1==(a===i||void 0!==i.categoryMatchesMap[a.tokenTypeIdx]))continue t}return!0}}return!1}function el(t){return(0,A.yW)(t,function(t){return(0,A.yW)(t,function(t){return(0,A.yW)(t,function(t){return(0,A.xb)(t.categoryMatches)})})})}var ef=(p=function(t,e){return(p=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});function eh(t){return tH(t)+"_#_"+t.idx+"_#_"+ep(t)}function ep(t){return t instanceof tP?t.terminalType.name:t instanceof tI?t.nonTerminalName:""}var ed=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return ef(e,t),e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(tG),em=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alternations=[],e}return ef(e,t),e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(tG),eg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return ef(e,t),e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(tG);function ev(t){t=(0,A.ce)(t,{errMsgProvider:tZ});var e,r={};return(0,A.Ed)(t.rules,function(t){r[t.name]=t}),(e=new t1(r,t.errMsgProvider)).resolveRefs(),e.errors}function eE(t){var e,r,n,o,a,i,c,u,s,l,f,h,p,d,m;return e=(t=(0,A.ce)(t,{errMsgProvider:tJ})).rules,r=t.maxLookahead,n=t.tokenTypes,o=t.errMsgProvider,a=t.grammarName,i=A.UI(e,function(t){return function(t,e){var r=new ed;t.accept(r);var n=r.allProductions,o=A.vM(n,eh),a=A.ei(o,function(t){return t.length>1});return A.UI(A.VO(a),function(r){var n=A.Ps(r),o=e.buildDuplicateFoundError(t,r),a=tH(n),i={message:o,type:R.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:a,occurrence:n.idx},c=ep(n);return c&&(i.parameter=c),i})}(t,o)}),c=A.UI(e,function(t){return function t(e,r,n,o){void 0===o&&(o=[]);var a=[],i=function t(e){var r=[];if(A.xb(e))return r;var n=A.Ps(e);if(n instanceof tI)r.push(n.referencedRule);else if(n instanceof tS||n instanceof tb||n instanceof tU||n instanceof tx||n instanceof t_||n instanceof tL)r=r.concat(t(n.definition));else if(n instanceof tk)r=A.xH(A.UI(n.definition,function(e){return t(e.definition)}));else if(n instanceof tP);else throw Error("non exhaustive match");var o=t$(n),a=e.length>1;if(!o||!a)return r;var i=A.Cw(e);return r.concat(t(i))}(r.definition);if(A.xb(i))return[];var c=e.name;A.r3(i,e)&&a.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:o}),type:R.LEFT_RECURSION,ruleName:c});var u=A.e5(i,o.concat([e])),s=A.UI(u,function(r){var a=A.Qw(o);return a.push(r),t(e,r,n,a)});return a.concat(A.xH(s))}(t,t,o)}),u=[],s=[],l=[],(0,A.yW)(c,A.xb)&&(u=(0,A.UI)(e,function(t){return function(t,e){var r=new em;t.accept(r);var n=r.alternations;return A.u4(n,function(r,n){var o=A.j7(n.definition),a=A.UI(o,function(r,o){var a=et([r],[],null,1);return A.xb(a)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:n,emptyChoiceIdx:o}),type:R.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:n.idx,alternative:o+1}:null});return r.concat(A.oA(a))},[])}(t,o)}),s=(0,A.UI)(e,function(t){return function(t,e,r){var n=new em;t.accept(n);var o=n.alternations;return o=(0,A.d1)(o,function(t){return!0===t.ignoreAmbiguities}),A.u4(o,function(n,o){var a,i,c,u,s=ec(o.idx,t,o.maxLookahead||e,o),l=(a=[],i=(0,A.u4)(s,function(t,e,r){return!0===o.definition[r].ignoreAmbiguities||(0,A.Ed)(e,function(e){var n=[r];(0,A.Ed)(s,function(t,a){r!==a&&es(t,e)&&!0!==o.definition[a].ignoreAmbiguities&&n.push(a)}),n.length>1&&!es(a,e)&&(a.push(e),t.push({alts:n,path:e}))}),t},[]),A.UI(i,function(e){var n=(0,A.UI)(e.alts,function(t){return t+1});return{message:r.buildAlternationAmbiguityError({topLevelRule:t,alternation:o,ambiguityIndices:n,prefixPath:e.path}),type:R.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:o.idx,alternatives:[e.alts]}})),f=(c=[],u=(0,A.u4)(s,function(t,e,r){var n=(0,A.UI)(e,function(t){return{idx:r,path:t}});return t.concat(n)},[]),(0,A.Ed)(u,function(e){if(!0!==o.definition[e.idx].ignoreAmbiguities){var n=e.idx,a=e.path,i=(0,A.Oq)(u,function(t){var e;return!0!==o.definition[t.idx].ignoreAmbiguities&&t.idx<n&&(e=t.path).length<a.length&&(0,A.yW)(e,function(t,e){var r=a[e];return t===r||r.categoryMatchesMap[t.tokenTypeIdx]})}),s=(0,A.UI)(i,function(e){var a=[e.idx+1,n+1],i=0===o.idx?"":o.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:o,ambiguityIndices:a,prefixPath:e.path}),type:R.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:i,alternatives:a}});c=c.concat(s)}}),c);return n.concat(l,f)},[])}(t,r,o)}),p=[],(0,A.Ed)(e,function(t){var e=new eg;t.accept(e);var n=e.allProductions;(0,A.Ed)(n,function(e){var n=function(t){if(t instanceof tb)return y.OPTION;if(t instanceof tL)return y.REPETITION;if(t instanceof tU)return y.REPETITION_MANDATORY;if(t instanceof tx)return y.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof t_)return y.REPETITION_WITH_SEPARATOR;if(t instanceof tk)return y.ALTERNATION;throw Error("non exhaustive match")}(e),a=e.maxLookahead||r,i=eu(e.idx,t,n,a)[0];if((0,A.xb)((0,A.xH)(i))){var c=o.buildEmptyRepetitionError({topLevelRule:t,repetition:e});p.push({message:c,type:R.NO_NON_EMPTY_LOOKAHEAD,ruleName:t.name})}})}),l=p),d=[],m=(0,A.UI)(n,function(t){return t.name}),(0,A.Ed)(e,function(t){var e=t.name;if((0,A.r3)(m,e)){var r=o.buildNamespaceConflictError(t);d.push({message:r,type:R.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:e})}}),f=(0,A.UI)(e,function(t){return function(t,e){var r=new em;t.accept(r);var n=r.alternations;return A.u4(n,function(r,n){return n.definition.length>255&&r.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:n}),type:R.TOO_MANY_ALTS,ruleName:t.name,occurrence:n.idx}),r},[])}(t,o)}),h=(0,A.UI)(e,function(t){return function(t,e,r,n){var o=[];if((0,A.u4)(e,function(e,r){return r.name===t.name?e+1:e},0)>1){var a=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});o.push({message:a,type:R.DUPLICATE_RULE_NAME,ruleName:t.name})}return o}(t,e,a,o)}),A.xH(i.concat(l,c,u,s,d,f,h))}function ey(t){(0,A.Ed)(t.rules,function(t){var e=new tW;t.accept(e),(0,A.Ed)(e.dslMethods,function(t){(0,A.Ed)(t,function(t,e){t.idx=e+1})})})}var eN=(d=function(t,e){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),eR="MismatchedTokenException",eT="NoViableAltException",eA="EarlyExitException",eM="NotAllInputParsedException",ew=[eR,eT,eA,eM];function eO(t){return(0,A.r3)(ew,t.name)}Object.freeze(ew);var eI=function(t){function e(e,r){var n=this.constructor,o=t.call(this,e)||this;return o.token=r,o.resyncedTokens=[],Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,o.constructor),o}return eN(e,t),e}(Error),eC=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=eR,o}return eN(e,t),e}(eI),eS=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=eT,o}return eN(e,t),e}(eI),eb=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.name=eM,n}return eN(e,t),e}(eI),eU=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=eA,o}return eN(e,t),e}(eI),ex={},eL="InRuleRecoveryException";function e_(t){this.name=eL,this.message=t}e_.prototype=Error.prototype;var ek=function(){function t(){}return t.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,A.e$)(t,"recoveryEnabled")?t.recoveryEnabled:e9.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=eP)},t.prototype.getTokenToInsert=function(t){var e=tA(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},t.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},t.prototype.tryInRepetitionRecovery=function(t,e,r,n){for(var o=this,a=this.findReSyncTokenType(),i=this.exportLexerState(),c=[],u=!1,s=this.LA(1),l=this.LA(1),f=function(){var t=o.LA(0),e=new eC(o.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:s,previous:t,ruleName:o.getCurrRuleFullName()}),s,o.LA(0));e.resyncedTokens=(0,A.j7)(c),o.SAVE_ERROR(e)};!u;){if(this.tokenMatcher(l,n)){f();return}if(r.call(this)){f(),t.apply(this,e);return}this.tokenMatcher(l,a)?u=!0:(l=this.SKIP_TOKEN(),this.addToResyncTokens(l,c))}this.importLexerState(i)},t.prototype.shouldInRepetitionRecoveryBeTried=function(t,e,r){return!(!1===r||void 0===t||void 0===e||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e)))},t.prototype.getFollowsForInRuleRecovery=function(t,e){var r=this.getCurrentGrammarPath(t,e);return this.getNextPossibleTokenTypes(r)},t.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new e_("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},t.prototype.canRecoverWithSingleTokenInsertion=function(t,e){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(t)||(0,A.xb)(e))return!1;var n=this.LA(1);return void 0!==(0,A.sE)(e,function(t){return r.tokenMatcher(n,t)})},t.prototype.canRecoverWithSingleTokenDeletion=function(t){return this.tokenMatcher(this.LA(2),t)},t.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(e);return(0,A.r3)(r,t)},t.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),r=2;;){var n=e.tokenType;if((0,A.r3)(t,n))return n;e=this.LA(r),r++}},t.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return ex;var t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(r)}},t.prototype.buildFullFollowKeyStack=function(){var t=this,e=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return(0,A.UI)(e,function(n,o){return 0===o?ex:{ruleName:t.shortRuleNameToFullName(n),idxInCallingRule:r[o],inRule:t.shortRuleNameToFullName(e[o-1])}})},t.prototype.flattenFollowSet=function(){var t=this,e=(0,A.UI)(this.buildFullFollowKeyStack(),function(e){return t.getFollowSetFromFollowKey(e)});return(0,A.xH)(e)},t.prototype.getFollowSetFromFollowKey=function(t){if(t===ex)return[tT];var e=t.ruleName+t.idxInCallingRule+tq+t.inRule;return this.resyncFollows[e]},t.prototype.addToResyncTokens=function(t,e){return this.tokenMatcher(t,tT)||e.push(t),e},t.prototype.reSyncTo=function(t){for(var e=[],r=this.LA(1);!1===this.tokenMatcher(r,t);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,e);return(0,A.j7)(e)},t.prototype.attemptInRepetitionRecovery=function(t,e,r,n,o,a,i){},t.prototype.getCurrentGrammarPath=function(t,e){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:(0,A.Qw)(this.RULE_OCCURRENCE_STACK),lastTok:t,lastTokOccurrence:e}},t.prototype.getHumanReadableRuleStack=function(){var t=this;return(0,A.UI)(this.RULE_STACK,function(e){return t.shortRuleNameToFullName(e)})},t}();function eP(t,e,r,n,o,a,i){var c=this.getKeyForAutomaticLookahead(n,o),u=this.firstAfterRepMap[c];if(void 0===u){var s=this.getCurrRuleFullName();u=new a(this.getGAstProductions()[s],o).startWalking(),this.firstAfterRepMap[c]=u}var l=u.token,f=u.occurrence,h=u.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=tT,f=1),this.shouldInRepetitionRecoveryBeTried(l,f,i)&&this.tryInRepetitionRecovery(t,e,r,l)}var eB=function(){function t(){}return t.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=(0,A.e$)(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:e9.dynamicTokensEnabled,this.maxLookahead=(0,A.e$)(t,"maxLookahead")?t.maxLookahead:e9.maxLookahead,this.lookAheadFuncsCache=(0,A.dU)()?new Map:[],(0,A.dU)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(t){var e=this;(0,A.Ed)(t,function(t){e.TRACE_INIT(t.name+" Rule Lookahead",function(){var r,n=(tY.reset(),t.accept(tY),r=tY.dslMethods,tY.reset(),r),o=n.alternation,a=n.repetition,i=n.option,c=n.repetitionMandatory,u=n.repetitionMandatoryWithSeparator,s=n.repetitionWithSeparator;(0,A.Ed)(o,function(r){var n=0===r.idx?"":r.idx;e.TRACE_INIT(""+tH(r)+n,function(){var n,o,a,i,c,u,s,l,f=(n=r.idx,o=r.maxLookahead||e.maxLookahead,a=r.hasPredicates,i=e.dynamicTokensEnabled,c=e.lookAheadBuilderForAlternatives,s=el(u=ec(n,t,o))?J:Z,c(u,a,s,i)),h=(l=e.fullRuleNameToShort[t.name],256|r.idx|l);e.setLaFuncCache(h,f)})}),(0,A.Ed)(a,function(r){e.computeLookaheadFunc(t,r.idx,768,y.REPETITION,r.maxLookahead,tH(r))}),(0,A.Ed)(i,function(r){e.computeLookaheadFunc(t,r.idx,512,y.OPTION,r.maxLookahead,tH(r))}),(0,A.Ed)(c,function(r){e.computeLookaheadFunc(t,r.idx,1024,y.REPETITION_MANDATORY,r.maxLookahead,tH(r))}),(0,A.Ed)(u,function(r){e.computeLookaheadFunc(t,r.idx,1536,y.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,tH(r))}),(0,A.Ed)(s,function(r){e.computeLookaheadFunc(t,r.idx,1280,y.REPETITION_WITH_SEPARATOR,r.maxLookahead,tH(r))})})})},t.prototype.computeLookaheadFunc=function(t,e,r,n,o,a){var i=this;this.TRACE_INIT(""+a+(0===e?"":e),function(){var a,c,u,s,l,f=(a=o||i.maxLookahead,c=i.dynamicTokensEnabled,u=i.lookAheadBuilderForOptional,l=el(s=eu(e,t,n,a))?J:Z,u(s[0],l,c)),h=e|r|i.fullRuleNameToShort[t.name];i.setLaFuncCache(h,f)})},t.prototype.lookAheadBuilderForOptional=function(t,e,r){return function(t,e,r){var n=(0,A.yW)(t,function(t){return 1===t.length}),o=t.length;if(!n||r)return function(){e:for(var r=0;r<o;r++){for(var n=t[r],a=n.length,i=0;i<a;i++)if(!1===e(this.LA(i+1),n[i]))continue e;return!0}return!1};var a=(0,A.xH)(t);if(1===a.length&&(0,A.xb)(a[0].categoryMatches)){var i=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===i}}var c=(0,A.u4)(a,function(t,e,r){return t[e.tokenTypeIdx]=!0,(0,A.Ed)(e.categoryMatches,function(e){t[e]=!0}),t},[]);return function(){return!0===c[this.LA(1).tokenTypeIdx]}}(t,e,r)},t.prototype.lookAheadBuilderForAlternatives=function(t,e,r,n){return function(t,e,r,n){var o=t.length,a=(0,A.yW)(t,function(t){return(0,A.yW)(t,function(t){return 1===t.length})});if(e)return function(e){for(var n=(0,A.UI)(e,function(t){return t.GATE}),a=0;a<o;a++){var i=t[a],c=i.length,u=n[a];if(void 0===u||!1!==u.call(this))e:for(var s=0;s<c;s++){for(var l=i[s],f=l.length,h=0;h<f;h++)if(!1===r(this.LA(h+1),l[h]))continue e;return a}}};if(!a||n)return function(){for(var e=0;e<o;e++){var n=t[e],a=n.length;e:for(var i=0;i<a;i++){for(var c=n[i],u=c.length,s=0;s<u;s++)if(!1===r(this.LA(s+1),c[s]))continue e;return e}}};var i=(0,A.UI)(t,function(t){return(0,A.xH)(t)}),c=(0,A.u4)(i,function(t,e,r){return(0,A.Ed)(e,function(e){(0,A.e$)(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=r),(0,A.Ed)(e.categoryMatches,function(e){(0,A.e$)(t,e)||(t[e]=r)})}),t},[]);return function(){return c[this.LA(1).tokenTypeIdx]}}(t,e,r,n)},t.prototype.getKeyForAutomaticLookahead=function(t,e){return e|t|this.getLastExplicitRuleShortName()},t.prototype.getLaFuncFromCache=function(t){},t.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},t.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},t.prototype.setLaFuncCache=function(t,e){},t.prototype.setLaFuncCacheUsingMap=function(t,e){this.lookAheadFuncsCache.set(t,e)},t.prototype.setLaFuncUsingObj=function(t,e){this.lookAheadFuncsCache[t]=e},t}();function eD(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset)}function eF(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}var eV="name";function eG(t){return t.name||"anonymous"}function ej(t,e){var r=Object.getOwnPropertyDescriptor(t,eV);return(!!(0,A.o8)(r)||!!r.configurable)&&(Object.defineProperty(t,eV,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0)}function e$(t,e){for(var r=(0,A.XP)(t),n=r.length,o=0;o<n;o++)for(var a=t[r[o]],i=a.length,c=0;c<i;c++){var u=a[c];void 0===u.tokenTypeIdx&&this[u.name](u.children,e)}}(m=N||(N={}))[m.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",m[m.MISSING_METHOD=1]="MISSING_METHOD";var eH=["constructor","visit","validateVisitor"],eW=function(){function t(){}return t.prototype.initTreeBuilder=function(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=(0,A.e$)(t,"nodeLocationTracking")?t.nodeLocationTracking:e9.nodeLocationTracking,this.outputCst){if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=eF,this.setNodeLocationFromNode=eF,this.cstPostRule=A.dG,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=A.dG,this.setNodeLocationFromNode=A.dG,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=eD,this.setNodeLocationFromNode=eD,this.cstPostRule=A.dG,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=A.dG,this.setNodeLocationFromNode=A.dG,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=A.dG,this.setNodeLocationFromNode=A.dG,this.cstPostRule=A.dG,this.setInitialNodeLocation=A.dG;else throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"')}else this.cstInvocationStateUpdate=A.dG,this.cstFinallyStateUpdate=A.dG,this.cstPostTerminal=A.dG,this.cstPostNonTerminal=A.dG,this.cstPostRule=A.dG},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(t){var e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstInvocationStateUpdate=function(t,e){var r={name:t,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},t.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},t.prototype.cstPostRuleFull=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset==!0?(r.endOffset=e.endOffset,r.endLine=e.endLine,r.endColumn=e.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset==!0?r.endOffset=e.endOffset:r.startOffset=NaN},t.prototype.cstPostTerminal=function(t,e){var r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[t]?r.children[t]=[e]:r.children[t].push(e),this.setNodeLocationFromToken(r.location,e)},t.prototype.cstPostNonTerminal=function(t,e){var r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[e]?r.children[e]=[t]:r.children[e].push(t),this.setNodeLocationFromNode(r.location,t.location)},t.prototype.getBaseCstVisitorConstructor=function(){if((0,A.o8)(this.baseCstVisitorConstructor)){var t,e,r,n=(t=this.className,e=(0,A.XP)(this.gastProductionsCache),ej(r=function(){},t+"BaseSemantics"),r.prototype={visit:function(t,e){if((0,A.kJ)(t)&&(t=t[0]),!(0,A.o8)(t))return this[t.name](t.children,e)},validateVisitor:function(){var t,r,n,o,a=(t=this,r=(0,A.UI)(e,function(e){if(!(0,A.mf)(t[e]))return{msg:"Missing visitor method: <"+e+"> on "+eG(t.constructor)+" CST Visitor.",type:N.MISSING_METHOD,methodName:e}}),n=(0,A.oA)(r),o=function(t,e){var r=[];for(var n in t)!(0,A.mf)(t[n])||(0,A.r3)(eH,n)||(0,A.r3)(e,n)||r.push({msg:"Redundant visitor method: <"+n+"> on "+eG(t.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\n",type:N.REDUNDANT_METHOD,methodName:n});return r}(this,e),n.concat(o));if(!(0,A.xb)(a)){var i=(0,A.UI)(a,function(t){return t.msg});throw Error("Errors Detected in CST Visitor <"+eG(this.constructor)+">:\n	"+i.join("\n\n").replace(/\n/g,"\n	"))}}},r.prototype.constructor=r,r._RULE_NAMES=e,r);return this.baseCstVisitorConstructor=n,n}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,A.o8)(this.baseCstVisitorWithDefaultsConstructor)){var t,e,r,n,o,a=(t=this.className,e=(0,A.XP)(this.gastProductionsCache),r=this.getBaseCstVisitorConstructor(),ej(n=function(){},t+"BaseSemanticsWithDefaults"),o=Object.create(r.prototype),(0,A.Ed)(e,function(t){o[t]=e$}),n.prototype=o,n.prototype.constructor=n,n);return this.baseCstVisitorWithDefaultsConstructor=a,a}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.getLastExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},t}(),eY=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!1,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):e7},t.prototype.LA=function(t){var e=this.currIdx+t;return e<0||this.tokVectorLength<=e?e7:this.tokVector[e]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(t){this.currIdx=t},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),eK=function(){function t(){}return t.prototype.ACTION=function(t){return t.call(this)},t.prototype.consume=function(t,e,r){return this.consumeInternal(e,t,r)},t.prototype.subrule=function(t,e,r){return this.subruleInternal(e,t,r)},t.prototype.option=function(t,e){return this.optionInternal(e,t)},t.prototype.or=function(t,e){return this.orInternal(e,t)},t.prototype.many=function(t,e){return this.manyInternal(t,e)},t.prototype.atLeastOne=function(t,e){return this.atLeastOneInternal(t,e)},t.prototype.CONSUME=function(t,e){return this.consumeInternal(t,0,e)},t.prototype.CONSUME1=function(t,e){return this.consumeInternal(t,1,e)},t.prototype.CONSUME2=function(t,e){return this.consumeInternal(t,2,e)},t.prototype.CONSUME3=function(t,e){return this.consumeInternal(t,3,e)},t.prototype.CONSUME4=function(t,e){return this.consumeInternal(t,4,e)},t.prototype.CONSUME5=function(t,e){return this.consumeInternal(t,5,e)},t.prototype.CONSUME6=function(t,e){return this.consumeInternal(t,6,e)},t.prototype.CONSUME7=function(t,e){return this.consumeInternal(t,7,e)},t.prototype.CONSUME8=function(t,e){return this.consumeInternal(t,8,e)},t.prototype.CONSUME9=function(t,e){return this.consumeInternal(t,9,e)},t.prototype.SUBRULE=function(t,e){return this.subruleInternal(t,0,e)},t.prototype.SUBRULE1=function(t,e){return this.subruleInternal(t,1,e)},t.prototype.SUBRULE2=function(t,e){return this.subruleInternal(t,2,e)},t.prototype.SUBRULE3=function(t,e){return this.subruleInternal(t,3,e)},t.prototype.SUBRULE4=function(t,e){return this.subruleInternal(t,4,e)},t.prototype.SUBRULE5=function(t,e){return this.subruleInternal(t,5,e)},t.prototype.SUBRULE6=function(t,e){return this.subruleInternal(t,6,e)},t.prototype.SUBRULE7=function(t,e){return this.subruleInternal(t,7,e)},t.prototype.SUBRULE8=function(t,e){return this.subruleInternal(t,8,e)},t.prototype.SUBRULE9=function(t,e){return this.subruleInternal(t,9,e)},t.prototype.OPTION=function(t){return this.optionInternal(t,0)},t.prototype.OPTION1=function(t){return this.optionInternal(t,1)},t.prototype.OPTION2=function(t){return this.optionInternal(t,2)},t.prototype.OPTION3=function(t){return this.optionInternal(t,3)},t.prototype.OPTION4=function(t){return this.optionInternal(t,4)},t.prototype.OPTION5=function(t){return this.optionInternal(t,5)},t.prototype.OPTION6=function(t){return this.optionInternal(t,6)},t.prototype.OPTION7=function(t){return this.optionInternal(t,7)},t.prototype.OPTION8=function(t){return this.optionInternal(t,8)},t.prototype.OPTION9=function(t){return this.optionInternal(t,9)},t.prototype.OR=function(t){return this.orInternal(t,0)},t.prototype.OR1=function(t){return this.orInternal(t,1)},t.prototype.OR2=function(t){return this.orInternal(t,2)},t.prototype.OR3=function(t){return this.orInternal(t,3)},t.prototype.OR4=function(t){return this.orInternal(t,4)},t.prototype.OR5=function(t){return this.orInternal(t,5)},t.prototype.OR6=function(t){return this.orInternal(t,6)},t.prototype.OR7=function(t){return this.orInternal(t,7)},t.prototype.OR8=function(t){return this.orInternal(t,8)},t.prototype.OR9=function(t){return this.orInternal(t,9)},t.prototype.MANY=function(t){this.manyInternal(0,t)},t.prototype.MANY1=function(t){this.manyInternal(1,t)},t.prototype.MANY2=function(t){this.manyInternal(2,t)},t.prototype.MANY3=function(t){this.manyInternal(3,t)},t.prototype.MANY4=function(t){this.manyInternal(4,t)},t.prototype.MANY5=function(t){this.manyInternal(5,t)},t.prototype.MANY6=function(t){this.manyInternal(6,t)},t.prototype.MANY7=function(t){this.manyInternal(7,t)},t.prototype.MANY8=function(t){this.manyInternal(8,t)},t.prototype.MANY9=function(t){this.manyInternal(9,t)},t.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},t.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},t.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},t.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},t.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},t.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},t.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},t.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},t.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},t.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},t.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},t.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},t.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},t.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},t.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},t.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},t.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},t.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},t.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},t.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},t.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},t.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},t.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},t.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},t.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},t.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},t.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},t.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},t.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},t.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},t.prototype.RULE=function(t,e,r){if(void 0===r&&(r=rt),(0,A.r3)(this.definedRulesNames,t)){var n={message:tJ.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:R.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(n)}this.definedRulesNames.push(t);var o=this.defineRule(t,e,r);return this[t]=o,o},t.prototype.OVERRIDE_RULE=function(t,e,r){void 0===r&&(r=rt);var n,o,a,i,c=[];c=c.concat((n=this.definedRulesNames,o=this.className,i=[],A.r3(n,t)||(a="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+o+"<-as it is not defined in any of the super grammars ",i.push({message:a,type:R.INVALID_RULE_OVERRIDE,ruleName:t})),i)),this.definitionErrors.push.apply(this.definitionErrors,c);var u=this.defineRule(t,e,r);return this[t]=u,u},t.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return t.apply(this,e),!0}catch(t){if(eO(t))return!1;throw t}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return tB((0,A.VO)(this.gastProductionsCache))},t}(),eq=function(){function t(){}return t.prototype.initRecognizerEngine=function(t,e){if(this.className=eG(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=J,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,A.e$)(e,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n	For Further details.");if((0,A.kJ)(t)){if((0,A.xb)(t))throw Error("A Token Vocabulary cannot be empty.\n	Note that the first argument for the parser constructor\n	is no longer a Token vector (since v4.0).");if("number"==typeof t[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n	For Further details.")}if((0,A.kJ)(t))this.tokensMap=(0,A.u4)(t,function(t,e){return t[e.name]=e,t},{});else if((0,A.e$)(t,"modes")&&(0,A.yW)((0,A.xH)((0,A.VO)(t.modes)),ta)){var r=(0,A.xH)((0,A.VO)(t.modes)),n=(0,A.jj)(r);this.tokensMap=(0,A.u4)(n,function(t,e){return t[e.name]=e,t},{})}else if((0,A.Kn)(t))this.tokensMap=(0,A.Cl)(t);else throw Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=tT;var o=(0,A.yW)((0,A.VO)(t),function(t){return(0,A.xb)(t.categoryMatches)});this.tokenMatcher=o?J:Z,tr((0,A.VO)(this.tokensMap))},t.prototype.defineRule=function(t,e,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var n,o=(0,A.e$)(r,"resyncEnabled")?r.resyncEnabled:rt.resyncEnabled,a=(0,A.e$)(r,"recoveryValueFunc")?r.recoveryValueFunc:rt.recoveryValueFunc,i=this.ruleShortNameIdx<<12;function c(t){try{if(!0!==this.outputCst)return e.apply(this,t);e.apply(this,t);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}catch(t){return this.invokeRuleCatch(t,o,a)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[i]=t,this.fullRuleNameToShort[t]=i,(n=function(e,r){return void 0===e&&(e=0),this.ruleInvocationStateUpdate(i,t,e),c.call(this,r)}).ruleName=t,n.originalGrammarAction=e,n},t.prototype.invokeRuleCatch=function(t,e,r){var n=1===this.RULE_STACK.length,o=e&&!this.isBackTracking()&&this.recoveryEnabled;if(eO(t)){if(o){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a)){if(t.resyncedTokens=this.reSyncTo(a),!this.outputCst)return r();var i=this.CST_STACK[this.CST_STACK.length-1];return i.recoveredNode=!0,i}if(this.outputCst){var i=this.CST_STACK[this.CST_STACK.length-1];i.recoveredNode=!0,t.partialCstResult=i}throw t}if(n)return this.moveToTerminatedState(),r()}throw t},t.prototype.optionInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(512,e);return this.optionInternalLogic(t,e,r)},t.prototype.optionInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(o=t.GATE)){var c=i;i=function(){return o.call(a)&&c.call(a)}}}else n=t;if(!0===i.call(this))return n.call(this)},t.prototype.atLeastOneInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(1024,t);return this.atLeastOneInternalLogic(t,e,r)},t.prototype.atLeastOneInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var c=i;i=function(){return o.call(a)&&c.call(a)}}}else n=e;if(!0===i.call(this))for(var u=this.doSingleRepetition(n);!0===i.call(this)&&!0===u;)u=this.doSingleRepetition(n);else throw this.raiseEarlyExitException(t,y.REPETITION_MANDATORY,e.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],i,1024,t,t8)},t.prototype.atLeastOneSepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(1536,t);this.atLeastOneSepFirstInternalLogic(t,e,r)},t.prototype.atLeastOneSepFirstInternalLogic=function(t,e,r){var n=this,o=e.DEF,a=e.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){o.call(this);for(var i=function(){return n.tokenMatcher(n.LA(1),a)};!0===this.tokenMatcher(this.LA(1),a);)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,a,i,o,t7],i,1536,t,t7)}else throw this.raiseEarlyExitException(t,y.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG)},t.prototype.manyInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(768,t);return this.manyInternalLogic(t,e,r)},t.prototype.manyInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var c=i;i=function(){return o.call(a)&&c.call(a)}}}else n=e;for(var u=!0;!0===i.call(this)&&!0===u;)u=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],i,768,t,t5,u)},t.prototype.manySepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(1280,t);this.manySepFirstInternalLogic(t,e,r)},t.prototype.manySepFirstInternalLogic=function(t,e,r){var n=this,o=e.DEF,a=e.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){o.call(this);for(var i=function(){return n.tokenMatcher(n.LA(1),a)};!0===this.tokenMatcher(this.LA(1),a);)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,a,i,o,t6],i,1280,t,t6)}},t.prototype.repetitionSepSecondInternal=function(t,e,r,n,o){for(;r();)this.CONSUME(e),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,r,n,o],r,1536,t,o)},t.prototype.doSingleRepetition=function(t){var e=this.getLexerPosition();return t.call(this),this.getLexerPosition()>e},t.prototype.orInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(256,e),n=(0,A.kJ)(t)?t:t.DEF,o=this.getLaFuncFromCache(r).call(this,n);if(void 0!==o)return n[o].ALT.call(this);this.raiseNoAltException(e,t.ERR_MSG)},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new eb(e,t))}},t.prototype.subruleInternal=function(t,e,r){var n;try{var o=void 0!==r?r.ARGS:void 0;return n=t.call(this,e,o),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:t.ruleName),n}catch(e){this.subruleInternalError(e,r,t.ruleName)}},t.prototype.subruleInternalError=function(t,e,r){throw eO(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==e&&void 0!==e.LABEL?e.LABEL:r),delete t.partialCstResult),t},t.prototype.consumeInternal=function(t,e,r){var n;try{var o=this.LA(1);!0===this.tokenMatcher(o,t)?(this.consumeToken(),n=o):this.consumeInternalError(t,o,r)}catch(r){n=this.consumeInternalRecovery(t,e,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:t.name,n),n},t.prototype.consumeInternalError=function(t,e,r){var n,o=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new eC(n,e,o))},t.prototype.consumeInternalRecovery=function(t,e,r){if(this.recoveryEnabled&&"MismatchedTokenException"===r.name&&!this.isBackTracking()){var n=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,n)}catch(t){if(t.name===eL)throw r;throw t}}else throw r},t.prototype.saveRecogState=function(){var t=this.errors,e=(0,A.Qw)(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK}},t.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(t,e,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e,t)},t.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},t.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},t.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),tT)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),ez=function(){function t(){}return t.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=(0,A.e$)(t,"errorMessageProvider")?t.errorMessageProvider:e9.errorMessageProvider},t.prototype.SAVE_ERROR=function(t){if(eO(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,A.Qw)(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return(0,A.Qw)(this._errors)},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),t.prototype.raiseEarlyExitException=function(t,e,r){for(var n=this.getCurrRuleFullName(),o=eu(t,this.getGAstProductions()[n],e,this.maxLookahead)[0],a=[],i=1;i<=this.maxLookahead;i++)a.push(this.LA(i));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:a,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new eU(c,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(t,e){for(var r=this.getCurrRuleFullName(),n=ec(t,this.getGAstProductions()[r],this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var i=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:n,actual:o,previous:i,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new eS(c,this.LA(1),i))},t}(),eX=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(t,e){var r=this.gastProductionsCache[t];if((0,A.o8)(r))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return et([r],e,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(t){var e=(0,A.Ps)(t.ruleStack);return new t3(this.getGAstProductions()[e],t).startWalking()},t}(),eQ={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(eQ);var eZ=tR({name:"RECORDING_PHASE_TOKEN",pattern:tu.NA});tr([eZ]);var eJ=tA(eZ,"This IToken indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(eJ);var e0={name:"This CSTNode indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}},e1=function(){function t(){}return t.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var e=function(e){var r=e>0?e:"";t["CONSUME"+r]=function(t,r){return this.consumeInternalRecord(t,e,r)},t["SUBRULE"+r]=function(t,r){return this.subruleInternalRecord(t,e,r)},t["OPTION"+r]=function(t){return this.optionInternalRecord(t,e)},t["OR"+r]=function(t){return this.orInternalRecord(t,e)},t["MANY"+r]=function(t){this.manyInternalRecord(e,t)},t["MANY_SEP"+r]=function(t){this.manySepFirstInternalRecord(e,t)},t["AT_LEAST_ONE"+r]=function(t){this.atLeastOneInternalRecord(e,t)},t["AT_LEAST_ONE_SEP"+r]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}},r=0;r<10;r++)e(r);t.consume=function(t,e,r){return this.consumeInternalRecord(e,t,r)},t.subrule=function(t,e,r){return this.subruleInternalRecord(e,t,r)},t.option=function(t,e){return this.optionInternalRecord(e,t)},t.or=function(t,e){return this.orInternalRecord(e,t)},t.many=function(t,e){this.manyInternalRecord(t,e)},t.atLeastOne=function(t,e){this.atLeastOneInternalRecord(t,e)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},t.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var e=0;e<10;e++){var r=e>0?e:"";delete t["CONSUME"+r],delete t["SUBRULE"+r],delete t["OPTION"+r],delete t["OR"+r],delete t["MANY"+r],delete t["MANY_SEP"+r],delete t["AT_LEAST_ONE"+r],delete t["AT_LEAST_ONE_SEP"+r]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})},t.prototype.ACTION_RECORD=function(t){},t.prototype.BACKTRACK_RECORD=function(t,e){return function(){return!0}},t.prototype.LA_RECORD=function(t){return e7},t.prototype.topLevelRuleRecord=function(t,e){try{var r=new tC({definition:[],name:t});return r.name=t,this.recordingProdStack.push(r),e.call(this),this.recordingProdStack.pop(),r}catch(t){if(!0!==t.KNOWN_RECORDER_ERROR)try{t.message=t.message+'\n	 This error was thrown during the "grammar recording phase" For more info see:\n	https://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(t){}throw t}},t.prototype.optionInternalRecord=function(t,e){return e2.call(this,tb,t,e)},t.prototype.atLeastOneInternalRecord=function(t,e){e2.call(this,tU,e,t)},t.prototype.atLeastOneSepFirstInternalRecord=function(t,e){e2.call(this,tx,e,t,!0)},t.prototype.manyInternalRecord=function(t,e){e2.call(this,tL,e,t)},t.prototype.manySepFirstInternalRecord=function(t,e){e2.call(this,t_,e,t,!0)},t.prototype.orInternalRecord=function(t,e){return e3.call(this,t,e)},t.prototype.subruleInternalRecord=function(t,e,r){if(e5(e),!t||!1===(0,A.e$)(t,"ruleName")){var n=Error("<SUBRULE"+e4(e)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=(0,A.fj)(this.recordingProdStack),a=new tI({idx:e,nonTerminalName:t.ruleName,referencedRule:void 0});return o.definition.push(a),this.outputCst?e0:eQ},t.prototype.consumeInternalRecord=function(t,e,r){if(e5(e),!tn(t)){var n=Error("<CONSUME"+e4(e)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=(0,A.fj)(this.recordingProdStack),a=new tP({idx:e,terminalType:t});return o.definition.push(a),eJ},t}();function e2(t,e,r,n){void 0===n&&(n=!1),e5(r);var o=(0,A.fj)(this.recordingProdStack),a=(0,A.mf)(e)?e:e.DEF,i=new t({definition:[],idx:r});return n&&(i.separator=e.SEP),(0,A.e$)(e,"MAX_LOOKAHEAD")&&(i.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(i),a.call(this),o.definition.push(i),this.recordingProdStack.pop(),eQ}function e3(t,e){var r=this;e5(e);var n=(0,A.fj)(this.recordingProdStack),o=!1===(0,A.kJ)(t),a=!1===o?t:t.DEF,i=new tk({definition:[],idx:e,ignoreAmbiguities:o&&!0===t.IGNORE_AMBIGUITIES});(0,A.e$)(t,"MAX_LOOKAHEAD")&&(i.maxLookahead=t.MAX_LOOKAHEAD);var c=(0,A.G)(a,function(t){return(0,A.mf)(t.GATE)});return i.hasPredicates=c,n.definition.push(i),(0,A.Ed)(a,function(t){var e=new tS({definition:[]});i.definition.push(e),(0,A.e$)(t,"IGNORE_AMBIGUITIES")?e.ignoreAmbiguities=t.IGNORE_AMBIGUITIES:(0,A.e$)(t,"GATE")&&(e.ignoreAmbiguities=!0),r.recordingProdStack.push(e),t.ALT.call(r),r.recordingProdStack.pop()}),eQ}function e4(t){return 0===t?"":""+t}function e5(t){if(t<0||t>255){var e=Error("Invalid DSL Method idx value: <"+t+">\n	Idx value must be a none negative value smaller than 256");throw e.KNOWN_RECORDER_ERROR=!0,e}}var e6=function(){function t(){}return t.prototype.initPerformanceTracer=function(t){if((0,A.e$)(t,"traceInitPerf")){var e=t.traceInitPerf,r="number"==typeof e;this.traceInitMaxIdent=r?e:1/0,this.traceInitPerf=r?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=e9.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(t,e){if(!0!==this.traceInitPerf)return e();this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var n=(0,A.HT)(e),o=n.time,a=n.value,i=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&i(r+"<-- <"+t+"> time: "+o+"ms"),this.traceInitIndent--,a},t}(),e8=(g=function(t,e){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),e7=tA(tT,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(e7);var e9=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:tQ,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),rt=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function re(t){return void 0===t&&(t=void 0),function(){return t}}(v=R||(R={}))[v.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",v[v.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",v[v.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",v[v.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",v[v.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",v[v.LEFT_RECURSION=5]="LEFT_RECURSION",v[v.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",v[v.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",v[v.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",v[v.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",v[v.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",v[v.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",v[v.TOO_MANY_ALTS=12]="TOO_MANY_ALTS";var rr=function(){function t(t,e){if(this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(e),this.initLexerAdapter(),this.initLooksAhead(e),this.initRecognizerEngine(t,e),this.initRecoverable(e),this.initTreeBuilder(e),this.initContentAssist(),this.initGastRecorder(e),this.initPerformanceTracer(e),(0,A.e$)(e,"ignoredIssues"))throw Error("The <ignoredIssues> IParserConfig property has been deprecated.\n	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n	For further details.");this.skipValidations=(0,A.e$)(e,"skipValidations")?e.skipValidations:e9.skipValidations}return t.performSelfAnalysis=function(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){(0,A.SV)(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),(0,A.Ed)(e.definedRulesNames,function(t){var r=e[t].originalGrammarAction,n=void 0;e.TRACE_INIT(t+" Rule",function(){n=e.topLevelRuleRecord(t,r)}),e.gastProductionsCache[t]=n})}finally{e.disableRecording()}});var n=[];if(e.TRACE_INIT("Grammar Resolving",function(){n=ev({rules:(0,A.VO)(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,n)}),e.TRACE_INIT("Grammar Validations",function(){if((0,A.xb)(n)&&!1===e.skipValidations){var t=eE({rules:(0,A.VO)(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:(0,A.VO)(e.tokensMap),errMsgProvider:tJ,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,t)}}),(0,A.xb)(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var t,r,n=(t=(0,A.VO)(e.gastProductionsCache),r={},(0,A.Ed)(t,function(t){var e=new tX(t).startWalking();(0,A.f0)(r,e)}),r);e.resyncFollows=n}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions((0,A.VO)(e.gastProductionsCache))})),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,A.xb)(e.definitionErrors))throw Error("Parser Definition Errors detected:\n "+(0,A.UI)(e.definitionErrors,function(t){return t.message}).join("\n-------------------------------\n"))})},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();(0,A.ef)(rr,[ek,eB,eW,eY,eq,eK,ez,eX,e1,e6]);var rn=function(t){function e(e,r){void 0===r&&(r=e9);var n=(0,A.Cl)(r);return n.outputCst=!0,t.call(this,e,n)||this}return e8(e,t),e}(rr),ro=function(t){function e(e,r){void 0===r&&(r=e9);var n=(0,A.Cl)(r);return n.outputCst=!1,t.call(this,e,n)||this}return e8(e,t),e}(rr);function ra(t,e){var r=void 0===e?{}:e,n=r.resourceBase,o=void 0===n?"https://unpkg.com/chevrotain@"+T+"/diagrams/":n,a=r.css;return"\n<!-- This is a generated file -->\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===a?"https://unpkg.com/chevrotain@"+T+"/diagrams/diagrams.css":a)+"'>\n"+("\n<script src='"+o+"vendor/railroad-diagrams.js'></script>\n<script src='"+o+"src/diagrams_builder.js'></script>\n<script src='"+o)+"src/diagrams_behavior.js'></script>\n<script src='"+o+'src/main.js\'></script>\n\n<div id="diagrams" align="center"></div>    \n'+("\n<script>\n    window.serializedGrammar = "+JSON.stringify(t,null,"  "))+';\n</script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n</script>\n'}function ri(t){var e;return"\nfunction "+t.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+(e=t.rules,(0,A.UI)(e,function(t){var e;return rl(1,'$.RULE("'+t.name+'", function() {')+"\n"+rs(t.definition,2)+(rl(2,"})")+"\n")}).join("\n"))+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+t.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+t.name+".prototype.constructor = "+t.name+"    \n    "}function rc(t,e,r){var n=rl(r,"$."+(t+e.idx)+"(");return e.separator?n+="{\n"+rl(r+1,"SEP: this.tokensMap."+e.separator.name)+",\nDEF: "+ru(e.definition,r+2)+"\n"+rl(r,"}")+"\n":n+=ru(e.definition,r+1),n+=rl(r,")")+"\n"}function ru(t,e){return"function() {\n"+rs(t,e)+(rl(e,"}")+"\n")}function rs(t,e){var r="";return(0,A.Ed)(t,function(t){r+=function(t,e){var r;if(t instanceof tI)return rl(e,"$.SUBRULE"+t.idx+"($."+t.nonTerminalName+")\n");if(t instanceof tb)return rc("OPTION",t,e);if(t instanceof tU)return rc("AT_LEAST_ONE",t,e);if(t instanceof tx)return rc("AT_LEAST_ONE_SEP",t,e);if(t instanceof t_)return rc("MANY_SEP",t,e);if(t instanceof tL)return rc("MANY",t,e);if(t instanceof tk)return rl(e,"$.OR"+t.idx+"([")+"\n"+(0,A.UI)(t.definition,function(t){var r,n;return rl(r=e+1,"{")+"\n"+(rl(r+1,"ALT: function() {")+"\n"+rs(t.definition,r+1)+rl(r+1,"}")+"\n")+rl(r,"}")}).join(",\n")+"\n"+rl(e,"])\n");else if(t instanceof tP)return r=t.terminalType.name,rl(e,"$.CONSUME"+t.idx+"(this.tokensMap."+r+")\n");else if(t instanceof tS)return rs(t.definition,e);else throw Error("non exhaustive match")}(t,e+1)}),r}function rl(t,e){return Array(4*t+1).join(" ")+e}function rf(t){var e,n=Function("tokenVocabulary","config","chevrotain","    \n"+ri(e={name:t.name,rules:t.rules})+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n");return function(e){return n(t.tokenVocabulary,e,r(89560))}}function rh(t){var e;return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+ri(e={name:t.name,rules:t.rules})+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}function rp(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n	 It performs no action other than printing this message.\n	 Please avoid using it as it will be completely removed in the future")}var rd=function(){throw Error("The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	\nSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0")}},71570:function(t,e,r){"use strict";function n(t){return t&&0===t.length}function o(t){return null==t?[]:Object.keys(t)}function a(t){for(var e=[],r=Object.keys(t),n=0;n<r.length;n++)e.push(t[r[n]]);return e}function i(t,e){for(var r=[],n=o(t),a=0;a<n.length;a++){var i=n[a];r.push(e.call(null,t[i],i))}return r}function c(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e.call(null,t[n],n));return r}function u(t){return n(t)?void 0:t[0]}function s(t){var e=t&&t.length;return e?t[e-1]:void 0}function l(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e.call(null,t[r],r);else if(b(t))for(var n=o(t),r=0;r<n.length;r++){var a=n[r],i=t[a];e.call(null,i,a)}else throw Error("non exhaustive match")}function f(t){return"string"==typeof t}function h(t){return void 0===t}function p(t){return t instanceof Function}function d(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function m(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function g(t,e){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n++){var o=t[n];e.call(null,o)&&r.push(o)}return r}function v(t,e){return g(t,function(t){return!e(t)})}function E(t,e){for(var r=Object.keys(t),n={},o=0;o<r.length;o++){var a=r[o],i=t[a];e(i)&&(n[a]=i)}return n}function y(t,e){return!!b(t)&&t.hasOwnProperty(e)}function N(t,e){return void 0!==A(t,function(t){return t===e})}function R(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}function T(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function A(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e.call(null,n))return n}}function M(t,e){for(var r=[],n=0;n<t.length;n++){var o=t[n];e.call(null,o)&&r.push(o)}return r}function w(t,e,r){for(var n=Array.isArray(t),i=n?t:a(t),c=n?[]:o(t),u=r,s=0;s<i.length;s++)u=e.call(null,u,i[s],n?s:c[s]);return u}function O(t){return v(t,function(t){return null==t})}function I(t,e){void 0===e&&(e=function(t){return t});var r=[];return w(t,function(t,n){var o=e(n);return N(r,o)?t:(r.push(o),t.concat(n))},[])}function C(t){return Array.isArray(t)}function S(t){return t instanceof RegExp}function b(t){return t instanceof Object}function U(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r))return!1;return!0}function x(t,e){return v(t,function(t){return N(e,t)})}function L(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}function _(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return -1}function k(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var a=e[n],i=o(a),c=0;c<i.length;c++){var u=i[c];t[u]=a[u]}return t}function P(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var a=e[n],i=o(a),c=0;c<i.length;c++){var u=i[c];y(t,u)||(t[u]=a[u])}return t}function B(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return P.apply(null,[{}].concat(t))}function D(t,e){var r={};return l(t,function(t){var n=e(t),o=r[n];o?o.push(t):r[n]=[t]}),r}function F(t,e){for(var r=T(t),n=o(e),a=0;a<n.length;a++){var i=n[a],c=e[i];r[i]=c}return r}function V(){}function G(t){return t}function j(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];e.push(void 0!==n?n:void 0)}return e}function $(t){console&&console.error&&console.error("Error: "+t)}function H(t){console&&console.warn&&console.warn("Warning: "+t)}function W(){return"function"==typeof Map}function Y(t,e){e.forEach(function(e){var r=e.prototype;Object.getOwnPropertyNames(r).forEach(function(n){if("constructor"!==n){var o=Object.getOwnPropertyDescriptor(r,n);o&&(o.get||o.set)?Object.defineProperty(t.prototype,n,o):t.prototype[n]=e.prototype[n]}})})}function K(t){function e(){}e.prototype=t;var r=new e;function n(){return typeof r.bar}return n(),n(),t}function q(t){return t[t.length-1]}function z(t){var e=new Date().getTime(),r=t();return{time:new Date().getTime()-e,value:r}}r.d(e,{Cl:function(){return T},Cw:function(){return d},Ed:function(){return l},G:function(){return L},HD:function(){return f},HT:function(){return z},Kj:function(){return S},Kn:function(){return b},Oq:function(){return M},Ps:function(){return u},Q8:function(){return i},Qw:function(){return R},SV:function(){return K},TS:function(){return F},UI:function(){return c},VO:function(){return a},WB:function(){return $},Wd:function(){return G},X0:function(){return j},XP:function(){return o},Z$:function(){return s},ce:function(){return B},cq:function(){return _},d1:function(){return v},dG:function(){return V},dU:function(){return W},e$:function(){return y},e5:function(){return x},ef:function(){return Y},ei:function(){return E},f0:function(){return k},fj:function(){return q},hX:function(){return g},j7:function(){return m},jj:function(){return I},kJ:function(){return C},mf:function(){return p},o8:function(){return h},oA:function(){return O},r3:function(){return N},rr:function(){return H},sE:function(){return A},u4:function(){return w},vM:function(){return D},xH:function(){return function t(e){for(var r=[],n=0;n<e.length;n++){var o=e[n];Array.isArray(o)?r=r.concat(t(o)):r.push(o)}return r}},xb:function(){return n},yW:function(){return U}})},19632:function(t,e,r){class n extends Error{constructor(t,e,r){if(super(e),null==e&&null==r&&n.errorMap.has(t))return n.errorMap.get(t);null==e&&null==r?(this._error=t,n.errorMap.set(t,this)):this._error=t,this.details=r}get error(){return this._error}get name(){return this._error}equals(t){return t instanceof n&&t._error===this._error}toString(){return this._error}}n.errorMap=new Map,n.DIV0=new n("#DIV/0!"),n.NA=new n("#N/A"),n.NAME=new n("#NAME?"),n.NULL=new n("#NULL!"),n.NUM=new n("#NUM!"),n.REF=new n("#REF!"),n.VALUE=new n("#VALUE!"),n.NOT_IMPLEMENTED=t=>new n("#NAME?",`Function ${t} is not implemented.`),n.TOO_MANY_ARGS=t=>new n("#N/A",`Function ${t} has too many arguments.`),n.ARG_MISSING=t=>{let{Types:e}=r(47436);return new n("#N/A",`Argument type ${t.map(t=>e[t]).join(", ")} is missing.`)},n.ERROR=(t,e)=>new n("#ERROR!",t,e),t.exports=n},68777:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a}=r(47436),i=new Date(Date.UTC(1900,0,1)),c=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],u=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],s=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],l=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,f=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,h=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,p=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function d(t){return Math.floor((t-i)/864e5)+(t>-22038912e5?2:1)}function m(t){if(t instanceof Date)return{date:t};t=o.accept(t);let e=!0,r;return isNaN(t)?(r=function(t){let e=t.match(l);if(!e)return;let r=e[2]?e[2]:":00",n=e[3]?e[3]:":00",o=e[4]?" "+e[4]:"",a=new Date(Date.parse(`1/1/1900 ${e[1]+r+n+o} UTC`)),i=new Date;return new Date(Date.UTC((i=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()))).getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()))}(t))?e=!1:r=function(t){let e=t.match(f),r=t.match(h),n=t.match(p);return e?t=e[1]+e[3]+new Date().getFullYear()+e[5]:r?t=r[1]+r[3]+new Date().getFullYear()+r[5]:n&&(t=n[1]+n[3]+new Date().getFullYear()+n[5]),new Date(Date.parse(`${t} UTC`))}(t):r=function(t){if(t<0)throw n.VALUE;return new Date(t<=60?i.getTime()+(t-1)*864e5:i.getTime()+(t-2)*864e5)}(t=Number(t)),{date:r,isDateGiven:e}}function g(t){return m(t).date}function v(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}let E={DATE:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>=1e4)throw n.NUM;return t<1900&&(t+=1900),d(Date.UTC(t,e-1,r))},DATEDIF:(t,e,r)=>{if(t=g(t),e=g(e),r=o.accept(r,a.STRING).toLowerCase(),t>e)throw n.NUM;let i=e.getUTCFullYear()-t.getUTCFullYear(),c=e.getUTCMonth()-t.getUTCMonth(),u=e.getUTCDate()-t.getUTCDate();switch(r){case"y":return(c<0||0===c&&u<0?-1:0)+i;case"m":return 12*i+c+(u<0?-1:0);case"d":return Math.floor(e-t)/864e5;case"md":return t.setUTCFullYear(e.getUTCFullYear()),u<0?t.setUTCMonth(e.getUTCMonth()-1):t.setUTCMonth(e.getUTCMonth()),Math.floor(e-t)/864e5;case"ym":return((u<0?-1:0)+12*i+c)%12;case"yd":return c<0||0===c&&u<0?t.setUTCFullYear(e.getUTCFullYear()-1):t.setUTCFullYear(e.getUTCFullYear()),Math.floor(e-t)/864e5}},DATEVALUE:t=>{let{date:e,isDateGiven:r}=m(t=o.accept(t,a.STRING));if(!r)return 0;let i=d(e);if(i<0||i>2958465)throw n.VALUE;return i},DAY:t=>g(t).getUTCDate(),DAYS:(t,e)=>{t=g(t);let r=0;return(e=g(e))<-22038912e5&&-22038912e5<t&&(r=1),Math.floor(t-e)/864e5+r},DAYS360:(t,e,r)=>{t=g(t),e=g(e),r=o.accept(r,a.BOOLEAN,!1),31===t.getUTCDate()&&t.setUTCDate(30),!r&&30>t.getUTCDate()&&e.getUTCDate()>30?e.setUTCMonth(e.getUTCMonth()+1,1):31===e.getUTCDate()&&e.setUTCDate(30);let n=e.getUTCFullYear()-t.getUTCFullYear();return 30*(e.getUTCMonth()-t.getUTCMonth())+(e.getUTCDate()-t.getUTCDate())+360*n},EDATE:(t,e)=>(t=g(t),e=o.accept(e,a.NUMBER),t.setUTCMonth(t.getUTCMonth()+e),d(t)),EOMONTH:(t,e)=>(t=g(t),e=o.accept(e,a.NUMBER),t.setUTCMonth(t.getUTCMonth()+e+1,0),d(t)),HOUR:t=>g(t).getUTCHours(),ISOWEEKNUM:t=>{let e=g(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=r.getUTCDay();r.setUTCDate(r.getUTCDate()+4-n);let o=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r-o)/864e5+1)/7)},MINUTE:t=>g(t).getUTCMinutes(),MONTH:t=>g(t).getUTCMonth()+1,NETWORKDAYS:(t,e,r)=>{t=g(t);let n=1;if(t>(e=g(e))){n=-1;let r=t;t=e,e=r}let i=[];null!=r&&o.flattenParams([r],a.NUMBER,!1,t=>{i.push(g(t))});let c=0;for(;t<=e;){if(0!==t.getUTCDay()&&6!==t.getUTCDay()){let e=!1;for(let r=0;r<i.length;r++)if(v(t,i[r])){e=!0;break}!e&&c++}t.setUTCDate(t.getUTCDate()+1)}return n*c},"NETWORKDAYS.INTL":(t,e,r,i)=>{t=g(t);let c=1;if(t>(e=g(e))){c=-1;let r=t;t=e,e=r}if("1111111"===(r=o.accept(r,null,1)))return 0;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);let t=[];for(let e=0;e<r.length;e++)"1"===r.charAt(e)&&t.push(e);r=t}else{if("number"!=typeof r)throw n.VALUE;r=s[r]}let u=[];null!=i&&o.flattenParams([i],a.NUMBER,!1,t=>{u.push(g(t))});let l=0;for(;t<=e;){let e=!1;for(let n=0;n<r.length;n++)if(r[n]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let r=0;r<u.length;r++)if(v(t,u[r])){e=!0;break}!e&&l++}t.setUTCDate(t.getUTCDate()+1)}return c*l},NOW:()=>{let t=new Date;return d(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))+(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},SECOND:t=>g(t).getUTCSeconds(),TIME:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>32767||e<0||e>32767||r<0||r>32767)throw n.NUM;return(3600*t+60*e+r)/86400},TIMEVALUE:t=>(3600*(t=g(t)).getUTCHours()+60*t.getUTCMinutes()+t.getUTCSeconds())/86400,TODAY:()=>{let t=new Date;return d(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))},WEEKDAY:(t,e)=>{let r=g(t);e=o.accept(e,a.NUMBER,1);let i=r.getUTCDay(),c=u[e];if(!c)throw n.NUM;return c[i]},WEEKNUM:(t,e)=>{let r=g(t);if(21===(e=o.accept(e,a.NUMBER,1)))return E.ISOWEEKNUM(t);let n=c[e],i=new Date(Date.UTC(r.getUTCFullYear(),0,1)),u=i.getUTCDay()<n?1:0;return Math.ceil(((r-i)/864e5+1)/7)+u},WORKDAY:(t,e,r)=>E["WORKDAY.INTL"](t,e,1,r),"WORKDAY.INTL":(t,e,r,i)=>{if(t=g(t),e=o.accept(e,a.NUMBER),"1111111"===(r=o.accept(r,null,1)))throw n.VALUE;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);let t=[];for(let e=0;e<r.length;e++)"1"===r.charAt(e)&&t.push(e);r=t}else{if("number"!=typeof r)throw n.VALUE;if(null==(r=s[r]))throw n.NUM}let c=[];null!=i&&o.flattenParams([i],a.NUMBER,!1,t=>{c.push(g(t))}),t.setUTCDate(t.getUTCDate()+1);let u=0;for(;u<e;){let e=!1;for(let n=0;n<r.length;n++)if(r[n]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let r=0;r<c.length;r++)if(v(t,c[r])){e=!0;break}!e&&u++}t.setUTCDate(t.getUTCDate()+1)}return d(t)-1},YEAR:t=>g(t).getUTCFullYear(),YEARFRAC:(t,e,r)=>{if((t=g(t))>(e=g(e))){let r=t;t=e,e=r}if((r=Math.trunc(r=o.accept(r,a.NUMBER,0)))<0||r>4)throw n.VALUE;let i=t.getUTCDate(),c=t.getUTCMonth()+1,u=t.getUTCFullYear(),s=e.getUTCDate(),l=e.getUTCMonth()+1,f=e.getUTCFullYear();switch(r){case 0:return 31===i&&31===s?(i=30,s=30):31===i?i=30:30===i&&31===s&&(s=30),Math.abs(s+30*l+360*f-(i+30*c+360*u))/360;case 1:if(f-u<2){let r=(1900===u||1===new Date(u,1,29).getMonth())&&1900!==u?366:365;return E.DAYS(e,t)/r}{let r=(new Date(f+1,0,1)-new Date(u,0,1))/1e3/60/60/24;return E.DAYS(e,t)/(r/(f-u+1))}case 2:return Math.abs(E.DAYS(e,t)/360);case 3:return Math.abs(E.DAYS(e,t)/365);case 4:return Math.abs(s+30*l+360*f-(i+30*c+360*u))/360}}};t.exports=E},16081:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a}=r(47436),i=r(15374),c=r(2263),u={"BETA.DIST":(t,e,r,c,u,s)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN),u=o.accept(u,a.NUMBER,0),s=o.accept(s,a.NUMBER,1),e<=0||r<=0||t<u||t>s||u===s)throw n.NUM;return t=(t-u)/(s-u),c?i.beta.cdf(t,e,r):i.beta.pdf(t,e,r)/(s-u)},"BETA.INV":(t,e,r,c,u)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.NUMBER,0),u=o.accept(u,a.NUMBER,1),e<=0||r<=0||t<=0||t>1)throw n.NUM;return i.beta.inv(t,e,r)*(u-c)+c},"BINOM.DIST":(t,e,r,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN),e<0||r<0||r>1||t<0||t>e)throw n.NUM;return c?i.binomial.cdf(t,e,r):i.binomial.pdf(t,e,r)},"BINOM.DIST.RANGE":(t,e,r,i)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.NUMBER,r),t<0||e<0||e>1||r<0||r>t||i<r||i>t)throw n.NUM;let u=0;for(let n=r;n<=i;n++)u+=c.COMBIN(t,n)*Math.pow(e,n)*Math.pow(1-e,t-n);return u},"BINOM.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||e<0||e>1||r<0||r>1)throw n.NUM;let c=0;for(;c<=t;){if(i.binomial.cdf(c,t,e)>=r)return c;c++}},"CHISQ.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),e=Math.trunc(e),t<0||e<1||e>1e10)throw n.NUM;return r?i.chisquare.cdf(t,e):i.chisquare.pdf(t,e)},"CHISQ.DIST.RT":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=Math.trunc(e=o.accept(e,a.NUMBER)),t<0||e<1||e>1e10)throw n.NUM;return 1-i.chisquare.cdf(t,e)},"CHISQ.INV":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=Math.trunc(e=o.accept(e,a.NUMBER)),t<0||t>1||e<1||e>1e10)throw n.NUM;return i.chisquare.inv(t,e)},"CHISQ.INV.RT":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=Math.trunc(e=o.accept(e,a.NUMBER)),t<0||t>1||e<1||e>1e10)throw n.NUM;return i.chisquare.inv(1-t,e)},"CHISQ.TEST":(t,e)=>{let r=o.accept(t,a.ARRAY,void 0,!1,!1),i=o.accept(e,a.ARRAY,void 0,!1,!1);if(r.length!==i.length||r[0].length!==i[0].length||1===r.length&&1===r[0].length)throw n.NA;let c=r.length,u=r[0].length,s=(c-1)*(u-1);s=1===c?u-1:c-1;let l=0;for(let t=0;t<c;t++)for(let e=0;e<u;e++)if("number"==typeof r[t][e]&&"number"==typeof i[t][e]){if(0===i[t][e])throw n.DIV0;l+=Math.pow(r[t][e]-i[t][e],2)/i[t][e]}let f=Math.exp(-.5*l);s%2==1&&(f*=Math.sqrt(2*l/Math.PI));let h=s;for(;h>=2;)f=f*l/h,h-=2;let p=f,d=s;for(;p>1e-15*f;)d+=2,f+=p=p*l/d;return 1-f},"CONFIDENCE.NORM":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=Math.trunc(r=o.accept(r,a.NUMBER)),t<=0||t>=1||e<=0||r<1)throw n.NUM;return i.normalci(1,t,e,r)[1]-1},"CONFIDENCE.T":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=Math.trunc(r=o.accept(r,a.NUMBER)),t<=0||t>=1||e<=0||r<1)throw n.NUM;if(1===r)throw n.DIV0;return i.tci(1,t,e,r)[1]-1},CORREL:(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;let r=[],c=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),c.push(e[n]));if(r.length<=1)throw n.DIV0;return i.corrcoeff(r,c)},"COVARIANCE.P":(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;let r=[],c=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),c.push(e[n]));let u=i.mean(r),s=i.mean(c),l=0;for(let t=0;t<r.length;t++)l+=(r[t]-u)*(c[t]-s);return l/r.length},"COVARIANCE.S":(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;let r=[],c=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),c.push(e[n]));if(r.length<=1)throw n.DIV0;return i.covariance(r,c)},DEVSQ:(...t)=>{let e=0,r=[];o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r.push(t))});let n=e/r.length;e=0;for(let t=0;t<r.length;t++)e+=(r[t]-n)**2;return e},"EXPON.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.BOOLEAN),t<0||e<=0)throw n.NUM;return r?i.exponential.cdf(t,e):i.exponential.pdf(t,e)},"F.DIST":(t,e,r,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN),t<0||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),c?i.centralF.cdf(t,e,r):i.centralF.pdf(t,e,r)},"F.DIST.RT":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),1-i.centralF.cdf(t,e,r)},"F.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>1||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),i.centralF.inv(t,e,r)},"F.INV.RT":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>1||e<1||e>=1e10||r<1||r>=1e10)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),i.centralF.inv(1-t,e,r)},"F.TEST":(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0);let r=[],c=[],u=0,s=0;for(let n=0;n<Math.max(t.length,e.length);n++)"number"==typeof t[n]&&(r.push(t[n]),u+=t[n]),"number"==typeof e[n]&&(c.push(e[n]),s+=e[n]);if(r.length<=1||c.length<=1)throw n.DIV0;u/=r.length,s/=c.length;let l=0,f=0;for(let t=0;t<r.length;t++)l+=(u-r[t])**2;l/=r.length-1;for(let t=0;t<c.length;t++)f+=(s-c[t])**2;return f/=c.length-1,2*i.centralF.cdf(l/f,r.length-1,c.length-1)},FISHER:t=>{if((t=o.accept(t,a.NUMBER))<=-1||t>=1)throw n.NUM;return Math.log((1+t)/(1-t))/2},FISHERINV:t=>{let e=Math.exp(2*(t=o.accept(t,a.NUMBER)));return(e-1)/(e+1)},FORECAST:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.ARRAY,void 0,!0,!0),(r=o.accept(r,a.ARRAY,void 0,!0,!0)).length!==e.length)throw n.NA;let c=[],u=[],s=!0;for(let t=0;t<e.length;t++)"number"==typeof e[t]&&"number"==typeof r[t]&&(c.push(e[t]),u.push(r[t]),r[t]!==r[0]&&(s=!1));if(s)throw n.DIV0;let l=i.mean(c),f=i.mean(u),h=0,p=0;for(let t=0;t<c.length;t++)h+=(u[t]-f)*(c[t]-l),p+=(u[t]-f)**2;let d=h/p;return l-d*f+d*t},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...t)=>u.FORECAST(...t),FREQUENCY:(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0);let r=[];for(let t=0;t<e.length;t++)"number"==typeof e[t]&&r.push(e[t]);r.sort(),r.push(1/0);let n=[];for(let e=0;e<r.length;e++){n[e]=[],n[e][0]=0;for(let o=0;o<t.length;o++)"number"==typeof t[o]&&t[o]<=r[e]&&(n[e][0]++,t[o]=null)}return n},GAMMA:t=>{if(0===(t=o.accept(t,a.NUMBER))||t<0&&t===Math.trunc(t))throw n.NUM;return i.gammafn(t)},"GAMMA.DIST":(t,e,r,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN),t<0||e<=0||r<=0)throw n.NUM;return c?i.gamma.cdf(t,e,r,!0):i.gamma.pdf(t,e,r,!1)},"GAMMA.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>1||e<=0||r<=0)throw n.NUM;return i.gamma.inv(t,e,r)},GAMMALN:t=>{if((t=o.accept(t,a.NUMBER))<=0)throw n.NUM;return i.gammaln(t)},"GAMMALN.PRECISE":t=>{if((t=o.accept(t,a.NUMBER))<=0)throw n.NUM;return i.gammaln(t)},GAUSS:t=>(t=o.accept(t,a.NUMBER),i.normal.cdf(t,0,1)-.5),GEOMEAN:(...t)=>{let e=[];return o.flattenParams(t,a.NUMBER,!0,(t,r)=>{"number"==typeof t&&e.push(t)}),i.geomean(e)},GROWTH:(t,e,r,i)=>{let c,u;t=o.accept(t,a.ARRAY,void 0,!0,!0);for(let e=0;e<t.length;e++)if("number"!=typeof t[e])throw n.VALUE;let s=null==(e=o.accept(e,a.ARRAY,null,!0,!0));if(null==e){e=[];for(let r=1;r<=t.length;r++)e.push(r)}else{if(e.length!==t.length)throw n.REF;for(let t=0;t<e.length;t++)if("number"!=typeof e[t])throw n.VALUE}if(null==(r=o.accept(r,a.ARRAY,null,!1,!0))&&s){r=[];for(let e=1;e<=t.length;e++)r.push(e);r=[r]}else null==r&&(r=Array.isArray(e[0])?e:[e]);i=o.accept(i,a.BOOLEAN,!0);let l=t.length,f=0,h=0,p=0,d=0;for(let r=0;r<l;r++){let n=e[r],o=Math.log(t[r]);f+=n,h+=o,p+=n*o,d+=n*n}f/=l,h/=l,p/=l,d/=l,i?(c=(p-f*h)/(d-f*f),u=h-c*f):(c=p/d,u=0);let m=[];for(let t=0;t<r.length;t++){m[t]=[];for(let e=0;e<r[0].length;e++){if("number"!=typeof r[t][e])throw n.VALUE;m[t][e]=Math.exp(u+c*r[t][e])}}return m},HARMEAN:(...t)=>{let e=0,r=0;return o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(r+=1/t,e++)}),e/r},"HYPGEOM.DIST":(t,e,r,i,u)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.NUMBER),u=o.accept(u,a.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r=Math.trunc(r),(i=Math.trunc(i))<=0||t<0||e<=0||r<=0||e>i||r>i||e<t||r<t||t<e-i+r)throw n.NUM;function s(t,e,r,n){return c.COMBIN(r,t)*c.COMBIN(n-r,e-t)/c.COMBIN(n,e)}return u?function(t,e,r,n){let o=0;for(let a=0;a<=t;a++)o+=s(a,e,r,n);return o}(t,e,r,i):s(t,e,r,i)},INTERCEPT:(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),(e=o.accept(e,a.ARRAY,void 0,!0,!0)).length!==t.length)throw n.NA;let r=[],c=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),c.push(e[n]));if(r.length<=1)throw n.DIV0;let u=i.mean(r),s=i.mean(c),l=0,f=0;for(let t=0;t<r.length;t++)l+=(c[t]-s)*(r[t]-u),f+=(c[t]-s)**2;return u-l/f*s},KURT:(...t)=>{let e=0,r=[];o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r.push(t))});let n=r.length;e/=n;let c=0;for(let t=0;t<n;t++)c+=Math.pow(r[t]-e,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(c/=Math.pow(i.stdev(r,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(t,e,r,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN),t<=0||r<=0)throw n.NUM;return c?i.lognormal.cdf(t,e,r):i.lognormal.pdf(t,e,r)},"LOGNORM.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<=0||t>=1||r<=0)throw n.NUM;return i.lognormal.inv(t,e,r)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(t,e,r,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r<0||r>1||t<0||e<1)throw n.NUM;return c?i.negbin.cdf(t,e,r):i.negbin.pdf(t,e,r)},"NORM.DIST":(t,e,r,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN),r<=0)throw n.NUM;return c?i.normal.cdf(t,e,r):i.normal.pdf(t,e,r)},"NORM.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<=0||t>=1||r<=0)throw n.NUM;return i.normal.inv(t,e,r)},"NORM.S.DIST":(t,e)=>(t=o.accept(t,a.NUMBER),(e=o.accept(e,a.BOOLEAN))?i.normal.cdf(t,0,1):i.normal.pdf(t,0,1)),"NORM.S.INV":t=>{if((t=o.accept(t,a.NUMBER))<=0||t>=1)throw n.NUM;return i.normal.inv(t,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:t=>Math.exp(-.5*(t=o.accept(t,a.NUMBER))*t)/2.5066282746310002,"POISSON.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.BOOLEAN),t<0||e<0)throw n.NUM;return t=Math.trunc(t),r?i.poisson.cdf(t,e):i.poisson.pdf(t,e)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),(r=o.accept(r,a.NUMBER))<=0)throw n.NUM;return(t-e)/r},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.BOOLEAN),e<1)throw n.NUM;return r?i.studentt.cdf(t,e):i.studentt.pdf(t,e)},"T.DIST.2T":(t,e)=>{if(t=o.accept(t,a.NUMBER),(e=o.accept(e,a.NUMBER))<1||t<0)throw n.NUM;return(1-i.studentt.cdf(t,e))*2},"T.DIST.RT":(t,e)=>{if(t=o.accept(t,a.NUMBER),(e=o.accept(e,a.NUMBER))<1)throw n.NUM;return 1-i.studentt.cdf(t,e)},"T.INV":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),t<=0||t>1||e<1)throw n.NUM;return e=e%1==0?e:Math.trunc(e),i.studentt.inv(t,e)},"T.INV.2T":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),t<=0||t>1||e<1)throw n.NUM;return e=e%1==0?e:Math.trunc(e),Math.abs(i.studentt.inv(t/2,e))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(t,e,r,i)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.BOOLEAN),t<0||e<=0||r<=0)throw n.NUM;return i?1-Math.exp(-Math.pow(t/r,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/r,e))*e/Math.pow(r,e)},"Z.TEST":()=>{}};t.exports={DistributionFunctions:u}},94903:function(t,e,r){let n=r(19632),o=r(46533),{FormulaHelpers:a,Types:i}=r(47436),c=r(67218),u=r(15374),s=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,l=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,f=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function h(t){t=a.accept(t);let e=0,r=0,o="i";if("number"==typeof t)return{real:t,im:r,unit:o};if("boolean"==typeof t)throw n.VALUE;let i=t.match(s);if(i)return{real:e=Number(i[0]),im:r,unit:o};if(i=t.match(l))return{real:e,im:r=Number(/^\s?[+-]?\s?$/.test(i[1])?i[1]+"1":i[1]),unit:o=i[0].slice(-1)};if(i=t.match(f))return{real:e=Number(i[1]),im:r=Number(/^\s?[+-]?\s?$/.test(i[3])?i[3]+"1":i[3]),unit:o=i[0].slice(-1)};throw n.NUM}let p={BESSELI:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return c.besseli(t,e)},BESSELJ:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return c.besselj(t,e)},BESSELK:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return c.besselk(t,e)},BESSELY:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return c.bessely(t,e)},BIN2DEC:t=>{let e=(t=a.accept(t,i.NUMBER_NO_BOOLEAN)).toString();if(e.length>10)throw n.NUM;return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)+-512:parseInt(e,2)},BIN2HEX:(t,e)=>{t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER_NO_BOOLEAN,null);let r=t.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substring(0,1))return(parseInt(r.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();let c=parseInt(t,2).toString(16);if(null==e)return c.toUpperCase();if(e<0)throw n.NUM;if((e=Math.trunc(e))>=c.length)return(o.REPT("0",e-c.length)+c).toUpperCase();throw n.NUM},BIN2OCT:(t,e)=>{t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER,null);let r=t.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substr(0,1))return(parseInt(r.substr(1),2)+1073741312).toString(8);let c=parseInt(t,2).toString(8);if(null==e)return c.toUpperCase();if(e<0)throw n.NUM;if((e=Math.trunc(e))>=c.length)return o.REPT("0",e-c.length)+c;throw n.NUM},BITAND:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>0xffffffffffff||e>0xffffffffffff)throw n.NUM;return t&e},BITLSHIFT:(t,e)=>{if(t=a.accept(t,i.NUMBER),Math.abs(e=Math.trunc(e=a.accept(e,i.NUMBER)))>53||t<0||Math.floor(t)!==t||t>0xffffffffffff)throw n.NUM;let r=e>=0?t*2**e:Math.trunc(t/2**-e);if(!(r>0xffffffffffff))return r;throw n.NUM},BITOR:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>0xffffffffffff||e>0xffffffffffff)throw n.NUM;return t|e},BITRSHIFT:(t,e)=>(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),p.BITLSHIFT(t,-e)),BITXOR:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<0||t>0xffffffffffff||Math.floor(t)!==t||e<0||e>0xffffffffffff||Math.floor(e)!==e)throw n.NUM;return t^e},COMPLEX:(t,e,r)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER_NO_BOOLEAN),"i"!==(r=a.accept(r,i.STRING,"i"))&&"j"!==r)throw n.VALUE;if(0===t&&0===e)return 0;if(0===t)return 1===e?r:-1===e?"-"+r:e.toString()+r;if(0===e)return t.toString();{let n=e>0?"+":"";return 1===e?t.toString()+n+r:-1===e?t.toString()+n+"-"+r:t.toString()+n+e.toString()+r}},DEC2BIN:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER,null),t<-512||t>511)throw n.NUM;if(t<0)return"1"+o.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);let r=parseInt(t,10).toString(2);if(null==e)return r;if((e=Math.trunc(e))<=0||e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r},DEC2HEX:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER,null),t<-549755813888||t>549755813888)throw n.NUM;if(t<0)return(1099511627776+t).toString(16).toUpperCase();let r=parseInt(t,10).toString(16);if(null==e)return r.toUpperCase();if((e=Math.trunc(e))<=0||e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r.toUpperCase()},DEC2OCT:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER,null),t<-536870912||t>536870912)throw n.NUM;if(t<0)return(t+1073741824).toString(8);let r=parseInt(t,10).toString(8);if(null==e)return r.toUpperCase();if((e=Math.trunc(e))<=0||e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r},DELTA:(t,e)=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN))===(e=a.accept(e,i.NUMBER_NO_BOOLEAN,0))?1:0,ERF:(t,e)=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER_NO_BOOLEAN,0),u.erf(t)),ERFC:t=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN),u.erfc(t)),GESTEP:(t,e)=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN))>=(e=a.accept(e,i.NUMBER_NO_BOOLEAN,0))?1:0,HEX2BIN:(t,e)=>{if(t=a.accept(t,i.STRING),e=a.accept(e,i.NUMBER,null),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let r=10===t.length&&"f"===t.substr(0,1).toLowerCase(),c=r?parseInt(t,16)-1099511627776:parseInt(t,16);if(c<-512||c>511)throw n.NUM;if(r)return"1"+o.REPT("0",9-(c+512).toString(2).length)+(c+512).toString(2);let u=c.toString(2);if(null==e)return u;if((e=Math.trunc(e))<=0||e<u.length)throw n.NUM;return o.REPT("0",e-u.length)+u},HEX2DEC:t=>{if((t=a.accept(t,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},HEX2OCT:(t,e)=>{if((t=a.accept(t,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let r=p.HEX2DEC(t);if(r>536870911||r<-536870912)throw n.NUM;return p.DEC2OCT(r,e)},IMABS:t=>{let{real:e,im:r}=h(t);return Math.sqrt(Math.pow(e,2)+Math.pow(r,2))},IMAGINARY:t=>h(t).im,IMARGUMENT:t=>{let{real:e,im:r}=h(t);if(0===e&&0===r)throw n.DIV0;return 0===e&&r>0?Math.PI/2:0===e&&r<0?-Math.PI/2:e<0&&0===r?Math.PI:e>0&&0===r?0:e>0?Math.atan(r/e):e<0&&r>0?Math.atan(r/e)+Math.PI:Math.atan(r/e)-Math.PI},IMCONJUGATE:t=>{let{real:e,im:r,unit:n}=h(t);return 0!==r?p.COMPLEX(e,-r,n):""+e},IMCOS:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.cos(e)*(Math.exp(r)+Math.exp(-r))/2,a=-Math.sin(e)*(Math.exp(r)-Math.exp(-r))/2;return p.COMPLEX(o,a,n)},IMCOSH:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.cos(r)*(Math.exp(e)+Math.exp(-e))/2,a=-Math.sin(r)*(Math.exp(e)-Math.exp(-e))/2;return p.COMPLEX(o,-a,n)},IMCOT:t=>{t=a.accept(t);let e=p.IMCOS(t),r=p.IMSIN(t);return p.IMDIV(e,r)},IMCSC:t=>(t=a.accept(t),p.IMDIV("1",p.IMSIN(t))),IMCSCH:t=>(t=a.accept(t),p.IMDIV("1",p.IMSINH(t))),IMDIV:(t,e)=>{let r=h(t),o=r.real,a=r.im,i=r.unit,c=h(e),u=c.real,s=c.im,l=c.unit;if(0===u&&0===s||i!==l)throw n.NUM;let f=Math.pow(u,2)+Math.pow(s,2);return p.COMPLEX((o*u+a*s)/f,(a*u-o*s)/f,i)},IMEXP:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.exp(e);return p.COMPLEX(o*Math.cos(r),o*Math.sin(r),n)},IMLN:t=>{let{real:e,im:r,unit:n}=h(t);return p.COMPLEX(Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2))),Math.atan(r/e),n)},IMLOG10:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(10),a=Math.atan(r/e)/Math.log(10);return p.COMPLEX(o,a,n)},IMLOG2:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(2),a=Math.atan(r/e)/Math.log(2);return p.COMPLEX(o,a,n)},IMPOWER:(t,e)=>{let{unit:r}=h(t);e=a.accept(e,i.NUMBER_NO_BOOLEAN);let n=Math.pow(p.IMABS(t),e),o=p.IMARGUMENT(t),c=n*Math.cos(e*o),u=n*Math.sin(e*o);return p.COMPLEX(c,u,r)},IMPRODUCT:(...t)=>{let e;let r=0;return a.flattenParams(t,null,!1,t=>{if(0===r)h(e=a.accept(t));else{let r=h(e),o=r.real,a=r.im,i=r.unit,c=h(t),u=c.real,s=c.im;if(i!==c.unit)throw n.VALUE;e=p.COMPLEX(o*u-a*s,o*s+a*u)}r++},1),e},IMREAL:t=>h(t).real,IMSEC:t=>p.IMDIV("1",p.IMCOS(t)),IMSECH:t=>p.IMDIV("1",p.IMCOSH(t)),IMSIN:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.sin(e)*(Math.exp(r)+Math.exp(-r))/2,a=Math.cos(e)*(Math.exp(r)-Math.exp(-r))/2;return p.COMPLEX(o,a,n)},IMSINH:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.cos(r)*(Math.exp(e)-Math.exp(-e))/2,a=Math.sin(r)*(Math.exp(e)+Math.exp(-e))/2;return p.COMPLEX(o,a,n)},IMSQRT:t=>{let{unit:e}=h(t),r=Math.sqrt(p.IMABS(t)),n=p.IMARGUMENT(t);return p.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),e)},IMSUB:(t,e)=>{let r=h(t),o=r.real,a=r.im,i=r.unit,c=h(e),u=c.real,s=c.im;if(i!==c.unit)throw n.VALUE;return p.COMPLEX(o-u,a-s,i)},IMSUM:(...t)=>{let e=0,r=0,o;return a.flattenParams(t,null,!1,t=>{let{real:a,im:i,unit:c}=h(t);if(o||(o=c),o!==c)throw n.VALUE;e+=a,r+=i}),p.COMPLEX(e,r,o)},IMTAN:t=>{let{unit:e}=h(t);return p.IMDIV(p.IMSIN(t),p.IMCOS(t),e)},OCT2BIN:(t,e)=>{if(t=a.accept(t,i.STRING),e=a.accept(e,i.NUMBER,null),t.length>10||e>10||null!==e&&e<0)throw n.NUM;e=Math.trunc(e);let r=10===t.length&&"7"===t.substring(0,1),c=p.OCT2DEC(t);if(c<-512||c>511)return n.NUM;if(r)return"1"+o.REPT("0",9-(512+c).toString(2).length)+(512+c).toString(2);let u=c.toString(2);if(0===e)return u;if(e<u.length)throw n.NUM;return o.REPT("0",e-u.length)+u},OCT2DEC:t=>{if((t=a.accept(t,i.STRING)).length>10)throw n.NUM;for(let e of t)if(e<"0"||e>"7")throw n.NUM;let e=parseInt(t,8);return e>=536870912?e-1073741824:e},OCT2HEX:(t,e)=>{if(t=a.accept(t,i.STRING),e=a.accept(e,i.NUMBER_NO_BOOLEAN,null),t.length>10)throw n.NUM;for(let e of t)if(e<"0"||e>"7")throw n.NUM;if((e=Math.trunc(e))<0||e>10)throw n.NUM;let r=p.OCT2DEC(t),c=p.DEC2HEX(r);if(0===e)return c;if(!(e<c.length))return o.REPT("0",e-c.length)+c;throw n.NUM}};t.exports=p},25275:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a}=r(47436),i={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},c={CELL:(t,e)=>{},"ERROR.TYPE":t=>{if((t=o.accept(t))instanceof n)return i[t.toString()];throw n.NA},INFO:()=>{},ISBLANK:t=>!!t.ref&&(null==t.value||""===t.value),ISERR:t=>(t=o.accept(t))instanceof n&&"#N/A"!==t.toString(),ISERROR:t=>(t=o.accept(t))instanceof n,ISEVEN:t=>(t=Math.trunc(t=o.accept(t,a.NUMBER)))%2==0,ISLOGICAL:t=>"boolean"==typeof(t=o.accept(t)),ISNA:t=>(t=o.accept(t))instanceof n&&"#N/A"===t.toString(),ISNONTEXT:t=>"string"!=typeof(t=o.accept(t)),ISNUMBER:t=>"number"==typeof(t=o.accept(t)),ISREF:t=>!(!t.ref||o.isCellRef(t)&&(t.ref.row>1048576||t.ref.col>16384)||o.isRangeRef(t)&&(t.ref.from.row>1048576||t.ref.from.col>16384||t.ref.to.row>1048576||t.ref.to.col>16384))&&!((t=o.accept(t))instanceof n&&"#REF!"===t.toString()),ISTEXT:t=>"string"==typeof(t=o.accept(t)),N:t=>{let e=typeof(t=o.accept(t));if("number"===e)return t;if("boolean"===e)return Number(t);if(t instanceof n)throw t;return 0},NA:()=>{throw n.NA},TYPE:t=>{if(t.ref){if(o.isRangeRef(t))return 16;if(o.isCellRef(t)&&"string"==typeof(t=o.accept(t))&&0===t.length)return 1}let e=typeof(t=o.accept(t));return"number"===e?1:"string"===e?2:"boolean"===e?4:t instanceof n?16:Array.isArray(t)?64:void 0}};t.exports=c},75703:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a}=r(47436);function i(t){let e=0,r=0;return o.flattenParams(t,null,!0,t=>{let n=typeof t;"string"===n?"TRUE"===t?t=!0:"FALSE"===t&&(t=!1):"number"===n&&(t=!!t),"boolean"==typeof t&&(!0===t?e++:r++)}),[e,r]}let c={AND:(...t)=>{let[e,r]=i(t);return 0===e&&0===r?n.VALUE:e>0&&0===r},FALSE:()=>!1,IF:(t,e,r,n)=>(e=o.accept(e,a.BOOLEAN),r=o.accept(r),n=o.accept(n,null,!1),e?r:n),IFERROR:(t,e)=>t.value instanceof n?o.accept(e):o.accept(t),IFNA:function(t,e){if(arguments.length>2)throw n.TOO_MANY_ARGS("IFNA");return n.NA.equals(t.value)?o.accept(e):o.accept(t)},IFS:(...t)=>{if(t.length%2!=0)return new n("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let e=0;e<t.length/2;e++){let r=o.accept(t[2*e],a.BOOLEAN),n=o.accept(t[2*e+1]);if(r)return n}return n.NA},NOT:t=>!(t=o.accept(t,a.BOOLEAN)),OR:(...t)=>{let[e,r]=i(t);return 0===e&&0===r?n.VALUE:e>0},SWITCH:(...t)=>{},TRUE:()=>!0,XOR:(...t)=>{let[e,r]=i(t);return 0===e&&0===r?n.VALUE:e%2==1}};t.exports=c},2263:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a,Factorials:i,Criteria:c}=r(47436),{Infix:u}=r(24463),s=[],l=[];function f(t){return t<=100?i[t]:s[t]>0?s[t]:s[t]=f(t-1)*t}let h={ABS:t=>Math.abs(t=o.accept(t,a.NUMBER)),AGGREGATE:(t,e,r,...n)=>{},ARABIC:t=>{if(t=o.accept(t,a.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))throw new n("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(t){e+=({M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1})[t]}),e},BASE:(t,e,r)=>{if((t=o.accept(t,a.NUMBER))<0||t>=9007199254740992||(e=o.accept(e,a.NUMBER))<2||e>36||(r=o.accept(r,a.NUMBER,0))<0)throw n.NUM;let i=t.toString(e).toUpperCase();return Array(Math.max(r+1-i.length,0)).join("0")+i},CEILING:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))return 0;if(t/e%1==0)return t;let r=Math.abs(e),n=Math.floor(Math.abs(t)/r);return t<0?e<0?-r*(n+1):-r*n:(n+1)*r},"CEILING.MATH":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,t>0?1:-1),r=o.accept(r,a.NUMBER,0),t>=0)return h.CEILING(t,e);let n=r?e:0;return h.CEILING(t,e)-n},"CEILING.PRECISE":(t,e)=>(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,1),h.CEILING(t,Math.abs(e))),COMBIN:(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),t<0||e<0||t<e)throw n.NUM;return h.FACT(t)/h.FACT(e)/h.FACT(t-e)},COMBINA:(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),(0===t||1===t)&&0===e)return 1;if(t<0||e<0)throw n.NUM;return h.COMBIN(t+e-1,t-1)},DECIMAL:(t,e)=>{if(t=o.accept(t,a.STRING),(e=Math.trunc(e=o.accept(e,a.NUMBER)))<2||e>36)throw n.NUM;let r=parseInt(t,e);if(isNaN(r))throw n.NUM;return r},DEGREES:t=>180/Math.PI*(t=o.accept(t,a.NUMBER)),EVEN:t=>h.CEILING(t,-2),EXP:t=>Math.exp(t=o.accept(t,a.NUMBER)),FACT:t=>{if((t=Math.trunc(t=o.accept(t,a.NUMBER)))>170||t<0)throw n.NUM;return t<=100?i[t]:f(t)},FACTDOUBLE:t=>{if((t=Math.trunc(t=o.accept(t,a.NUMBER)))<-1)throw n.NUM;return -1===t?1:function t(e){return 1===e||0===e?1:2===e?2:l[e]>0?l[e]:l[e]=t(e-2)*e}(t)},FLOOR:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))return 0;if(t>0&&e<0)throw n.NUM;if(t/e%1==0)return t;let r=Math.abs(e),i=Math.floor(Math.abs(t)/r);return t<0?e<0?-r*i:-r*(i+1):i*r},"FLOOR.MATH":(t,e,r)=>(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,t>0?1:-1),0===(r=o.accept(r,a.NUMBER,0))||t>=0)?h.FLOOR(t,Math.abs(e)):h.FLOOR(t,e)+e,"FLOOR.PRECISE":(t,e)=>(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,1),h.FLOOR(t,Math.abs(e))),GCD:(...t)=>{let e=[];o.flattenParams(t,null,!1,t=>{if(isNaN(t="boolean"==typeof t?NaN:Number(t)))throw n.VALUE;if(t<0||t>9007199254740990)throw n.NUM;e.push(Math.trunc(t))},0);let r,a,i=t.length,c=Math.abs(e[0]);for(r=1;r<i;r++){for(a=Math.abs(e[r]);c&&a;)c>a?c%=a:a%=c;c+=a}return c},INT:t=>Math.floor(t=o.accept(t,a.NUMBER)),"ISO.CEILING":(...t)=>h["CEILING.PRECISE"](...t),LCM:(...t)=>{let e=[];o.flattenParams(t,null,!1,t=>{if(isNaN(t="boolean"==typeof t?NaN:Number(t)))throw n.VALUE;if(t<0||t>9007199254740990)throw n.NUM;e.push(Math.trunc(t))},1);let r=e.length,a=Math.abs(e[0]);for(let t=1;t<r;t++){let r=Math.abs(e[t]),n=a;for(;a&&r;)a>r?a%=r:r%=a;a=Math.abs(n*e[t])/(a+r)}return a},LN:t=>Math.log(t=o.accept(t,a.NUMBER)),LOG:(t,e)=>Math.log(t=o.accept(t,a.NUMBER))/Math.log(e=o.accept(e,a.NUMBER,10)),LOG10:t=>Math.log10(t=o.accept(t,a.NUMBER)),MDETERM:t=>{if((t=o.accept(t,a.ARRAY,void 0,!1,!0))[0].length!==t.length)throw n.VALUE;let e=t.length,r=t[0].length,i=0,c,u;if(1===e)return t[0][0];if(2===e)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(let n=0;n<r;n++){c=t[0][n],u=t[0][n];for(let o=1;o<e;o++)u*=t[o][((n+o)%r+r)%r],c*=t[o][((n-o)%r+r)%r];i+=u-c}return i},MINVERSE:t=>{},MMULT:(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!1,!0),e=o.accept(e,a.ARRAY,void 0,!1,!0);let r=t.length,i=t[0].length,c=e.length,u=e[0].length,s=Array(r);if(i!==c)throw n.VALUE;for(let o=0;o<r;o++){s[o]=Array(u);for(let r=0;r<u;r++){s[o][r]=0;for(let a=0;a<i;a++){let i=t[o][a],c=e[a][r];if("number"!=typeof i||"number"!=typeof c)throw n.VALUE;s[o][r]+=t[o][a]*e[a][r]}}}return s},MOD:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))throw n.DIV0;return t-e*h.INT(t/e)},MROUND:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))return 0;if(t>0&&e<0||t<0&&e>0)throw n.NUM;return t/e%1==0?t:Math.round(t/e)*e},MULTINOMIAL:(...t)=>{let e=0,r=1;return o.flattenParams(t,a.NUMBER,!1,t=>{if(t<0)throw n.NUM;e+=t,r*=f(t)}),f(e)/r},MUNIT:t=>{t=o.accept(t,a.NUMBER);let e=[];for(let r=0;r<t;r++){let n=[];for(let e=0;e<t;e++)r===e?n.push(1):n.push(0);e.push(n)}return e},ODD:t=>{if(0===(t=o.accept(t,a.NUMBER)))return 1;let e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},PI:()=>Math.PI,POWER:(t,e)=>(t=o.accept(t,a.NUMBER))**(e=o.accept(e,a.NUMBER)),PRODUCT:(...t)=>{let e=1;return o.flattenParams(t,null,!0,(t,r)=>{let n=Number(t);r.isLiteral&&!isNaN(n)?e*=n:"number"==typeof t&&(e*=t)},1),e},QUOTIENT:(t,e)=>Math.trunc((t=o.accept(t,a.NUMBER))/(e=o.accept(e,a.NUMBER))),RADIANS:t=>(t=o.accept(t,a.NUMBER))/180*Math.PI,RAND:()=>Math.random(),RANDBETWEEN:(t,e)=>(t=o.accept(t,a.NUMBER),Math.floor(Math.random()*((e=o.accept(e,a.NUMBER))-t+1)+t)),ROMAN:(t,e)=>{if(t=o.accept(t,a.NUMBER),0!==(e=o.accept(e,a.NUMBER,0)))throw Error("ROMAN: only allows form=0 (classic form).");let r=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",c=3;for(;c--;)i=(n[+r.pop()+10*c]||"")+i;return Array(+r.join("")+1).join("M")+i},ROUND:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Math.pow(10,Math.abs(e=o.accept(e,a.NUMBER))),n=t>0?1:-1;return e>0?n*Math.round(Math.abs(t)*r)/r:0===e?n*Math.round(Math.abs(t)):n*Math.round(Math.abs(t)/r)*r},ROUNDDOWN:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Math.pow(10,Math.abs(e=o.accept(e,a.NUMBER))),n=t>0?1:-1;return e>0?n*Math.round((Math.abs(t)-1/r*.5)*r)/r:0===e?n*Math.round(Math.abs(t)-.5):n*Math.round((Math.abs(t)-.5*r)/r)*r},ROUNDUP:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Math.pow(10,Math.abs(e=o.accept(e,a.NUMBER))),n=t>0?1:-1;return e>0?n*Math.round((Math.abs(t)+1/r*.5)*r)/r:0===e?n*Math.round(Math.abs(t)+.5):n*Math.round((Math.abs(t)+.5*r)/r)*r},SERIESSUM:(t,e,r,i)=>{t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER);let c=0,u;return o.flattenParams([i],a.NUMBER,!1,o=>{if("number"!=typeof o)throw n.VALUE;0===c?u=o*Math.pow(t,e):u+=o*Math.pow(t,e+c*r),c++}),u},SIGN:t=>(t=o.accept(t,a.NUMBER))>0?1:0===t?0:-1,SQRT:t=>{if((t=o.accept(t,a.NUMBER))<0)throw n.NUM;return Math.sqrt(t)},SQRTPI:t=>{if((t=o.accept(t,a.NUMBER))<0)throw n.NUM;return Math.sqrt(t*Math.PI)},SUBTOTAL:()=>{},SUM:(...t)=>{let e=0;return o.flattenParams(t,a.NUMBER,!0,(t,r)=>{r.isLiteral?e+=t:"number"==typeof t&&(e+=t)}),e},SUMIF:(t,e,r,n)=>{let a=o.retrieveRanges(t,e,n);e=a[0],n=a[1];let i=(r=o.retrieveArg(t,r)).isArray;r=c.parse(o.accept(r));let s=0;return e.forEach((t,e)=>{t.forEach((t,o)=>{let a=n[e][o];"number"==typeof a&&("wc"===r.op?r.match===r.value.test(t)&&(s+=a):u.compareOp(t,r.op,r.value,Array.isArray(t),i)&&(s+=a))})}),s},SUMIFS:()=>{},SUMPRODUCT:(t,...e)=>{t=o.accept(t,a.ARRAY,void 0,!1,!0),e.forEach(e=>{if(e=o.accept(e,a.ARRAY,void 0,!1,!0),t[0].length!==e[0].length||t.length!==e.length)throw n.VALUE;for(let r=0;r<t.length;r++)for(let n=0;n<t[0].length;n++)"number"!=typeof t[r][n]&&(t[r][n]=0),"number"!=typeof e[r][n]&&(e[r][n]=0),t[r][n]*=e[r][n]});let r=0;return t.forEach(t=>{t.forEach(t=>{r+=t})}),r},SUMSQ:(...t)=>{let e=0;return o.flattenParams(t,a.NUMBER,!0,(t,r)=>{r.isLiteral?e+=t**2:"number"==typeof t&&(e+=t**2)}),e},SUMX2MY2:(t,e)=>{let r=[],a=[],i=0;if(o.flattenParams([t],null,!1,(t,e)=>{r.push(t)}),o.flattenParams([e],null,!1,(t,e)=>{a.push(t)}),r.length!==a.length)throw n.NA;for(let t=0;t<r.length;t++)"number"==typeof r[t]&&"number"==typeof a[t]&&(i+=r[t]**2-a[t]**2);return i},SUMX2PY2:(t,e)=>{let r=[],a=[],i=0;if(o.flattenParams([t],null,!1,(t,e)=>{r.push(t)}),o.flattenParams([e],null,!1,(t,e)=>{a.push(t)}),r.length!==a.length)throw n.NA;for(let t=0;t<r.length;t++)"number"==typeof r[t]&&"number"==typeof a[t]&&(i+=r[t]**2+a[t]**2);return i},SUMXMY2:(t,e)=>{let r=[],a=[],i=0;if(o.flattenParams([t],null,!1,(t,e)=>{r.push(t)}),o.flattenParams([e],null,!1,(t,e)=>{a.push(t)}),r.length!==a.length)throw n.NA;for(let t=0;t<r.length;t++)"number"==typeof r[t]&&"number"==typeof a[t]&&(i+=(r[t]-a[t])**2);return i},TRUNC:t=>Math.trunc(t=o.accept(t,a.NUMBER))};t.exports=h},78648:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a,WildCard:i,Address:c}=r(47436),u=r(12361),s={ADDRESS:(t,e,r,i,u)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER,1),i=o.accept(i,a.BOOLEAN,!0),u=o.accept(u,a.STRING,""),t<1||e<1||r<1||r>4)throw n.VALUE;let s="";return u.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(u)?s+=`'${u}'!`:s+=u+"!"),i?s+=(1===r||3===r?"$":"")+c.columnNumberToName(e)+(1===r||2===r?"$":"")+t:s+="R"+(4===r||3===r?`[${t}]`:t)+"C"+(4===r||2===r?`[${e}]`:e),s},AREAS:t=>(t=o.accept(t))instanceof u?t.length:1,CHOOSE:(t,...e)=>{},COLUMN:(t,e)=>{if(null==e){if(null!=t.position.col)return t.position.col;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return e.ref.col;if(o.isRangeRef(e))return e.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")},COLUMNS:(t,e)=>{if(null==e)throw Error("COLUMNS requires one argument");if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return 1;if(o.isRangeRef(e))return Math.abs(e.ref.from.col-e.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(t,e,r,c)=>{t=o.accept(t);try{e=o.accept(e,a.ARRAY,void 0,!1)}catch(t){if(t instanceof n)throw n.NA;throw t}if(r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===e[r-1])throw n.REF;let u=typeof t;if(c){let o=u===typeof e[0][0]?e[0][0]:null;for(let a=1;a<e[0].length;a++){let i=e[0][a];if(typeof i===u){if(o>t&&i>t)throw n.NA;if(i===t)return e[r-1][a];if(null!=o&&i>t&&o<=t)return e[r-1][a-1];o=i}}if(null==o)throw n.NA;return o}{let o=-1;if(-1===(o=i.isWildCard(t)?e[0].findIndex(e=>i.toRegex(t,"i").test(e)):e[0].findIndex(e=>e===t)))throw n.NA;return e[r-1][o]}},INDEX:(t,e,r,i,c)=>{r={value:(r=t.utils.extractRefValue(r)).val,isArray:r.isArray},r=Math.trunc(r=o.accept(r,a.NUMBER)),null==i?i=1:(i={value:(i=t.utils.extractRefValue(i)).val,isArray:i.isArray},i=Math.trunc(i=o.accept(i,a.NUMBER,1))),null==c?c=1:(c={value:(c=t.utils.extractRefValue(c)).val,isArray:c.isArray},c=Math.trunc(c=o.accept(c,a.NUMBER,1)));let s=e;if(e instanceof u)s=e.refs[c-1];else if(c>1)throw n.REF;if(0===r&&0===i)return s;if(0===r){if(o.isRangeRef(s)){if(s.ref.to.col-s.ref.from.col<i-1)throw n.REF;return s.ref.from.col+=i-1,s.ref.to.col=s.ref.from.col,s}if(Array.isArray(s)){let t=[];return s.forEach(e=>t.push([e[i-1]])),t}}if(0===i){if(o.isRangeRef(s)){if(s.ref.to.row-s.ref.from.row<r-1)throw n.REF;return s.ref.from.row+=r-1,s.ref.to.row=s.ref.from.row,s}if(Array.isArray(s))return s[i-1]}if(0!==r&&0!==i){if(o.isRangeRef(s)){if((s=s.ref).to.row-s.from.row<r-1||s.to.col-s.from.col<i-1)throw n.REF;return{ref:{row:s.from.row+r-1,col:s.from.col+i-1}}}if(o.isCellRef(s)){if(s=s.ref,r>1||i>1)throw n.REF;return{ref:{row:s.row+r-1,col:s.col+i-1}}}if(Array.isArray(s)){if(s.length<r||s[0].length<i)throw n.REF;return s[r-1][i-1]}}},MATCH:()=>{},ROW:(t,e)=>{if(null==e){if(null!=t.position.row)return t.position.row;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return e.ref.row;if(o.isRangeRef(e))return e.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")},ROWS:(t,e)=>{if(null==e)throw Error("ROWS requires one argument");if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return 1;if(o.isRangeRef(e))return Math.abs(e.ref.from.row-e.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:t=>{t=o.accept(t,a.ARRAY,void 0,!1);let e=[];for(let r=0;r<t[0].length;r++){e[r]=[];for(let n=0;n<t.length;n++)e[r][n]=t[n][r]}return e},VLOOKUP:(t,e,r,c)=>{t=o.accept(t);try{e=o.accept(e,a.ARRAY,void 0,!1)}catch(t){if(t instanceof n)throw n.NA;throw t}if(r=o.accept(r,a.NUMBER),c=o.accept(c,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===e[0][r-1])throw n.REF;let u=typeof t;if(c){let o=u===typeof e[0][0]?e[0][0]:null;for(let a=1;a<e.length;a++){let i=e[a],c=e[a][0];if(typeof c===u){if(o>t&&c>t)throw n.NA;if(c===t)return i[r-1];if(null!=o&&c>t&&o<=t)return e[a-1][r-1];o=c}}if(null==o)throw n.NA;return o}{let o=-1;if(-1===(o=i.isWildCard(t)?e.findIndex(e=>i.toRegex(t,"i").test(e[0])):e.findIndex(e=>e[0]===t)))throw n.NA;return e[o][r-1]}}};t.exports=s},18790:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a,Criteria:i,Address:c}=r(47436),{Infix:u}=r(24463),{DistributionFunctions:s}=r(16081),l={AVEDEV:(...t)=>{let e=0,r=[];o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r.push(t))});let n=e/r.length;e=0;for(let t=0;t<r.length;t++)e+=Math.abs(r[t]-n);return e/r.length},AVERAGE:(...t)=>{let e=0,r=0;return o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r++)}),e/r},AVERAGEA:(...t)=>{let e=0,r=0;return o.flattenParams(t,a.NUMBER,!0,(t,n)=>{let o=typeof t;"number"===o?(e+=t,r++):"string"===o&&r++}),e/r},AVERAGEIF:(t,e,r,a)=>{let c=o.retrieveRanges(t,e,a);e=c[0],a=c[1];let s=(r=o.retrieveArg(t,r)).isArray;r=i.parse(o.accept(r));let l=0,f=0;if(e.forEach((t,e)=>{t.forEach((t,n)=>{let o=a[e][n];"number"==typeof o&&("wc"===r.op?r.match===r.value.test(t)&&(l+=o,f++):u.compareOp(t,r.op,r.value,Array.isArray(t),s)&&(l+=o,f++))})}),0===f)throw n.DIV0;return l/f},AVERAGEIFS:()=>{},COUNT:(...t)=>{let e=0;return o.flattenParams(t,null,!0,(t,r)=>{r.isLiteral&&!isNaN(t)?e++:"number"==typeof t&&e++}),e},COUNTIF:(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!1,!0);let r=e.isArray;e=o.accept(e);let n=0;return e=i.parse(e),t.forEach(t=>{t.forEach(t=>{"wc"===e.op?e.match===e.value.test(t)&&n++:u.compareOp(t,e.op,e.value,Array.isArray(t),r)&&n++})}),n},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};t.exports=Object.assign(l,s)},46533:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a,WildCard:i}=r(47436),c=r(32855),u=r(33226),s={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"｡｢｣､･ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ",full:"。「」、・ヲァィゥェォャュョッーアイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワン゛゜"},extras:{delta:0,half:"\xa2\xa3\xac\xaf\xa6\xa5₩ |←↑→↓■\xb0",full:"￠￡￢￣￤￥￦　￨￩￪￫￬￭￮"}},l=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)+t.delta):[...t.full][[...t.half].indexOf(e)],f=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)-t.delta):[...t.half][[...t.full].indexOf(e)],h=(t,e)=>t[e+"RE"]||RegExp("["+t[e]+"]","g"),p=Object.keys(s).map(t=>s[t]),d=t=>p.reduce((t,e)=>t.replace(h(e,"half"),l(e)),t),m=t=>p.reduce((t,e)=>t.replace(h(e,"full"),f(e)),t),g={ASC:t=>m(t=o.accept(t,a.STRING)),BAHTTEXT:t=>{t=o.accept(t,a.NUMBER);try{return u(t)}catch(t){throw Error(`Error in https://github.com/jojoee/bahttext 
${t.toString()}`)}},CHAR:t=>{if((t=o.accept(t,a.NUMBER))>255||t<1)throw n.VALUE;return String.fromCharCode(t)},CLEAN:t=>(t=o.accept(t,a.STRING)).replace(/[\x00-\x1F]/g,""),CODE:t=>{if(0===(t=o.accept(t,a.STRING)).length)throw n.VALUE;return t.charCodeAt(0)},CONCAT:(...t)=>{let e="";return o.flattenParams(t,a.STRING,!1,t=>{t=o.accept(t,a.STRING),e+=t}),e},CONCATENATE:(...t)=>{let e="";if(0===t.length)throw Error("CONCATENATE need at least one argument.");return t.forEach(t=>{t=o.accept(t,a.STRING),e+=t}),e},DBCS:t=>d(t=o.accept(t,a.STRING)),DOLLAR:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Array(e=o.accept(e,a.NUMBER,2)).fill("0").join("");return c.format(`$#,##0.${r}_);($#,##0.${r})`,t).trim()},EXACT:(t,e)=>(t=o.accept(t,[a.STRING]))===(e=o.accept(e,[a.STRING])),FIND:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.STRING),(r=o.accept(r,a.NUMBER,1))<1||r>e.length)throw n.VALUE;let i=e.indexOf(t,r-1);if(-1===i)throw n.VALUE;return i+1},FINDB:(...t)=>g.FIND(...t),FIXED:(t,e,r)=>{t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,2),r=o.accept(r,a.BOOLEAN,!1);let n=Array(e).fill("0").join(""),i=r?"":"#,";return c.format(`${i}##0.${n}_);(${i}##0.${n})`,t).trim()},LEFT:(t,e)=>{if(t=o.accept(t,a.STRING),(e=o.accept(e,a.NUMBER,1))<0)throw n.VALUE;return e>t.length?t:t.slice(0,e)},LEFTB:(...t)=>g.LEFT(...t),LEN:t=>(t=o.accept(t,a.STRING)).length,LENB:(...t)=>g.LEN(...t),LOWER:t=>(t=o.accept(t,a.STRING)).toLowerCase(),MID:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),e>t.length)return"";if(e<1||r<1)throw n.VALUE;return t.slice(e-1,e+r-1)},MIDB:(...t)=>g.MID(...t),NUMBERVALUE:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.STRING,"."),r=o.accept(r,a.STRING,","),0===t.length)return 0;if(0===e.length||0===r.length||(e=e[0])===(r=r[0])||t.indexOf(e)<t.lastIndexOf(r))throw n.VALUE;let i=t.replace(r,"").replace(e,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!i)throw n.VALUE;let c=i[1].length,u=i[3].length,s=i[4].length,l=Number(i[2]);if(c>1||c&&!u||!c&&u||isNaN(l))throw n.VALUE;return l/=100**s,c?-l:l},PHONETIC:()=>{},PROPER:t=>(t=(t=(t=o.accept(t,[a.STRING])).toLowerCase()).charAt(0).toUpperCase()+t.slice(1)).replace(/(?:[^a-zA-Z])([a-zA-Z])/g,t=>t.toUpperCase()),REPLACE:(t,e,r,n)=>{t=o.accept(t,[a.STRING]),e=o.accept(e,[a.NUMBER]),r=o.accept(r,[a.NUMBER]),n=o.accept(n,[a.STRING]);let i=t.split("");return i.splice(e-1,r,n),i.join("")},REPLACEB:(...t)=>g.REPLACE(...t),REPT:(t,e)=>{t=o.accept(t,a.STRING),e=o.accept(e,a.NUMBER);let r="";for(let n=0;n<e;n++)r+=t;return r},RIGHT:(t,e)=>{if(t=o.accept(t,a.STRING),(e=o.accept(e,a.NUMBER,1))<0)throw n.VALUE;let r=t.length;return e>r?t:t.slice(r-e)},RIGHTB:(...t)=>g.RIGHT(...t),SEARCH:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.STRING),(r=o.accept(r,a.NUMBER,1))<1||r>e.length)throw n.VALUE;let c=i.isWildCard(t)?i.toRegex(t,"i"):t,u=e.slice(r-1).search(c);if(-1===u)throw n.VALUE;return u+r},SEARCHB:(...t)=>g.SEARCH(...t),SUBSTITUTE:(...t)=>{},T:t=>"string"==typeof(t=o.accept(t))?t:"",TEXT:(t,e)=>{t=o.accept(t,a.NUMBER),e=o.accept(e,a.STRING);try{return c.format(e,t)}catch(t){throw console.error(t),n.VALUE}},TEXTJOIN:(...t)=>{},TRIM:t=>(t=o.accept(t,[a.STRING])).replace(/^\s+|\s+$/g,""),UNICHAR:t=>{if((t=o.accept(t,[a.NUMBER]))<=0)throw n.VALUE;return String.fromCharCode(t)},UNICODE:t=>g.CODE(t)};t.exports=g},78989:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a}=r(47436),i={ACOS:t=>{if((t=o.accept(t,a.NUMBER))>1||t<-1)throw n.NUM;return Math.acos(t)},ACOSH:t=>{if((t=o.accept(t,a.NUMBER))<1)throw n.NUM;return Math.acosh(t)},ACOT:t=>Math.PI/2-Math.atan(t=o.accept(t,a.NUMBER)),ACOTH:t=>{if(1>=Math.abs(t=o.accept(t,a.NUMBER)))throw n.NUM;return Math.atanh(1/t)},ASIN:t=>{if((t=o.accept(t,a.NUMBER))>1||t<-1)throw n.NUM;return Math.asin(t)},ASINH:t=>Math.asinh(t=o.accept(t,a.NUMBER)),ATAN:t=>Math.atan(t=o.accept(t,a.NUMBER)),ATAN2:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER))&&0===t)throw n.DIV0;return Math.atan2(e,t)},ATANH:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>1)throw n.NUM;return Math.atanh(t)},COS:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return Math.cos(t)},COSH:t=>Math.cosh(t=o.accept(t,a.NUMBER)),COT:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;if(0===t)throw n.DIV0;return 1/Math.tan(t)},COTH:t=>{if(0===(t=o.accept(t,a.NUMBER)))throw n.DIV0;return 1/Math.tanh(t)},CSC:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return 1/Math.sin(t)},CSCH:t=>{if(0===(t=o.accept(t,a.NUMBER)))throw n.DIV0;return 1/Math.sinh(t)},SEC:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return 1/Math.cos(t)},SECH:t=>1/Math.cosh(t=o.accept(t,a.NUMBER)),SIN:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return Math.sin(t)},SINH:t=>Math.sinh(t=o.accept(t,a.NUMBER)),TAN:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return Math.tan(t)},TANH:t=>Math.tanh(t=o.accept(t,a.NUMBER))};t.exports=i},6352:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a}=r(47436);t.exports={ENCODEURL:t=>encodeURIComponent(o.accept(t,a.STRING)),FILTERXML:()=>{},WEBSERVICE:(t,e)=>{throw n.ERROR("WEBSERVICE is not supported in sync mode.")}}},47436:function(t,e,r){let n=r(19632),o=r(12361),a={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},i={};Object.keys(a).forEach(t=>{i[a[t]]=t});class c{constructor(){this.Types=a,this.type2Number={number:a.NUMBER,boolean:a.BOOLEAN,string:a.STRING,object:-1}}checkFunctionResult(t){if("number"==typeof t){if(isNaN(t))return n.VALUE;if(!isFinite(t))return n.NUM}return null==t?n.NULL:t}flattenDeep(t){return t.reduce((t,e)=>Array.isArray(e)?t.concat(this.flattenDeep(e)):t.concat(e),[])}acceptNumber(t,e=!0,r=!0){let o;if(t instanceof n)return t;if("number"==typeof t)o=t;else if("boolean"==typeof t){if(r)o=Number(t);else throw n.VALUE}else if("string"==typeof t){if(0===t.length||(o=Number(t))!=o)throw n.VALUE}else if(Array.isArray(t)){if(e)o=this.acceptNumber(t[0][0]);else if(1===t[0].length)o=this.acceptNumber(t[0][0]);else throw n.VALUE}else throw Error("Unknown type in FormulaHelpers.acceptNumber");return o}flattenParams(t,e,r,i,c=null,u=1){if(t.length<u)throw n.ARG_MISSING([e]);null==c&&(c=e===a.NUMBER?0:null==e?null:""),t.forEach(t=>{let{isCellRef:a,isRangeRef:u,isArray:s}=t,l=t.value instanceof o,f=!a&&!u&&!s&&!l,h={isLiteral:f,isCellRef:a,isRangeRef:u,isArray:s,isUnion:l};if(f)i(t=t.omitted?c:this.accept(t,e,c),h);else if(a)i(t.value,h);else if(l){if(!r)throw n.VALUE;t=t.value.data,(t=this.flattenDeep(t)).forEach(t=>{i(t,h)})}else(u||s)&&(t=this.flattenDeep(t.value)).forEach(t=>{i(t,h)})})}accept(t,e=null,r,i=!0,c=!1){if(Array.isArray(e)&&(e=e[0]),null==t&&void 0===r)throw n.ARG_MISSING([e]);if(null==t)return r;if("object"!=typeof t||Array.isArray(t))return t;let u=t.isArray;if(null!=t.value&&(t=t.value),null==e)return t;if(t instanceof n)throw t;if(e===a.ARRAY){if(Array.isArray(t))return i?this.flattenDeep(t):t;if(t instanceof o);else if(c)return i?[t]:[[t]];throw n.VALUE}if(e===a.COLLECTIONS)return t;u&&(t=t[0][0]);let s=this.type(t);if(e===a.STRING)t=s===a.BOOLEAN?t?"TRUE":"FALSE":`${t}`;else if(e===a.BOOLEAN){if(s===a.STRING)throw n.VALUE;s===a.NUMBER&&(t=!!t)}else if(e===a.NUMBER)t=this.acceptNumber(t,!1);else if(e===a.NUMBER_NO_BOOLEAN)t=this.acceptNumber(t,!1,!1);else throw n.VALUE;return t}type(t){let e=this.type2Number[typeof t];return -1===e&&(Array.isArray(t)?e=a.ARRAY:t.ref?e=t.ref.from?a.RANGE_REF:a.CELL_REF:t instanceof o&&(e=a.COLLECTIONS)),e}isRangeRef(t){return t.ref&&t.ref.from}isCellRef(t){return t.ref&&!t.ref.from}retrieveRanges(t,e,r){return r=l.extend(e,r),e=this.retrieveArg(t,e),e=u.accept(e,a.ARRAY,void 0,!1,!0),r!==e?(r=this.retrieveArg(t,r),r=u.accept(r,a.ARRAY,void 0,!1,!0)):r=e,[e,r]}retrieveArg(t,e){if(null===e)return{value:0,isArray:!1,omitted:!0};let r=t.utils.extractRefValue(e);return{value:r.val,isArray:r.isArray,ref:e.ref}}}let u=new c,s={isWildCard:t=>"string"==typeof t&&/[*?]/.test(t),toRegex:(t,e)=>RegExp(t.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),e)},l={columnNumberToName:t=>{let e=t,r="",n=0;for(;e>0;)r=String.fromCharCode(65+(n=(e-1)%26))+r,e=Math.floor((e-n)/26);return r},columnNameToNumber:t=>{let e=(t=t.toUpperCase()).length,r=0;for(let n=0;n<e;n++){let o=t.charCodeAt(n);isNaN(o)||(r+=(o-64)*26**(e-n-1))}return r},extend:(t,e)=>{let r,n;if(null==e)return t;if(u.isCellRef(t))r=0,n=0;else if(u.isRangeRef(t))r=t.ref.to.row-t.ref.from.row,n=t.ref.to.col-t.ref.from.col;else throw Error("Address.extend should not reach here.");return u.isCellRef(e)?(r>0||n>0)&&(e={ref:{from:{col:e.ref.col,row:e.ref.row},to:{row:e.ref.row+r,col:e.ref.col+n}}}):(e.ref.to.row=e.ref.from.row+r,e.ref.to.col=e.ref.from.col+n),e}};t.exports={FormulaHelpers:u,Types:a,ReversedTypes:i,Factorials:[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],WildCard:s,Criteria:{parse:t=>{let e=typeof t;if("string"===e){let e=t.toUpperCase();if("TRUE"===e||"FALSE"===e)return{op:"=",value:"TRUE"===e};let r=t.match(/(<>|>=|<=|>|<|=)(.*)/);if(r){let t=r[1],e;if(isNaN(r[2])){let o=r[2].toUpperCase();if("TRUE"===o||"FALSE"===o)e="TRUE"===o;else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(r[2]))e=new n(r[2]);else if(e=r[2],s.isWildCard(e))return{op:"wc",value:s.toRegex(e),match:"="===t}}else e=Number(r[2]);return{op:t,value:e}}return s.isWildCard(t)?{op:"wc",value:s.toRegex(t),match:!0}:{op:"=",value:t}}if("boolean"===e||"number"===e||Array.isArray(t)||t instanceof n)return{op:"=",value:t};throw Error(`Criteria.parse: type ${typeof t} not support`)}},Address:l}},24463:function(t,e,r){let n=r(19632),{FormulaHelpers:o}=r(47436),a={unaryOp:(t,e,r)=>{let a=1;if(t.forEach(t=>{if("+"===t);else if("-"===t)a=-a;else throw Error(`Unrecognized prefix: ${t}`)}),null==e&&(e=0),1===a)return e;try{e=o.acceptNumber(e,r)}catch(t){if(t instanceof n)Array.isArray(e)&&(e=e[0][0]);else throw t}return"number"==typeof e&&isNaN(e)?n.VALUE:-e}},i={percentOp:(t,e,r)=>{try{t=o.acceptNumber(t,r)}catch(t){if(t instanceof n)return t;throw t}if("%"===e)return t/100;throw Error(`Unrecognized postfix: ${e}`)}},c={boolean:3,string:2,number:1},u={compareOp:(t,e,r,n,o)=>{null==t&&(t=0),null==r&&(r=0),n&&(t=t[0][0]),o&&(r=r[0][0]);let a=typeof t,i=typeof r;if(a===i)switch(e){case"=":return t===r;case">":return t>r;case"<":return t<r;case"<>":return t!==r;case"<=":return t<=r;case">=":return t>=r}else switch(e){case"=":return!1;case">":return c[a]>c[i];case"<":return c[a]<c[i];case"<>":return!0;case"<=":return c[a]<=c[i];case">=":return c[a]>=c[i]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(t,e,r,n,o)=>(null==t&&(t=""),null==r&&(r=""),n&&(t=t[0][0]),o&&(r=r[0][0]),"boolean"==typeof t&&(t=t?"TRUE":"FALSE"),"boolean"==typeof r&&(r=r?"TRUE":"FALSE"),""+t+r),mathOp:(t,e,r,a,i)=>{null==t&&(t=0),null==r&&(r=0);try{t=o.acceptNumber(t,a),r=o.acceptNumber(r,i)}catch(t){if(t instanceof n)return t;throw t}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":if(0===r)return n.DIV0;return t/r;case"^":return t**r}throw Error("Infix.mathOp: Should not reach here.")}};t.exports={Prefix:a,Postfix:i,Infix:u,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}}},99556:function(t,e,r){let n=r(19632),{FormulaHelpers:o}=r(47436),{Parser:a}=r(482),i=r(60645),c=r(38892),{formatChevrotainError:u}=r(54229);class s{constructor(t){this.data=[],this.utils=new c(this),t=Object.assign({onVariable:()=>null},t),this.utils=new c(this),this.onVariable=t.onVariable,this.functions={},this.parser=new a(this,this.utils)}getCell(t){return null!=t.row&&(null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(e=>e.from&&e.from.row<=t.row&&e.to.row>=t.row&&e.from.col<=t.col&&e.to.col>=t.col||e.row===t.row&&e.col===t.col&&e.sheet===t.sheet)&&this.data.push(t)),0}getRange(t){return null!=t.from.row&&(null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(e=>e.from&&e.from.row===t.from.row&&e.from.col===t.from.col&&e.to.row===t.to.row&&e.to.col===t.to.col)&&this.data.push(t)),[[0]]}getVariable(t){let e={ref:this.onVariable(t,this.position.sheet)};return null==e.ref?n.NAME:(o.isCellRef(e)?this.getCell(e.ref):this.getRange(e.ref),0)}retrieveRef(t){return o.isRangeRef(t)?this.getRange(t.ref):o.isCellRef(t)?this.getCell(t.ref):t}callFunction(t,e){return e.forEach(t=>{null!=t&&this.retrieveRef(t)}),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,e,r=!1){if(0===t.length)throw Error("Input must not be empty.");this.data=[],this.position=e;let o=i.lex(t);this.parser.input=o.tokens;try{let t=this.parser.formulaWithBinaryOp();this.checkFormulaResult(t)}catch(t){if(!r)throw n.ERROR(t.message,t)}if(this.parser.errors.length>0&&!r)throw u(this.parser.errors[0],t);return this.data}}t.exports={DepParser:s}},38892:function(t,e,r){let n=r(19632),{FormulaHelpers:o,Types:a,Address:i}=r(47436),{Prefix:c,Postfix:u,Infix:s,Operators:l}=r(24463),f=r(12361);class h{constructor(t){this.context=t}columnNameToNumber(t){return i.columnNameToNumber(t)}parseCellAddress(t){let e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){if(!Number.isInteger(+t))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,e){return this.extractRefValue(e),0}applyPostfix(t,e){return this.extractRefValue(t),0}applyInfix(t,e,r){return this.extractRefValue(t),this.extractRefValue(r),0}applyIntersect(t){let e,r,o,a,i,c,u;if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let s=t.shift().ref;if(i=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),r=Math.max(s.from.col,s.to.col),a=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,r=a=s.col}return(t.forEach(t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){let c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(s>e||c<o||f>r||l<a||i!==t.sheet)&&(u=n.NULL),e=Math.min(e,c),o=Math.max(o,s),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>r||t.col<a||i!==t.sheet)&&(u=n.NULL),e=o=t.row,r=a=t.col}}),u)?u:((c=e===o&&r===a?{ref:{sheet:i,row:e,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:e,col:r}}}).ref.sheet||delete c.ref.sheet,c)}applyUnion(t){let e=new f;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];e.add(this.extractRefValue(t[r]).val,t[r])}return e}applyRange(t){let e=-1,r=-1,n=1048577,o=16385;return t.forEach(t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(n=1,e=1048576),void 0===t.col&&(o=1,r=16384),t.row>e&&(e=t.row),t.row<n&&(n=t.row),t.col>r&&(r=t.col),t.col<o&&(o=t.col)}),e===n&&r===o?{ref:{row:e,col:r}}:{ref:{from:{row:n,col:o},to:{row:e,col:r}}}}extractRefValue(t){let e=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:e}:{val:t,isArray:e}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new n(t.toUpperCase())}isFormulaError(t){return t instanceof n}}t.exports=h},67583:function(t,e,r){let n=r(46533),o=r(2263),a=r(78989),i=r(75703),c=r(94903),u=r(78648),s=r(25275),l=r(18790),f=r(68777),h=r(6352),p=r(19632),{FormulaHelpers:d}=r(47436),{Parser:m,allTokens:g}=r(482),v=r(60645),E=r(54229);class y{constructor(t,e=!1){this.logs=[],this.isTest=e,this.utils=new E(this),t=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},t),this.onVariable=t.onVariable,this.functions=Object.assign({},f,l,s,u,c,i,n,o,a,h,t.functions,t.functionsNeedContext),this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(o).concat(Object.keys(a)).concat(Object.keys(i)).concat(Object.keys(c)).concat(Object.keys(u)).concat(Object.keys(l)).concat(Object.keys(f)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(t.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(s),this.parser=new m(this,this.utils)}static get allTokens(){return g}getCell(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){let e={ref:this.onVariable(t,this.position.sheet,this.position)};return null==e.ref?p.NAME:e}retrieveRef(t){return d.isRangeRef(t)?this.getRange(t.ref):d.isCellRef(t)?this.getCell(t.ref):t}_callFunction(t,e){0===t.indexOf("_xlfn.")&&(t=t.slice(6)),t=t.toUpperCase();let r=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(e=e.map(e=>{if(null===e)return{value:r,isArray:!1,omitted:!0};let n=this.utils.extractRefValue(e);return this.funsPreserveRef.includes(t)?{value:n.val,isArray:n.isArray,ref:e.ref}:{value:n.val,isArray:n.isArray,isRangeRef:!!d.isRangeRef(e),isCellRef:!!d.isCellRef(e)}})),this.functions[t]){let r;try{r=this.funsNeedContextAndNoDataRetrieve.includes(t)||this.funsNeedContext.includes(t)?this.functions[t](this,...e):this.functions[t](...e)}catch(t){if(t instanceof p)return t;throw t}if(void 0===r){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}return r}if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}async callFunctionAsync(t,e){let r=[];for(let t of e)r.push(await t);let n=await this._callFunction(t,r);return d.checkFunctionResult(n)}callFunction(t,e){if(this.async)return this.callFunctionAsync(t,e);{let r=this._callFunction(t,e);return d.checkFunctionResult(r)}}supportedFunctions(){let t=[];return Object.keys(this.functions).forEach(e=>{try{let r=this.functions[e](0,0,0,0,0,0,0,0,0,0,0);if(void 0===r)return;t.push(e)}catch(r){r instanceof Error&&t.push(e)}}),t.sort()}checkFormulaResult(t,e=!1){let r=typeof t;if("number"===r){if(isNaN(t))return p.VALUE;if(!isFinite(t))return p.NUM;t+=0}else if("object"===r){if(t instanceof p)return t;if(e){if(t.ref&&(t=this.retrieveRef(t)),"object"==typeof t&&!Array.isArray(t)&&null!=t)return p.VALUE}else if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else{if(!Array.isArray(t))return p.VALUE;t=t[0][0]}}return t}parse(t,e,r=!1){let n;if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!1;let o=v.lex(t);this.parser.input=o.tokens;try{if(n=this.parser.formulaWithBinaryOp(),(n=this.checkFormulaResult(n,r))instanceof p)return n}catch(t){throw p.ERROR(t.message,t)}if(this.parser.errors.length>0){let e=this.parser.errors[0];throw E.formatChevrotainError(e,t)}return n}async parseAsync(t,e,r=!1){let n;if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!0;let o=v.lex(t);this.parser.input=o.tokens;try{if(n=await this.parser.formulaWithBinaryOp(),(n=this.checkFormulaResult(n,r))instanceof p)return n}catch(t){throw p.ERROR(t.message,t)}if(this.parser.errors.length>0){let e=this.parser.errors[0];throw E.formatChevrotainError(e,t)}return n}}t.exports={FormulaParser:y,FormulaHelpers:d}},60645:function(t,e,r){let{createToken:n,Lexer:o}=r(89560),a=r(19632),i={},c=n({name:"WhiteSpace",pattern:/\s+/,group:o.SKIPPED}),u=n({name:"String",pattern:/"(""|[^"])*"/}),s=n({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),l=n({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),f=n({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),h=n({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),p=n({name:"RefError",pattern:/#REF!/}),d=n({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),m=n({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),g=n({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:d}),v=n({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),E=n({name:"Boolean",pattern:/TRUE|FALSE/i}),y=n({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:d}),N=n({name:"At",pattern:/@/}),R=n({name:"Comma",pattern:/,/}),T=n({name:"Colon",pattern:/:/}),A=n({name:"Semicolon",pattern:/;/}),M=n({name:"OpenParen",pattern:/\(/}),w=n({name:"CloseParen",pattern:/\)/}),O=n({name:"OpenSquareParen",pattern:/\[/}),I=n({name:"CloseSquareParen",pattern:/]/});n({name:"exclamationMark",pattern:/!/});let C=n({name:"OpenCurlyParen",pattern:/{/}),S=n({name:"CloseCurlyParen",pattern:/}/}),b=n({name:"QuoteS",pattern:/'/}),U=n({name:"MulOp",pattern:/\*/}),x=n({name:"PlusOp",pattern:/\+/}),L=n({name:"DivOp",pattern:/\//}),_=n({name:"MinOp",pattern:/-/}),k=n({name:"ConcatOp",pattern:/&/}),P=n({name:"ExOp",pattern:/\^/}),B=n({name:"PercentOp",pattern:/%/}),D=n({name:"GtOp",pattern:/>/}),F=n({name:"EqOp",pattern:/=/}),V=n({name:"LtOp",pattern:/</}),G=[c,u,l,s,f,h,p,m,g,E,y,d,v,N,R,T,A,M,w,O,I,C,S,b,U,x,L,_,k,P,U,B,n({name:"NeqOp",pattern:/<>/}),n({name:"GteOp",pattern:/>=/}),n({name:"LteOp",pattern:/<=/}),D,F,V],j=new o(G,{ensureOptimizations:!0});G.forEach(t=>{i[t.name]=t}),t.exports={tokenVocabulary:i,lex:function(t){let e=j.tokenize(t);if(e.errors.length>0){let r=e.errors[0],n=r.line,o=r.column,i="\n"+t.split("\n")[n-1]+"\n";throw i+=Array(o-1).fill(" ").join("")+"^\n",r.message=i+`Error at position ${n}:${o}
`+r.message,r.errorLocation={line:n,column:o},a.ERROR(r.message,r)}return e}}},482:function(t,e,r){let n=r(60645),{EmbeddedActionsParser:o}=r(89560),a=n.tokenVocabulary,{String:i,SheetQuoted:c,ExcelRefFunction:u,ExcelConditionalRefFunction:s,Function:l,FormulaErrorT:f,RefError:h,Cell:p,Sheet:d,Name:m,Number:g,Boolean:v,Column:E,Comma:y,Colon:N,Semicolon:R,OpenParen:T,CloseParen:A,OpenCurlyParen:M,CloseCurlyParen:w,MulOp:O,PlusOp:I,DivOp:C,MinOp:S,ConcatOp:b,ExOp:U,PercentOp:x,NeqOp:L,GteOp:_,LteOp:k,GtOp:P,EqOp:B,LtOp:D}=n.tokenVocabulary;class F extends o{constructor(t,e){super(a,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=e,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];let r=this;r.RULE("formulaWithBinaryOp",()=>{let t=[],e=[r.SUBRULE(r.formulaWithPercentOp)];return r.MANY(()=>{t.push(r.OR(r.c1||(r.c1=[{ALT:()=>r.CONSUME(P).image},{ALT:()=>r.CONSUME(B).image},{ALT:()=>r.CONSUME(D).image},{ALT:()=>r.CONSUME(L).image},{ALT:()=>r.CONSUME(_).image},{ALT:()=>r.CONSUME(k).image},{ALT:()=>r.CONSUME(b).image},{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(S).image},{ALT:()=>r.CONSUME(O).image},{ALT:()=>r.CONSUME(C).image},{ALT:()=>r.CONSUME(U).image}]))),e.push(r.SUBRULE2(r.formulaWithPercentOp))}),r.ACTION(()=>{for(let r of this.binaryOperatorsPrecedence)for(let n=0,o=t.length;n<o;n++){let a=t[n];r.includes(a)&&(t.splice(n,1),e.splice(n,2,this.utils.applyInfix(e[n],a,e[n+1])),n--,o--)}}),e[0]}),r.RULE("plusMinusOp",()=>r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(S).image}])),r.RULE("formulaWithPercentOp",()=>{let t=r.SUBRULE(r.formulaWithUnaryOp);return r.OPTION(()=>{let e=r.CONSUME(x).image;t=r.ACTION(()=>this.utils.applyPostfix(t,e))}),t}),r.RULE("formulaWithUnaryOp",()=>{let t=[];r.MANY(()=>{let e=r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(S).image}]);t.push(e)});let e=r.SUBRULE(r.formulaWithIntersect);return t.length>0?r.ACTION(()=>this.utils.applyPrefix(t,e)):e}),r.RULE("formulaWithIntersect",()=>{let t=r.SUBRULE(r.formulaWithRange),e=[t];return(r.MANY({GATE:()=>{let t=r.LA(0);return r.LA(1).startOffset>t.endOffset+1},DEF:()=>{e.push(r.SUBRULE3(r.formulaWithRange))}}),e.length>1)?r.ACTION(()=>r.ACTION(()=>this.utils.applyIntersect(e))):t}),r.RULE("formulaWithRange",()=>{let t=r.SUBRULE(r.formula),e=[t];return(r.MANY(()=>{r.CONSUME(N),e.push(r.SUBRULE2(r.formula))}),e.length>1)?r.ACTION(()=>r.ACTION(()=>this.utils.applyRange(e))):t}),r.RULE("formula",()=>r.OR9([{ALT:()=>r.SUBRULE(r.referenceWithoutInfix)},{ALT:()=>r.SUBRULE(r.paren)},{ALT:()=>r.SUBRULE(r.constant)},{ALT:()=>r.SUBRULE(r.functionCall)},{ALT:()=>r.SUBRULE(r.constantArray)}])),r.RULE("paren",()=>{let t;r.CONSUME(T);let e=[];return e.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME(y),e.push(r.SUBRULE2(r.formulaWithBinaryOp))}),t=e.length>1?r.ACTION(()=>this.utils.applyUnion(e)):e[0],r.CONSUME(A),t}),r.RULE("constantArray",()=>{let t=[[]],e=0;return r.CONSUME(M),t[e].push(r.SUBRULE(r.constantForArray)),r.MANY(()=>{let n=r.OR([{ALT:()=>r.CONSUME(y).image},{ALT:()=>r.CONSUME(R).image}]),o=r.SUBRULE2(r.constantForArray);","===n||(t[++e]=[]),t[e].push(o)}),r.CONSUME(w),r.ACTION(()=>this.utils.toArray(t))}),r.RULE("constantForArray",()=>r.OR([{ALT:()=>{let t=r.OPTION(()=>r.SUBRULE(r.plusMinusOp)),e=r.CONSUME(g).image,n=r.ACTION(()=>this.utils.toNumber(e));return t?r.ACTION(()=>this.utils.applyPrefix([t],n)):n}},{ALT:()=>{let t=r.CONSUME(i).image;return r.ACTION(()=>this.utils.toString(t))}},{ALT:()=>{let t=r.CONSUME(v).image;return r.ACTION(()=>this.utils.toBoolean(t))}},{ALT:()=>{let t=r.CONSUME(f).image;return r.ACTION(()=>this.utils.toError(t))}},{ALT:()=>{let t=r.CONSUME(h).image;return r.ACTION(()=>this.utils.toError(t))}}])),r.RULE("constant",()=>r.OR([{ALT:()=>{let t=r.CONSUME(g).image;return r.ACTION(()=>this.utils.toNumber(t))}},{ALT:()=>{let t=r.CONSUME(i).image;return r.ACTION(()=>this.utils.toString(t))}},{ALT:()=>{let t=r.CONSUME(v).image;return r.ACTION(()=>this.utils.toBoolean(t))}},{ALT:()=>{let t=r.CONSUME(f).image;return r.ACTION(()=>this.utils.toError(t))}}])),r.RULE("functionCall",()=>{let e=r.CONSUME(l).image.slice(0,-1),n=r.SUBRULE(r.arguments);return r.CONSUME(A),r.ACTION(()=>t.callFunction(e,n))}),r.RULE("arguments",()=>{r.MANY2(()=>{r.CONSUME2(y)});let t=[];return r.OPTION(()=>{t.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME1(y),t.push(null),r.OPTION3(()=>{t.pop(),t.push(r.SUBRULE2(r.formulaWithBinaryOp))})})}),t}),r.RULE("referenceWithoutInfix",()=>r.OR([{ALT:()=>r.SUBRULE(r.referenceItem)},{ALT:()=>{let t=r.SUBRULE(r.prefixName),e=r.SUBRULE2(r.formulaWithRange);return r.ACTION(()=>{if(this.utils.isFormulaError(e))return e;e.ref.sheet=t}),e}}])),r.RULE("referenceItem",()=>r.OR([{ALT:()=>{let t=r.CONSUME(p).image;return r.ACTION(()=>this.utils.parseCellAddress(t))}},{ALT:()=>{let e=r.CONSUME(m).image;return r.ACTION(()=>t.getVariable(e))}},{ALT:()=>{let t=r.CONSUME(E).image;return r.ACTION(()=>this.utils.parseCol(t))}},{ALT:()=>{let t=r.CONSUME(h).image;return r.ACTION(()=>this.utils.toError(t))}}])),r.RULE("prefixName",()=>r.OR([{ALT:()=>r.CONSUME(d).image.slice(0,-1)},{ALT:()=>r.CONSUME(c).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}t.exports={Parser:F}},12361:function(t){class e{constructor(t,e){if(null==t&&null==e)this._data=[],this._refs=[];else{if(t.length!==e.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=e}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,e){this._data.push(t),this._refs.push(e)}}t.exports=e},54229:function(t,e,r){let n=r(19632),{Address:o}=r(47436),{Prefix:a,Postfix:i,Infix:c,Operators:u}=r(24463),s=r(12361),{NotAllInputParsedException:l}=r(89560);class f{constructor(t){this.context=t}columnNameToNumber(t){return o.columnNameToNumber(t)}parseCellAddress(t){let e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:e[0],col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){if(!Number.isInteger(+t))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,e){return t=this.columnNameToNumber(t),e=this.columnNameToNumber(e),{ref:{from:{col:Math.min(t,e),row:null},to:{col:Math.max(t,e),row:null}}}}parseRowRange(t,e){return{ref:{from:{col:null,row:Math.min(t,e)},to:{col:null,row:Math.max(t,e)}}}}_applyPrefix(t,e,r){return this.isFormulaError(e)?e:a.unaryOp(t,e,r)}async applyPrefixAsync(t,e){let{val:r,isArray:n}=this.extractRefValue(await e);return this._applyPrefix(t,r,n)}applyPrefix(t,e){if(this.context.async)return this.applyPrefixAsync(t,e);{let{val:r,isArray:n}=this.extractRefValue(e);return this._applyPrefix(t,r,n)}}_applyPostfix(t,e,r){return this.isFormulaError(t)?t:i.percentOp(t,r,e)}async applyPostfixAsync(t,e){let{val:r,isArray:n}=this.extractRefValue(await t);return this._applyPostfix(r,n,e)}applyPostfix(t,e){if(this.context.async)return this.applyPostfixAsync(t,e);{let{val:r,isArray:n}=this.extractRefValue(t);return this._applyPostfix(r,n,e)}}_applyInfix(t,e,r){let n=t.val,o=t.isArray,a=r.val,i=r.isArray;if(this.isFormulaError(n))return n;if(this.isFormulaError(a))return a;if(u.compareOp.includes(e))return c.compareOp(n,e,a,o,i);if(u.concatOp.includes(e))return c.concatOp(n,e,a,o,i);if(u.mathOp.includes(e))return c.mathOp(n,e,a,o,i);throw Error(`Unrecognized infix: ${e}`)}async applyInfixAsync(t,e,r){let n=this.extractRefValue(await t),o=this.extractRefValue(await r);return this._applyInfix(n,e,o)}applyInfix(t,e,r){if(this.context.async)return this.applyInfixAsync(t,e,r);{let n=this.extractRefValue(t),o=this.extractRefValue(r);return this._applyInfix(n,e,o)}}applyIntersect(t){let e,r,o,a,i,c,u;if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let s=t.shift().ref;if(i=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),r=Math.max(s.from.col,s.to.col),a=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,r=a=s.col}return(t.forEach(t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){let c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(s>e||c<o||f>r||l<a||i!==t.sheet)&&(u=n.NULL),e=Math.min(e,c),o=Math.max(o,s),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>r||t.col<a||i!==t.sheet)&&(u=n.NULL),e=o=t.row,r=a=t.col}}),u)?u:((c=e===o&&r===a?{ref:{sheet:i,row:e,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:e,col:r}}}).ref.sheet||delete c.ref.sheet,c)}applyUnion(t){let e=new s;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];e.add(this.extractRefValue(t[r]).val,t[r])}return e}applyRange(t){let e=-1,r=-1,n=1048577,o=16385;return t.forEach(t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(n=1,e=1048576),void 0===t.col&&(o=1,r=16384),t.row>e&&(e=t.row),t.row<n&&(n=t.row),t.col>r&&(r=t.col),t.col<o&&(o=t.col)}),e===n&&r===o?{ref:{row:e,col:r}}:{ref:{from:{row:n,col:o},to:{row:e,col:r}}}}extractRefValue(t){let e=!1;return(Array.isArray(t)&&(e=!0),t.ref)?{val:this.context.retrieveRef(t),isArray:e}:{val:t,isArray:e}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new n(t.toUpperCase())}isFormulaError(t){return t instanceof n}static formatChevrotainError(t,e){let r,o,a="";return t instanceof l?(r=t.token.startLine,o=t.token.startColumn):(r=t.previousToken.startLine,o=t.previousToken.startColumn+1),a+="\n"+e.split("\n")[r-1]+"\n"+Array(o-1).fill(" ").join("")+"^\n"+`Error at position ${r}:${o}
`+t.message,t.errorLocation={line:r,column:o},n.ERROR(a,t)}}t.exports=f},76426:function(t,e,r){let{FormulaParser:n}=r(67583),{DepParser:o}=r(99556);Object.assign(n,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:r(32855),DepParser:o,FormulaError:r(19632),...r(47436)}),t.exports=n},32855:function(t){class e{}function r(t){let e="",r=t.length-1;for(;r>=0;)e+=t.charAt(r--);return e}function n(t,e){let r="";for(;r.length<e;)r+=t;return r}function o(t,e){let r=""+t;return r.length>=e?r:n("0",e-r.length)+r}function a(t,e){let r=""+t;return r.length>=e?r:n(" ",e-r.length)+r}function i(t,e){let r=""+t;return r.length>=e?r:r+n(" ",e-r.length)}function c(t,e){let r;if(t>4294967296||t<-4294967296){let r;return(r=""+Math.round(t)).length>=e?r:n("0",e-r.length)+r}return(r=""+Math.round(t)).length>=e?r:n("0",e-r.length)+r}function u(t,e){return e=e||0,t.length>=7+e&&(32|t.charCodeAt(e))==103&&(32|t.charCodeAt(e+1))==101&&(32|t.charCodeAt(e+2))==110&&(32|t.charCodeAt(e+3))==101&&(32|t.charCodeAt(e+4))==114&&(32|t.charCodeAt(e+5))==97&&(32|t.charCodeAt(e+6))==108}e.version="0.10.3";let s=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],l=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function f(t){t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t[65535]="General"}let h={};function p(t,e,r){let n=t<0?-1:1,o=t*n,a=0,i=1,c=0,u=1,s=0,l=0,f=Math.floor(o);for(;s<e&&(c=(f=Math.floor(o))*i+a,l=f*s+u,!(o-f<5e-8));)o=1/(o-f),a=i,i=c,u=s,s=l;if(l>e&&(s>e?(l=u,c=a):(l=s,c=i)),!r)return[0,n*c,l];let h=Math.floor(n*c/l);return[h,n*c-h*l,l]}function d(t,e,r){if(t>2958465||t<0)return null;let n=0|t,o=Math.floor(86400*(t-n)),a=0,i=[],c={D:n,T:o,u:86400*(t-n)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(1e-6>Math.abs(c.u)&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,86400==++o&&(c.T=o=0,++n,++c.D)),60===n)i=r?[1317,10,29]:[1900,2,29],a=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;let t=new Date(1900,0,1);t.setDate(t.getDate()+n-1),i=[t.getFullYear(),t.getMonth()+1,t.getDate()],a=t.getDay(),n<60&&(a=(a+6)%7),r&&(a=0)}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=o%60,o=Math.floor(o/60),c.M=o%60,o=Math.floor(o/60),c.H=o,c.q=a,c}f(h),e.parse_date_code=d;let m=new Date(1899,11,31,0,0,0),g=m.getTime(),v=new Date(1900,2,1,0,0,0);function E(t,e){let r=t.getTime();return e?r-=1262304e5:t>=v&&(r+=864e5),(r-(g+(t.getTimezoneOffset()-m.getTimezoneOffset())*6e4))/864e5}function y(t){return t.toString(10)}e._general_int=y;let N=function(){let t=/\.(\d*[1-9])0+$/,e=/\.0*$/,r=/\.(\d*[1-9])0+/,n=/\.0*[Ee]/,o=/(E[+-])(\d)$/;function a(r){return r.indexOf(".")>-1?r.replace(e,"").replace(t,".$1"):r}return function(e){let i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),c;if(i>=-4&&i<=-1)c=e.toPrecision(10+i);else if(9>=Math.abs(i))c=function(t){let e=t<0?12:11,r=a(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10)).length<=e?r:t.toExponential(5)}(e);else if(10===i)c=e.toFixed(10).substr(0,12);else{let r;(r=e.toFixed(11).replace(t,".$1")).length>(e<0?12:11)&&(r=e.toPrecision(6)),c=r}return a(function(t){for(let e=0;e!==t.length;++e)if((32|t.charCodeAt(e))==101)return t.replace(r,".$1").replace(n,"E").replace("e","E").replace(o,"$10$2");return t}(c))}}();function R(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?y(t):N(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return U(14,E(t,e&&e.date1904),e)}throw Error("unsupported value in General format: "+t)}function T(t){if(t.length<=3)return t;let e=t.length%3,r=t.substr(0,e);for(;e!==t.length;e+=3)r+=(r.length>0?",":"")+t.substr(e,3);return r}e._general_num=N,e._general=R;let A=function(){let t=/%/g,e=/# (\?+)( ?)\/( ?)(\d+)/,u=/^#*0*\.([0#]+)/,s=/\).*[0#]/,l=/\(###\) ###\\?-####/;function f(t){let e="",r;for(let n=0;n!==t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function h(t,e){let r=Math.pow(10,e);return""+Math.round(t*r)/r}function d(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?0:Math.round((t-Math.floor(t))*Math.pow(10,e))}return function(m,g,v){return(0|v)===v?function c(h,d,m){let g;if(40===h.charCodeAt(0)&&!d.match(s)){let t=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return m>=0?c("n",t,m):"("+c("n",t,-m)+")"}if(44===d.charCodeAt(d.length-1))return function(t,e,r){let n=e.length-1;for(;44===e.charCodeAt(n-1);)--n;return A(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}(h,d,m);if(-1!==d.indexOf("%"))return function(e,r,o){let a=r.replace(t,""),i=r.length-a.length;return A(e,a,o*Math.pow(10,2*i))+n("%",i)}(h,d,m);if(-1!==d.indexOf("E"))return function t(e,r){let n;let o=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0===r)return"0.0E+0";if(r<0)return"-"+t(e,-r);let a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));let i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(r/Math.pow(10,i)).toPrecision(o+1+(a+i)%a)).match(/[Ee]/)){let t=Math.floor(Math.log(r)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(t-n.length+i):n+="E+"+(t-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(t,e,r,n){return e+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"})}else n=r.toExponential(o);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}(d,m);if(36===d.charCodeAt(0))return"$"+c(h,d.substr(" "==d.charAt(1)?2:1),m);let v,E,y,N=Math.abs(m),R=m<0?"-":"";if(d.match(/^00+$/))return R+o(N,d.length);if(d.match(/^[#?]+$/))return g=""+m,0===m&&(g=""),g.length>d.length?g:f(d.substr(0,d.length-g.length))+g;if(v=d.match(e)){var M;return R+(0===N?"":""+N)+n(" ",(M=v)[1].length+2+M[4].length)}if(d.match(/^#+0+$/))return R+o(N,d.length-d.indexOf("0"));if(v=d.match(u))return g=(g=(""+m).replace(/^([^\.]+)$/,"$1."+f(v[1])).replace(/\.$/,"."+f(v[1]))).replace(/\.(\d*)$/,function(t,e){return"."+e+n("0",f(v[1]).length-e.length)}),-1!==d.indexOf("0.")?g:g.replace(/^0\./,".");if(v=(d=d.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return R+(""+N).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,v[1].length?"0.":".");if(v=d.match(/^#{1,3},##0(\.?)$/))return R+T(""+N);if(v=d.match(/^#,##0\.([#0]*0)$/))return m<0?"-"+c(h,d,-m):T(""+m)+"."+n("0",v[1].length);if(v=d.match(/^#,#*,#0/))return c(h,d.replace(/^#,#*,/,""),m);if(v=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=r(c(h,d.replace(/[\\-]/g,""),m)),E=0,r(r(d.replace(/\\/g,"")).replace(/[0#]/g,function(t){return E<g.length?g.charAt(E++):"0"===t?"0":""}));if(d.match(l))return"("+(g=c(h,"##########",m)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);let w="";if(v=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return y=p(N,Math.pow(10,E=Math.min(v[4].length,7))-1,!1),g=""+R," "==(w=A("n",v[1],y[1])).charAt(w.length-1)&&(w=w.substr(0,w.length-1)+"0"),g+=w+v[2]+"/"+v[3],(w=i(y[2],E)).length<v[4].length&&(w=f(v[4].substr(v[4].length-w.length))+w),g+=w;if(v=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return R+((y=p(N,Math.pow(10,E=Math.min(Math.max(v[1].length,v[4].length),7))-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?a(y[1],E)+v[2]+"/"+v[3]+i(y[2],E):n(" ",2*E+1+v[2].length+v[3].length));if(v=d.match(/^[#0?]+$/))return(g=""+m,d.length<=g.length)?g:f(d.substr(0,d.length-g.length))+g;if(v=d.match(/^([#0]+)\.([#0]+)$/)){E=(g=""+m.toFixed(Math.min(v[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");let t=d.indexOf(".")-E,e=d.length-g.length-t;return f(d.substr(0,t)+g+d.substr(d.length-e))}if(v=d.match(/^00,000\.([#0]*0)$/))return m<0?"-"+c(h,d,-m):T(""+m).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t})+"."+o(0,v[1].length);switch(d){case"###,###":case"##,###":case"#,###":let O=T(""+N);return"0"!==O?R+O:"";default:if(d.match(/\.[0#?]*$/))return c(h,d.slice(0,d.lastIndexOf(".")),m)+f(d.slice(d.lastIndexOf(".")))}throw Error("unsupported format |"+d+"|")}(m,g,v):function m(g,v,E){var y;let N;if(40===g.charCodeAt(0)&&!v.match(s)){let t=v.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return E>=0?m("n",t,E):"("+m("n",t,-E)+")"}if(44===v.charCodeAt(v.length-1))return function(t,e,r){let n=e.length-1;for(;44===e.charCodeAt(n-1);)--n;return A(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}(g,v,E);if(-1!==v.indexOf("%"))return function(e,r,o){let a=r.replace(t,""),i=r.length-a.length;return A(e,a,o*Math.pow(10,2*i))+n("%",i)}(g,v,E);if(-1!==v.indexOf("E"))return function t(e,r){let n;let o=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0===r)return"0.0E+0";if(r<0)return"-"+t(e,-r);let a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));let i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(r/Math.pow(10,i)).toPrecision(o+1+(a+i)%a)).indexOf("e")){let t=Math.floor(Math.log(r)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(t-n.length+i):n+="E+"+(t-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(t,e,r,n){return e+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"})}else n=r.toExponential(o);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}(v,E);if(36===v.charCodeAt(0))return"$"+m(g,v.substr(" "==v.charAt(1)?2:1),E);let R,M,w,O=Math.abs(E),I=E<0?"-":"";if(v.match(/^00+$/))return I+c(O,v.length);if(v.match(/^[#?]+$/))return"0"===(N=c(E,0))&&(N=""),N.length>v.length?N:f(v.substr(0,v.length-N.length))+N;if(R=v.match(e))return function(t,e,r){let i=parseInt(t[4],10),c=Math.round(e*i),u=Math.floor(c/i),s=c-u*i;return r+(0===u?"":""+u)+" "+(0===s?n(" ",t[1].length+1+t[4].length):a(s,t[1].length)+t[2]+"/"+t[3]+o(i,t[4].length))}(R,O,I);if(v.match(/^#+0+$/))return I+c(O,v.length-v.indexOf("0"));if(R=v.match(u))return N=h(E,R[1].length).replace(/^([^\.]+)$/,"$1."+f(R[1])).replace(/\.$/,"."+f(R[1])).replace(/\.(\d*)$/,function(t,e){return"."+e+n("0",f(R[1]).length-e.length)}),-1!==v.indexOf("0.")?N:N.replace(/^0\./,".");if(R=(v=v.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return I+h(O,R[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,R[1].length?"0.":".");if(R=v.match(/^#{1,3},##0(\.?)$/))return I+T(c(O,0));if(R=v.match(/^#,##0\.([#0]*0)$/))return E<0?"-"+m(g,v,-E):T(""+(Math.floor(E)+((y=R[1].length)<(""+Math.round((E-Math.floor(E))*Math.pow(10,y))).length?1:0)))+"."+o(d(E,R[1].length),R[1].length);if(R=v.match(/^#,#*,#0/))return m(g,v.replace(/^#,#*,/,""),E);if(R=v.match(/^([0#]+)(\\?-([0#]+))+$/))return N=r(m(g,v.replace(/[\\-]/g,""),E)),M=0,r(r(v.replace(/\\/g,"")).replace(/[0#]/g,function(t){return M<N.length?N.charAt(M++):"0"===t?"0":""}));if(v.match(l))return"("+(N=m(g,"##########",E)).substr(0,3)+") "+N.substr(3,3)+"-"+N.substr(6);let C="";if(R=v.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return w=p(O,Math.pow(10,M=Math.min(R[4].length,7))-1,!1),N=""+I," "===(C=A("n",R[1],w[1])).charAt(C.length-1)&&(C=C.substr(0,C.length-1)+"0"),N+=C+R[2]+"/"+R[3],(C=i(w[2],M)).length<R[4].length&&(C=f(R[4].substr(R[4].length-C.length))+C),N+=C;if(R=v.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return I+((w=p(O,Math.pow(10,M=Math.min(Math.max(R[1].length,R[4].length),7))-1,!0))[0]||(w[1]?"":"0"))+" "+(w[1]?a(w[1],M)+R[2]+"/"+R[3]+i(w[2],M):n(" ",2*M+1+R[2].length+R[3].length));if(R=v.match(/^[#0?]+$/))return(N=c(E,0),v.length<=N.length)?N:f(v.substr(0,v.length-N.length))+N;if(R=v.match(/^([#0?]+)\.([#0]+)$/)){M=(N=""+E.toFixed(Math.min(R[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");let t=v.indexOf(".")-M,e=v.length-N.length-t;return f(v.substr(0,t)+N+v.substr(v.length-e))}if(R=v.match(/^00,000\.([#0]*0)$/))return M=d(E,R[1].length),E<0?"-"+m(g,v,-E):T(E<2147483647&&E>-2147483648?""+(E>=0?0|E:E-1|0):""+Math.floor(E)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t})+"."+o(M,R[1].length);switch(v){case"###,##0.00":return m(g,"#,##0.00",E);case"###,###":case"##,###":case"#,###":let S=T(c(O,0));return"0"!==S?I+S:"";case"###,###.00":return m(g,"###,##0.00",E).replace(/^0\./,".");case"#,###.00":return m(g,"#,##0.00",E).replace(/^0\./,".")}throw Error("unsupported format |"+v+"|")}(m,g,v)}}();function M(t){let e=[],r=!1,n=0;for(let o=0;o<t.length;++o)switch(t.charCodeAt(o)){case 34:r=!r;break;case 95:case 42:case 92:++o;break;case 59:e[e.length]=t.substr(n,o-n),n=o+1}if(e[e.length]=t.substr(n),!0===r)throw Error("Format |"+t+"| unterminated string ");return e}e._split=M;let w=/\[[HhMmSs]*\]/;function O(t){let e=0,r="",n="";for(;e<t.length;)switch(r=t.charAt(e)){case"G":u(t,e)&&(e+=6),e++;break;case'"':for(;34!==t.charCodeAt(++e)&&e<t.length;)++e;++e;break;case"\\":case"_":e+=2;break;case"@":++e;break;case"B":case"b":if("1"===t.charAt(e+1)||"2"===t.charAt(e+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===t.substr(e,3).toUpperCase()||"AM/PM"===t.substr(e,5).toUpperCase())return!0;++e;break;case"[":for(n=r;"]"!==t.charAt(e++)&&e<t.length;)n+=t.charAt(e);if(n.match(w))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||"\\"==r&&"-"==t.charAt(e+1)&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(" "===t.charAt(e)||"*"===t.charAt(e))&&++e;break;case"(":case")":case" ":default:++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);}return!1}function I(t,e,r,n){let a=[],i="",c=0,f="",h="t",p,m,g,v="H";for(;c<t.length;)switch(f=t.charAt(c)){case"G":if(!u(t,c))throw Error("unrecognized character "+f+" in "+t);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(i="";34!==(g=t.charCodeAt(++c))&&c<t.length;)i+=String.fromCharCode(g);a[a.length]={t:"t",v:i},++c;break;case"\\":let o=t.charAt(++c),s="("===o||")"===o?o:"t";a[a.length]={t:s,v:o},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:e},++c;break;case"B":case"b":if("1"===t.charAt(c+1)||"2"===t.charAt(c+1)){if(null==p&&null==(p=d(e,r,"2"===t.charAt(c+1))))return"";a[a.length]={t:"X",v:t.substr(c,2)},h=f,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||null==p&&null==(p=d(e,r)))return"";for(i=f;++c<t.length&&t.charAt(c).toLowerCase()===f;)i+=f;"m"===f&&"h"===h.toLowerCase()&&(f="M"),"h"===f&&(f=v),a[a.length]={t:f,v:i},h=f;break;case"A":case"a":let l={t:f,v:f};if(null==p&&(p=d(e,r)),"A/P"===t.substr(c,3).toUpperCase()?(null!=p&&(l.v=p.H>=12?"P":"A"),l.t="T",v="h",c+=3):"AM/PM"===t.substr(c,5).toUpperCase()?(null!=p&&(l.v=p.H>=12?"PM":"AM"),l.t="T",c+=5,v="h"):(l.t="t",++c),null==p&&"T"===l.t)return"";a[a.length]=l,h=f;break;case"[":for(i=f;"]"!==t.charAt(c++)&&c<t.length;)i+=t.charAt(c);if("]"!==i.slice(-1))throw'unterminated "[" block: |'+i+"|";if(i.match(w)){if(null==p&&null==(p=d(e,r)))return"";a[a.length]={t:"Z",v:i.toLowerCase()},h=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",O(t)||(a[a.length]={t:"t",v:i}));break;case".":if(null!=p){for(i=f;++c<t.length&&"0"===(f=t.charAt(c));)i+=f;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=f;++c<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(c))>-1||"\\"==f&&"-"==t.charAt(c+1)&&c<t.length-2&&"0#".indexOf(t.charAt(c+2))>-1;)i+=f;a[a.length]={t:"n",v:i};break;case"?":for(i=f;t.charAt(++c)===f;)i+=f;a[a.length]={t:f,v:i},h=f;break;case"*":++c,(" "===t.charAt(c)||"*"===t.charAt(c))&&++c;break;case"(":case")":a[a.length]={t:1===n||"number"==typeof e&&e<0?"t":f,v:f},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=f;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)i+=t.charAt(c);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:f,v:f},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(f))throw Error("unrecognized character "+f+" in "+t);a[a.length]={t:"t",v:f},++c}let E=0,y=0,N;for(c=a.length-1,h="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=v,h="h",E<1&&(E=1);break;case"s":(N=a[c].v.match(/\.0+$/))&&(y=Math.max(y,N[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=a[c].t;break;case"m":"s"===h&&(a[c].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[c].v.match(/[Hh]/)&&(E=1),E<2&&a[c].v.match(/[Mm]/)&&(E=2),E<3&&a[c].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M)}let T="",M;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=function(t,e,r,n){let a="",i=0,c=0,u=r.y,f,h=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,h=2;break;default:f=u%1e4,h=4}break;case 109:switch(e.length){case 1:case 2:f=r.m,h=e.length;break;case 3:return l[r.m-1][1];case 5:return l[r.m-1][0];default:return l[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,h=e.length;break;case 3:return s[r.q][0];default:return s[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if("s"!==e&&"ss"!==e&&".0"!==e&&".00"!==e&&".000"!==e)throw"bad second format: "+e;if(0===r.u&&("s"===e||"ss"===e))return o(r.S,e.length);if((i=Math.round((c=n>=2?3===n?1e3:100:1===n?10:1)*(r.S+r.u)))>=60*c&&(i=0),"s"===e)return 0===i?"0":""+i/c;if(a=o(i,2+n),"ss"===e)return a.substr(0,2);return"."+a.substr(2,e.length-1);case 90:switch(e){case"[h]":case"[hh]":f=24*r.D+r.H;break;case"[m]":case"[mm]":f=(24*r.D+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((24*r.D+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=3===e.length?1:2;break;case 101:f=u,h=1}return h>0?o(f,h):""}(a[c].t.charCodeAt(0),a[c].v,p,y),a[c].t="t";break;case"n":case"(":case"?":for(M=c+1;null!=a[M]&&("?"===(f=a[M].t)||"D"===f||(" "===f||"t"===f)&&null!=a[M+1]&&("?"===a[M+1].t||"t"===a[M+1].t&&"/"===a[M+1].v)||"("===a[c].t&&(" "===f||"n"===f||")"===f)||"t"===f&&("/"===a[M].v||" "===a[M].v&&null!=a[M+1]&&"?"===a[M+1].t));)a[c].v+=a[M].v,a[M]={v:"",t:";"},++M;T+=a[c].v,c=M-1;break;case"G":a[c].t="t",a[c].v=R(e,r)}let I="",C,S;if(T.length>0){40===T.charCodeAt(0)?(C=e<0&&45===T.charCodeAt(0)?-e:e,S=A("(",T,C)):(S=A("n",T,C=e<0&&n>1?-e:e),C<0&&a[0]&&"t"===a[0].t&&(S=S.substr(1),a[0].v="-"+a[0].v)),M=S.length-1;let t=a.length;for(c=0;c<a.length;++c)if(null!=a[c]&&"t"!==a[c].t&&a[c].v.indexOf(".")>-1){t=c;break}let r=a.length;if(t===a.length&&-1===S.indexOf("E")){for(c=a.length-1;c>=0;--c)null!=a[c]&&-1!=="n?(".indexOf(a[c].t)&&(M>=a[c].v.length-1?(M-=a[c].v.length,a[c].v=S.substr(M+1,a[c].v.length)):M<0?a[c].v="":(a[c].v=S.substr(0,M+1),M=-1),a[c].t="t",r=c);M>=0&&r<a.length&&(a[r].v=S.substr(0,M+1)+a[r].v)}else if(t!==a.length&&-1===S.indexOf("E")){for(M=S.indexOf(".")-1,c=t;c>=0;--c)if(null!=a[c]&&-1!=="n?(".indexOf(a[c].t)){for(m=a[c].v.indexOf(".")>-1&&c===t?a[c].v.indexOf(".")-1:a[c].v.length-1,I=a[c].v.substr(m+1);m>=0;--m)M>=0&&("0"===a[c].v.charAt(m)||"#"===a[c].v.charAt(m))&&(I=S.charAt(M--)+I);a[c].v=I,a[c].t="t",r=c}for(M>=0&&r<a.length&&(a[r].v=S.substr(0,M+1)+a[r].v),M=S.indexOf(".")+1,c=t;c<a.length;++c)if(null!=a[c]&&(-1!=="n?(".indexOf(a[c].t)||c===t)){for(m=a[c].v.indexOf(".")>-1&&c===t?a[c].v.indexOf(".")+1:0,I=a[c].v.substr(0,m);m<a[c].v.length;++m)M<S.length&&(I+=S.charAt(M++));a[c].v=I,a[c].t="t",r=c}}}for(c=0;c<a.length;++c)null!=a[c]&&"n(?".indexOf(a[c].t)>-1&&(C=n>1&&e<0&&c>0&&"-"===a[c-1].v?-e:e,a[c].v=A(a[c].t,a[c].v,C),a[c].t="t");let b="";for(c=0;c!==a.length;++c)null!=a[c]&&(b+=a[c].v);return b}e.is_date=O,e._eval=I;let C=/\[[=<>]/,S=/\[([=<>]*)(-?\d+\.?\d*)\]/;function b(t,e){if(null==e)return!1;let r=parseFloat(e[2]);switch(e[1]){case"=":if(t===r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!==r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0}return!1}function U(t,e,r){null==r&&(r={});let n="";switch(typeof t){case"string":n="m/d/yy"===t&&r.dateNF?r.dateNF:t;break;case"number":n=14===t&&r.dateNF?r.dateNF:(null!=r.table?r.table:h)[t]}if(u(n,0))return R(e,r);e instanceof Date&&(e=E(e,r.date1904));let o=function(t,e){let r=M(t),n=r.length,o=r[n-1].indexOf("@");if(n<4&&o>-1&&--n,r.length>4)throw Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof e)return[4,4===r.length||o>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=o>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}let a=e>0?r[0]:e<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,a];if(null!=r[0].match(C)||null!=r[1].match(C)){let t=r[0].match(S),o=r[1].match(S);return b(e,t)?[n,r[0]]:b(e,o)?[n,r[1]]:[n,r[null!=t&&null!=o?2:1]]}return[n,a]}(n,e);if(u(o[1]))return R(e,r);if(!0===e)e="TRUE";else if(!1===e)e="FALSE";else if(""===e||null==e)return"";return I(o[1],e,r,o[0])}function x(t,e){if("number"!=typeof e){e=+e||-1;for(let r=0;r<392;++r){if(void 0===h[r]){e<0&&(e=r);continue}if(h[r]===t){e=r;break}}e<0&&(e=391)}return h[e]=t,e}e.load=x,e._table=h,e.get_table=function(){return h},e.load_table=function(t){for(let e=0;392!==e;++e)void 0!==t[e]&&x(t[e],e)},e.init_table=f,e.format=U,t.exports=e},15374:function(t){var e;e=function(){var t,e=function(t,e){var r=Array.prototype.concat,n=Array.prototype.slice,o=Object.prototype.toString;function a(e,r){var n=e>r?e:r;return t.pow(10,17-~~(t.log(n>0?n:-n)*t.LOG10E))}var i=Array.isArray||function(t){return"[object Array]"===o.call(t)};function c(t){return"[object Function]"===o.call(t)}function u(t){return"number"==typeof t&&t-t==0}function s(){return new s._init(arguments)}function l(){return 0}function f(){return 1}function h(t,e){return t===e?1:0}s.fn=s.prototype,s._init=function(t){if(i(t[0])){if(i(t[0][0])){c(t[1])&&(t[0]=s.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=c(t[1])?s.map(t[0],t[1]):t[0],this.length=1}else if(u(t[0]))this[0]=s.seq.apply(null,t),this.length=1;else{if(t[0]instanceof s)return s(t[0].toArray());this[0]=[],this.length=1}return this},s._init.prototype=s.prototype,s._init.constructor=s,s.utils={calcRdx:a,isArray:i,isFunction:c,isNumber:u,toVector:function(t){return r.apply([],t)}},s._random_fn=t.random,s.setRandom=function(t){if("function"!=typeof t)throw TypeError("fn is not a function");s._random_fn=t},s.extend=function(t){var e,r;if(1==arguments.length){for(r in t)s[r]=t[r];return this}for(e=1;e<arguments.length;e++)for(r in arguments[e])t[r]=arguments[e][r];return t},s.rows=function(t){return t.length||1},s.cols=function(t){return t[0].length||1},s.dimensions=function(t){return{rows:s.rows(t),cols:s.cols(t)}},s.row=function(t,e){return i(e)?e.map(function(e){return s.row(t,e)}):t[e]},s.rowa=function(t,e){return s.row(t,e)},s.col=function(t,e){if(i(e)){var r=s.arange(t.length).map(function(){return Array(e.length)});return e.forEach(function(e,n){s.arange(t.length).forEach(function(o){r[o][n]=t[o][e]})}),r}for(var n=Array(t.length),o=0;o<t.length;o++)n[o]=[t[o][e]];return n},s.cola=function(t,e){return s.col(t,e).map(function(t){return t[0]})},s.diag=function(t){for(var e=s.rows(t),r=Array(e),n=0;n<e;n++)r[n]=[t[n][n]];return r},s.antidiag=function(t){for(var e=s.rows(t)-1,r=Array(e),n=0;e>=0;e--,n++)r[n]=[t[n][e]];return r},s.transpose=function(t){var e,r,n,o,a,c=[];for(i(t[0])||(t=[t]),r=t.length,n=t[0].length,a=0;a<n;a++){for(o=0,e=Array(r);o<r;o++)e[o]=t[o][a];c.push(e)}return 1===c.length?c[0]:c},s.map=function(t,e,r){var n,o,a,c,u;for(i(t[0])||(t=[t]),o=t.length,a=t[0].length,c=r?t:Array(o),n=0;n<o;n++)for(c[n]||(c[n]=Array(a)),u=0;u<a;u++)c[n][u]=e(t[n][u],n,u);return 1===c.length?c[0]:c},s.cumreduce=function(t,e,r){var n,o,a,c,u;for(i(t[0])||(t=[t]),o=t.length,a=t[0].length,c=r?t:Array(o),n=0;n<o;n++)for(c[n]||(c[n]=Array(a)),a>0&&(c[n][0]=t[n][0]),u=1;u<a;u++)c[n][u]=e(c[n][u-1],t[n][u]);return 1===c.length?c[0]:c},s.alter=function(t,e){return s.map(t,e,!0)},s.create=function(t,e,r){var n,o,a=Array(t);for(c(e)&&(r=e,e=t),n=0;n<t;n++)for(o=0,a[n]=Array(e);o<e;o++)a[n][o]=r(n,o);return a},s.zeros=function(t,e){return u(e)||(e=t),s.create(t,e,l)},s.ones=function(t,e){return u(e)||(e=t),s.create(t,e,f)},s.rand=function(t,e){return u(e)||(e=t),s.create(t,e,s._random_fn)},s.identity=function(t,e){return u(e)||(e=t),s.create(t,e,h)},s.symmetric=function(t){var e,r,n=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<n;e++)for(r=0;r<n;r++)if(t[r][e]!==t[e][r])return!1;return!0},s.clear=function(t){return s.alter(t,l)},s.seq=function(t,e,r,n){c(n)||(n=!1);var o,i=[],u=a(t,e),s=(e*u-t*u)/((r-1)*u),l=t;for(o=0;l<=e&&o<r;l=(t*u+s*u*++o)/u)i.push(n?n(l,o):l);return i},s.arange=function(t,r,n){var o,a=[];if(n=n||1,e===r&&(r=t,t=0),t===r||0===n||t<r&&n<0||t>r&&n>0)return[];if(n>0)for(o=t;o<r;o+=n)a.push(o);else for(o=t;o>r;o+=n)a.push(o);return a},s.slice=function(){function t(t,r,n,o){var a,i=[],c=t.length;if(e===r&&e===n&&e===o)return s.copy(t);if(r=r||0,n=n||t.length,o=o||1,(r=r>=0?r:c+r)===(n=n>=0?n:c+n)||0===o||r<n&&o<0||r>n&&o>0)return[];if(o>0)for(a=r;a<n;a+=o)i.push(t[a]);else for(a=r;a>n;a+=o)i.push(t[a]);return i}return function(e,r){if(u((r=r||{}).row)){var n,o;return u(r.col)?e[r.row][r.col]:t(s.rowa(e,r.row),(n=r.col||{}).start,n.end,n.step)}return u(r.col)?t(s.cola(e,r.col),(o=r.row||{}).start,o.end,o.step):(o=r.row||{},n=r.col||{},t(e,o.start,o.end,o.step).map(function(e){return t(e,n.start,n.end,n.step)}))}}(),s.sliceAssign=function(r,n,o){var a,i;if(u(n.row)){if(u(n.col))return r[n.row][n.col]=o;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,a=s.arange(n.col.start,t.min(r.length,n.col.end),n.col.step);var c=n.row;return a.forEach(function(t,e){r[c][t]=o[e]}),r}if(u(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,i=s.arange(n.row.start,t.min(r[0].length,n.row.end),n.row.step);var l=n.col;return i.forEach(function(t,e){r[t][l]=o[e]}),r}return e===o[0].length&&(o=[o]),n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,i=s.arange(n.row.start,t.min(r.length,n.row.end),n.row.step),a=s.arange(n.col.start,t.min(r[0].length,n.col.end),n.col.step),i.forEach(function(t,e){a.forEach(function(n,a){r[t][n]=o[e][a]})}),r},s.diagonal=function(t){var e=s.zeros(t.length,t.length);return t.forEach(function(t,r){e[r][r]=t}),e},s.copy=function(t){return t.map(function(t){return u(t)?t:t.map(function(t){return t})})};var p=s.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},p.map=function(t,e){return s(s.map(this,t,e))},p.cumreduce=function(t,e){return s(s.cumreduce(this,t,e))},p.alter=function(t){return s.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e){var r,n=this;return e?(setTimeout(function(){e.call(n,p[t].call(n))}),this):i(r=s[t](this))?s(r):r}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e,r){var n=this;return r?(setTimeout(function(){r.call(n,p[t].call(n,e))}),this):s(s[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(){return s(s[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),s}(Math);return function(t,e){var r=t.utils.isFunction;function n(t,e){return t-e}function o(t,r,n){return e.max(r,e.min(t,n))}t.sum=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.sumsqrd=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r]*t[r];return e},t.sumsqerr=function(e){for(var r,n=t.mean(e),o=0,a=e.length;--a>=0;)o+=(r=e[a]-n)*r;return o},t.sumrow=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.product=function(t){for(var e=1,r=t.length;--r>=0;)e*=t[r];return e},t.min=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]<e&&(e=t[r]);return e},t.max=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]>e&&(e=t[r]);return e},t.unique=function(t){for(var e={},r=[],n=0;n<t.length;n++)e[t[n]]||(e[t[n]]=!0,r.push(t[n]));return r},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(r){var n=r.map(e.log),o=t.mean(n);return e.exp(o)},t.median=function(t){var e=t.length,r=t.slice().sort(n);return 1&e?r[e/2|0]:(r[e/2-1]+r[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,function(t,e){return t+e})},t.cumprod=function(e){return t.cumreduce(e,function(t,e){return t*e})},t.diff=function(t){var e,r=[],n=t.length;for(e=1;e<n;e++)r.push(t[e]-t[e-1]);return r},t.rank=function(t){var e,r=[],o={};for(e=0;e<t.length;e++){var a=t[e];o[a]?o[a]++:(o[a]=1,r.push(a))}var i=r.sort(n),c={},u=1;for(e=0;e<i.length;e++){var a=i[e],s=o[a],l=(u+(u+s-1))/2;c[a]=l,u+=s}return t.map(function(t){return c[t]})},t.mode=function(t){var e,r=t.length,o=t.slice().sort(n),a=1,i=0,c=0,u=[];for(e=0;e<r;e++)o[e]===o[e+1]?a++:(a>i?(u=[o[e]],i=a,c=0):a===i&&(u.push(o[e]),c++),a=1);return 0===c?u[0]:u},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,r){return t.sumsqerr(e)/(e.length-(r?1:0))},t.pooledvariance=function(e){return e.reduce(function(e,r){return e+t.sumsqerr(r)},0)/(e.reduce(function(t,e){return t+e.length},0)-e.length)},t.deviation=function(e){for(var r=t.mean(e),n=e.length,o=Array(n),a=0;a<n;a++)o[a]=e[a]-r;return o},t.stdev=function(r,n){return e.sqrt(t.variance(r,n))},t.pooledstdev=function(r){return e.sqrt(t.pooledvariance(r))},t.meandev=function(r){for(var n=t.mean(r),o=[],a=r.length-1;a>=0;a--)o.push(e.abs(r[a]-n));return t.mean(o)},t.meddev=function(r){for(var n=t.median(r),o=[],a=r.length-1;a>=0;a--)o.push(e.abs(r[a]-n));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var r=t.length,o=t.slice().sort(n);return[o[e.round(r/4)-1],o[e.round(r/2)-1],o[e.round(3*r/4)-1]]},t.quantiles=function(t,r,a,i){var c,u,s,l,f,h,p=t.slice().sort(n),d=[r.length],m=t.length;for(void 0===a&&(a=3/8),void 0===i&&(i=3/8),c=0;c<r.length;c++)s=a+(u=r[c])*(1-a-i),l=m*u+s,f=e.floor(o(l,1,m-1)),h=o(l-f,0,1),d[c]=(1-h)*p[f-1]+h*p[f];return d},t.percentile=function(t,e,r){var o=t.slice().sort(n),a=e*(o.length+(r?1:-1))+(r?0:1),i=parseInt(a);return i+1<o.length?o[i-1]+(a-i)*(o[i]-o[i-1]):o[i-1]},t.percentileOfScore=function(t,e,r){var n,o,a=0,i=t.length,c=!1;for("strict"===r&&(c=!0),o=0;o<i;o++)n=t[o],(c&&n<e||!c&&n<=e)&&a++;return a/i},t.histogram=function(r,n){n=n||4;var o,a=t.min(r),i=(t.max(r)-a)/n,c=r.length,u=[];for(o=0;o<n;o++)u[o]=0;for(o=0;o<c;o++)u[e.min(e.floor((r[o]-a)/i),n-1)]+=1;return u},t.covariance=function(e,r){var n,o=t.mean(e),a=t.mean(r),i=e.length,c=Array(i);for(n=0;n<i;n++)c[n]=(e[n]-o)*(r[n]-a);return t.sum(c)/(i-1)},t.corrcoeff=function(e,r){return t.covariance(e,r)/t.stdev(e,1)/t.stdev(r,1)},t.spearmancoeff=function(e,r){return e=t.rank(e),r=t.rank(r),t.corrcoeff(e,r)},t.stanMoment=function(r,n){for(var o=t.mean(r),a=t.stdev(r),i=r.length,c=0,u=0;u<i;u++)c+=e.pow((r[u]-o)/a,n);return c/r.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var a=t.prototype;(function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(n,o){var i=[],c=0,u=this;if(r(n)&&(o=n,n=!1),o)return setTimeout(function(){o.call(u,a[e].call(u,n))}),this;if(this.length>1){for(u=!0===n?this:this.transpose();c<u.length;c++)i[c]=t[e](u[c]);return i}return t[e](this[0],n)}}(e[n])})("cumsum cumprod".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(n,o){var i=[],c=0,u=this;if(r(n)&&(o=n,n=!1),o)return setTimeout(function(){o.call(u,a[e].call(u,n))}),this;if(this.length>1){for("sumrow"!==e&&(u=!0===n?this:this.transpose());c<u.length;c++)i[c]=t[e](u[c]);return!0===n?t[e](t.utils.toVector(i)):i}return t[e](this[0],n)}}(e[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(){var n,o=[],i=0,c=this,u=Array.prototype.slice.call(arguments);if(r(u[u.length-1])){n=u[u.length-1];var s=u.slice(0,u.length-1);return setTimeout(function(){n.call(c,a[e].apply(c,s))}),this}n=void 0;var l=function(r){return t[e].apply(c,[r].concat(u))};if(this.length>1){for(c=c.transpose();i<c.length;i++)o[i]=l(c[i]);return o}return l(this[0])}}(e[n])}("quantiles percentileOfScore".split(" "))}(e,Math),t=Math,e.gammaln=function(e){var r,n,o=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-.000005395239384953],i=1.000000000190015;for(n=(r=e)+5.5,n-=(e+.5)*t.log(n);o<6;o++)i+=a[o]/++r;return t.log(2.5066282746310007*i/e)-n},e.loggam=function(e){var r,n,o,a,i,c,u,s=[.08333333333333333,-.002777777777777778,7936507936507937e-19,-.0005952380952380952,8417508417508418e-19,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(r=e,u=0,1==e||2==e)return 0;for(e<=7&&(u=t.floor(7-e),r=e+u),n=1/(r*r),o=2*t.PI,i=-1.3924322169059,c=8;c>=0;c--)i*=n,i+=s[c];if(a=i/r+.5*t.log(o)+(r-.5)*t.log(r)-r,e<=7)for(c=1;c<=u;c++)a-=t.log(r-1),r-=1;return a},e.gammafn=function(e){var r,n,o,a,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],u=!1,s=0,l=0,f=0,h=e;if(e>171.6243769536076)return 1/0;if(h<=0){if(!(a=h%1+36e-17))return 1/0;u=(1&h?-1:1)*t.PI/t.sin(t.PI*a),h=1-h}for(r=0,o=h,n=h<1?h++:(h-=s=(0|h)-1)-1;r<8;++r)f=(f+i[r])*n,l=l*n+c[r];if(a=f/l+1,o<h)a/=o;else if(o>h)for(r=0;r<s;++r)a*=h,h++;return u&&(a=u/a),a},e.gammap=function(t,r){return e.lowRegGamma(t,r)*e.gammafn(t)},e.lowRegGamma=function(r,n){var o,a=e.gammaln(r),i=r,c=1/r,u=c,s=n+1-r,l=1/1e-30,f=1/s,h=f,p=1,d=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);if(n<0||r<=0)return NaN;if(n<r+1){for(;p<=d;p++)c+=u*=n/++i;return c*t.exp(-n+r*t.log(n)-a)}for(;p<=d;p++)s+=2,h*=(f=1/(f=(o=-p*(p-r))*f+s))*(l=s+o/l);return 1-h*t.exp(-n+r*t.log(n)-a)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(r,n){return r>170||n>170?t.exp(e.combinationln(r,n)):e.factorial(r)/e.factorial(n)/e.factorial(r-n)},e.combinationln=function(t,r){return e.factorialln(t)-e.factorialln(r)-e.factorialln(t-r)},e.permutation=function(t,r){return e.factorial(t)/e.factorial(t-r)},e.betafn=function(r,n){if(!(r<=0)&&!(n<=0))return r+n>170?t.exp(e.betaln(r,n)):e.gammafn(r)*e.gammafn(n)/e.gammafn(r+n)},e.betaln=function(t,r){return e.gammaln(t)+e.gammaln(r)-e.gammaln(t+r)},e.betacf=function(e,r,n){var o,a,i,c,u=1,s=r+n,l=r+1,f=r-1,h=1,p=1-s*e/l;for(1e-30>t.abs(p)&&(p=1e-30),c=p=1/p;u<=100&&(o=2*u,p=1+(a=u*(n-u)*e/((f+o)*(r+o)))*p,1e-30>t.abs(p)&&(p=1e-30),h=1+a/h,1e-30>t.abs(h)&&(h=1e-30),c*=(p=1/p)*h,p=1+(a=-(r+u)*(s+u)*e/((r+o)*(l+o)))*p,1e-30>t.abs(p)&&(p=1e-30),h=1+a/h,1e-30>t.abs(h)&&(h=1e-30),c*=i=(p=1/p)*h,!(3e-7>t.abs(i-1)));u++);return c},e.gammapinv=function(r,n){var o,a,i,c,u,s,l=0,f=n-1,h=e.gammaln(n);if(r>=1)return t.max(100,n+100*t.sqrt(n));if(r<=0)return 0;for(n>1?(u=t.log(f),s=t.exp(f*(u-1)-h),c=r<.5?r:1-r,o=(2.30753+.27061*(a=t.sqrt(-2*t.log(c))))/(1+a*(.99229+.04481*a))-a,r<.5&&(o=-o),o=t.max(.001,n*t.pow(1-1/(9*n)-o/(3*t.sqrt(n)),3))):o=r<(a=1-n*(.253+.12*n))?t.pow(r/a,1/n):1-t.log(1-(r-a)/(1-a));l<12;l++){if(o<=0)return 0;if(i=(e.lowRegGamma(n,o)-r)/(a=n>1?s*t.exp(-(o-f)+f*(t.log(o)-u)):t.exp(-o+f*t.log(o)-h)),(o-=a=i/(1-.5*t.min(1,i*((n-1)/o-1))))<=0&&(o=.5*(o+a)),t.abs(a)<1e-8*o)break}return o},e.erf=function(e){var r,n,o,a,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,366839497852761e-18,42523324806907e-18,-.000020278578112534,-.000001624290004647,130365583558e-17,15626441722e-18,-.000000085238095915,6529054439e-18,5059343495e-18,-.000000000991364156,-.000000000227365122,96467911e-18,2394038e-18,-.000000000006886027,894487e-18,313092e-18,-.000000000000112708,381e-18,7106e-18,-.000000000000001523,-.000000000000000094,121e-18,-.000000000000000028],c=i.length-1,u=!1,s=0,l=0;for(e<0&&(e=-e,u=!0),n=4*(r=2/(2+e))-2;c>0;c--)o=s,s=n*s-l+i[c],l=o;return a=r*t.exp(-e*e+.5*(i[0]+n*s)-l),u?a-1:1-a},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(r){var n,o,a,i,c=0;if(r>=2)return -100;if(r<=0)return 100;for(i=r<1?r:2-r,n=-.70711*((2.30753+.27061*(a=t.sqrt(-2*t.log(i/2))))/(1+a*(.99229+.04481*a))-a);c<2;c++)o=e.erfc(n)-i,n+=o/(1.1283791670955126*t.exp(-n*n)-n*o);return r<1?n:-n},e.ibetainv=function(r,n,o){var a,i,c,u,s,l,f,h,p,d,m=n-1,g=o-1,v=0;if(r<=0)return 0;if(r>=1)return 1;for(n>=1&&o>=1?(c=r<.5?r:1-r,l=(2.30753+.27061*(u=t.sqrt(-2*t.log(c))))/(1+u*(.99229+.04481*u))-u,r<.5&&(l=-l),f=(l*l-3)/6,h=2/(1/(2*n-1)+1/(2*o-1)),p=l*t.sqrt(f+h)/h-(1/(2*o-1)-1/(2*n-1))*(f+5/6-2/(3*h)),l=n/(n+o*t.exp(2*p))):(a=t.log(n/(n+o)),i=t.log(o/(n+o)),p=(u=t.exp(n*a)/n)+(s=t.exp(o*i)/o),l=r<u/p?t.pow(n*p*r,1/n):1-t.pow(o*p*(1-r),1/o)),d=-e.gammaln(n)-e.gammaln(o)+e.gammaln(n+o);v<10&&0!==l&&1!==l&&(s=(e.ibeta(l,n,o)-r)/(u=t.exp(m*t.log(l)+g*t.log(1-l)+d)),(l-=u=s/(1-.5*t.min(1,s*(m/l-g/(1-l)))))<=0&&(l=.5*(l+u)),l>=1&&(l=.5*(l+u+1)),!(t.abs(u)<1e-8*l)||!(v>0));v++);return l},e.ibeta=function(r,n,o){var a=0===r||1===r?0:t.exp(e.gammaln(n+o)-e.gammaln(n)-e.gammaln(o)+n*t.log(r)+o*t.log(1-r));return!(r<0)&&!(r>1)&&(r<(n+1)/(n+o+2)?a*e.betacf(r,n,o)/n:1-a*e.betacf(1-r,o,n)/o)},e.randn=function(r,n){var o,a,i,c,u;if(n||(n=r),r)return e.create(r,n,function(){return e.randn()});do o=e._random_fn(),a=1.7156*(e._random_fn()-.5),u=(i=o-.449871)*i+(c=t.abs(a)+.386595)*(.196*c-.25472*i);while(u>.27597&&(u>.27846||a*a>-4*t.log(o)*o*o));return a/o},e.randg=function(r,n,o){var a,i,c,u,s,l,f=r;if(o||(o=n),r||(r=1),n)return(l=e.zeros(n,o)).alter(function(){return e.randg(r)}),l;r<1&&(r+=1),a=r-1/3,i=1/t.sqrt(9*a);do{do u=1+i*(s=e.randn());while(u<=0);u=u*u*u,c=e._random_fn()}while(c>1-.331*t.pow(s,4)&&t.log(c)>.5*s*s+a*(1-u+t.log(u)));if(r==f)return a*u;do c=e._random_fn();while(0===c);return t.pow(c,1/f)*a*u},function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e.map(this,function(r){return e[t](r)}))}}(t[r])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[r])}("randn".split(" ")),function(t,e){function r(t,r,n,o){for(var a,i=0,c=1,u=1,s=1,l=0,f=0;e.abs((u-f)/u)>o;)f=u,i=u+(a=-(r+l)*(r+n+l)*t/(r+2*l)/(r+2*l+1))*i,c=s+a*c,l+=1,u=i+(a=l*(n-l)*t/(r+2*l-1)/(r+2*l))*u,i/=s=c+a*s,c/=s,u/=s,s=1;return u/r}function n(r,n,o){var a=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],i=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],c=.5*r;if(c>=8)return 1;var u=2*t.normal.cdf(c,0,1,1,0)-1;u=u>=e.exp(-50/o)?e.pow(u,o):0;for(var s=c,l=(8-c)/(y=r>3?2:3),f=s+l,h=0,p=o-1,d=1;d<=y;d++){for(var m=0,g=.5*(f+s),v=.5*(f-s),E=1;E<=12;E++){var y,N,R=g+v*(6<E?a[(N=12-E+1)-1]:-a[(N=E)-1]),T=R*R;if(T>60)break;var A=2*t.normal.cdf(R,0,1,1,0)*.5-2*t.normal.cdf(R,r,1,1,0)*.5;A>=e.exp(-30/p)&&(m+=A=i[N-1]*e.exp(-(.5*T))*e.pow(A,p))}m*=2*v*o/e.sqrt(2*e.PI),h+=m,s=f,f+=l}return(u+=h)<=e.exp(-30/n)?0:(u=e.pow(u,n))>=1?1:u}(function(e){for(var r=0;r<e.length;r++)!function(e){t[e]=function t(e,r,n){return this instanceof t?(this._a=e,this._b=r,this._c=n,this):new t(e,r,n)},t.fn[e]=function(r,n,o){var a=t[e](r,n,o);return a.data=this,a},t[e].prototype.sample=function(r){var n=this._a,o=this._b,a=this._c;return r?t.alter(r,function(){return t[e].sample(n,o,a)}):t[e].sample(n,o,a)},function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(n){var o=this._a,a=this._b,i=this._c;return(n||0===n||(n=this.data),"number"!=typeof n)?t.fn.map.call(n,function(n){return t[e][r](n,o,a,i)}):t[e][r](n,o,a,i)}}(r[n])}("pdf cdf inv".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(){return t[e][r](this._a,this._b,this._c)}}(r[n])}("mean median mode variance".split(" "))}(e[r])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(r,n,o){return r>1||r<0?0:1==n&&1==o?1:n<512&&o<512?e.pow(r,n-1)*e.pow(1-r,o-1)/t.betafn(n,o):e.exp((n-1)*e.log(r)+(o-1)*e.log(1-r)-t.betaln(n,o))},cdf:function(e,r,n){return e>1||e<0?(e>1)*1:t.ibeta(e,r,n)},inv:function(e,r,n){return t.ibetainv(e,r,n)},mean:function(t,e){return t/(t+e)},median:function(e,r){return t.ibetainv(.5,e,r)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,r){var n=t.randg(e);return n/(n+t.randg(r))},variance:function(t,r){return t*r/(e.pow(t+r,2)*(t+r+1))}}),t.extend(t.centralF,{pdf:function(r,n,o){var a,i;return r<0?0:n<=2?0===r&&n<2?1/0:0===r&&2===n?1:1/t.betafn(n/2,o/2)*e.pow(n/o,n/2)*e.pow(r,n/2-1)*e.pow(1+n/o*r,-(n+o)/2):(a=n*r/(o+r*n),i=o/(o+r*n),n*i/2*t.binomial.pdf((n-2)/2,(n+o-2)/2,a))},cdf:function(e,r,n){return e<0?0:t.ibeta(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/t.ibetainv(e,r/2,n/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,r){return 2*t.randg(e/2)/e/(2*t.randg(r/2)/r)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,r,n){return n<0?0:n/(e.pow(t-r,2)+e.pow(n,2))/e.PI},cdf:function(t,r,n){return e.atan((t-r)/n)/e.PI+.5},inv:function(t,r,n){return r+n*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(r,n){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*n+r}}),t.extend(t.chisquare,{pdf:function(r,n){return r<0?0:0===r&&2===n?.5:e.exp((n/2-1)*e.log(r)-r/2-n/2*e.log(2)-t.gammaln(n/2))},cdf:function(e,r){return e<0?0:t.lowRegGamma(r/2,e/2)},inv:function(e,r){return 2*t.gammapinv(e,.5*r)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,r){return t<0?0:r*e.exp(-r*t)},cdf:function(t,r){return t<0?0:1-e.exp(-r*t)},inv:function(t,r){return-e.log(1-t)/r},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(r){return -1/r*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(r,n,o){return r<0?0:0===r&&1===n?1/o:e.exp((n-1)*e.log(r)-r/o-t.gammaln(n)-n*e.log(o))},cdf:function(e,r,n){return e<0?0:t.lowRegGamma(r,e/n)},inv:function(e,r,n){return t.gammapinv(e,r)*n},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,r){return t.randg(e)*r},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(r,n,o){return r<=0?0:e.exp(-(n+1)*e.log(r)-o/r-t.gammaln(n)+n*e.log(o))},cdf:function(e,r,n){return e<=0?0:1-t.lowRegGamma(r,n/e)},inv:function(e,r,n){return n/t.gammapinv(1-e,r)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,r){return r/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,r,n){return 0===t&&1===r?n:1===t&&1===n?r:e.exp(e.log(r)+e.log(n)+(r-1)*e.log(t)+(n-1)*e.log(1-e.pow(t,r)))},cdf:function(t,r,n){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,r),n)},inv:function(t,r,n){return e.pow(1-e.pow(1-t,1/n),1/r)},mean:function(e,r){return r*t.gammafn(1+1/e)*t.gammafn(r)/t.gammafn(1+1/e+r)},median:function(t,r){return e.pow(1-e.pow(2,-1/r),1/t)},mode:function(t,r){if(t>=1&&r>=1&&1!==t&&1!==r)return e.pow((t-1)/(t*r-1),1/t)},variance:function(){throw Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,r,n){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(n)-e.pow(e.log(t)-r,2)/(2*n*n))},cdf:function(r,n,o){return r<0?0:.5+.5*t.erf((e.log(r)-n)/e.sqrt(2*o*o))},inv:function(r,n,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*r)+n)},mean:function(t,r){return e.exp(t+r*r/2)},median:function(t){return e.exp(t)},mode:function(t,r){return e.exp(t-r*r)},sample:function(r,n){return e.exp(t.randn()*n+r)},variance:function(t,r){return(e.exp(r*r)-1)*e.exp(2*t+r*r)}}),t.extend(t.noncentralt,{pdf:function(r,n,o){return 1e-14>e.abs(o)?t.studentt.pdf(r,n):1e-14>e.abs(r)?e.exp(t.gammaln((n+1)/2)-o*o/2-.5*e.log(e.PI*n)-t.gammaln(n/2)):n/r*(t.noncentralt.cdf(r*e.sqrt(1+2/n),n+2,o)-t.noncentralt.cdf(r,n,o))},cdf:function(r,n,o){if(1e-14>e.abs(o))return t.studentt.cdf(r,n);var a=!1;r<0&&(a=!0,o=-o);for(var i=t.normal.cdf(-o,0,1),c=1e-14+1,u=1e-14+1,s=r*r/(r*r+n),l=0,f=e.exp(-o*o/2),h=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;l<200||u>1e-14||c>1e-14;)u=c,l>0&&(f*=o*o/(2*l),h*=o*o/(2*(l+.5))),i+=.5*(c=f*t.beta.cdf(s,l+.5,n/2)+h*t.beta.cdf(s,l+1,n/2)),l++;return a?1-i:i}}),t.extend(t.normal,{pdf:function(t,r,n){return e.exp(-.5*e.log(2*e.PI)-e.log(n)-e.pow(t-r,2)/(2*n*n))},cdf:function(r,n,o){return .5*(1+t.erf((r-n)/e.sqrt(2*o*o)))},inv:function(e,r,n){return -1.4142135623730951*n*t.erfcinv(2*e)+r},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,r){return t.randn()*r+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,r,n){return t<r?0:n*e.pow(r,n)/e.pow(t,n+1)},cdf:function(t,r,n){return t<r?0:1-e.pow(r/t,n)},inv:function(t,r,n){return r/e.pow(1-t,1/n)},mean:function(t,r){if(!(r<=1))return r*e.pow(t,r)/(r-1)},median:function(t,r){return r*e.SQRT2*t},mode:function(t){return t},variance:function(t,r){if(!(r<=2))return t*t*r/(e.pow(r-1,2)*(r-2))}}),t.extend(t.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(e.sqrt(n)*t.betafn(.5,n/2))*e.pow(1+r*r/n,-((n+1)/2))},cdf:function(r,n){var o=n/2;return t.ibeta((r+e.sqrt(r*r+n))/(2*e.sqrt(r*r+n)),o,o)},inv:function(r,n){var o=t.ibetainv(2*e.min(r,1-r),.5*n,.5);return o=e.sqrt(n*(1-o)/o),r>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return t.randn()*e.sqrt(r/(2*t.randg(r/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,r,n){return t<0||r<0||n<0?0:n/r*e.pow(t/r,n-1)*e.exp(-e.pow(t/r,n))},cdf:function(t,r,n){return t<0?0:1-e.exp(-e.pow(t/r,n))},inv:function(t,r,n){return r*e.pow(-e.log(1-t),1/n)},mean:function(e,r){return e*t.gammafn(1+1/r)},median:function(t,r){return t*e.pow(e.log(2),1/r)},mode:function(t,r){return r<=1?0:t*e.pow((r-1)/r,1/r)},sample:function(r,n){return r*e.pow(-e.log(t._random_fn()),1/n)},variance:function(r,n){return r*r*t.gammafn(1+2/n)-e.pow(t.weibull.mean(r,n),2)}}),t.extend(t.uniform,{pdf:function(t,e,r){return t<e||t>r?0:1/(r-e)},cdf:function(t,e,r){return t<e?0:t<r?(t-e)/(r-e):1},inv:function(t,e,r){return e+t*(r-e)},mean:function(t,e){return .5*(t+e)},median:function(e,r){return t.mean(e,r)},mode:function(){throw Error("mode is not yet implemented")},sample:function(e,r){return e/2+r/2+(r/2-e/2)*(2*t._random_fn()-1)},variance:function(t,r){return e.pow(r-t,2)/12}}),t.extend(t.binomial,{pdf:function(r,n,o){return 0===o||1===o?n*o===r?1:0:t.combination(n,r)*e.pow(o,r)*e.pow(1-o,n-r)},cdf:function(n,o,a){if(n<0)return 0;if(n>=o)return 1;if(a<0||a>1||o<=0)return NaN;var i,c=(n=e.floor(n))+1,u=o-n,s=c+u,l=e.exp(t.gammaln(s)-t.gammaln(u)-t.gammaln(c)+c*e.log(a)+u*e.log(1-a));return i=a<(c+1)/(s+2)?l*r(a,c,u,1e-10):1-l*r(1-a,u,c,1e-10),e.round(1e10*(1-i))/1e10}}),t.extend(t.negbin,{pdf:function(r,n,o){return r===r>>>0&&(r<0?0:t.combination(r+n-1,n-1)*e.pow(1-o,r)*e.pow(o,n))},cdf:function(e,r,n){var o=0,a=0;if(e<0)return 0;for(;a<=e;a++)o+=t.negbin.pdf(a,r,n);return o}}),t.extend(t.hypgeom,{pdf:function(r,n,o,a){if(r!=r|0)return!1;if(r<0||r<o-(n-a)||r>a||r>o)return 0;if(2*o>n)return 2*a>n?t.hypgeom.pdf(n-o-a+r,n,n-o,n-a):t.hypgeom.pdf(a-r,n,n-o,a);if(2*a>n)return t.hypgeom.pdf(o-r,n,o,n-a);if(o<a)return t.hypgeom.pdf(r,n,a,o);for(var i=1,c=0,u=0;u<r;u++){for(;i>1&&c<a;)i*=1-o/(n-c),c++;i*=(a-u)*(o-u)/((u+1)*(n-o-a+u+1))}for(;c<a;c++)i*=1-o/(n-c);return e.min(1,e.max(0,i))},cdf:function(r,n,o,a){if(r<0||r<o-(n-a))return 0;if(r>=a||r>=o)return 1;if(2*o>n)return 2*a>n?t.hypgeom.cdf(n-o-a+r,n,n-o,n-a):1-t.hypgeom.cdf(a-r-1,n,n-o,a);if(2*a>n)return 1-t.hypgeom.cdf(o-r-1,n,o,n-a);if(o<a)return t.hypgeom.cdf(r,n,a,o);for(var i=1,c=1,u=0,s=0;s<r;s++){for(;i>1&&u<a;){var l=1-o/(n-u);c*=l,i*=l,u++}c*=(a-s)*(o-s)/((s+1)*(n-o-a+s+1)),i+=c}for(;u<a;u++)i*=1-o/(n-u);return e.min(1,e.max(0,i))}}),t.extend(t.poisson,{pdf:function(r,n){return n<0||r%1!=0||r<0?0:e.pow(n,r)*e.exp(-n)/t.factorial(r)},cdf:function(e,r){var n=[],o=0;if(e<0)return 0;for(;o<=e;o++)n.push(t.poisson.pdf(o,r));return t.sum(n)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(r){var n=1,o=0,a=e.exp(-r);do o++,n*=t._random_fn();while(n>a);return o-1},sampleLarge:function(r){var n,o,a,i,c,u,s,l,f,h;for(i=e.sqrt(r),c=e.log(r),u=-.059+.02483*(s=.931+2.53*i),l=1.1239+1.1328/(s-3.4),f=.9277-3.6224/(s-2);;)if(o=e.random()-.5,a=e.random(),h=.5-e.abs(o),n=e.floor((2*u/h+s)*o+r+.43),h>=.07&&a<=f||!(n<0)&&(!(h<.013)||!(a>h))&&e.log(a)+e.log(l)-e.log(u/(h*h)+s)<=-r+n*c-t.loggam(n+1))return n},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,r,n){return r<=e||n<e||n>r?NaN:t<e||t>r?0:t<n?2*(t-e)/((r-e)*(n-e)):t===n?2/(r-e):2*(r-t)/((r-e)*(r-n))},cdf:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=r?0:t>=n?1:t<=o?e.pow(t-r,2)/((n-r)*(o-r)):1-e.pow(n-t,2)/((n-r)*(n-o))},inv:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=(o-r)/(n-r)?r+(n-r)*e.sqrt((o-r)/(n-r)*t):r+(n-r)*(1-e.sqrt((1-t)*(1-(o-r)/(n-r))))},mean:function(t,e,r){return(t+e+r)/3},median:function(t,r,n){return n<=(t+r)/2?r-e.sqrt((r-t)*(r-n))/e.sqrt(2):n>(t+r)/2?t+e.sqrt((r-t)*(n-t))/e.sqrt(2):void 0},mode:function(t,e,r){return r},sample:function(r,n,o){var a=t._random_fn();return a<(o-r)/(n-r)?r+e.sqrt(a*(n-r)*(o-r)):n-e.sqrt((1-a)*(n-r)*(n-o))},variance:function(t,e,r){return(t*t+e*e+r*r-t*e-t*r-e*r)/18}}),t.extend(t.arcsine,{pdf:function(t,r,n){return n<=r?NaN:t<=r||t>=n?0:2/e.PI*e.pow(e.pow(n-r,2)-e.pow(2*t-r-n,2),-.5)},cdf:function(t,r,n){return t<r?0:t<n?2/e.PI*e.asin(e.sqrt((t-r)/(n-r))):1},inv:function(t,r,n){return r+(.5-.5*e.cos(e.PI*t))*(n-r)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,r){return r<=t?NaN:e.pow(r-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,r,n){return n<=0?0:e.exp(-e.abs(t-r)/n)/(2*n)},cdf:function(t,r,n){return n<=0?0:t<r?.5*e.exp((t-r)/n):1-.5*e.exp(-(t-r)/n)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(r,n){var o=t._random_fn()-.5;return r-o/e.abs(o)*n*e.log(1-2*e.abs(o))}}),t.extend(t.tukey,{cdf:function(r,o,a){var i=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],c=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(a<2||o<2)return NaN;if(!Number.isFinite(r))return 1;if(a>25e3)return n(r,1,o);var u=.5*a,s=u*e.log(a)-a*e.log(2)-t.gammaln(u),l=u-1,f=.25*a;d=a<=100?1:a<=800?.5:a<=5e3?.25:.125,s+=e.log(d);for(var h=0,p=1;p<=50;p++){for(var d,m,g,v=0,E=(2*p-1)*d,y=1;y<=16;y++)8<y?(m=y-8-1,g=s+l*e.log(E+i[m]*d)-(i[m]*d+E)*f):(m=y-1,g=s+l*e.log(E-i[m]*d)+(i[m]*d-E)*f),g>=-30&&(v+=n(8<y?r*e.sqrt((i[m]*d+E)*.5):r*e.sqrt((-(i[m]*d)+E)*.5),1,o)*c[m]*e.exp(g));if(p*d>=1&&v<=1e-14)break;h+=v}if(v>1e-14)throw Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(r,n,o){if(o<2||n<2||r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var a,i,c,u,s,l,f=(c=.5-.5*r,s=(u=e.sqrt(e.log(1/(c*c))))+((((-.0000453642210148*u+-.204231210125)*u+-.342242088547)*u+-1)*u+.322232421088)/((((.0038560700634*u+.10353775285)*u+.531103462366)*u+.588581570495)*u+.099348462606),o<120&&(s+=(s*s*s+s)/o/4),l=.8832-.2368*s,o<120&&(l+=-1.214/o+1.208*s/o),s*(l*e.log(n-1)+1.4142)),h=t.tukey.cdf(f,n,o)-r;a=h>0?e.max(0,f-1):f+1;for(var p=t.tukey.cdf(a,n,o)-r,d=1;d<50;d++)if(i=a-p*(a-f)/(p-h),h=p,f=a,i<0&&(i=0,p=-r),p=t.tukey.cdf(i,n,o)-r,a=i,1e-4>e.abs(a-f))return i;throw Error("tukey.inv failed to converge")}})}(e,Math),function(t,e){var r,n,o=Array.prototype.push,a=t.utils.isArray;function i(e){return a(e)||e instanceof t}t.extend({add:function(e,r){return i(r)?(i(r[0])||(r=[r]),t.map(e,function(t,e,n){return t+r[e][n]})):t.map(e,function(t){return t+r})},subtract:function(e,r){return i(r)?(i(r[0])||(r=[r]),t.map(e,function(t,e,n){return t-r[e][n]||0})):t.map(e,function(t){return t-r})},divide:function(e,r){return i(r)?(i(r[0])||(r=[r]),t.multiply(e,t.inv(r))):t.map(e,function(t){return t/r})},multiply:function(e,r){var n,o,a,c,u,s,l,f;if(void 0===e.length&&void 0===r.length)return e*r;if(u=e.length,s=e[0].length,l=t.zeros(u,a=i(r)?r[0].length:s),f=0,i(r)){for(;f<a;f++)for(n=0;n<u;n++){for(o=0,c=0;o<s;o++)c+=e[n][o]*r[o][f];l[n][f]=c}return 1===u&&1===f?l[0][0]:l}return t.map(e,function(t){return t*r})},outer:function(e,r){return t.multiply(e.map(function(t){return[t]}),[r])},dot:function(e,r){i(e[0])||(e=[e]),i(r[0])||(r=[r]);for(var n,o,a=1===e[0].length&&1!==e.length?t.transpose(e):e,c=1===r[0].length&&1!==r.length?t.transpose(r):r,u=[],s=0,l=a.length,f=a[0].length;s<l;s++){for(o=0,u[s]=[],n=0;o<f;o++)n+=a[s][o]*c[s][o];u[s]=n}return 1===u.length?u[0]:u},pow:function(r,n){return t.map(r,function(t){return e.pow(t,n)})},exp:function(r){return t.map(r,function(t){return e.exp(t)})},log:function(r){return t.map(r,function(t){return e.log(t)})},abs:function(r){return t.map(r,function(t){return e.abs(t)})},norm:function(t,r){var n=0,o=0;for(isNaN(r)&&(r=2),i(t[0])&&(t=t[0]);o<t.length;o++)n+=e.pow(e.abs(t[o]),r);return e.pow(n,1/r)},angle:function(r,n){return e.acos(t.dot(r,n)/(t.norm(r)*t.norm(n)))},aug:function(t,e){var r,n=[];for(r=0;r<t.length;r++)n.push(t[r].slice());for(r=0;r<n.length;r++)o.apply(n[r],e[r]);return n},inv:function(e){for(var r,n=e.length,o=e[0].length,a=t.identity(n,o),i=t.gauss_jordan(e,a),c=[],u=0;u<n;u++)for(c[u]=[],r=o;r<i[0].length;r++)c[u][r-o]=i[u][r];return c},det:function t(e){if(2===e.length)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(var r=0,n=0;n<e.length;n++){for(var o=[],a=1;a<e.length;a++){o[a-1]=[];for(var i=0;i<e.length;i++)i<n?o[a-1][i]=e[a][i]:i>n&&(o[a-1][i-1]=e[a][i])}var c=n%2?-1:1;r+=t(o)*e[0][n]*c}return r},gauss_elimination:function(r,n){var o,a,i,c,u=0,s=0,l=r.length,f=r[0].length,h=1,p=0,d=[];for(u=0,o=(r=t.aug(r,n))[0].length;u<l;u++){for(a=r[u][u],s=u,c=u+1;c<f;c++)a<e.abs(r[c][u])&&(a=r[c][u],s=c);if(s!=u)for(c=0;c<o;c++)i=r[u][c],r[u][c]=r[s][c],r[s][c]=i;for(s=u+1;s<l;s++)for(h=r[s][u]/r[u][u],c=u;c<o;c++)r[s][c]=r[s][c]-h*r[u][c]}for(u=l-1;u>=0;u--){for(p=0,s=u+1;s<=l-1;s++)p+=d[s]*r[u][s];d[u]=(r[u][o-1]-p)/r[u][u]}return d},gauss_jordan:function(r,n){var o,a,i,c=t.aug(r,n),u=c.length,s=c[0].length,l=0;for(a=0;a<u;a++){var f=a;for(i=a+1;i<u;i++)e.abs(c[i][a])>e.abs(c[f][a])&&(f=i);var h=c[a];for(c[a]=c[f],c[f]=h,i=a+1;i<u;i++)for(l=c[i][a]/c[a][a],o=a;o<s;o++)c[i][o]-=c[a][o]*l}for(a=u-1;a>=0;a--){for(i=0,l=c[a][a];i<a;i++)for(o=s-1;o>a-1;o--)c[i][o]-=c[a][o]*c[i][a]/l;for(c[a][a]/=l,o=u;o<s;o++)c[a][o]/=l}return c},triaUpSolve:function(e,r){var n,o=e[0].length,a=t.zeros(1,o)[0],i=!1;return(void 0!=r[0].length&&(r=r.map(function(t){return t[0]}),i=!0),t.arange(o-1,-1,-1).forEach(function(i){n=t.arange(i+1,o).map(function(t){return a[t]*e[i][t]}),a[i]=(r[i]-t.sum(n))/e[i][i]}),i)?a.map(function(t){return[t]}):a},triaLowSolve:function(e,r){var n,o=e[0].length,a=t.zeros(1,o)[0],i=!1;return(void 0!=r[0].length&&(r=r.map(function(t){return t[0]}),i=!0),t.arange(o).forEach(function(o){n=t.arange(o).map(function(t){return e[o][t]*a[t]}),a[o]=(r[o]-t.sum(n))/e[o][o]}),i)?a.map(function(t){return[t]}):a},lu:function(e){var r,n=e.length,o=t.identity(n),a=t.zeros(e.length,e[0].length);return t.arange(n).forEach(function(t){a[0][t]=e[0][t]}),t.arange(1,n).forEach(function(i){t.arange(i).forEach(function(n){r=t.arange(n).map(function(t){return o[i][t]*a[t][n]}),o[i][n]=(e[i][n]-t.sum(r))/a[n][n]}),t.arange(i,n).forEach(function(n){r=t.arange(i).map(function(t){return o[i][t]*a[t][n]}),a[i][n]=e[r.length][n]-t.sum(r)})}),[o,a]},cholesky:function(r){var n,o=r.length,a=t.zeros(r.length,r[0].length);return t.arange(o).forEach(function(i){n=t.arange(i).map(function(t){return e.pow(a[i][t],2)}),a[i][i]=e.sqrt(r[i][i]-t.sum(n)),t.arange(i+1,o).forEach(function(e){n=t.arange(i).map(function(t){return a[i][t]*a[e][t]}),a[e][i]=(r[i][e]-t.sum(n))/a[i][i]})}),a},gauss_jacobi:function(r,n,o,a){for(var i,c,u,s,l=0,f=0,h=r.length,p=[],d=[],m=[];l<h;l++)for(f=0,p[l]=[],d[l]=[],m[l]=[];f<h;f++)l>f?(p[l][f]=r[l][f],d[l][f]=m[l][f]=0):l<f?(d[l][f]=r[l][f],p[l][f]=m[l][f]=0):(m[l][f]=r[l][f],p[l][f]=d[l][f]=0);for(u=t.multiply(t.multiply(t.inv(m),t.add(p,d)),-1),c=t.multiply(t.inv(m),n),i=o,s=t.add(t.multiply(u,o),c),l=2;e.abs(t.norm(t.subtract(s,i)))>a;)i=s,s=t.add(t.multiply(u,i),c),l++;return s},gauss_seidel:function(r,n,o,a){for(var i,c,u,s,l,f=0,h=r.length,p=[],d=[],m=[];f<h;f++)for(i=0,p[f]=[],d[f]=[],m[f]=[];i<h;i++)f>i?(p[f][i]=r[f][i],d[f][i]=m[f][i]=0):f<i?(d[f][i]=r[f][i],p[f][i]=m[f][i]=0):(m[f][i]=r[f][i],p[f][i]=d[f][i]=0);for(s=t.multiply(t.multiply(t.inv(t.add(m,p)),d),-1),u=t.multiply(t.inv(t.add(m,p)),n),c=o,l=t.add(t.multiply(s,o),u),f=2;e.abs(t.norm(t.subtract(l,c)))>a;)c=l,l=t.add(t.multiply(s,c),u),f+=1;return l},SOR:function(r,n,o,a,i){for(var c,u,s,l,f,h=0,p=r.length,d=[],m=[],g=[];h<p;h++)for(c=0,d[h]=[],m[h]=[],g[h]=[];c<p;c++)h>c?(d[h][c]=r[h][c],m[h][c]=g[h][c]=0):h<c?(m[h][c]=r[h][c],d[h][c]=g[h][c]=0):(g[h][c]=r[h][c],d[h][c]=m[h][c]=0);for(l=t.multiply(t.inv(t.add(g,t.multiply(d,i))),t.subtract(t.multiply(g,1-i),t.multiply(m,i))),s=t.multiply(t.multiply(t.inv(t.add(g,t.multiply(d,i))),n),i),u=o,f=t.add(t.multiply(l,o),s),h=2;e.abs(t.norm(t.subtract(f,u)))>a;)u=f,f=t.add(t.multiply(l,u),s),h++;return f},householder:function(r){for(var n,o,a,i,c=r.length,u=r[0].length,s=0,l=[],f=[];s<c-1;s++){for(n=0,i=s+1;i<u;i++)n+=r[i][s]*r[i][s];for(n=(r[s+1][s]>0?-1:1)*e.sqrt(n),o=e.sqrt((n*n-r[s+1][s]*n)/2),(l=t.zeros(c,1))[s+1][0]=(r[s+1][s]-n)/(2*o),a=s+2;a<c;a++)l[a][0]=r[a][s]/(2*o);f=t.subtract(t.identity(c,u),t.multiply(t.multiply(l,t.transpose(l)),2)),r=t.multiply(f,t.multiply(r,f))}return r},QR:(r=t.sum,n=t.arange,function(o){var a,i,c,u=o.length,s=o[0].length,l=t.zeros(s,s);for(i=0,o=t.copy(o);i<s;i++){for(a=0,l[i][i]=e.sqrt(r(n(u).map(function(t){return o[t][i]*o[t][i]})));a<u;a++)o[a][i]=o[a][i]/l[i][i];for(c=i+1;c<s;c++)for(a=0,l[i][c]=r(n(u).map(function(t){return o[t][i]*o[t][c]}));a<u;a++)o[a][c]=o[a][c]-o[a][i]*l[i][c]}return[o,l]}),lstsq:function(e,r){var n,o,a,i=!1;void 0===r[0].length&&(r=r.map(function(t){return[t]}),i=!0);var c=t.QR(e),u=c[0],s=c[1],l=e[0].length,f=t.slice(u,{col:{end:l}}),h=(n=t.slice(s,{row:{end:l}}),o=(n=t.copy(n)).length,a=t.identity(o),t.arange(o-1,-1,-1).forEach(function(e){t.sliceAssign(a,{row:e},t.divide(t.slice(a,{row:e}),n[e][e])),t.sliceAssign(n,{row:e},t.divide(t.slice(n,{row:e}),n[e][e])),t.arange(e).forEach(function(r){var o=t.multiply(n[r][e],-1),i=t.slice(n,{row:r}),c=t.multiply(t.slice(n,{row:e}),o);t.sliceAssign(n,{row:r},t.add(i,c));var u=t.slice(a,{row:r}),s=t.multiply(t.slice(a,{row:e}),o);t.sliceAssign(a,{row:r},t.add(u,s))})}),a),p=t.transpose(f);void 0===p[0].length&&(p=[p]);var d=t.multiply(t.multiply(h,p),r);return(void 0===d.length&&(d=[[d]]),i)?d.map(function(t){return t[0]}):d},jacobi:function(r){for(var n,o,a,i,c,u,s,l=1,f=r.length,h=t.identity(f,f),p=[];1===l;){for(n=0,c=r[0][1],a=0,i=1;n<f;n++)for(o=0;o<f;o++)n!=o&&c<e.abs(r[n][o])&&(c=e.abs(r[n][o]),a=n,i=o);for(n=1,u=r[a][a]===r[i][i]?r[a][i]>0?e.PI/4:-e.PI/4:e.atan(2*r[a][i]/(r[a][a]-r[i][i]))/2,(s=t.identity(f,f))[a][a]=e.cos(u),s[a][i]=-e.sin(u),s[i][a]=e.sin(u),s[i][i]=e.cos(u),h=t.multiply(h,s),r=t.multiply(t.multiply(t.inv(s),r),s),l=0;n<f;n++)for(o=1;o<f;o++)n!=o&&e.abs(r[n][o])>.001&&(l=1)}for(n=0;n<f;n++)p.push(r[n][n]);return[h,p]},rungekutta:function(t,e,r,n,o,a){var i,c,u,s;if(2===a)for(;n<=r;)i=e*t(n,o),c=e*t(n+e,o+i),o+=(i+c)/2,n+=e;if(4===a)for(;n<=r;)i=e*t(n,o),c=e*t(n+e/2,o+i/2),u=e*t(n+e/2,o+c/2),s=e*t(n+e,o+u),o+=(i+2*c+2*u+s)/6,n+=e;return o},romberg:function(t,r,n,o){for(var a,i,c,u,s,l=0,f=(n-r)/2,h=[],p=[],d=[];l<o/2;){for(s=t(r),c=r,u=0;c<=n;c+=f,u++)h[u]=c;for(c=1,a=h.length;c<a-1;c++)s+=(c%2!=0?4:2)*t(h[c]);s=f/3*(s+t(n)),d[l]=s,f/=2,l++}for(i=d.length,a=1;1!==i;){for(c=0;c<i-1;c++)p[c]=(e.pow(4,a)*d[c+1]-d[c])/(e.pow(4,a)-1);i=p.length,d=p,p=[],a++}return d},richardson:function(t,r,n,o){function a(t,e){for(var r,n=0,o=t.length;n<o;n++)t[n]===e&&(r=n);return r}for(var i,c,u,s,l,f=e.abs(n-t[a(t,n)+1]),h=0,p=[],d=[];o>=f;)i=a(t,n+o),c=a(t,n),p[h]=(r[i]-2*r[c]+r[2*c-i])/(o*o),o/=2,h++;for(s=p.length,u=1;1!=s;){for(l=0;l<s-1;l++)d[l]=(e.pow(4,u)*p[l+1]-p[l])/(e.pow(4,u)-1);s=d.length,p=d,d=[],u++}return p},simpson:function(t,e,r,n){for(var o,a=(r-e)/n,i=t(e),c=[],u=e,s=0,l=1;u<=r;u+=a,s++)c[s]=u;for(o=c.length;l<o-1;l++)i+=(l%2!=0?4:2)*t(c[l]);return a/3*(i+t(r))},hermite:function(t,e,r,n){for(var o,a=t.length,i=0,c=0,u=[],s=[],l=[],f=[];c<a;c++){for(o=0,u[c]=1;o<a;o++)c!=o&&(u[c]*=(n-t[o])/(t[c]-t[o]));for(o=0,s[c]=0;o<a;o++)c!=o&&(s[c]+=1/(t[c]-t[o]));l[c]=(1-2*(n-t[c])*s[c])*(u[c]*u[c]),f[c]=(n-t[c])*(u[c]*u[c]),i+=l[c]*e[c]+f[c]*r[c]}return i},lagrange:function(t,e,r){for(var n,o,a=0,i=0,c=t.length;i<c;i++){for(n=0,o=e[i];n<c;n++)i!=n&&(o*=(r-t[n])/(t[i]-t[n]));a+=o}return a},cubic_spline:function(e,r,n){for(var o,a=e.length,i=0,c=[],u=[],s=[],l=[],f=[],h=[],p=[];i<a-1;i++)f[i]=e[i+1]-e[i];for(i=1,s[0]=0;i<a-1;i++)s[i]=3/f[i]*(r[i+1]-r[i])-3/f[i-1]*(r[i]-r[i-1]);for(i=1;i<a-1;i++)c[i]=[],u[i]=[],c[i][i-1]=f[i-1],c[i][i]=2*(f[i-1]+f[i]),c[i][i+1]=f[i],u[i][0]=s[i];for(o=0,l=t.multiply(t.inv(c),u);o<a-1;o++)h[o]=(r[o+1]-r[o])/f[o]-f[o]*(l[o+1][0]+2*l[o][0])/3,p[o]=(l[o+1][0]-l[o][0])/(3*f[o]);for(o=0;o<a&&!(e[o]>n);o++);return r[o-=1]+(n-e[o])*h[o]+t.sq(n-e[o])*l[o]+(n-e[o])*t.sq(n-e[o])*p[o]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented")},PCA:function(e){var r,n,o=e.length,a=e[0].length,i=0,c=[],u=[],s=[],l=[],f=[],h=[],p=[],d=[],m=[],g=[];for(i=0;i<o;i++)c[i]=t.sum(e[i])/a;for(i=0;i<a;i++)for(r=0,p[i]=[];r<o;r++)p[i][r]=e[r][i]-c[r];for(i=0,p=t.transpose(p);i<o;i++)for(r=0,d[i]=[];r<o;r++)d[i][r]=t.dot([p[i]],[p[r]])/(a-1);for(i=0,m=(s=t.jacobi(d))[0],u=s[1],g=t.transpose(m);i<u.length;i++)for(r=i;r<u.length;r++)u[i]<u[r]&&(n=u[i],u[i]=u[r],u[r]=n,l=g[i],g[i]=g[r],g[r]=l);for(i=0,h=t.transpose(p);i<o;i++)for(r=0,f[i]=[];r<h.length;r++)f[i][r]=t.dot([g[i]],[h[r]]);return[e,u,g,f]}}),function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(r,n){var o=this;return n?(setTimeout(function(){n.call(o,t.fn[e].call(o,r))},15),this):"number"==typeof t[e](this,r)?t[e](this,r):t(t[e](this,r))}}(e[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(e,Math),function(t,e){var r=[].slice,n=t.utils.isNumber,o=t.utils.isArray;function a(t,r,n,o){if(t>1||n>1||t<=0||n<=0)throw Error("Proportions should be greater than 0 and less than 1");var a=(t*r+n*o)/(r+o);return(t-n)/e.sqrt(a*(1-a)*(1/r+1/o))}t.extend({zscore:function(){var e=r.call(arguments);return n(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var n,a=r.call(arguments);return o(a[1])?(n=t.zscore(a[0],a[1],a[3]),1===a[2]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):a.length>2?(n=t.zscore(a[0],a[1],a[2]),1===a[3]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):(n=a[0],1===a[1]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(r,n,o){var a=e.abs(this.zscore(r,o));return 1===n?t.normal.cdf(-a,0,1):2*t.normal.cdf(-a,0,1)}}),t.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/e.sqrt(n[3])):(n[0]-t.mean(n[1]))/(t.stdev(n[1],!0)/e.sqrt(n[1].length))},ttest:function(){var o,a=r.call(arguments);return 5===a.length?(o=e.abs(t.tscore(a[0],a[1],a[2],a[3])),1===a[4]?t.studentt.cdf(-o,a[3]-1):2*t.studentt.cdf(-o,a[3]-1)):n(a[1])?(o=e.abs(a[0]),1==a[2]?t.studentt.cdf(-o,a[1]-1):2*t.studentt.cdf(-o,a[1]-1)):(o=e.abs(t.tscore(a[0],a[1])),1==a[2]?t.studentt.cdf(-o,a[1].length-1):2*t.studentt.cdf(-o,a[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(r,n){return 1===n?1-t.studentt.cdf(e.abs(this.tscore(r)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(r)),this.cols()-1)}}),t.extend({anovafscore:function(){var n,o,a,i,c,u,s,l,f=r.call(arguments);if(1===f.length){for(s=0,c=Array(f[0].length);s<f[0].length;s++)c[s]=f[0][s];f=c}for(s=0,o=[];s<f.length;s++)o=o.concat(f[s]);for(s=0,a=t.mean(o),n=0;s<f.length;s++)n+=f[s].length*e.pow(t.mean(f[s])-a,2);for(n/=f.length-1,u=0,s=0;s<f.length;s++)for(l=0,i=t.mean(f[s]);l<f[s].length;l++)u+=e.pow(f[s][l]-i,2);return n/(u/=o.length-f.length)},anovaftest:function(){var e,o,a,i,c=r.call(arguments);if(n(c[0]))return 1-t.centralF.cdf(c[0],c[1],c[2]);var u=t.anovafscore(c);for(i=0,e=c.length-1,a=0;i<c.length;i++)a+=c[i].length;return o=a-e-1,1-t.centralF.cdf(u,e,o)},ftest:function(e,r,n){return 1-t.centralF.cdf(e,r,n)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,r=0;for(e=0;e<this.length;e++)r+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,r-this.length)}}),t.extend({qscore:function(){var o,a,i,c,u,s=r.call(arguments);return n(s[0])?(o=s[0],a=s[1],i=s[2],c=s[3],u=s[4]):(o=t.mean(s[0]),a=t.mean(s[1]),i=s[0].length,c=s[1].length,u=s[2]),e.abs(o-a)/(u*e.sqrt((1/i+1/c)/2))},qtest:function(){var e,n=r.call(arguments);3===n.length?(e=n[0],n=n.slice(1)):7===n.length?(e=t.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(e=t.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],a=n[1];return 1-t.tukey.cdf(e,a,o-a)},tukeyhsd:function(e){for(var r=t.pooledstdev(e),n=e.map(function(e){return t.mean(e)}),o=e.reduce(function(t,e){return t+e.length},0),a=[],i=0;i<e.length;++i)for(var c=i+1;c<e.length;++c){var u=t.qtest(n[i],n[c],e[i].length,e[c].length,r,o,e.length);a.push([[i,c],u])}return a}}),t.extend({normalci:function(){var n,o=r.call(arguments),a=[,,];return n=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},tci:function(){var n,o=r.call(arguments),a=[,,];return n=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,r){return t.normalci(e,r,this.toArray())},tci:function(e,r){return t.tci(e,r,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,r,n,o){var i=a(e,r,n,o);return t.ztest(i,1)},twoSidedDifferenceOfProportions:function(e,r,n,o){var i=a(e,r,n,o);return t.ztest(i,2)}})}(e,Math),e.models=function(){function t(t,r){var n=t.length,o=r[0].length-1,a=e.lstsq(r,t),i=e.multiply(r,a.map(function(t){return[t]})).map(function(t){return t[0]}),c=e.subtract(t,i),u=e.mean(t),s=e.sum(i.map(function(t){return Math.pow(t-u,2)})),l=e.sum(t.map(function(t,e){return Math.pow(t-i[e],2)})),f=s+l;return{exog:r,endog:t,nobs:n,df_model:o,df_resid:n-o-1,coef:a,predict:i,resid:c,ybar:u,SST:f,SSE:s,SSR:l,R2:s/f}}return{ols:function(r,n){var o,a,i,c,u,s,l,f,h,p,d,m,g,v,E=t(r,n),y=(a=(o=E.exog)[0].length,i=e.arange(a).map(function(r){var n=e.arange(a).filter(function(t){return t!==r});return t(e.col(o,r).map(function(t){return t[0]}),e.col(o,n))}),c=Math.sqrt(E.SSR/E.df_resid),u=i.map(function(t){return c/Math.sqrt(t.SST*(1-t.R2))}),l=(s=E.coef.map(function(t,e){return(t-0)/u[e]})).map(function(t){var r=e.studentt.cdf(t,E.df_resid);return(r>.5?1-r:r)*2}),f=e.studentt.inv(.975,E.df_resid),h=E.coef.map(function(t,e){var r=f*u[e];return[t-r,t+r]}),{se:u,t:s,p:l,sigmaHat:c,interval95:h}),N=(v=1-(d=p=E.R2/E.df_model/((1-E.R2)/E.df_resid),m=E.df_model,g=E.df_resid,e.beta.cdf(d/(g/m+d),m/2,g/2)),{F_statistic:p,pvalue:v}),R=1-(1-E.R2)*((E.nobs-1)/E.df_resid);return E.t=y,E.f=N,E.adjust_R2=R,E}}}(),e.extend({buildxmatrix:function(){for(var t=Array(arguments.length),r=0;r<arguments.length;r++){var n=[1];t[r]=n.concat(arguments[r])}return e(t)},builddxmatrix:function(){for(var t=Array(arguments[0].length),r=0;r<arguments[0].length;r++){var n=[1];t[r]=n.concat(arguments[0][r])}return e(t)},buildjxmatrix:function(t){for(var r=Array(t.length),n=0;n<t.length;n++)r[n]=t[n];return e.builddxmatrix(r)},buildymatrix:function(t){return e(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,r){var n,o,a,i,c;if(t.cols()==r.rows()){if(r.rows()>1){for(n=0,i=[];n<t.rows();n++)for(o=0,i[n]=[];o<r.cols();o++){for(a=0,c=0;a<t.cols();a++)c+=t.toArray()[n][a]*r.toArray()[a][o];i[n][o]=c}return e(i)}for(n=0,i=[];n<t.rows();n++)for(o=0,i[n]=[];o<r.cols();o++){for(a=0,c=0;a<t.cols();a++)c+=t.toArray()[n][a]*r.toArray()[o];i[n][o]=c}return e(i)}},regress:function(t,r){var n=e.xtranspxinv(t),o=t.transpose(),a=e.matrixmult(e(n),o);return e.matrixmult(a,r)},regresst:function(t,r,n){var o,a,i,c=e.regress(t,r),u={};u.anova={};var s=e.jMatYBar(t,c);u.yBar=s;var l=r.mean();u.anova.residuals=e.residuals(r,s),u.anova.ssr=e.ssr(s,l),u.anova.msr=u.anova.ssr/(t[0].length-1),u.anova.sse=e.sse(r,s),u.anova.mse=u.anova.sse/(r.length-(t[0].length-1)-1),u.anova.sst=e.sst(r,l),u.anova.mst=u.anova.sst/(r.length-1),u.anova.r2=1-u.anova.sse/u.anova.sst,u.anova.r2<0&&(u.anova.r2=0),u.anova.fratio=u.anova.msr/u.anova.mse,u.anova.pvalue=e.anovaftest(u.anova.fratio,t[0].length-1,r.length-(t[0].length-1)-1),u.anova.rmse=Math.sqrt(u.anova.mse),u.anova.r2adj=1-u.anova.mse/u.anova.mst,u.anova.r2adj<0&&(u.anova.r2adj=0),u.stats=Array(t[0].length);for(var f=e.xtranspxinv(t),h=0;h<c.length;h++)o=Math.sqrt(u.anova.mse*Math.abs(f[h][h])),a=Math.abs(c[h]/o),i=e.ttest(a,r.length-t[0].length-1,n),u.stats[h]=[c[h],o,a,i];return u.regress=c,u},xtranspx:function(t){return e.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var r=e.matrixmult(t.transpose(),t);return e.inv(r)},jMatYBar:function(t,r){var n=e.matrixmult(t,r);return new e(n)},residuals:function(t,r){return e.matrixsubtract(t,r)},ssr:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},sse:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r},sst:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},matrixsubtract:function(t,r){for(var n=Array(t.length),o=0;o<t.length;o++){n[o]=Array(t[o].length);for(var a=0;a<t[o].length;a++)n[o][a]=t[o][a]-r[o][a]}return e(n)}}),e.jStat=e,e},t.exports=e()},60282:function(t,e,r){"use strict";r.d(e,{Z:function(){return n}});/**
 * @license lucide-react v0.381.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("LoaderPinwheel",[["path",{d:"M2 12c0-2.8 2.2-5 5-5s5 2.2 5 5 2.2 5 5 5 5-2.2 5-5",key:"1cg5zf"}],["path",{d:"M7 20.7a1 1 0 1 1 5-8.7 1 1 0 1 0 5-8.6",key:"1gnrpi"}],["path",{d:"M7 3.3a1 1 0 1 1 5 8.6 1 1 0 1 0 5 8.6",key:"u9yy5q"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},54326:function(t,e,r){"use strict";r.d(e,{Z:function(){return n}});/**
 * @license lucide-react v0.381.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("PanelRightClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]])},16463:function(t,e,r){"use strict";var n=r(71169);r.o(n,"useRouter")&&r.d(e,{useRouter:function(){return n.useRouter}})},20357:function(t,e,r){"use strict";var n,o;t.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(o=r.g.process)?void 0:o.env)?r.g.process:r(88081)},88081:function(t){!function(){var e={229:function(t){var e,r,n,o=t.exports={};function a(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function c(t){if(e===setTimeout)return setTimeout(t,0);if((e===a||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:a}catch(t){e=a}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var u=[],s=!1,l=-1;function f(){s&&n&&(s=!1,n.length?u=n.concat(u):l=-1,u.length&&h())}function h(){if(!s){var t=c(f);s=!0;for(var e=u.length;e;){for(n=u,u=[];++l<e;)n&&n[l].run();l=-1,e=u.length}n=null,s=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new p(t,e)),1!==u.length||s||c(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var a=r[t]={exports:{}},i=!0;try{e[t](a,a.exports,n),i=!1}finally{i&&delete r[t]}return a.exports}n.ab="//";var o=n(229);t.exports=o}()},80448:function(t,e,r){"use strict";r.d(e,{ZP:function(){return eo}});var n,o,a=r(2265),i=r(56800),c=r.n(i),u=r(76426),s=r.n(u),l=r(27494),f=r(54887);r(20357);let h=Symbol(),p=Symbol(),d="undefined"==typeof window||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?a.useEffect:a.useLayoutEffect,m=l.unstable_runWithPriority?t=>{try{(0,l.unstable_runWithPriority)(l.unstable_NormalPriority,t)}catch(e){if("Not implemented."===e.message)t();else throw e}}:t=>t(),g=t=>({value:e,children:r})=>{let n=(0,a.useRef)(e),o=(0,a.useRef)(0),[i,c]=(0,a.useState)(null);i&&(i(e),c(null));let u=(0,a.useRef)();if(!u.current){let t=new Set;u.current={[h]:{v:n,n:o,l:t,u:(e,r)=>{(0,f.unstable_batchedUpdates)(()=>{o.current+=1;let n={n:o.current};null!=r&&r.suspense&&(n.n*=-1,n.p=new Promise(t=>{c(()=>e=>{n.v=e,delete n.p,t(e)})})),t.forEach(t=>t(n)),e()})}}}}return d(()=>{n.current=e,o.current+=1,m(()=>{u.current[h].l.forEach(t=>{t({n:o.current,v:e})})})},[e]),(0,a.createElement)(t,{value:u.current},r)};function v(t,e){let{v:{current:r},n:{current:n},l:o}=(0,a.useContext)(t)[h],i=e(r),[c,u]=(0,a.useReducer)((t,o)=>{if(!o)return[r,i];if("p"in o)throw o.p;if(o.n===n)return Object.is(t[1],i)?t:[r,i];try{if("v"in o){if(Object.is(t[0],o.v))return t;let r=e(o.v);if(Object.is(t[1],r))return t;return[o.v,r]}}catch(t){}return[...t]},[r,i]);return Object.is(c[1],i)||u(),d(()=>(o.add(u),()=>{o.delete(u)}),[o]),c[1]}var E=function(t,e){return(E=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function y(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var N=function(){return(N=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function R(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}function T(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function A(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function M(t,e,r){if(r||2==arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}var w="SET_DATA",O="SET_CREATE_FORMULA_PARSER",I="SELECT_ENTIRE_ROW",C="SELECT_ENTIRE_COLUMN",S="SELECT_ENTIRE_WORKSHEET",b="SET_SELECTION",U="SELECT",x="ACTIVATE",L="SET_CELL_DATA",_="SET_CELL_DIMENSIONS",k="COPY",P="PASTE",B="EDIT",D="VIEW",F="BLUR",V="KEY_PRESS",G="KEY_DOWN",j="DRAG_START",$="DRAG_END",H="COMMIT";function W(t,e){return{type:L,payload:{active:t,data:e}}}function Y(t,e){var r=e[t.row];if(void 0!==r)return r[t.column]}function K(t,e,r){for(var n=[],o=e.column-t.column,a=t.row;a<=e.row;a++){var i=a-t.row;n[i]=n[i]||Array(o);for(var c=t.column;c<=e.column;c++)n[i][c-t.column]=Y({row:a,column:c},r)}return n}function q(t,e,r){var n=M([],A(r),!1),o=r[0],a=o?M([],A(o),!1):[];a.length-1<t.column&&(a[t.column]=void 0,n[0]=a);var i=r[t.row]?M([],A(r[t.row]),!1):[];return i[t.column]=e,n[t.row]=i,n}function z(t,e){if(!Q(t,e))return e;var r=M([],A(e),!1),n=M([],A(e[t.row]),!1);return n[t.column]=void 0,r[t.row]=n,r}function X(t){var e,r,n,o,a,i,c,u,s,l,f,h,p,d;return R(this,function(m){switch(m.label){case 0:m.trys.push([0,11,12,13]),r=(e=T(t.entries())).next(),m.label=1;case 1:if(r.done)return[3,10];o=(n=A(r.value,2))[0],a=n[1],m.label=2;case 2:m.trys.push([2,7,8,9]),p=void 0,c=(i=T(a.entries())).next(),m.label=3;case 3:if(c.done)return[3,6];return s=(u=A(c.value,2))[0],l=u[1],[4,[{row:o,column:s},l]];case 4:m.sent(),m.label=5;case 5:return c=i.next(),[3,3];case 6:return[3,9];case 7:return p={error:m.sent()},[3,9];case 8:try{c&&!c.done&&(d=i.return)&&d.call(i)}finally{if(p)throw p.error}return[7];case 9:return r=e.next(),[3,1];case 10:return[3,13];case 11:return f={error:m.sent()},[3,13];case 12:try{r&&!r.done&&(h=e.return)&&h.call(e)}finally{if(f)throw f.error}return[7];case 13:return[2]}})}function Q(t,e){var r=e[0];return r&&t.row>=0&&t.column>=0&&Number.isInteger(t.row)&&Number.isInteger(t.column)&&t.column<r.length&&t.row<e.length}function Z(t){return{columns:tt(t),rows:J(t)}}function J(t){return t.length}function tt(t){var e=t[0];return e?e.length:0}function te(t){var e=Z(t);return{row:e.rows-1,column:e.columns-1}}var tr=function(){function t(t,e){this.start={row:Math.min(t.row,e.row),column:Math.min(t.column,e.column)},this.end={row:Math.max(t.row,e.row),column:Math.max(t.column,e.column)}}return t.prototype[Symbol.iterator]=function(){var t,e;return R(this,function(r){switch(r.label){case 0:t=this.start.row,r.label=1;case 1:if(!(t<=this.end.row))return[3,6];e=this.start.column,r.label=2;case 2:if(!(e<=this.end.column))return[3,5];return[4,{row:t,column:e}];case 3:r.sent(),r.label=4;case 4:return e++,[3,2];case 5:return t++,[3,1];case 6:return[2]}})},t.prototype.size=function(){return(this.end.row+1-this.start.row)*(this.end.column+1-this.start.column)},t.prototype.has=function(t){return t.row>=this.start.row&&t.column>=this.start.column&&t.row<=this.end.row&&t.column<=this.end.column},t.prototype.mask=function(e){return new t({row:e.start.row>this.start.row?e.start.row:this.start.row,column:e.start.column>this.start.column?e.start.column:this.start.column},{row:e.end.row<this.end.row?e.end.row:this.end.row,column:e.end.column<this.end.column?e.end.column:this.end.column})},t.prototype.equals=function(t){return this.start.row===t.start.row&&this.start.column===t.start.column&&this.end.row===t.end.row&&this.end.column===t.end.column},t}(),tn={row:0,column:0},to=function(){},ta=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.toRange=function(t){return null},e.prototype.normalizeTo=function(t){return this},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(){return 0},e.prototype.has=function(){return!1},e.prototype.equals=function(t){return t instanceof e},e}(to),ti=function(t){function e(e){var r=t.call(this)||this;return r.range=e,r}return y(e,t),e.prototype.toRange=function(t){return this.range},e.prototype.normalizeTo=function(t){var r=th(t);return new e(this.range.mask(r))},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(t){var e=this.toRange(t);return e?e.size():0},e.prototype.has=function(t,e){var r=this.toRange(t);return null!==r&&r.has(e)},e.prototype.equals=function(t){return t instanceof e&&this.range.equals(t.range)},e}(to),tc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e}(to),tu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.toRange=function(t){return th(t)},e.prototype.normalizeTo=function(t){return this},e.prototype.hasEntireColumn=function(t){return!0},e.prototype.hasEntireRow=function(t){return!0},e.prototype.size=function(t){return tt(t)*J(t)},e.prototype.has=function(t,e){return!0},e.prototype.equals=function(t){return t instanceof e},e}(tc),ts=function(t){function e(e,r){var n=this;if(!tp(e))throw new td("start");if(!tp(r))throw new td("end");return(n=t.call(this)||this).start=Math.min(e,r),n.end=Math.max(e,r),n}return y(e,t),e.prototype.equals=function(t){return t instanceof e&&this.constructor===t.constructor&&this.start===t.start&&this.end===t.end},e}(tc),tl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.toRange=function(t){var e=te(t);return new tr({row:this.start,column:0},{row:this.end,column:e.column})},e.prototype.normalizeTo=function(t){var r=J(t);return new e(Math.max(this.start,0),Math.min(this.end,r-1))},e.prototype.hasEntireRow=function(t){return t>=this.start&&t<=this.end},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(t){return(this.end-this.start+1)*tt(t)},e.prototype.has=function(t,e){return e.row>=this.start&&e.row<=this.end},e}(ts),tf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.toRange=function(t){var e=te(t);return new tr({row:0,column:this.start},{row:e.row,column:this.end})},e.prototype.normalizeTo=function(t){var r=tt(t);return new e(Math.max(this.start,0),Math.min(this.end,r-1))},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return t>=this.start&&t<=this.end},e.prototype.size=function(t){return(this.end-this.start+1)*J(t)},e.prototype.has=function(t,e){return e.column>=this.start&&e.column<=this.end},e}(ts);function th(t){return new tr(tn,te(t))}function tp(t){return Number.isInteger(t)&&t>=0}var td=function(t){function e(e){return t.call(this,"".concat(e," is not a valid index. It must be 0 or a positive integer"))||this}return y(e,t),e}(Error),tm="text/plain";function tg(t,e,r){void 0===e&&(e=0),void 0===r&&(r=1);var n=[];if(-1===Math.sign(t-e)){for(var o=e;o>t;o-=r)n.push(o);return n}for(var o=e;o<t;o+=r)n.push(o);return n}function tv(t,e){return!!(t&&e.column===t.column&&e.row===t.row)}function tE(t){return{width:t.offsetWidth,height:t.offsetHeight,left:t.offsetLeft,top:t.offsetTop}}function ty(t,e,r){var n=e&&e[t.row],o=r&&r[t.column];return n&&o&&N(N({},n),o)}function tN(t,e,r){var n=ty(r.start,t,e),o=ty(r.end,t,e);return n&&o&&{width:o.left+o.width-n.left,height:o.top+o.height-n.top,top:n.top,left:n.left}}function tR(t,e){return null!==t&&"view"===e&&tT(t)}function tT(t){return t.matches(":focus-within")}function tA(t){return"".concat(t.row,",").concat(t.column)}function tM(t){var e=A(t.split(","),2),r=e[0],n=e[1];return{row:Number(r),column:Number(n)}}var tw=function(){function t(t){this.set=t}return t.from=function(e){var r,n,o=new Set;try{for(var a=T(e),i=a.next();!i.done;i=a.next()){var c=i.value;o.add(tA(c))}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new t(o)},t.prototype.has=function(t){return this.set.has(tA(t))},Object.defineProperty(t.prototype,"size",{get:function(){return this.set.size},enumerable:!1,configurable:!0}),t.prototype.add=function(e){var r=new Set(this.set);return r.add(tA(e)),new t(r)},t.prototype.delete=function(e){var r=new Set(this.set);return r.delete(tA(e))?new t(r):this},t.prototype.difference=function(t){var e,r,n=this;try{for(var o=T(t),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.delete(i)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype.union=function(t){var e,r,n=this;try{for(var o=T(t),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.add(i)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype[Symbol.iterator]=function(){var t,e,r,n;return R(this,function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),e=(t=T(this.set)).next(),o.label=1;case 1:if(e.done)return[3,4];return[4,tM(e.value)];case 2:o.sent(),o.label=3;case 3:return e=t.next(),[3,1];case 4:return[3,7];case 5:return r={error:o.sent()},[3,7];case 6:try{e&&!e.done&&(n=t.return)&&n.call(t)}finally{if(r)throw r.error}return[7];case 7:return[2]}})},t}();function tO(t){return"string"==typeof t&&t.startsWith("=")&&t.length>1}function tI(t){return t.slice(1)}function tC(t,e){return new(s())(N(N({},e),{onCell:function(e){var r=Y({row:e.row-1,column:e.col-1},t);return isNaN(null==r?void 0:r.value)?null==r?void 0:r.value:Number(null==r?void 0:r.value)},onRange:function(e){var r=Z(t);return function(t,e){for(var r=[],n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++){var a=t[n][o];r.push(e?e(a,{row:n,column:o}):a)}return r}(K({row:e.from.row-1,column:e.from.col-1},{row:Math.min(e.to.row-1,r.rows-1),column:Math.min(e.to.col-1,r.columns-1)},t),function(t){return isNaN(null==t?void 0:t.value)?null==t?void 0:t.value:Number(null==t?void 0:t.value)})}}))}var tS=new u.DepParser;function tb(t,e,r){var n=Z(r),o=n.rows,a=n.columns;try{var i=tS.parse(t,tU(e));return tw.from(i.flatMap(function(t){if("from"in t){var e=t.from,r=t.to,n={row:e.row-1,column:e.col-1},i={row:Math.min(r.row-1,o-1),column:Math.min(r.col-1,a-1)},c=new tr(n,i);return Array.from(c)}return{row:t.row-1,column:t.col-1}}))}catch(t){if(t instanceof u.FormulaError)return tw.from([]);throw t}}function tU(t){return{row:t.row+1,col:t.column+1,sheet:"Sheet1"}}var tx=function(){function t(t){void 0===t&&(t=new Map),this.forwards=t}return t.from=function(e){var r,n,o=new Map;try{for(var a=T(e),i=a.next();!i.done;i=a.next()){var c=A(i.value,2),u=c[0],s=c[1];o.set(tA(u),s)}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new t(o)},t.prototype.set=function(e,r){var n=new t(new Map(this.forwards));return 0===r.size?n.forwards.delete(tA(e)):n.forwards.set(tA(e),r),n},t.prototype.get=function(t){return this.forwards.get(tA(t))||tw.from([])},t.prototype.getBackwards=function(t){var e,r,n=tw.from([]);try{for(var o=T(this.forwards),a=o.next();!a.done;a=o.next()){var i=A(a.value,2),c=i[0];i[1].has(t)&&(n=n.add(tM(c)))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype.getBackwardsRecursive=function(t,e){void 0===e&&(e=tw.from([]));var r,n,o=this.getBackwards(t),a=e;try{for(var i=T(o),c=i.next();!c.done;c=i.next()){var u=c.value;a.has(u)||(a=a.add(u),o=o.union(this.getBackwardsRecursive(u,a)))}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},t.prototype.hasCircularDependency=function(t){for(var e,r,n=tw.from([]),o=[t];o.length>0;){var a=o.pop();if(a){if(n.has(a))return!0;n=n.add(a);var i=this.get(a);if(i)try{for(var c=(e=void 0,T(i)),u=c.next();!u.done;u=c.next()){var s=u.value;o.push(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}}}return!1},t.prototype[Symbol.iterator]=function(){var t,e,r,n,o,a,i,c,u,s,l,f,h,p,d;return R(this,function(m){switch(m.label){case 0:t=new Set,m.label=1;case 1:m.trys.push([1,13,14,15]),r=(e=T(this.forwards)).next(),m.label=2;case 2:if(r.done)return[3,12];return o=(n=A(r.value,2))[0],a=n[1],i=tM(o),t.add(o),[4,[i,a]];case 3:m.sent(),m.label=4;case 4:m.trys.push([4,9,10,11]),p=void 0,u=(c=T(a)).next(),m.label=5;case 5:if(u.done)return[3,8];if(l=tA(s=u.value),!(!t.has(l)&&!this.forwards.has(l)))return[3,7];return t.add(l),[4,[s,tw.from([])]];case 6:m.sent(),m.label=7;case 7:return u=c.next(),[3,5];case 8:return[3,11];case 9:return p={error:m.sent()},[3,11];case 10:try{u&&!u.done&&(d=c.return)&&d.call(c)}finally{if(p)throw p.error}return[7];case 11:return r=e.next(),[3,2];case 12:return[3,15];case 13:return f={error:m.sent()},[3,15];case 14:try{r&&!r.done&&(h=e.return)&&h.call(e)}finally{if(f)throw f.error}return[7];case 15:return[2]}})},t.prototype.traverseBFSBackwards=function(){var t,e,r,n,o,a,i,c,u,s,l,f,h,p,d;return R(this,function(m){switch(m.label){case 0:t=tw.from([]),e=[];try{for(n=(r=T(this)).next();!n.done;n=r.next())a=(o=A(n.value,2))[0],i=o[1],0===i.size&&(t=t.add(a),e.push(a))}catch(t){f={error:t}}finally{try{n&&!n.done&&(h=r.return)&&h.call(r)}finally{if(f)throw f.error}}m.label=1;case 1:if(!(e.length>0))return[3,3];if(!(a=e.shift()))return[3,1];return[4,a];case 2:if(m.sent(),0===(c=this.getBackwards(a)).size)return[3,1];try{for(p=void 0,s=(u=T(c)).next();!s.done;s=u.next())l=s.value,t.has(l)||0!==this.get(l).difference(t).size||(e.push(l),t=t.add(l))}catch(t){p={error:t}}finally{try{s&&!s.done&&(d=u.return)&&d.call(u)}finally{if(p)throw p.error}}return[3,1];case 3:return[2]}})},t}(),tL=function(t,e,r,n){this.createFormulaParser=t,this.data=e,this.referenceGraph=r||function(t){var e,r,n=[];try{for(var o=T(X(t)),a=o.next();!a.done;a=o.next()){var i=A(a.value,2),c=i[0],u=i[1];if(u&&tO(u.value)){var s=tb(tI(u.value),c,t);n.push([c,s])}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return tx.from(n)}(e),this.evaluatedData=n||function(t,e,r){var n,o,a=t,i=r(a);try{for(var c=T(e.traverseBFSBackwards()),u=c.next();!u.done;u=c.next()){var s=u.value,l=Y(s,t);if(l&&tO(l.value)){var f=t_(l.value,s,i);a=q(s,N(N({},l),{value:f}),a),i=r(a)}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return a}(e,this.referenceGraph,this.createFormulaParser)};function t_(t,e,r){var n=tI(t);try{return function(t,e,r){try{var n=tU(e),o=r.parse(t,n);return o instanceof u.FormulaError?o.toString():o}catch(t){if(t instanceof u.FormulaError)return t.toString();throw t}}(n,e,r)}catch(t){return u.FormulaError.REF}}var tk={active:null,mode:"view",rowDimensions:{},columnDimensions:{},lastChanged:null,hasPasted:!1,cut:!1,dragging:!1,model:new tL(tC,[]),selected:new ta,copied:null,lastCommit:null};function tP(t,e){var r,n,o,a,i,c;switch(e.type){case w:var s=e.payload.data,l=t.active&&Q(t.active,s)?t.active:null,f=t.selected.normalizeTo(s);return N(N({},t),{model:new tL(t.model.createFormulaParser,s),active:l,selected:f});case O:var h=e.payload.createFormulaParser;return N(N({},t),{model:new tL(h,t.model.data)});case I:var p=e.payload,d=p.row,m=p.extend,g=t.active;return N(N({},t),{selected:m&&g?new tl(g.row,d):new tl(d,d),active:m&&g?g:N(N({},tn),{row:d}),mode:"view"});case C:var v=e.payload,E=v.column,m=v.extend,g=t.active;return N(N({},t),{selected:m&&g?new tf(g.column,E):new tf(E,E),active:m&&g?g:N(N({},tn),{column:E}),mode:"view"});case S:return N(N({},t),{selected:new tu,active:tn,mode:"view"});case b:var y=e.payload.selection,R=y.toRange(t.model.data),g=t.active&&y.has(t.model.data,t.active)?t.active:null==R?void 0:R.start;return N(N({},t),{selected:y,active:g||null,mode:"view"});case U:var W=e.payload.point;if(t.active&&!tv(t.active,W))return N(N({},t),{selected:new ti(new tr(W,t.active)),mode:"view"});return t;case x:var W=e.payload.point;return N(N({},t),{selected:new ti(new tr(W,W)),active:W,mode:tv(t.active,W)?"edit":"view"});case L:var K,J,tt,te,to,ta,tc,ts,th=e.payload,g=th.active,tp=th.data;if(tX(t))return t;return N(N({},t),{model:(tt=t.model,to=q(te=g,tp,tt.data),ta=tO(tp.value)?(K=tt.referenceGraph,J=tb(tI(tp.value),te,to),K.set(te,J)):tt.referenceGraph,tc=tt.createFormulaParser(to),ts=function(t,e,r,n,o,a){if(r.hasCircularDependency(n)){var i,c,s,l,f=tw.from([n]),h=q(n,N(N({},o),{value:u.FormulaError.REF}),t);try{for(var p=T(r.getBackwardsRecursive(n)),d=p.next();!d.done;d=p.next()){var m=d.value;if(f.has(m))break;f=f.add(m);var g=Y(m,e);g&&(h=q(m,N(N({},g),{value:u.FormulaError.REF}),h))}}catch(t){i={error:t}}finally{try{d&&!d.done&&(c=p.return)&&c.call(p)}finally{if(i)throw i.error}}return h}var v=t,E=tO(o.value)?t_(o.value,n,a):o.value;v=q(n,N(N({},o),{value:E}),v);try{for(var y=T(r.getBackwardsRecursive(n)),R=y.next();!R.done;R=y.next()){var m=R.value,g=Y(m,e);if(g){var A=tO(g.value)?t_(g.value,n,a):g.value,M=N(N({},g),{value:A});v=q(m,M,v)}}}catch(t){s={error:t}}finally{try{R&&!R.done&&(l=y.return)&&l.call(y)}finally{if(s)throw s.error}}return v}(tt.evaluatedData,to,ta,te,tp,tc),new tL(tt.createFormulaParser,to,ta,ts)),lastChanged:g});case _:var td=e.payload,W=td.point,tm=td.dimensions,tg=t.rowDimensions[W.row],tE=t.columnDimensions[W.column];if(tg&&tE&&tg.top===tm.top&&tg.height===tm.height&&tE.left===tm.left&&tE.width===tm.width)return t;return N(N({},t),{rowDimensions:N(N({},t.rowDimensions),((r={})[W.row]={top:tm.top,height:tm.height},r)),columnDimensions:N(N({},t.columnDimensions),((n={})[W.column]={left:tm.left,width:tm.width},n))});case k:case"CUT":var ty=t.selected.toRange(t.model.data);return N(N({},t),{copied:ty,cut:"CUT"===e.type,hasPasted:!1});case P:var tN,tR,tT,tA=e.payload.data,g=t.active;if(!g)return t;var tM=(tN=function(t){return{value:t}},void 0===tR&&(tR="	"),void 0===tT&&(tT=/\r\n|\n|\r/),tA.replace(/"([^"]*?)"/g,function(t,e){return e.replace(/\n/g,"\\n")}).split(tT).map(function(t){return t.split(tR).map(function(t){return t.replace(/\\n/g,"\n")}).map(tN)})),tS=Z(tM),ty=t.selected.toRange(t.model.data);if(ty&&1===tS.rows&&1===tS.columns){var tU=Y({row:0,column:0},tM),tx=t.cut&&t.copied?z(t.copied.start,t.model.data):t.model.data,tk=[];try{for(var tP=T(ty||[]),tj=tP.next();!tj.done;tj=tP.next()){var W=tj.value,t$=Y(W,t.model.data);tk.push({prevCell:t$||null,nextCell:tU||null}),tx=q(W,tU,tx)}}catch(t){o={error:t}}finally{try{tj&&!tj.done&&(a=tP.return)&&a.call(tP)}finally{if(o)throw o.error}}return N(N({},t),{model:new tL(tC,tx),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:tk})}var tH={rows:g.row+tS.rows,columns:g.column+tS.columns},tW=function(t,e){var r=Z(t),n=r.rows,o=r.columns;if(n>=e.rows&&o>=e.columns)return t;var a={rows:e.rows>n?e.rows:n,columns:e.columns>o?e.columns:o},i=M([],A(t),!1);if(a.columns>o){var c=a.columns-o;i=i.map(function(t){return M(M([],A(t),!1),A(Array(c).fill(void 0)),!1)})}if(a.rows>n){var u=a.rows-n,s=Array(a.columns).fill(void 0);i=M(M([],A(i),!1),A(Array(u).fill(s)),!1)}return i}(t.model.data,tH),tY={data:tW,commit:[]};try{for(var tK=T(X(tM)),tq=tK.next();!tq.done;tq=tK.next()){var tQ=A(tq.value,2),W=tQ[0],tU=tQ[1],tZ=tY.commit||[],tJ={row:W.row+g.row,column:W.column+g.column},t0=tY.data;if(t.cut){if(t.copied){var t1={row:W.row+t.copied.start.row,column:W.column+t.copied.start.column};t0=z(t1,tY.data)}tZ=M(M([],A(tZ),!1),[{prevCell:tU||null,nextCell:null}],!1)}Q(tJ,tW)||(tY={data:t0,commit:tZ});var t$=Y(tJ,t0)||null;tZ=M(M([],A(tZ),!1),[{prevCell:t$,nextCell:tU||null}],!1),tY.data=q(tJ,N(N({value:void 0},t$),tU),t0),tY.commit=tZ}}catch(t){i={error:t}}finally{try{tq&&!tq.done&&(c=tK.return)&&c.call(tK)}finally{if(i)throw i.error}}return N(N({},t),{model:new tL(tC,tY.data),selected:new ti(new tr(g,{row:g.row+tS.rows-1,column:g.column+tS.columns-1})),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:tY.commit});case B:return tB(t);case D:return tV(t);case"CLEAR":return tD(t);case F:return tF(t);case V:var t2=e.payload.event;if(tX(t)||t2.metaKey)return t;if("view"===t.mode&&t.active)return tB(t);return t;case G:var t3=e.payload.event,t4=tz(t,t3);if(t4)return N(N({},t),t4(t,t3));return t;case j:return N(N({},t),{dragging:!0});case $:return N(N({},t),{dragging:!1});case H:var t5=e.payload.changes;return N(N({},t),tG(t5));default:throw Error("Unknown action")}}function tB(t){return tX(t)?t:N(N({},t),{mode:"edit"})}function tD(t){if(!t.active)return t;var e,r,n=t.selected.toRange(t.model.data),o=[],a=t.model.data;try{for(var i=T(n||[]),c=i.next();!c.done;c=i.next()){var u,s=c.value,l=Y(s,t.model.data),f=(u=l)&&!u.readOnly?Object.assign({},u,{value:void 0}):u;o.push({prevCell:l||null,nextCell:f||null}),a=q(s,f,a)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return N(N(N({},t),{model:new tL(tC,a)}),tG(o))}function tF(t){return N(N({},t),{active:null,selected:new ta})}function tV(t){return N(N({},t),{mode:"view"})}function tG(t){return{lastCommit:t}}var tj=function(t,e){return function(r){if(r.active){var n={row:r.active.row+t,column:r.active.column+e};return Q(n,r.model.data)?N(N({},r),{active:n,selected:new ti(new tr(n,n)),mode:"view"}):N(N({},r),{mode:"view"})}}},t$={ArrowUp:tj(-1,0),ArrowDown:tj(1,0),ArrowLeft:tj(0,-1),ArrowRight:tj(0,1),Tab:tj(0,1),Enter:tB,Backspace:tD,Delete:tD,Escape:tF},tH={Escape:tV,Tab:t$.Tab,Enter:t$.ArrowDown},tW={Tab:tj(0,-1)};(n=o||(o={})).Left="Left",n.Right="Right",n.Top="Top",n.Bottom="Bottom";var tY={ArrowUp:function(t){return N(N({},t),{selected:tQ(t.selected,t.active,t.model.data,o.Top)})},ArrowDown:function(t){return N(N({},t),{selected:tQ(t.selected,t.active,t.model.data,o.Bottom)})},ArrowLeft:function(t){return N(N({},t),{selected:tQ(t.selected,t.active,t.model.data,o.Left)})},ArrowRight:function(t){return N(N({},t),{selected:tQ(t.selected,t.active,t.model.data,o.Right)})},Tab:tj(0,-1)},tK={},tq={};function tz(t,e){var r=e.key;return("edit"===t.mode?e.shiftKey?tW:tH:e.shiftKey&&e.metaKey?tK:e.shiftKey?tY:e.metaKey?tq:t$)[r]}function tX(t){var e=t.active&&Y(t.active,t.model.data)||null;return!!(null==e?void 0:e.readOnly)}function tQ(t,e,r,n){var a,i,c,u,s,l;return e?t instanceof ti?(i=n===o.Left||n===o.Right?"column":"row",u="start"==(c=n===o.Left||n===o.Top?"start":"end")?-1:1,s=t.range.has(N(N({},e),((a={})[i]=e[i]+-1*u,a))),l=new tr(t.range.start,t.range.end),l[s?"start"===c?"end":"start":c][i]+=u,new ti(l).normalizeTo(r)):t instanceof tf?function(t,e,r,n){if(n===o.Top||n===o.Bottom)return t;var a=n===o.Left?-1:1,i=n===o.Left?"start":"end",c="start"===i?"end":"start",u=N({},t);return(n===o.Left?t.end>e.row:t.start<e.row)?u[c]=t[c]+a:u[i]=t[i]+a,new tf(Math.max(u.start,0),Math.max(u.end,0)).normalizeTo(r)}(t,e,r,n):t instanceof tl?function(t,e,r,n){if(n===o.Left||n===o.Right)return t;var a=n===o.Top?-1:1,i=n===o.Top?"start":"end",c="start"===i?"end":"start",u=N({},t);return(n===o.Top?t.end>e.row:t.start<e.row)?u[c]=t[c]+a:u[i]=t[i]+a,new tl(Math.max(u.start,0),Math.max(u.end,0)).normalizeTo(r)}(t,e,r,n):t:t}var tZ=function(t){let e=(0,a.createContext)({[h]:{v:{current:t},n:{current:-1},l:new Set,u:t=>t()}});return e[p]=e.Provider,e.Provider=g(e.Provider),delete e.Consumer,e}([tk,function(){}]),tJ=function(t){var e=t.children,r=tg(t.columns+(t.hideColumnIndicators?0:1)).map(function(t){return a.createElement("col",{key:t})});return a.createElement("table",{className:"Spreadsheet__table"},a.createElement("colgroup",null,r),a.createElement("tbody",null,e))},t0=function(t){return a.createElement("tr",N({},t))},t1=function(t){return a.createElement("tr",N({},t))};function t2(){return v(tZ,function(t){var e=A(t,2);return e[0],e[1]})}function t3(t){return v(tZ,function(e){return t(A(e,1)[0])})}var t4=function(t){var e=t.selected,r=t.onSelect,n=a.useCallback(function(){r()},[r]);return a.createElement("th",{className:c()("Spreadsheet__header",{"Spreadsheet__header--selected":e}),onClick:n,tabIndex:0})},t5=function(t){var e=t.column,r=t.label,n=t.selected,o=t.onSelect,i=a.useCallback(function(t){o(e,t.shiftKey)},[o,e]);return a.createElement("th",{className:c()("Spreadsheet__header",{"Spreadsheet__header--selected":n}),onClick:i,tabIndex:0},void 0!==r?r:function(t){for(var e="",r=t;r>=0;)e=String.fromCharCode(65+r%26)+e,r=Math.floor(r/26)-1;return e}(e))},t6=function(t){var e=t.row,r=t.label,n=t.selected,o=t.onSelect,i=a.useCallback(function(t){o(e,t.shiftKey)},[o,e]);return a.createElement("th",{className:c()("Spreadsheet__header",{"Spreadsheet__header--selected":n}),onClick:i,tabIndex:0},void 0!==r?r:e+1)},t8=function(t){var e=t.row,r=t.column,n=t.DataViewer,o=t.selected,i=t.active,u=t.dragging,s=t.mode,l=t.data,f=t.evaluatedData,h=t.select,p=t.activate,d=t.setCellDimensions,m=t.setCellData,g=a.useRef(null),v=a.useMemo(function(){return{row:e,column:r}},[e,r]),E=a.useCallback(function(t){"view"===s&&(d(v,tE(t.currentTarget)),t.shiftKey?h(v):p(v))},[s,d,v,h,p]),y=a.useCallback(function(t){u&&(d(v,tE(t.currentTarget)),h(v))},[d,h,u,v]);return a.useEffect(function(){var t=g.current;o&&t&&d(v,tE(t)),t&&i&&"view"===s&&t.focus()},[d,o,i,s,v,l]),l&&l.DataViewer&&(n=l.DataViewer),a.createElement("td",{ref:g,className:c()("Spreadsheet__cell",null==l?void 0:l.className,{"Spreadsheet__cell--readonly":null==l?void 0:l.readOnly}),onMouseOver:y,onMouseDown:E,tabIndex:0},a.createElement(n,{row:e,column:r,cell:l,evaluatedCell:f,setCellData:m}))},t7=function(t){var e,r,n,o,i=(e=t.cell,(o=null!==(n=null==(r=t.evaluatedCell)?void 0:r.value)&&void 0!==n?n:null==e?void 0:e.value)&&"object"==typeof o?o.toString():o);return"boolean"==typeof i?a.createElement("span",{className:"Spreadsheet__data-viewer Spreadsheet__data-viewer--boolean"},i?"TRUE":"FALSE"):a.createElement("span",{className:c()("Spreadsheet__data-viewer",{"Spreadsheet__data-viewer--preserve-breaks":"string"==typeof i&&i.includes("\n")})},i)},t9=function(t){var e,r=t.onChange,n=t.cell,o=a.useRef(null),i=a.useCallback(function(t){r(N(N({},n),{value:t.target.value}))},[r,n]);a.useEffect(function(){if(o.current){var t;(t=o.current).selectionStart=t.selectionEnd=t.value.length}},[o]);var c=null!==(e=null==n?void 0:n.value)&&void 0!==e?e:"";return a.createElement("div",{className:"Spreadsheet__data-editor"},a.createElement("input",{ref:o,type:"text",onChange:i,value:c,autoFocus:!0}))},et=function(t){var e=a.useRef(null),r=t2(),n=a.useCallback(function(t,e){return r(W(t,e))},[r]),o=a.useCallback(function(){return r({type:B})},[r]),i=a.useCallback(function(t){return r({type:H,payload:{changes:t}})},[r]),u=a.useCallback(function(){r({type:D})},[r]),s=t3(function(t){return t.active}),l=t3(function(t){return t.mode}),f=t3(function(t){return t.active?Y(t.active,t.model.data):void 0}),h=t3(function(t){return s?ty(s,t.rowDimensions,t.columnDimensions):void 0}),p=a.useMemo(function(){return!s||!h},[s,h]),d=a.useRef(void 0),m=a.useRef(null),g=a.useRef(void 0),v=a.useCallback(function(t){s&&n(s,t)},[n,s]);a.useEffect(function(){var t=e.current;!p&&t&&t.focus()},[e,p]),a.useEffect(function(){var t=m.current,e=g.current;if(m.current=s,g.current=f,t&&e){var r=(null==s?void 0:s.row)!==t.row||(null==s?void 0:s.column)!==t.column;if(r||"edit"!==l){var n=d.current;e!==n?i([{prevCell:n||null,nextCell:e}]):r||f===e||i([{prevCell:e,nextCell:f||null}]),d.current=f}}});var E=f&&f.DataEditor||t.DataEditor,y=f&&f.readOnly;return p?null:a.createElement("div",{ref:e,className:c()("Spreadsheet__active-cell","Spreadsheet__active-cell--".concat(l)),style:h,onClick:"view"!==l||y?void 0:o,tabIndex:0},"edit"===l&&s&&a.createElement(E,{row:s.row,column:s.column,cell:f,onChange:v,exitEditMode:u}))},ee=function(t){var e,r=t.dimensions,n=t.dragging,o=t.hidden,i=t.variant,u=r||{},s=u.width,l=u.height,f=u.top,h=u.left;return a.createElement("div",{className:c()("Spreadsheet__floating-rect",((e={})["Spreadsheet__floating-rect--".concat(i)]=i,e["Spreadsheet__floating-rect--dragging"]=n,e["Spreadsheet__floating-rect--hidden"]=o,e)),style:{width:s,height:l,top:f,left:h}})},er=function(){var t=t3(function(t){return t.selected}),e=t3(function(e){var r,n,o,a;return t&&(r=e.rowDimensions,n=e.columnDimensions,o=e.model.data,(a=e.selected.toRange(o))?tN(r,n,a):void 0)}),r=t3(function(t){return t.dragging}),n=t3(function(t){return 2>t.selected.size(t.model.data)});return a.createElement(ee,{variant:"selected",dimensions:e,dragging:r,hidden:n})},en=function(){var t=t3(function(t){return t.copied}),e=t3(function(e){return t&&tN(e.rowDimensions,e.columnDimensions,t)}),r=null===t;return a.createElement(ee,{variant:"copied",dimensions:e,hidden:r,dragging:!1})};!function(t,e){void 0===e&&(e={});var r=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}(".Spreadsheet {\n  --background-color: white;\n  --text-color: black;\n  --readonly-text-color: rgba(0, 0, 0, 0.4);\n  --outline-color: #4285f4;\n  --outline-background-color: rgba(160, 195, 255, 0.2);\n  --border-color: hsl(2deg, 0%, 91%);\n  --header-background-color: rgba(0, 0, 0, 0.04);\n  --elevation: 0 2px 5px rgba(0, 0, 0, 0.4);\n\n  position: relative;\n  overflow: visible;\n  background: var(--background-color);\n  color: var(--text-color);\n  display: inline-block;\n}\n\n.Spreadsheet--dark-mode {\n  --background-color: black;\n  --text-color: white;\n  --readonly-text-color: rgba(255, 255, 255, 0.4);\n  --header-background-color: rgba(255, 255, 255, 0.04);\n  --border-color: hsl(2deg, 0%, 19%);\n}\n\n.Spreadsheet__active-cell {\n  position: absolute;\n  border: 2px solid var(--outline-color);\n  box-sizing: border-box;\n}\n\n.Spreadsheet__active-cell--edit {\n  background: var(--background-color);\n  box-shadow: var(--elevation);\n}\n\n.Spreadsheet__table {\n  border-collapse: collapse;\n  table-layout: fixed;\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__active-cell {\n  cursor: cell;\n}\n\n.Spreadsheet__cell {\n  outline: none;\n}\n\n.Spreadsheet__cell--readonly {\n  color: var(--readonly-text-color);\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__header {\n  min-width: 6em;\n  min-height: 1.9em;\n  height: 1.9em;\n  max-height: 1.9em;\n  border: 1px solid var(--border-color);\n  overflow: hidden;\n  word-break: keep-all;\n  white-space: nowrap;\n  text-align: left;\n  box-sizing: border-box;\n  user-select: none;\n}\n\n.Spreadsheet__header {\n  background: var(--header-background-color);\n  color: var(--readonly-text-color);\n  text-align: center;\n  font: inherit;\n}\n\n.Spreadsheet__header--selected {\n  background: #5f6268;\n  color: #fff;\n}\n\n.Spreadsheet__header,\n.Spreadsheet__data-viewer,\n.Spreadsheet__data-editor input {\n  padding: 4px;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__data-viewer--preserve-breaks {\n  white-space: pre-wrap;\n}\n\n.Spreadsheet__data-editor,\n.Spreadsheet__data-editor input {\n  width: 100%;\n  height: 100%;\n}\n\n.Spreadsheet__data-editor input {\n  font: inherit;\n  color: inherit;\n  background: none;\n  border: none;\n  outline: none;\n  margin: 0;\n}\n\n.Spreadsheet__data-viewer--boolean {\n  text-align: center;\n}\n\n.Spreadsheet__floating-rect {\n  position: absolute;\n  pointer-events: none;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__floating-rect--hidden {\n  display: none;\n}\n\n.Spreadsheet__floating-rect--selected {\n  background: var(--outline-background-color);\n  border: 2px var(--outline-color) solid;\n}\n\n.Spreadsheet__floating-rect--dragging {\n  border: none;\n}\n\n.Spreadsheet__floating-rect--copied {\n  border: 2px var(--outline-color) dashed;\n}\n");var eo=function(t){var e=t.className,r=t.darkMode,n=t.columnLabels,o=t.rowLabels,i=t.hideColumnIndicators,u=t.hideRowIndicators,s=t.onKeyDown,l=t.Table,f=void 0===l?tJ:l,h=t.Row,p=void 0===h?t0:h,d=t.HeaderRow,m=void 0===d?t1:d,g=t.DataEditor,v=void 0===g?t9:g,E=t.DataViewer,y=void 0===E?t7:E,R=t.onChange,M=void 0===R?function(){}:R,L=t.onModeChange,B=void 0===L?function(){}:L,D=t.onSelect,H=void 0===D?function(){}:D,q=t.onActivate,z=void 0===q?function(){}:q,Q=t.onBlur,J=void 0===Q?function(){}:Q,tt=t.onCellCommit,te=void 0===tt?function(){}:tt,tr=a.useMemo(function(){var e=new tL(t.createFormulaParser||tC,t.data);return N(N({},tk),{model:e,selected:t.selected||tk.selected})},[t.createFormulaParser,t.data,t.selected]),tn=a.useReducer(tP,tr),to=A(tn,2),ta=to[0],ti=to[1],tc=a.useMemo(function(){var t,e,r;return e=(t=Z(ta.model.data)).columns,r=t.rows,{rows:o?Math.max(r,o.length):r,columns:n?Math.max(e,n.length):e}},[ta.model.data,o,n]),ts=ta.mode,tl=a.useRef(null),tf=a.useCallback(function(){return ti({type:k})},[ti]),th=a.useCallback(function(){return ti({type:"CUT"})},[ti]),tp=a.useCallback(function(t){return ti({type:P,payload:{data:t}})},[ti]),td=a.useCallback(function(t){return ti({type:G,payload:{event:t}})},[ti]),tE=a.useCallback(function(t){return ti({type:V,payload:{event:t}})},[ti]),ty=a.useCallback(function(){return ti({type:j})},[ti]),tN=a.useCallback(function(){return ti({type:$})},[ti]),tA=a.useCallback(function(t){return ti({type:w,payload:{data:t}})},[ti]),tM=a.useCallback(function(t){return ti({type:O,payload:{createFormulaParser:t}})},[ti]),tw=a.useCallback(function(){return ti({type:F})},[ti]),tO=a.useCallback(function(t){return ti({type:b,payload:{selection:t}})},[ti]),tI=a.useRef(ta.active);a.useEffect(function(){if(ta.active!==tI.current){if(ta.active)z(ta.active);else{var t=tl.current;t&&tT(t)&&document.activeElement&&document.activeElement.blur(),J()}}tI.current=ta.active},[z,J,ta.active]);var tS=a.useRef(ta.model.data);a.useEffect(function(){ta.model.data!==tS.current&&ta.model.data!==t.data&&M(ta.model.data),tS.current=ta.model.data},[ta.model.data,M,t.data]);var tb=a.useRef(ta.selected);a.useEffect(function(){ta.selected.equals(tb.current)||t.selected&&ta.selected.equals(t.selected)||H(ta.selected),tb.current=ta.selected},[ta.selected,H,t.selected]);var tU=a.useRef(ta.mode);a.useEffect(function(){ta.mode!==tU.current&&B(ta.mode),tU.current=ta.mode},[ta.mode,B]);var tx=a.useRef(ta.lastCommit);a.useEffect(function(){var t,e;if(ta.lastCommit&&ta.lastCommit!==tx.current)try{for(var r=T(ta.lastCommit),n=r.next();!n.done;n=r.next()){var o=n.value;te(o.prevCell,o.nextCell,ta.lastChanged)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},[te,ta.lastChanged,ta.lastCommit]);var t_=a.useRef(t.selected);a.useEffect(function(){t.selected&&t_.current&&!t.selected.equals(t_.current)&&tO(t.selected),t_.current=t.selected},[t.selected,tO]);var tB=a.useRef(t.data);a.useEffect(function(){t.data!==tB.current&&tA(t.data),tB.current=t.data},[t.data,tA]);var tD=a.useRef(t.createFormulaParser);a.useEffect(function(){t.createFormulaParser!==tD.current&&t.createFormulaParser&&tM(t.createFormulaParser),tD.current=t.createFormulaParser},[t.createFormulaParser,tM]);var tF=a.useCallback(function(t){var e=ta.model,r=ta.selected,n=e.data,o=r.toRange(n);if(o){var a,i=function(t,e,r){void 0===e&&(e="	"),void 0===r&&(r="\n");for(var n="",o=Z(t),a=o.rows,i=o.columns,c=0;c<a;c++){c&&(n+=r);for(var u=0;u<i;u++)u&&(n+=e),t[c]&&u in t[c]&&(n+=String(t[c][u]))}return n}(function(t,e){var r,n,o=[];try{for(var a=T(X(e)),i=a.next();!i.done;i=a.next()){var c=A(i.value,2),u=c[0],s=c[1];!function(t,e,r){var n=r[0];n||(n=[],r[0]=n),t.row in r||(r[t.row]=[]),t.column in n||(n[t.column]=void 0),r[t.row][t.column]=e}(u,t(s,u),o)}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}(function(t){return(null==t?void 0:t.value)||""},K(o.start,o.end,n)));null===(a=t.clipboardData)||void 0===a||a.setData(tm,i)}},[ta]),tV=a.useCallback(function(t){tR(tl.current,ts)&&(t.preventDefault(),t.stopPropagation(),tF(t),th())},[ts,tF,th]),tG=a.useCallback(function(t){tR(tl.current,ts)&&(t.preventDefault(),t.stopPropagation(),tF(t),tf())},[ts,tF,tf]),tj=a.useCallback(function(t){tR(tl.current,ts)&&(t.preventDefault(),t.stopPropagation(),t.clipboardData)&&tp(window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):t.clipboardData&&t.clipboardData.getData?t.clipboardData.getData(tm):"")},[ts,tp]),t$=a.useCallback(function(t){t.persist(),s&&s(t),t.defaultPrevented||(void 0!==tz(ta,t)&&t.nativeEvent.preventDefault(),td(t))},[ta,s,td]),tH=a.useCallback(function(){tN(),document.removeEventListener("mouseup",tH)},[tN]),tW=a.useCallback(function(t){ta.dragging||1!==t.buttons||(ty(),document.addEventListener("mouseup",tH))},[ta,ty,tH]),tY=a.useCallback(function(t){t.currentTarget.contains(t.relatedTarget)||tw()},[tw]),tK=a.useMemo(function(){var e;return e=t.Cell||t8,function(t){var r=t.row,n=t.column,o=t2(),i=a.useMemo(function(){return{row:r,column:n}},[r,n]),c=a.useCallback(function(t){return o(W(i,t))},[o,i]),u=a.useCallback(function(t){return o({type:U,payload:{point:t}})},[o]),s=a.useCallback(function(t){return o({type:x,payload:{point:t}})},[o]),l=a.useCallback(function(t,e){return o({type:_,payload:{point:t,dimensions:e}})},[o]),f=t3(function(t){return tv(t.active,i)}),h=t3(function(t){return f?t.mode:"view"}),p=t3(function(t){return Y(i,t.model.data)}),d=t3(function(t){return Y(i,t.model.evaluatedData)}),m=t3(function(t){return t.selected.has(t.model.data,i)}),g=t3(function(t){return t.dragging}),v=t3(function(t){var e;return(null===(e=t.copied)||void 0===e?void 0:e.has(i))||!1});return a.createElement(e,N({},t,{selected:m,active:f,copied:v,dragging:g,mode:h,evaluatedData:d,data:p,select:u,activate:s,setCellDimensions:l,setCellData:c}))}},[t.Cell]),tq=a.useMemo(function(){var e;return e=t.CornerIndicator||t4,function(t){var r=t2(),n=a.useCallback(function(){return r({type:S})},[r]),o=t3(function(t){return t.selected instanceof tu});return a.createElement(e,N({},t,{selected:o,onSelect:n}))}},[t.CornerIndicator]),tX=a.useMemo(function(){var e;return e=t.RowIndicator||t6,function(t){var r=t2(),n=t3(function(e){return e.selected.hasEntireRow(t.row)}),o=a.useCallback(function(t,e){return r({type:I,payload:{row:t,extend:e}})},[r]);return a.createElement(e,N({},t,{selected:n,onSelect:o}))}},[t.RowIndicator]),tQ=a.useMemo(function(){var e;return e=t.ColumnIndicator||t5,function(t){var r=t2(),n=a.useCallback(function(t,e){return r({type:C,payload:{column:t,extend:e}})},[r]),o=t3(function(e){return e.selected.hasEntireColumn(t.column)});return a.createElement(e,N({},t,{selected:o,onSelect:n}))}},[t.ColumnIndicator]);a.useEffect(function(){return document.addEventListener("cut",tV),document.addEventListener("copy",tG),document.addEventListener("paste",tj),function(){document.removeEventListener("cut",tV),document.removeEventListener("copy",tG),document.removeEventListener("paste",tj)}},[tV,tG,tj]);var ee=a.useMemo(function(){return a.createElement(f,{columns:tc.columns,hideColumnIndicators:i},a.createElement(m,null,!u&&!i&&a.createElement(tq,null),!i&&tg(tc.columns).map(function(t){return n?a.createElement(tQ,{key:t,column:t,label:t in n?n[t]:null}):a.createElement(tQ,{key:t,column:t})})),tg(tc.rows).map(function(t){return a.createElement(p,{key:t,row:t},!u&&(o?a.createElement(tX,{key:t,row:t,label:t in o?o[t]:null}):a.createElement(tX,{key:t,row:t})),tg(tc.columns).map(function(e){return a.createElement(tK,{key:e,row:t,column:e,DataViewer:y})}))}))},[f,tc.rows,tc.columns,i,p,m,u,tq,n,tQ,o,tX,tK,y]),eo=a.useMemo(function(){return a.createElement(et,{DataEditor:v})},[v]),ea=a.useMemo(function(){return a.createElement("div",{ref:tl,className:c()("Spreadsheet",e,{"Spreadsheet--dark-mode":r}),onKeyPress:tE,onKeyDown:t$,onMouseMove:tW,onBlur:tY},ee,eo,a.createElement(er,null),a.createElement(en,null))},[e,r,tE,t$,tW,tY,ee,eo]);return a.createElement(tZ.Provider,{value:tn},ea)}},63511:function(t,e){var r,n,o;"undefined"!=typeof self&&self,n=[],void 0!==(o="function"==typeof(r=function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx},t.prototype.pattern=function(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");var e=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":c(r,"global");break;case"i":c(r,"ignoreCase");break;case"m":c(r,"multiLine");break;case"u":c(r,"unicode");break;case"y":c(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:e,loc:this.loc(0)}},t.prototype.disjunction=function(){var t=[],e=this.idx;for(t.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(e)}},t.prototype.alternative=function(){for(var t=[],e=this.idx;this.isTerm();)t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(e)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}u(e);var e,r=this.disjunction();return this.consumeChar(")"),{type:e,value:r,loc:this.loc(t)}}(function(){throw Error("Internal Error - Should never get here!")})()},t.prototype.quantifier=function(t){var e=this.idx;switch(this.popChar()){case"*":r={atLeast:0,atMost:1/0};break;case"+":r={atLeast:1,atMost:1/0};break;case"?":r={atLeast:0,atMost:1};break;case"{":var r,n=this.integerIncludingZero();switch(this.popChar()){case"}":r={atLeast:n,atMost:n};break;case",":r=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===t&&void 0===r)return;u(r)}if(!0!==t||void 0!==r)return u(r),"?"===this.peekChar(0)?(this.consumeChar("?"),r.greedy=!1):r.greedy=!0,r.type="Quantifier",r.loc=this.loc(e),r},t.prototype.atom=function(){var t,e=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group()}return void 0===t&&this.isPatternCharacter()&&(t=this.patternCharacter()),u(t),t.loc=this.loc(e),this.isQuantifier()&&(t.quantifier=this.quantifier()),t},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},t.prototype.characterClassEscape=function(){var t,e=!1;switch(this.popChar()){case"d":t=s;break;case"D":t=s,e=!0;break;case"s":t=f;break;case"S":t=f,e=!0;break;case"w":t=l;break;case"W":t=l,e=!0}return u(t),{type:"Set",value:t,complement:e}},t.prototype.controlEscapeAtom=function(){var t;switch(this.popChar()){case"f":t=a("\f");break;case"n":t=a("\n");break;case"r":t=a("\r");break;case"t":t=a("	");break;case"v":t=a("\v")}return u(t),{type:"Character",value:t}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var t=this.popChar();if(!1===/[a-zA-Z]/.test(t))throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},t.prototype.characterClass=function(){var t=[],e=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),e=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");t.push({from:r.value,to:n.value})}else i(r.value,t),t.push(a("-")),i(n.value,t)}else i(r.value,t)}return this.consumeChar("]"),{type:"Set",complement:e,value:t}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var t=!0;(this.consumeChar("("),"?"===this.peekChar(0))?(this.consumeChar("?"),this.consumeChar(":"),t=!1):this.groupIdx++;var e=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:t,value:e};return t&&(r.idx=this.groupIdx),r},t.prototype.positiveInteger=function(){var t=this.popChar();if(!1===o.test(t))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.integerIncludingZero=function(){var t=this.popChar();if(!1===n.test(t))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.patternCharacter=function(){var t=this.popChar();switch(t){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(t)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},t.prototype.isDigit=function(){return n.test(this.peekChar(0))},t.prototype.isClassAtom=function(t){switch(void 0===t&&(t=0),this.peekChar(t)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},t.prototype.isQuantifier=function(){var t=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(t)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(t){for(var e="",n=0;n<t;n++){var o=this.popChar();if(!1===r.test(o))throw Error("Expecting a HexDecimal digits");e+=o}return{type:"Character",value:parseInt(e,16)}},t.prototype.peekChar=function(t){return void 0===t&&(t=0),this.input[this.idx+t]},t.prototype.popChar=function(){var t=this.peekChar(0);return this.consumeChar(),t},t.prototype.consumeChar=function(t){if(void 0!==t&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(t){return{begin:t,end:this.idx}};var e,r=/[0-9a-fA-F]/,n=/[0-9]/,o=/[1-9]/;function a(t){return t.charCodeAt(0)}function i(t,e){void 0!==t.length?t.forEach(function(t){e.push(t)}):e.push(t)}function c(t,e){if(!0===t[e])throw"duplicate flag "+e;t[e]=!0}function u(t){if(void 0===t)throw Error("Internal Error - Should never get here!")}var s=[];for(e=a("0");e<=a("9");e++)s.push(e);var l=[a("_")].concat(s);for(e=a("a");e<=a("z");e++)l.push(e);for(e=a("A");e<=a("Z");e++)l.push(e);var f=[a(" "),a("\f"),a("\n"),a("\r"),a("	"),a("\v"),a("	"),a("\xa0"),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a("\u2028"),a("\u2029"),a(" "),a(" "),a("　"),a("\uFEFF")];function h(){}return h.prototype.visitChildren=function(t){for(var e in t){var r=t[e];t.hasOwnProperty(e)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach(function(t){this.visit(t)},this))}},h.prototype.visit=function(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t)}this.visitChildren(t)},h.prototype.visitPattern=function(t){},h.prototype.visitFlags=function(t){},h.prototype.visitDisjunction=function(t){},h.prototype.visitAlternative=function(t){},h.prototype.visitStartAnchor=function(t){},h.prototype.visitEndAnchor=function(t){},h.prototype.visitWordBoundary=function(t){},h.prototype.visitNonWordBoundary=function(t){},h.prototype.visitLookahead=function(t){},h.prototype.visitNegativeLookahead=function(t){},h.prototype.visitCharacter=function(t){},h.prototype.visitSet=function(t){},h.prototype.visitGroup=function(t){},h.prototype.visitGroupBackReference=function(t){},h.prototype.visitQuantifier=function(t){},{RegExpParser:t,BaseRegExpVisitor:h,VERSION:"0.5.0"}})?r.apply(e,n):r)&&(t.exports=o)},12599:function(t,e){"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function r(t,e){var r=t.length;for(t.push(e);0<r;){var n=r-1>>>1,o=t[n];if(0<a(o,e))t[n]=e,t[r]=o,r=n;else break}}function n(t){return 0===t.length?null:t[0]}function o(t){if(0===t.length)return null;var e=t[0],r=t.pop();if(r!==e){t[0]=r;for(var n=0,o=t.length,i=o>>>1;n<i;){var c=2*(n+1)-1,u=t[c],s=c+1,l=t[s];if(0>a(u,r))s<o&&0>a(l,u)?(t[n]=l,t[s]=r,n=s):(t[n]=u,t[c]=r,n=c);else if(s<o&&0>a(l,r))t[n]=l,t[s]=r,n=s;else break}}return e}function a(t,e){var r=t.sortIndex-e.sortIndex;return 0!==r?r:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var i,c=performance;e.unstable_now=function(){return c.now()}}else{var u=Date,s=u.now();e.unstable_now=function(){return u.now()-s}}var l=[],f=[],h=1,p=null,d=3,m=!1,g=!1,v=!1,E="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,N="undefined"!=typeof setImmediate?setImmediate:null;function R(t){for(var e=n(f);null!==e;){if(null===e.callback)o(f);else if(e.startTime<=t)o(f),e.sortIndex=e.expirationTime,r(l,e);else break;e=n(f)}}function T(t){if(v=!1,R(t),!g){if(null!==n(l))g=!0,L(A);else{var e=n(f);null!==e&&_(T,e.startTime-t)}}}function A(t,r){g=!1,v&&(v=!1,y(O),O=-1),m=!0;var a=d;try{for(R(r),p=n(l);null!==p&&(!(p.expirationTime>r)||t&&!S());){var i=p.callback;if("function"==typeof i){p.callback=null,d=p.priorityLevel;var c=i(p.expirationTime<=r);r=e.unstable_now(),"function"==typeof c?p.callback=c:p===n(l)&&o(l),R(r)}else o(l);p=n(l)}if(null!==p)var u=!0;else{var s=n(f);null!==s&&_(T,s.startTime-r),u=!1}return u}finally{p=null,d=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var M=!1,w=null,O=-1,I=5,C=-1;function S(){return!(e.unstable_now()-C<I)}function b(){if(null!==w){var t=e.unstable_now();C=t;var r=!0;try{r=w(!0,t)}finally{r?i():(M=!1,w=null)}}else M=!1}if("function"==typeof N)i=function(){N(b)};else if("undefined"!=typeof MessageChannel){var U=new MessageChannel,x=U.port2;U.port1.onmessage=b,i=function(){x.postMessage(null)}}else i=function(){E(b,0)};function L(t){w=t,M||(M=!0,i())}function _(t,r){O=E(function(){t(e.unstable_now())},r)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,L(A))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var r=d;d=e;try{return t()}finally{d=r}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var r=d;d=t;try{return e()}finally{d=r}},e.unstable_scheduleCallback=function(t,o,a){var i=e.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?i+a:i,t){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return c=a+c,t={id:h++,callback:o,priorityLevel:t,startTime:a,expirationTime:c,sortIndex:-1},a>i?(t.sortIndex=a,r(f,t),null===n(l)&&t===n(f)&&(v?(y(O),O=-1):v=!0,_(T,a-i))):(t.sortIndex=c,r(l,t),g||m||(g=!0,L(A))),t},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(t){var e=d;return function(){var r=d;d=e;try{return t.apply(this,arguments)}finally{d=r}}}},27494:function(t,e,r){"use strict";t.exports=r(12599)},56800:function(t,e){var r;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var t="",e=0;e<arguments.length;e++){var r=arguments[e];r&&(t=a(t,function(t){if("string"==typeof t||"number"==typeof t)return t;if("object"!=typeof t)return"";if(Array.isArray(t))return o.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var e="";for(var r in t)n.call(t,r)&&t[r]&&(e=a(e,r));return e}(r)))}return t}function a(t,e){return e?t?t+" "+e:t+e:t}t.exports?(o.default=o,t.exports=o):void 0!==(r=(function(){return o}).apply(e,[]))&&(t.exports=r)}()},44458:function(t,e,r){"use strict";r.d(e,{Ee:function(){return E},NY:function(){return y},fC:function(){return v}});var n=r(22988),o=r(2265),a=r(98324),i=r(75137),c=r(1336),u=r(25171);let s="Avatar",[l,f]=(0,a.b)(s),[h,p]=l(s),d=(0,o.forwardRef)((t,e)=>{let{__scopeAvatar:r,...a}=t,[i,c]=(0,o.useState)("idle");return(0,o.createElement)(h,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:c},(0,o.createElement)(u.WV.span,(0,n.Z)({},a,{ref:e})))}),m=(0,o.forwardRef)((t,e)=>{let{__scopeAvatar:r,src:a,onLoadingStatusChange:s=()=>{},...l}=t,f=p("AvatarImage",r),h=function(t){let[e,r]=(0,o.useState)("idle");return(0,c.b)(()=>{if(!t){r("error");return}let e=!0,n=new window.Image,o=t=>()=>{e&&r(t)};return r("loading"),n.onload=o("loaded"),n.onerror=o("error"),n.src=t,()=>{e=!1}},[t]),e}(a),d=(0,i.W)(t=>{s(t),f.onImageLoadingStatusChange(t)});return(0,c.b)(()=>{"idle"!==h&&d(h)},[h,d]),"loaded"===h?(0,o.createElement)(u.WV.img,(0,n.Z)({},l,{ref:e,src:a})):null}),g=(0,o.forwardRef)((t,e)=>{let{__scopeAvatar:r,delayMs:a,...i}=t,c=p("AvatarFallback",r),[s,l]=(0,o.useState)(void 0===a);return(0,o.useEffect)(()=>{if(void 0!==a){let t=window.setTimeout(()=>l(!0),a);return()=>window.clearTimeout(t)}},[a]),s&&"loaded"!==c.imageLoadingStatus?(0,o.createElement)(u.WV.span,(0,n.Z)({},i,{ref:e})):null}),v=d,E=m,y=g}}]);