(()=>{var e={};e.id=590,e.ids=[590],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},71327:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>f,pages:()=>l,routeModule:()=>p,tree:()=>u}),r(74283),r(2525),r(35866);var n=r(23191),o=r(88716),a=r(37922),i=r.n(a),s=r(95231),c={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>s[e]);r.d(t,c);let u=["",{children:["financial_research_agent",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,74283)),"C:\\Users\\Daniyal\\Desktop\\final\\marketplace_kareai\\src\\app\\financial_research_agent\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,2525)),"C:\\Users\\Daniyal\\Desktop\\final\\marketplace_kareai\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["C:\\Users\\Daniyal\\Desktop\\final\\marketplace_kareai\\src\\app\\financial_research_agent\\page.tsx"],f="/financial_research_agent/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/financial_research_agent/page",pathname:"/financial_research_agent",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},5617:(e,t,r)=>{Promise.resolve().then(r.bind(r,14887))},92629:e=>{let t="ศูนย์บาทถ้วน",r=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],n=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];function o(e){let t="",a=e.length;if(a>7){let t=a-7+1,r=e.slice(0,t),n=e.slice(t);return o(r)+"ล้าน"+o(n)}for(let o=0;o<a;o++){let i=e[o];i>0&&(t+=r[i]+n[a-o-1])}return t}function a(e){let t=e;return(t=(t=t.replace("หนึ่งสิบ","สิบ")).replace("สองสิบ","ยี่สิบ")).length>5&&t.length-t.lastIndexOf("หนึ่ง")==5&&(t=t.substr(0,t.length-5)+"เอ็ด"),t}null!=e.exports&&(e.exports=function(e){var r,n;let i=t;if(isNaN(e)||e>=Number.MAX_SAFE_INTEGER)return i;let s=Math.floor(e).toString(),c=Math.round(e%1*100).toString(),u=Array.from(s).map(Number),l=Array.from(c).map(Number),f=o(u),h=o(l);return f=a(f),h=a(h),r=f,n=h,i=""===r&&""===n?t:""!==r&&""===n?r+"บาทถ้วน":""===r&&""!==n?n+"สตางค์":r+"บาท"+n+"สตางค์"})},51198:(e,t)=>{!function(e){"undefined"==typeof DO_NOT_EXPORT_BESSEL?e(t):e({})}(function(e){e.version="1.0.2";var t,r,n,o,a,i,s,c,u,l,f,h,p,d,m,v,g=Math;function E(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function y(e,t,r,n,o){if(0===t)return r;if(1===t)return n;for(var a=2/e,i=n,s=1;s<t;++s)i=n*s*a+o*r,r=n,n=i;return i}function N(e,t,r,n,o){return function(r,a){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}if(0===a)return e(r);if(1===a)return t(r);if(a<0)return NaN;a|=0;var i=e(r),s=t(r);return y(r,a,i,s,o)}}var R=function(){var e=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-.000002073370639,2093887211e-16].reverse(),n=[-.01562499995,1430488765e-13,-.000006911147651,7621095161e-16,-.0000000934935152].reverse();function o(o){var a=0,i=0,s=0,c=o*o;if(o<8)a=(i=E(e,c))/(s=E(t,c));else{var u=o-.785398164;i=E(r,c=64/c),s=E(n,c),a=g.sqrt(.636619772/o)*(g.cos(u)*i-g.sin(u)*s*8/o)}return a}var a=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),i=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-.00003516396496,2457520174e-15,-.000000240337019].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-.00000088228987,105787412e-15].reverse();function u(e){var t=0,r=0,n=0,o=e*e,u=g.abs(e)-2.356194491;return 8>Math.abs(e)?t=(r=e*E(a,o))/(n=E(i,o)):(r=E(s,o=64/o),n=E(c,o),t=g.sqrt(.636619772/g.abs(e))*(g.cos(u)*r-g.sin(u)*n*8/g.abs(e)),e<0&&(t=-t)),t}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return o(t);if(1===r)return u(t);if(0===t)return 0;var n=0;if(t>r)n=y(t,r,o(t),u(t),-1);else{for(var a=2*g.floor((r+g.floor(g.sqrt(40*r)))/2),i=!1,s=0,c=0,l=1,f=0,h=2/t,p=a;p>0;p--)f=p*h*l-s,s=l,l=f,g.abs(l)>1e10&&(l*=1e-10,s*=1e-10,n*=1e-10,c*=1e-10),i&&(c+=l),i=!i,p==r&&(n=s);n/=c=2*c-l}return n}}(),A=(t=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),r=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-.000002073370639,2093887211e-16].reverse(),o=[-.01562499995,1430488765e-13,-.000006911147651,7621095161e-16,-.0000000934945152].reverse(),a=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),i=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),s=[1,.00183105,-.00003516396496,2457520174e-15,-.000000240337019].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-.00000088228987,105787412e-15].reverse(),N(function(e){var a=0,i=0,s=0,c=e*e,u=e-.785398164;return e<8?a=(i=E(t,c))/(s=E(r,c))+.636619772*R(e,0)*g.log(e):(i=E(n,c=64/c),s=E(o,c),a=g.sqrt(.636619772/e)*(g.sin(u)*i+g.cos(u)*s*8/e)),a},function(e){var t=0,r=0,n=0,o=e*e,u=e-2.356194491;return e<8?t=(r=e*E(a,o))/(n=E(i,o))+.636619772*(R(e,1)*g.log(e)-1/e):(r=E(s,o=64/o),n=E(c,o),t=g.sqrt(.636619772/e)*(g.sin(u)*r+g.cos(u)*n*8/e)),t},"BESSELY",1,-1)),T=(u=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),l=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),f=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),h=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,r){if(0===(r=Math.round(r)))return t<=3.75?E(u,t*t/14.0625):g.exp(g.abs(t))/g.sqrt(g.abs(t))*E(l,3.75/g.abs(t));if(1===r)return t<3.75?t*E(f,t*t/14.0625):(t<0?-1:1)*g.exp(g.abs(t))/g.sqrt(g.abs(t))*E(h,3.75/g.abs(t));if(r<0)return NaN;if(0===g.abs(t))return 0;if(t==1/0)return 1/0;var n,o=0,a=2/g.abs(t),i=0,s=1,c=0;for(n=2*g.round((r+g.round(g.sqrt(40*r)))/2);n>0;n--)c=n*a*s+i,i=s,s=c,g.abs(s)>1e10&&(s*=1e-10,i*=1e-10,o*=1e-10),n==r&&(o=i);return o*=e(t,0)/s,t<0&&r%2?-o:o}),M=(p=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),d=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),m=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-.00004686].reverse(),v=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-.00068245].reverse(),N(function(e){return e<=2?-g.log(e/2)*T(e,0)+E(p,e*e/4):g.exp(-e)/g.sqrt(e)*E(d,2/e)},function(e){return e<=2?g.log(e/2)*T(e,1)+1/e*E(m,e*e/4):g.exp(-e)/g.sqrt(e)*E(v,2/e)},"BESSELK",2,1));e.besselj=R,e.bessely=A,e.besseli=T,e.besselk=M})},75490:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Alternation:()=>eN,Alternative:()=>ed,CstParser:()=>tZ,EMPTY_ALT:()=>tX,EOF:()=>es,EarlyExitException:()=>tv,EmbeddedActionsParser:()=>tJ,GAstVisitor:()=>eO,Lexer:()=>q,LexerDefinitionErrorType:()=>n,MismatchedTokenException:()=>tp,NoViableAltException:()=>td,NonTerminal:()=>eh,NotAllInputParsedException:()=>tm,Option:()=>em,Parser:()=>t8,ParserDefinitionErrorType:()=>i,Repetition:()=>eE,RepetitionMandatory:()=>ev,RepetitionMandatoryWithSeparator:()=>eg,RepetitionWithSeparator:()=>ey,Rule:()=>ep,Terminal:()=>eR,VERSION:()=>s,assignOccurrenceIndices:()=>to,clearCache:()=>t9,createSyntaxDiagramsCode:()=>t0,createToken:()=>ea,createTokenInstance:()=>ec,defaultGrammarResolverErrorProvider:()=>eD,defaultGrammarValidatorErrorProvider:()=>eB,defaultLexerErrorProvider:()=>W,defaultParserErrorProvider:()=>eP,generateParserFactory:()=>t6,generateParserModule:()=>t7,isRecognitionException:()=>tf,resolveGrammar:()=>tr,serializeGrammar:()=>eA,serializeProduction:()=>eT,tokenLabel:()=>K,tokenMatcher:()=>eu,tokenName:()=>z,validateGrammar:()=>tn});var n,o,a,i,s="7.1.2",c=r(76785),u=r(25975),l={},f=new u.RegExpParser;function h(e){var t=e.toString();if(l.hasOwnProperty(t))return l[t];var r=f.pattern(t);return l[t]=r,r}var p=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d="Complement Sets are not supported for first char optimization",m='Unable to use "first char" lexer optimizations:\n';function v(e,t,r){var n=k(e);t[n]=n,!0===r&&function(e,t){var r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){var o=k(n.charCodeAt(0));t[o]=o}else{var a=r.toLowerCase();if(a!==r){var o=k(a.charCodeAt(0));t[o]=o}}}(e,t)}function g(e,t){return(0,c.sE)(e.value,function(e){return"number"==typeof e?(0,c.r3)(t,e):void 0!==(0,c.sE)(t,function(t){return e.from<=t&&t<=e.to})})}var E=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return p(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){(0,c.r3)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===g(e,this.targetCharCodes)&&(this.found=!0):void 0!==g(e,this.targetCharCodes)&&(this.found=!0)},t}(u.BaseRegExpVisitor);function y(e,t){if(!(t instanceof RegExp))return void 0!==(0,c.sE)(t,function(t){return(0,c.r3)(e,t.charCodeAt(0))});var r=h(t),n=new E(e);return n.visit(r),n.found}var N=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R="PATTERN",A="defaultMode",T="modes",M="boolean"==typeof RegExp("(?:)").sticky,w=/[^\\][\$]/,O=/[^\\[][\^]|^\^/;function I(e){var t=e.ignoreCase?"i":"";return RegExp("^(?:"+e.source+")",t)}function b(e){var t=e.ignoreCase?"iy":"y";return RegExp(""+e.source,t)}function C(e){var t=e.PATTERN;if((0,c.Kj)(t))return!1;if((0,c.mf)(t)||(0,c.e$)(t,"exec"))return!0;if((0,c.HD)(t))return!1;throw Error("non exhaustive match")}function x(e){return!!(0,c.HD)(e)&&1===e.length&&e.charCodeAt(0)}var S={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function U(e,t){if((0,c.e$)(e,"LINE_BREAKS"))return!1;if((0,c.Kj)(e.PATTERN)){try{y(t,e.PATTERN)}catch(e){return{issue:n.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if((0,c.HD)(e.PATTERN))return!1;if(C(e))return{issue:n.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function _(e){return(0,c.UI)(e,function(e){return(0,c.HD)(e)&&e.length>0?e.charCodeAt(0):e})}function L(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}function k(e){return e<256?e:P[e]}var P=[];function D(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function B(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var F=1,j={};function G(e){var t=function(e){for(var t=(0,c.Qw)(e),r=e,n=!0;n;){r=(0,c.oA)((0,c.xH)((0,c.UI)(r,function(e){return e.CATEGORIES})));var o=(0,c.e5)(r,t);t=t.concat(o),(0,c.xb)(o)?n=!1:r=o}return t}(e);(0,c.Ed)(t,function(e){V(e)||(j[F]=e,e.tokenTypeIdx=F++),$(e)&&!(0,c.kJ)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),$(e)||(e.CATEGORIES=[]),(0,c.e$)(e,"categoryMatches")||(e.categoryMatches=[]),(0,c.e$)(e,"categoryMatchesMap")||(e.categoryMatchesMap={})}),(0,c.Ed)(t,function(e){(function e(t,r){(0,c.Ed)(t,function(e){r.categoryMatchesMap[e.tokenTypeIdx]=!0}),(0,c.Ed)(r.CATEGORIES,function(n){var o=t.concat(r);(0,c.r3)(o,n)||e(o,n)})})([],e)}),(0,c.Ed)(t,function(e){e.categoryMatches=[],(0,c.Ed)(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(j[r].tokenTypeIdx)})}),(0,c.Ed)(t,function(e){e.isParent=e.categoryMatches.length>0})}function V(e){return(0,c.e$)(e,"tokenTypeIdx")}function $(e){return(0,c.e$)(e,"CATEGORIES")}function H(e){return(0,c.e$)(e,"tokenTypeIdx")}var W={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,o){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}};!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(n||(n={}));var Y={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:W,traceInitPerf:!1,skipValidations:!1};Object.freeze(Y);var q=function(){function e(e,t){var r=this;if(void 0===t&&(t=Y),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,c.TS)(Y,t);var o=this.config.traceInitPerf;!0===o?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof o&&(this.traceInitMaxIdent=o,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var o,a=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===Y.lineTerminatorsPattern)r.config.lineTerminatorsPattern=S;else if(r.config.lineTerminatorCharacters===Y.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),(0,c.kJ)(e)?((o={modes:{}}).modes[A]=(0,c.Qw)(e),o[A]=A):(a=!1,o=(0,c.Cl)(e))}),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",function(){var e,t;r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat((e=o,r.trackStartLines,r.config.lineTerminatorCharacters,t=[],(0,c.e$)(e,A)||t.push({message:"A MultiMode Lexer cannot be initialized without a <"+A+"> property in its definition\n",type:n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,c.e$)(e,T)||t.push({message:"A MultiMode Lexer cannot be initialized without a <"+T+"> property in its definition\n",type:n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,c.e$)(e,T)&&(0,c.e$)(e,A)&&!(0,c.e$)(e.modes,e.defaultMode)&&t.push({message:"A MultiMode Lexer cannot be initialized with a "+A+": <"+e.defaultMode+">which does not exist\n",type:n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,c.e$)(e,T)&&(0,c.Ed)(e.modes,function(e,r){(0,c.Ed)(e,function(e,o){(0,c.o8)(e)&&t.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+r+"> at index: <"+o+">\n",type:n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),t))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){var e,t,a,i,s,u,l,f;r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat((e=o,t=r.trackStartLines,a=r.config.lineTerminatorCharacters,i=[],s=!1,u=(0,c.oA)((0,c.xH)((0,c.Q8)(e.modes,function(e){return e}))),l=(0,c.d1)(u,function(e){return e[R]===q.NA}),f=_(a),t&&(0,c.Ed)(l,function(e){var t=U(e,f);if(!1!==t){var r={message:function(e,t){if(t.issue===n.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n	The problem is in the <"+e.name+"> Token Type\n	 Root cause: "+t.errMsg+".\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===n.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n	The problem is in the <"+e.name+"> Token Type\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(e,t),type:t.issue,tokenType:e};i.push(r)}else(0,c.e$)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(s=!0):y(f,e.PATTERN)&&(s=!0)}),t&&!s&&i.push({message:"Warning: No LINE_BREAKS Found.\n	This Lexer has been defined to track line and column information,\n	But none of the Token Types can be identified as matching a line terminator.\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n	for details.",type:n.NO_LINE_BREAKS_FLAGS}),i))})),o.modes=o.modes?o.modes:{},(0,c.Ed)(o.modes,function(e,t){o.modes[t]=(0,c.d1)(e,function(e){return(0,c.o8)(e)})});var i=(0,c.XP)(o.modes);if((0,c.Ed)(o.modes,function(e,o){r.TRACE_INIT("Mode: <"+o+"> processing",function(){if(r.modes.push(o),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",function(){var t,o,a,s,l,f,p,d,m,v,g,E,y,A,T,M,I,b,C,x,S,U;r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat((t=[],l=(0,c.hX)(e,function(e){return!(0,c.e$)(e,R)}),o={errors:(0,c.UI)(l,function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:n.MISSING_PATTERN,tokenTypes:[e]}}),valid:(0,c.e5)(e,l)},t=t.concat(o.errors),s=(f=o.valid,p=(0,c.hX)(f,function(e){var t=e[R];return!(0,c.Kj)(t)&&!(0,c.mf)(t)&&!(0,c.e$)(t,"exec")&&!(0,c.HD)(t)}),a={errors:(0,c.UI)(p,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:n.INVALID_PATTERN,tokenTypes:[e]}}),valid:(0,c.e5)(f,p)}).valid,t=(t=(t=(t=(t=t.concat(a.errors)).concat((d=[],m=(0,c.hX)(s,function(e){return(0,c.Kj)(e[R])}),(d=(d=(d=(d=d.concat((v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return N(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(u.BaseRegExpVisitor),g=(0,c.hX)(m,function(e){var t=e[R];try{var r=h(t),n=new v;return n.visit(r),n.found}catch(e){return w.test(t.source)}}),(0,c.UI)(g,function(e){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:n.EOI_ANCHOR_FOUND,tokenTypes:[e]}})))).concat((E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return N(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(u.BaseRegExpVisitor),y=(0,c.hX)(m,function(e){var t=e[R];try{var r=h(t),n=new E;return n.visit(r),n.found}catch(e){return O.test(t.source)}}),(0,c.UI)(y,function(e){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:n.SOI_ANCHOR_FOUND,tokenTypes:[e]}})))).concat((A=(0,c.hX)(m,function(e){var t=e[R];return t instanceof RegExp&&(t.multiline||t.global)}),(0,c.UI)(A,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:n.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}})))).concat((T=[],M=(0,c.UI)(m,function(e){return(0,c.u4)(m,function(t,r){return e.PATTERN.source!==r.PATTERN.source||(0,c.r3)(T,r)||r.PATTERN===q.NA||(T.push(r),t.push(r)),t},[])}),M=(0,c.oA)(M),I=(0,c.hX)(M,function(e){return e.length>1}),(0,c.UI)(I,function(e){var t=(0,c.UI)(e,function(e){return e.name});return{message:"The same RegExp pattern ->"+(0,c.Ps)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:n.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}})))).concat((b=(0,c.hX)(m,function(e){return e[R].test("")}),(0,c.UI)(b,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:n.EMPTY_MATCH_PATTERN,tokenTypes:[e]}})))))).concat((C=(0,c.hX)(s,function(e){if(!(0,c.e$)(e,"GROUP"))return!1;var t=e.GROUP;return t!==q.SKIPPED&&t!==q.NA&&!(0,c.HD)(t)}),(0,c.UI)(C,function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:n.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}})))).concat((x=(0,c.hX)(s,function(e){return void 0!==e.PUSH_MODE&&!(0,c.r3)(i,e.PUSH_MODE)}),(0,c.UI)(x,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:n.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}})))).concat((S=[],U=(0,c.u4)(s,function(e,t,r){var n=t.PATTERN;return n===q.NA||((0,c.HD)(n)?e.push({str:n,idx:r,tokenType:t}):(0,c.Kj)(n)&&void 0===(0,c.sE)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],function(e){return -1!==n.source.indexOf(e)})&&e.push({str:n.source,idx:r,tokenType:t})),e},[]),(0,c.Ed)(s,function(e,t){(0,c.Ed)(U,function(r){var o=r.str,a=r.idx,i=r.tokenType;if(t<a&&function(e,t){if((0,c.Kj)(t)){var r=t.exec(e);return null!==r&&0===r.index}if((0,c.mf)(t))return t(e,0,[],{});if((0,c.e$)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(o,e.PATTERN)){var s="Token: ->"+i.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE";S.push({message:s,type:n.UNREACHABLE_PATTERN,tokenTypes:[e,i]})}})}),S))))}),(0,c.xb)(r.lexerDefinitionErrors)){var a;G(e),r.TRACE_INIT("analyzeTokenTypes",function(){var n,o,i,s,l,f,p,g,E,N,A,T,w,O,S,D,B;n={lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)},(O=(n=(0,c.ce)(n,{useSticky:M,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer)("initCharCodeToOptimizedIndexMap",function(){(function(){if((0,c.xb)(P)){P=Array(65536);for(var e=0;e<65536;e++)P[e]=e>255?255+~~(e/255):e}})()}),O("Reject Lexer.NA",function(){o=(0,c.d1)(e,function(e){return e[R]===q.NA})}),S=!1,O("Transform Patterns",function(){S=!1,i=(0,c.UI)(o,function(e){var t=e[R];if((0,c.Kj)(t)){var r=t.source;return 1!==r.length||"^"===r||"$"===r||"."===r||t.ignoreCase?2!==r.length||"\\"!==r[0]||(0,c.r3)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?n.useSticky?b(t):I(t):r[1]:r}if((0,c.mf)(t))return S=!0,{exec:t};if((0,c.e$)(t,"exec"))return S=!0,t;if("string"==typeof t){if(1===t.length)return t;var o=new RegExp(t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"));return n.useSticky?b(o):I(o)}throw Error("non exhaustive match")})}),O("misc mapping",function(){s=(0,c.UI)(o,function(e){return e.tokenTypeIdx}),l=(0,c.UI)(o,function(e){var t=e.GROUP;if(t!==q.SKIPPED){if((0,c.HD)(t))return t;if((0,c.o8)(t))return!1;throw Error("non exhaustive match")}}),f=(0,c.UI)(o,function(e){var t=e.LONGER_ALT;if(t)return(0,c.cq)(o,t)}),p=(0,c.UI)(o,function(e){return e.PUSH_MODE}),g=(0,c.UI)(o,function(e){return(0,c.e$)(e,"POP_MODE")})}),O("Line Terminator Handling",function(){var e=_(n.lineTerminatorCharacters);E=(0,c.UI)(o,function(e){return!1}),"onlyOffset"!==n.positionTracking&&(E=(0,c.UI)(o,function(t){return(0,c.e$)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===U(t,e)?y(e,t.PATTERN):void 0}))}),O("Misc Mapping #2",function(){N=(0,c.UI)(o,C),A=(0,c.UI)(i,x),T=(0,c.u4)(o,function(e,t){var r=t.GROUP;return(0,c.HD)(r)&&r!==q.SKIPPED&&(e[r]=[]),e},{}),w=(0,c.UI)(i,function(e,t){return{pattern:i[t],longerAlt:f[t],canLineTerminator:E[t],isCustom:N[t],short:A[t],group:l[t],push:p[t],pop:g[t],tokenTypeIdx:s[t],tokenType:o[t]}})}),D=!0,B=[],n.safeMode||O("First Char Optimization",function(){B=(0,c.u4)(o,function(e,t,r){if("string"==typeof t.PATTERN){var o;L(e,k(t.PATTERN.charCodeAt(0)),w[r])}else if((0,c.kJ)(t.START_CHARS_HINT))(0,c.Ed)(t.START_CHARS_HINT,function(t){var n=k("string"==typeof t?t.charCodeAt(0):t);o!==n&&(o=n,L(e,n,w[r]))});else if((0,c.Kj)(t.PATTERN)){if(t.PATTERN.unicode)D=!1,n.ensureOptimizations&&(0,c.WB)(""+m+"	Unable to analyze < "+t.PATTERN.toString()+" > pattern.\n	The regexp unicode flag is not currently supported by the regexp-to-ast library.\n	This will disable the lexer's first char optimizations.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var a=function(e,t){void 0===t&&(t=!1);try{var r=h(e);return function e(t,r,n){switch(t.type){case"Disjunction":for(var o=0;o<t.value.length;o++)e(t.value[o],r,n);break;case"Alternative":for(var a=t.value,o=0;o<a.length;o++){var i=a[o];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}switch(i.type){case"Character":v(i.value,r,n);break;case"Set":if(!0===i.complement)throw Error(d);(0,c.Ed)(i.value,function(e){if("number"==typeof e)v(e,r,n);else if(!0===n)for(var t=e.from;t<=e.to;t++)v(t,r,n);else{for(var t=e.from;t<=e.to&&t<256;t++)v(t,r,n);if(e.to>=256)for(var o=e.from>=256?e.from:256,a=e.to,i=k(o),s=k(a),c=i;c<=s;c++)r[c]=c}});break;case"Group":e(i.value,r,n);break;default:throw Error("Non Exhaustive Match")}var s=void 0!==i.quantifier&&0===i.quantifier.atLeast;if("Group"===i.type&&!1===function e(t){return!!t.quantifier&&0===t.quantifier.atLeast||!!t.value&&((0,c.kJ)(t.value)?(0,c.yW)(t.value,e):e(t.value))}(i)||"Group"!==i.type&&!1===s)break}break;default:throw Error("non exhaustive match!")}return(0,c.VO)(r)}(r.value,{},r.flags.ignoreCase)}catch(r){if(r.message===d)t&&(0,c.rr)(""+m+"	Unable to optimize: < "+e.toString()+" >\n	Complement Sets cannot be automatically optimized.\n	This will disable the lexer's first char optimizations.\n	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";t&&(n="\n	This will disable the lexer's first char optimizations.\n	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),(0,c.WB)(m+"\n	Failed parsing: < "+e.toString()+" >\n	Using the regexp-to-ast library version: "+u.VERSION+"\n	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}(t.PATTERN,n.ensureOptimizations);(0,c.xb)(a)&&(D=!1),(0,c.Ed)(a,function(t){L(e,t,w[r])})}}else n.ensureOptimizations&&(0,c.WB)(""+m+"	TokenType: <"+t.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n	This will disable the lexer's first char optimizations.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),D=!1;return e},[])}),O("ArrayPacking",function(){B=(0,c.X0)(B)}),a={emptyGroups:T,patternIdxToConfig:w,charCodeToPatternIdxToConfig:B,hasCustom:S,canBeOptimized:D}}),r.patternIdxToConfig[o]=a.patternIdxToConfig,r.charCodeToPatternIdxToConfig[o]=a.charCodeToPatternIdxToConfig,r.emptyGroups=(0,c.TS)(r.emptyGroups,a.emptyGroups),r.hasCustom=a.hasCustom||r.hasCustom,r.canModeBeOptimized[o]=a.canBeOptimized}})}),r.defaultMode=o.defaultMode,!(0,c.xb)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling)throw Error("Errors detected in definition of Lexer:\n"+(0,c.UI)(r.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"));(0,c.Ed)(r.lexerDefinitionWarning,function(e){(0,c.rr)(e.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(M?(r.chopInput=c.Wd,r.match=r.matchWithTest):(r.updateLastIndex=c.dG,r.match=r.matchWithExec),a&&(r.handleModes=c.dG),!1===r.trackStartLines&&(r.computeNewColumn=c.Wd),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=c.dG),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var e=(0,c.u4)(r.canModeBeOptimized,function(e,t,r){return!1===t&&e.push(r),e},[]);if(t.ensureOptimizations&&!(0,c.xb)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n	 Or inspect the console log for details on how to resolve these issues.')}),r.TRACE_INIT("clearRegExpParserCache",function(){l={}}),r.TRACE_INIT("toFastProperties",function(){(0,c.SV)(r)})})}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!(0,c.xb)(this.lexerDefinitionErrors))throw Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+(0,c.UI)(this.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"));return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var r,n,o,a,i,s,u,l,f,h,p,d,m,v,g,E,y,N,R=this,A=e,T=A.length,M=0,w=0,O=Array(this.hasCustom?0:Math.floor(e.length/10)),I=[],b=this.trackStartLines?1:void 0,C=this.trackStartLines?1:void 0,x=(r=this.emptyGroups,n={},o=(0,c.XP)(r),(0,c.Ed)(o,function(e){var t=r[e];if((0,c.kJ)(t))n[e]=[];else throw Error("non exhaustive match")}),n),S=this.trackStartLines,U=this.config.lineTerminatorsPattern,_=0,L=[],P=[],D=[],B=[];Object.freeze(B);var F=void 0;function j(){return L}function G(e){var t=P[k(e)];return void 0===t?B:t}var V=function(e){if(1===D.length&&void 0===e.tokenType.PUSH_MODE){var t=R.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);I.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{D.pop();var r=(0,c.Z$)(D);L=R.patternIdxToConfig[r],P=R.charCodeToPatternIdxToConfig[r],_=L.length;var n=R.canModeBeOptimized[r]&&!1===R.config.safeMode;F=P&&n?G:j}};function $(e){D.push(e),P=this.charCodeToPatternIdxToConfig[e],_=(L=this.patternIdxToConfig[e]).length,_=L.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;F=P&&t?G:j}for($.call(this,t);M<T;){l=null;var H=A.charCodeAt(M),W=F(H),Y=W.length;for(a=0;a<Y;a++){var q=(N=W[a]).pattern;f=null;var K=N.short;if(!1!==K?H===K&&(l=q):!0===N.isCustom?null!==(y=q.exec(A,M,O,x))?(l=y[0],void 0!==y.payload&&(f=y.payload)):l=null:(this.updateLastIndex(q,M),l=this.match(q,e,M)),null!==l){if(void 0!==(u=N.longerAlt)){var z=L[u],X=z.pattern;h=null,!0===z.isCustom?null!==(y=X.exec(A,M,O,x))?(s=y[0],void 0!==y.payload&&(h=y.payload)):s=null:(this.updateLastIndex(X,M),s=this.match(X,e,M)),s&&s.length>l.length&&(l=s,f=h,N=z)}break}}if(null!==l){if(p=l.length,void 0!==(d=N.group)&&(m=N.tokenTypeIdx,v=this.createTokenInstance(l,M,m,N.tokenType,b,C,p),this.handlePayload(v,f),!1===d?w=this.addToken(O,w,v):x[d].push(v)),e=this.chopInput(e,p),M+=p,C=this.computeNewColumn(C,p),!0===S&&!0===N.canLineTerminator){var Q=0,Z=void 0,J=void 0;U.lastIndex=0;do!0===(Z=U.test(l))&&(J=U.lastIndex-1,Q++);while(!0===Z);0!==Q&&(b+=Q,C=p-J,this.updateTokenEndLineColumnLocation(v,d,J,Q,b,C,p))}this.handleModes(N,V,$,v)}else{for(var ee=M,et=b,er=C,en=!1;!en&&M<T;)for(A.charCodeAt(M),e=this.chopInput(e,1),M++,i=0;i<_;i++){var eo=L[i],q=eo.pattern,K=eo.short;if(!1!==K?A.charCodeAt(M)===K&&(en=!0):!0===eo.isCustom?en=null!==q.exec(A,M,O,x):(this.updateLastIndex(q,M),en=null!==q.exec(e)),!0===en)break}g=M-ee,E=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(A,ee,g,et,er),I.push({offset:ee,line:et,column:er,length:g,message:E})}}return this.hasCustom||(O.length=w),{tokens:O,groups:x,errors:I}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var o=e.push;t(n),void 0!==o&&r.call(this,o)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,o,a,i){var s,c;void 0===t||(c=(s=r===i-1)?-1:0,1===n&&!0===s||(e.endLine=o+c,e.endColumn=a-1+-c))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,o,a){return{image:e,startOffset:t,startLine:o,startColumn:a,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,o,a,i){return{image:e,startOffset:t,endOffset:t+i-1,startLine:o,endLine:o,startColumn:a,endColumn:a+i-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.prototype.TRACE_INIT=function(e,t){if(!0!==this.traceInitPerf)return t();this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var n=(0,c.HT)(t),o=n.time,a=n.value,i=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&i(r+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function K(e){return X(e)?e.LABEL:e.name}function z(e){return e.name}function X(e){return(0,c.HD)(e.LABEL)&&""!==e.LABEL}var Q="categories",Z="label",J="group",ee="push_mode",et="pop_mode",er="longer_alt",en="line_breaks",eo="start_chars_hint";function ea(e){return ei(e)}function ei(e){var t=e.pattern,r={};if(r.name=e.name,(0,c.o8)(t)||(r.PATTERN=t),(0,c.e$)(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,c.e$)(e,Q)&&(r.CATEGORIES=e[Q]),G([r]),(0,c.e$)(e,Z)&&(r.LABEL=e[Z]),(0,c.e$)(e,J)&&(r.GROUP=e[J]),(0,c.e$)(e,et)&&(r.POP_MODE=e[et]),(0,c.e$)(e,ee)&&(r.PUSH_MODE=e[ee]),(0,c.e$)(e,er)&&(r.LONGER_ALT=e[er]),(0,c.e$)(e,en)&&(r.LINE_BREAKS=e[en]),(0,c.e$)(e,eo)&&(r.START_CHARS_HINT=e[eo]),r}var es=ei({name:"EOF",pattern:q.NA});function ec(e,t,r,n,o,a,i,s){return{image:t,startOffset:r,endOffset:n,startLine:o,endLine:a,startColumn:i,endColumn:s,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function eu(e,t){return D(e,t)}G([es]);var el=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ef=function(){function e(e){this._definition=e}return Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e},enumerable:!1,configurable:!0}),e.prototype.accept=function(e){e.visit(this),(0,c.Ed)(this.definition,function(t){t.accept(e)})},e}(),eh=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!1,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(ef),ep=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),t}(ef),ed=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),t}(ef),em=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),t}(ef),ev=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),t}(ef),eg=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),t}(ef),eE=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),t}(ef),ey=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),t}(ef),eN=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,(0,c.f0)(r,(0,c.ei)(t,function(e){return void 0!==e})),r}return el(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e},enumerable:!1,configurable:!0}),t}(ef),eR=function(){function e(e){this.idx=1,(0,c.f0)(this,(0,c.ei)(e,function(e){return void 0!==e}))}return e.prototype.accept=function(e){e.visit(this)},e}();function eA(e){return(0,c.UI)(e,eT)}function eT(e){function t(e){return(0,c.UI)(e,eT)}if(e instanceof eh)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof ed)return{type:"Alternative",definition:t(e.definition)};if(e instanceof em)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof ev)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof eg)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:eT(new eR({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof ey)return{type:"RepetitionWithSeparator",idx:e.idx,separator:eT(new eR({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof eE)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};else if(e instanceof eN)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};else if(e instanceof eR){var r={type:"Terminal",name:e.terminalType.name,label:K(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=(0,c.Kj)(n)?n.source:n),r}else if(e instanceof ep)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};else throw Error("non exhaustive match")}var eM=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),(0,c.Ed)(e.definition,function(n,o){var a=(0,c.Cw)(e.definition,o+1);if(n instanceof eh)r.walkProdRef(n,a,t);else if(n instanceof eR)r.walkTerminal(n,a,t);else if(n instanceof ed)r.walkFlat(n,a,t);else if(n instanceof em)r.walkOption(n,a,t);else if(n instanceof ev)r.walkAtLeastOne(n,a,t);else if(n instanceof eg)r.walkAtLeastOneSep(n,a,t);else if(n instanceof ey)r.walkManySep(n,a,t);else if(n instanceof eE)r.walkMany(n,a,t);else if(n instanceof eN)r.walkOr(n,a,t);else throw Error("non exhaustive match")})},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new em({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=ew(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new em({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=ew(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var n=this,o=t.concat(r);(0,c.Ed)(e.definition,function(e){var t=new ed({definition:[e]});n.walk(t,o)})},e}();function ew(e,t,r){return[new em({definition:[new eR({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}var eO=function(){function e(){}return e.prototype.visit=function(e){switch(e.constructor){case eh:return this.visitNonTerminal(e);case ed:return this.visitAlternative(e);case em:return this.visitOption(e);case ev:return this.visitRepetitionMandatory(e);case eg:return this.visitRepetitionMandatoryWithSeparator(e);case ey:return this.visitRepetitionWithSeparator(e);case eE:return this.visitRepetition(e);case eN:return this.visitAlternation(e);case eR:return this.visitTerminal(e);case ep:return this.visitRule(e);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitAlternative=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}(),eI=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function eb(e,t){return void 0===t&&(t=[]),e instanceof em||e instanceof eE||e instanceof ey||(e instanceof eN?(0,c.G)(e.definition,function(e){return eb(e,t)}):!(e instanceof eh&&(0,c.r3)(t,e))&&e instanceof ef&&(e instanceof eh&&t.push(e),(0,c.yW)(e.definition,function(e){return eb(e,t)})))}function eC(e){if(e instanceof eh)return"SUBRULE";if(e instanceof em)return"OPTION";if(e instanceof eN)return"OR";if(e instanceof ev)return"AT_LEAST_ONE";if(e instanceof eg)return"AT_LEAST_ONE_SEP";if(e instanceof ey)return"MANY_SEP";if(e instanceof eE)return"MANY";else if(e instanceof eR)return"CONSUME";else throw Error("non exhaustive match")}var ex=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return eI(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";(0,c.e$)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";(0,c.e$)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(eO),eS=new ex;function eU(e){if(e instanceof eh)return eU(e.referencedRule);if(e instanceof eR)return[e.terminalType];if(e instanceof ed||e instanceof em||e instanceof eE||e instanceof ev||e instanceof eg||e instanceof ey||e instanceof eR||e instanceof ep)return function(e){for(var t,r=[],n=e.definition,o=0,a=n.length>o,i=!0;a&&i;)i=eb(t=n[o]),r=r.concat(eU(t)),o+=1,a=n.length>o;return(0,c.jj)(r)}(e);if(e instanceof eN){var t;return t=(0,c.UI)(e.definition,function(e){return eU(e)}),(0,c.jj)((0,c.xH)(t))}throw Error("non exhaustive match")}var e_="_~IN~_",eL=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ek=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows={},r}return eL(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n,o,a=(n=e.referencedRule,o=e.idx,n.name+o+e_+this.topProd.name),i=eU(new ed({definition:t.concat(r)}));this.follows[a]=i},t}(eM),eP={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(X(t)?"--> "+K(t)+" <--":"token of type --> "+t.name+" <--")+" but found --> '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,n=(e.previous,e.customUserDescription);e.ruleName;var o="Expecting: ",a="\nbut found: '"+(0,c.Ps)(r).image+"'";if(n)return o+n+a;var i=(0,c.u4)(t,function(e,t){return e.concat(t)},[]),s=(0,c.UI)(i,function(e){return"["+(0,c.UI)(e,function(e){return K(e)}).join(", ")+"]"});return o+"one of these possible Token sequences:\n"+(0,c.UI)(s,function(e,t){return"  "+(t+1)+". "+e}).join("\n")+a},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,n=e.customUserDescription;e.ruleName;var o="Expecting: ",a="\nbut found: '"+(0,c.Ps)(r).image+"'";return n?o+n+a:o+"expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+(0,c.UI)(t,function(e){return"["+(0,c.UI)(e,function(e){return K(e)}).join(",")+"]"}).join(" ,")+">"+a}};Object.freeze(eP);var eD={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},eB={buildDuplicateFoundError:function(e,t){var r=e.name,n=(0,c.Ps)(t),o=n.idx,a=eC(n),i=n instanceof eR?n.terminalType.name:n instanceof eh?n.nonTerminalName:"",s="->"+a+(o>0?o:"")+"<- "+(i?"with argument: ->"+i+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return(s=s.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=(0,c.UI)(e.prefixPath,function(e){return K(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\n"+("in <OR"+r)+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=(0,c.UI)(e.prefixPath,function(e){return K(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=eC(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"deprecated"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+">"+(" in <OR"+e.alternation.idx)+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n"+("<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name)+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name,r=t+" --> "+c.UI(e.leftRecursionPath,function(e){return e.name}).concat([t]).join(" --> ");return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+r+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"deprecated"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof ep?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}},eF=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ej=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return eF(t,e),t.prototype.resolveRefs=function(){var e=this;(0,c.Ed)((0,c.VO)(this.nameToTopRule),function(t){e.currTopLevel=t,t.accept(e)})},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:i.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(eO),eG=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),eV=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return eG(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=new ed({definition:t.concat(r)});this.possibleTokTypes=eU(n),this.found=!0}},t}(function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return eG(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,c.Qw)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,c.Qw)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){(0,c.xb)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(eM)),e$=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return eG(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(eM),eH=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eG(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof eR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(e$),eW=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eG(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof eR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(e$),eY=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eG(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof eR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(e$),eq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return eG(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof eR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(e$);function eK(e,t,r){void 0===r&&(r=[]),r=(0,c.Qw)(r);var n=[],o=0;function a(a){var i=eK(a.concat((0,c.Cw)(e,o+1)),t,r);return n.concat(i)}for(;r.length<t&&o<e.length;){var i=e[o];if(i instanceof ed||i instanceof eh)return a(i.definition);if(i instanceof em)n=a(i.definition);else if(i instanceof ev){var s=i.definition.concat([new eE({definition:i.definition})]);return a(s)}else if(i instanceof eg){var s=[new ed({definition:i.definition}),new eE({definition:[new eR({terminalType:i.separator})].concat(i.definition)})];return a(s)}else if(i instanceof ey){var s=i.definition.concat([new eE({definition:[new eR({terminalType:i.separator})].concat(i.definition)})]);n=a(s)}else if(i instanceof eE){var s=i.definition.concat([new eE({definition:i.definition})]);n=a(s)}else if(i instanceof eN)return(0,c.Ed)(i.definition,function(e){!1===(0,c.xb)(e.definition)&&(n=a(e.definition))}),n;else if(i instanceof eR)r.push(i.terminalType);else throw Error("non exhaustive match");o++}return n.push({partialPath:r,suffixDef:(0,c.Cw)(e,o)}),n}function ez(e,t,r,n){var o="EXIT_NONE_TERMINAL",a=[o],i="EXIT_ALTERNATIVE",s=!1,u=t.length,l=u-n-1,f=[],h=[];for(h.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!(0,c.xb)(h);){var p=h.pop();if(p===i){s&&(0,c.Z$)(h).idx<=l&&h.pop();continue}var d=p.def,m=p.idx,v=p.ruleStack,g=p.occurrenceStack;if(!(0,c.xb)(d)){var E=d[0];if(E===o){var y={idx:m,def:(0,c.Cw)(d),ruleStack:(0,c.j7)(v),occurrenceStack:(0,c.j7)(g)};h.push(y)}else if(E instanceof eR){if(m<u-1){var N=m+1;if(r(t[N],E.terminalType)){var y={idx:N,def:(0,c.Cw)(d),ruleStack:v,occurrenceStack:g};h.push(y)}}else if(m===u-1)f.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:v,occurrenceStack:g}),s=!0;else throw Error("non exhaustive match")}else if(E instanceof eh){var R=(0,c.Qw)(v);R.push(E.nonTerminalName);var A=(0,c.Qw)(g);A.push(E.idx);var y={idx:m,def:E.definition.concat(a,(0,c.Cw)(d)),ruleStack:R,occurrenceStack:A};h.push(y)}else if(E instanceof em){var T={idx:m,def:(0,c.Cw)(d),ruleStack:v,occurrenceStack:g};h.push(T),h.push(i);var M={idx:m,def:E.definition.concat((0,c.Cw)(d)),ruleStack:v,occurrenceStack:g};h.push(M)}else if(E instanceof ev){var w=new eE({definition:E.definition,idx:E.idx}),O=E.definition.concat([w],(0,c.Cw)(d)),y={idx:m,def:O,ruleStack:v,occurrenceStack:g};h.push(y)}else if(E instanceof eg){var I=new eR({terminalType:E.separator}),w=new eE({definition:[I].concat(E.definition),idx:E.idx}),O=E.definition.concat([w],(0,c.Cw)(d)),y={idx:m,def:O,ruleStack:v,occurrenceStack:g};h.push(y)}else if(E instanceof ey){var T={idx:m,def:(0,c.Cw)(d),ruleStack:v,occurrenceStack:g};h.push(T),h.push(i);var I=new eR({terminalType:E.separator}),b=new eE({definition:[I].concat(E.definition),idx:E.idx}),O=E.definition.concat([b],(0,c.Cw)(d)),M={idx:m,def:O,ruleStack:v,occurrenceStack:g};h.push(M)}else if(E instanceof eE){var T={idx:m,def:(0,c.Cw)(d),ruleStack:v,occurrenceStack:g};h.push(T),h.push(i);var b=new eE({definition:E.definition,idx:E.idx}),O=E.definition.concat([b],(0,c.Cw)(d)),M={idx:m,def:O,ruleStack:v,occurrenceStack:g};h.push(M)}else if(E instanceof eN)for(var C=E.definition.length-1;C>=0;C--){var x={idx:m,def:E.definition[C].definition.concat((0,c.Cw)(d)),ruleStack:v,occurrenceStack:g};h.push(x),h.push(i)}else if(E instanceof ed)h.push({idx:m,def:E.definition.concat((0,c.Cw)(d)),ruleStack:v,occurrenceStack:g});else if(E instanceof ep)h.push(function(e,t,r,n){var o=(0,c.Qw)(r);o.push(e.name);var a=(0,c.Qw)(n);return a.push(1),{idx:t,def:e.definition,ruleStack:o,occurrenceStack:a}}(E,m,v,g));else throw Error("non exhaustive match")}}return f}var eX=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(o||(o={}));var eQ=function(e){function t(t,r,n){var o=e.call(this)||this;return o.topProd=t,o.targetOccurrence=r,o.targetProdType=n,o}return eX(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,o.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,o.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,o.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,o.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,o.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(eM),eZ=function(e){function t(t,r,n){var o=e.call(this)||this;return o.targetOccurrence=t,o.targetProdType=r,o.targetRef=n,o.result=[],o}return eX(t,e),t.prototype.checkIsTarget=function(e,t){e.idx===this.targetOccurrence&&this.targetProdType===t&&(void 0===this.targetRef||e===this.targetRef)&&(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,o.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,o.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,o.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,o.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,o.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,o.ALTERNATION)},t}(eO);function eJ(e){for(var t=Array(e),r=0;r<e;r++)t[r]=[];return t}function e0(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],o=[],a=0;a<t.length;a++){var i=t[a];o.push(i+"_"+n.tokenTypeIdx);for(var s=0;s<n.categoryMatches.length;s++){var c="_"+n.categoryMatches[s];o.push(i+c)}}t=o}return t}function e1(e,t){for(var r=(0,c.UI)(e,function(e){return eK([e],1)}),n=eJ(r.length),o=(0,c.UI)(r,function(e){var t={};return(0,c.Ed)(e,function(e){var r=e0(e.partialPath);(0,c.Ed)(r,function(e){t[e]=!0})}),t}),a=r,i=1;i<=t;i++){var s=a;a=eJ(s.length);for(var u=function(e){for(var r=s[e],u=0;u<r.length;u++){var l=r[u].partialPath,f=r[u].suffixDef,h=e0(l);if(function(e,t,r){for(var n=0;n<e.length;n++)if(n!==r){for(var o=e[n],a=0;a<t.length;a++)if(!0===o[t[a]])return!1}return!0}(o,h,e)||(0,c.xb)(f)||l.length===t){var p=n[e];if(!1===e4(p,l)){p.push(l);for(var d=0;d<h.length;d++){var m=h[d];o[e][m]=!0}}}else{var v=eK(f,i+1,l);a[e]=a[e].concat(v),(0,c.Ed)(v,function(t){var r=e0(t.partialPath);(0,c.Ed)(r,function(t){o[e][t]=!0})})}}},l=0;l<s.length;l++)u(l)}return n}function e2(e,t,r,n){var a=new eZ(e,o.ALTERNATION,n);return t.accept(a),e1(a.result,r)}function e3(e,t,r,n){var o=new eZ(e,r);t.accept(o);var a=o.result,i=new eQ(t,e,r).startWalking();return e1([new ed({definition:a}),new ed({definition:i})],n)}function e4(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var o=0;o<n.length;o++){var a=t[o],i=n[o];if(!1==(a===i||void 0!==i.categoryMatchesMap[a.tokenTypeIdx]))continue e}return!0}}return!1}function e5(e){return(0,c.yW)(e,function(e){return(0,c.yW)(e,function(e){return(0,c.yW)(e,function(e){return(0,c.xb)(e.categoryMatches)})})})}var e6=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function e7(e){return eC(e)+"_#_"+e.idx+"_#_"+e9(e)}function e9(e){return e instanceof eR?e.terminalType.name:e instanceof eh?e.nonTerminalName:""}var e8=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return e6(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(eO),te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return e6(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(eO),tt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return e6(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(eO);function tr(e){e=(0,c.ce)(e,{errMsgProvider:eD});var t,r={};return(0,c.Ed)(e.rules,function(e){r[e.name]=e}),(t=new ej(r,e.errMsgProvider)).resolveRefs(),t.errors}function tn(e){var t,r,n,a,s,u,l,f,h,p,d,m,v,g,E;return t=(e=(0,c.ce)(e,{errMsgProvider:eB})).rules,r=e.maxLookahead,n=e.tokenTypes,a=e.errMsgProvider,s=e.grammarName,u=c.UI(t,function(e){return function(e,t){var r=new e8;e.accept(r);var n=r.allProductions,o=c.vM(n,e7),a=c.ei(o,function(e){return e.length>1});return c.UI(c.VO(a),function(r){var n=c.Ps(r),o=t.buildDuplicateFoundError(e,r),a=eC(n),s={message:o,type:i.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:a,occurrence:n.idx},u=e9(n);return u&&(s.parameter=u),s})}(e,a)}),l=c.UI(t,function(e){return function e(t,r,n,o){void 0===o&&(o=[]);var a=[],s=function e(t){var r=[];if(c.xb(t))return r;var n=c.Ps(t);if(n instanceof eh)r.push(n.referencedRule);else if(n instanceof ed||n instanceof em||n instanceof ev||n instanceof eg||n instanceof ey||n instanceof eE)r=r.concat(e(n.definition));else if(n instanceof eN)r=c.xH(c.UI(n.definition,function(t){return e(t.definition)}));else if(n instanceof eR);else throw Error("non exhaustive match");var o=eb(n),a=t.length>1;if(!o||!a)return r;var i=c.Cw(t);return r.concat(e(i))}(r.definition);if(c.xb(s))return[];var u=t.name;c.r3(s,t)&&a.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:o}),type:i.LEFT_RECURSION,ruleName:u});var l=c.e5(s,o.concat([t])),f=c.UI(l,function(r){var a=c.Qw(o);return a.push(r),e(t,r,n,a)});return a.concat(c.xH(f))}(e,e,a)}),f=[],h=[],p=[],(0,c.yW)(l,c.xb)&&(f=(0,c.UI)(t,function(e){return function(e,t){var r=new te;e.accept(r);var n=r.alternations;return c.u4(n,function(r,n){var o=c.j7(n.definition),a=c.UI(o,function(r,o){var a=ez([r],[],null,1);return c.xb(a)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:o}),type:i.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:o+1}:null});return r.concat(c.oA(a))},[])}(e,a)}),h=(0,c.UI)(t,function(e){return function(e,t,r){var n=new te;e.accept(n);var o=n.alternations;return o=(0,c.d1)(o,function(e){return!0===e.ignoreAmbiguities}),c.u4(o,function(n,o){var a,s,u,l,f=e2(o.idx,e,o.maxLookahead||t,o),h=(a=[],s=(0,c.u4)(f,function(e,t,r){return!0===o.definition[r].ignoreAmbiguities||(0,c.Ed)(t,function(t){var n=[r];(0,c.Ed)(f,function(e,a){r!==a&&e4(e,t)&&!0!==o.definition[a].ignoreAmbiguities&&n.push(a)}),n.length>1&&!e4(a,t)&&(a.push(t),e.push({alts:n,path:t}))}),e},[]),c.UI(s,function(t){var n=(0,c.UI)(t.alts,function(e){return e+1});return{message:r.buildAlternationAmbiguityError({topLevelRule:e,alternation:o,ambiguityIndices:n,prefixPath:t.path}),type:i.AMBIGUOUS_ALTS,ruleName:e.name,occurrence:o.idx,alternatives:[t.alts]}})),p=(u=[],l=(0,c.u4)(f,function(e,t,r){var n=(0,c.UI)(t,function(e){return{idx:r,path:e}});return e.concat(n)},[]),(0,c.Ed)(l,function(t){if(!0!==o.definition[t.idx].ignoreAmbiguities){var n=t.idx,a=t.path,s=(0,c.Oq)(l,function(e){var t;return!0!==o.definition[e.idx].ignoreAmbiguities&&e.idx<n&&(t=e.path).length<a.length&&(0,c.yW)(t,function(e,t){var r=a[t];return e===r||r.categoryMatchesMap[e.tokenTypeIdx]})}),f=(0,c.UI)(s,function(t){var a=[t.idx+1,n+1],s=0===o.idx?"":o.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:e,alternation:o,ambiguityIndices:a,prefixPath:t.path}),type:i.AMBIGUOUS_PREFIX_ALTS,ruleName:e.name,occurrence:s,alternatives:a}});u=u.concat(f)}}),u);return n.concat(h,p)},[])}(e,r,a)}),v=[],(0,c.Ed)(t,function(e){var t=new tt;e.accept(t);var n=t.allProductions;(0,c.Ed)(n,function(t){var n=function(e){if(e instanceof em)return o.OPTION;if(e instanceof eE)return o.REPETITION;if(e instanceof ev)return o.REPETITION_MANDATORY;if(e instanceof eg)return o.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof ey)return o.REPETITION_WITH_SEPARATOR;if(e instanceof eN)return o.ALTERNATION;throw Error("non exhaustive match")}(t),s=t.maxLookahead||r,u=e3(t.idx,e,n,s)[0];if((0,c.xb)((0,c.xH)(u))){var l=a.buildEmptyRepetitionError({topLevelRule:e,repetition:t});v.push({message:l,type:i.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}})}),p=v),g=[],E=(0,c.UI)(n,function(e){return e.name}),(0,c.Ed)(t,function(e){var t=e.name;if((0,c.r3)(E,t)){var r=a.buildNamespaceConflictError(e);g.push({message:r,type:i.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}}),d=(0,c.UI)(t,function(e){return function(e,t){var r=new te;e.accept(r);var n=r.alternations;return c.u4(n,function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:i.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r},[])}(e,a)}),m=(0,c.UI)(t,function(e){return function(e,t,r,n){var o=[];if((0,c.u4)(t,function(t,r){return r.name===e.name?t+1:t},0)>1){var a=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});o.push({message:a,type:i.DUPLICATE_RULE_NAME,ruleName:e.name})}return o}(e,t,s,a)}),c.xH(u.concat(p,l,f,h,g,d,m))}function to(e){(0,c.Ed)(e.rules,function(e){var t=new ex;e.accept(t),(0,c.Ed)(t.dslMethods,function(e){(0,c.Ed)(e,function(e,t){e.idx=t+1})})})}var ta=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ti="MismatchedTokenException",ts="NoViableAltException",tc="EarlyExitException",tu="NotAllInputParsedException",tl=[ti,ts,tc,tu];function tf(e){return(0,c.r3)(tl,e.name)}Object.freeze(tl);var th=function(e){function t(t,r){var n=this.constructor,o=e.call(this,t)||this;return o.token=r,o.resyncedTokens=[],Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,o.constructor),o}return ta(t,e),t}(Error),tp=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.previousToken=n,o.name=ti,o}return ta(t,e),t}(th),td=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.previousToken=n,o.name=ts,o}return ta(t,e),t}(th),tm=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.name=tu,n}return ta(t,e),t}(th),tv=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.previousToken=n,o.name=tc,o}return ta(t,e),t}(th),tg={},tE="InRuleRecoveryException";function ty(e){this.name=tE,this.message=e}ty.prototype=Error.prototype;var tN=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,c.e$)(e,"recoveryEnabled")?e.recoveryEnabled:tK.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=tR)},e.prototype.getTokenToInsert=function(e){var t=ec(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var o=this,a=this.findReSyncTokenType(),i=this.exportLexerState(),s=[],u=!1,l=this.LA(1),f=this.LA(1),h=function(){var e=o.LA(0),t=new tp(o.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:l,previous:e,ruleName:o.getCurrRuleFullName()}),l,o.LA(0));t.resyncedTokens=(0,c.j7)(s),o.SAVE_ERROR(t)};!u;){if(this.tokenMatcher(f,n)){h();return}if(r.call(this)){h(),e.apply(this,t);return}this.tokenMatcher(f,a)?u=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,s))}this.importLexerState(i)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!(!1===r||void 0===e||void 0===t||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new ty("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||(0,c.xb)(t))return!1;var n=this.LA(1);return void 0!==(0,c.sE)(t,function(e){return r.tokenMatcher(n,e)})},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return(0,c.r3)(r,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if((0,c.r3)(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return tg;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return(0,c.UI)(t,function(n,o){return 0===o?tg:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[o],inRule:e.shortRuleNameToFullName(t[o-1])}})},e.prototype.flattenFollowSet=function(){var e=this,t=(0,c.UI)(this.buildFullFollowKeyStack(),function(t){return e.getFollowSetFromFollowKey(t)});return(0,c.xH)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===tg)return[es];var t=e.ruleName+e.idxInCallingRule+e_+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,es)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return(0,c.j7)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,o,a,i){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:(0,c.Qw)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return(0,c.UI)(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)})},e}();function tR(e,t,r,n,o,a,i){var s=this.getKeyForAutomaticLookahead(n,o),c=this.firstAfterRepMap[s];if(void 0===c){var u=this.getCurrRuleFullName();c=new a(this.getGAstProductions()[u],o).startWalking(),this.firstAfterRepMap[s]=c}var l=c.token,f=c.occurrence,h=c.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=es,f=1),this.shouldInRepetitionRecoveryBeTried(l,f,i)&&this.tryInRepetitionRecovery(e,t,r,l)}var tA=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=(0,c.e$)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:tK.dynamicTokensEnabled,this.maxLookahead=(0,c.e$)(e,"maxLookahead")?e.maxLookahead:tK.maxLookahead,this.lookAheadFuncsCache=(0,c.dU)()?new Map:[],(0,c.dU)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;(0,c.Ed)(e,function(e){t.TRACE_INIT(e.name+" Rule Lookahead",function(){var r,n=(eS.reset(),e.accept(eS),r=eS.dslMethods,eS.reset(),r),a=n.alternation,i=n.repetition,s=n.option,u=n.repetitionMandatory,l=n.repetitionMandatoryWithSeparator,f=n.repetitionWithSeparator;(0,c.Ed)(a,function(r){var n=0===r.idx?"":r.idx;t.TRACE_INIT(""+eC(r)+n,function(){var n,o,a,i,s,c,u,l,f=(n=r.idx,o=r.maxLookahead||t.maxLookahead,a=r.hasPredicates,i=t.dynamicTokensEnabled,s=t.lookAheadBuilderForAlternatives,u=e5(c=e2(n,e,o))?B:D,s(c,a,u,i)),h=(l=t.fullRuleNameToShort[e.name],256|r.idx|l);t.setLaFuncCache(h,f)})}),(0,c.Ed)(i,function(r){t.computeLookaheadFunc(e,r.idx,768,o.REPETITION,r.maxLookahead,eC(r))}),(0,c.Ed)(s,function(r){t.computeLookaheadFunc(e,r.idx,512,o.OPTION,r.maxLookahead,eC(r))}),(0,c.Ed)(u,function(r){t.computeLookaheadFunc(e,r.idx,1024,o.REPETITION_MANDATORY,r.maxLookahead,eC(r))}),(0,c.Ed)(l,function(r){t.computeLookaheadFunc(e,r.idx,1536,o.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,eC(r))}),(0,c.Ed)(f,function(r){t.computeLookaheadFunc(e,r.idx,1280,o.REPETITION_WITH_SEPARATOR,r.maxLookahead,eC(r))})})})},e.prototype.computeLookaheadFunc=function(e,t,r,n,o,a){var i=this;this.TRACE_INIT(""+a+(0===t?"":t),function(){var a,s,c,u,l,f=(a=o||i.maxLookahead,s=i.dynamicTokensEnabled,c=i.lookAheadBuilderForOptional,l=e5(u=e3(t,e,n,a))?B:D,c(u[0],l,s)),h=t|r|i.fullRuleNameToShort[e.name];i.setLaFuncCache(h,f)})},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return function(e,t,r){var n=(0,c.yW)(e,function(e){return 1===e.length}),o=e.length;if(!n||r)return function(){t:for(var r=0;r<o;r++){for(var n=e[r],a=n.length,i=0;i<a;i++)if(!1===t(this.LA(i+1),n[i]))continue t;return!0}return!1};var a=(0,c.xH)(e);if(1===a.length&&(0,c.xb)(a[0].categoryMatches)){var i=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===i}}var s=(0,c.u4)(a,function(e,t,r){return e[t.tokenTypeIdx]=!0,(0,c.Ed)(t.categoryMatches,function(t){e[t]=!0}),e},[]);return function(){return!0===s[this.LA(1).tokenTypeIdx]}}(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,n){return function(e,t,r,n){var o=e.length,a=(0,c.yW)(e,function(e){return(0,c.yW)(e,function(e){return 1===e.length})});if(t)return function(t){for(var n=(0,c.UI)(t,function(e){return e.GATE}),a=0;a<o;a++){var i=e[a],s=i.length,u=n[a];if(void 0===u||!1!==u.call(this))t:for(var l=0;l<s;l++){for(var f=i[l],h=f.length,p=0;p<h;p++)if(!1===r(this.LA(p+1),f[p]))continue t;return a}}};if(!a||n)return function(){for(var t=0;t<o;t++){var n=e[t],a=n.length;t:for(var i=0;i<a;i++){for(var s=n[i],c=s.length,u=0;u<c;u++)if(!1===r(this.LA(u+1),s[u]))continue t;return t}}};var i=(0,c.UI)(e,function(e){return(0,c.xH)(e)}),s=(0,c.u4)(i,function(e,t,r){return(0,c.Ed)(t,function(t){(0,c.e$)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),(0,c.Ed)(t.categoryMatches,function(t){(0,c.e$)(e,t)||(e[t]=r)})}),e},[]);return function(){return s[this.LA(1).tokenTypeIdx]}}(e,t,r,n)},e.prototype.getKeyForAutomaticLookahead=function(e,t){return t|e|this.getLastExplicitRuleShortName()},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();function tT(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}function tM(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}var tw="name";function tO(e){return e.name||"anonymous"}function tI(e,t){var r=Object.getOwnPropertyDescriptor(e,tw);return(!!(0,c.o8)(r)||!!r.configurable)&&(Object.defineProperty(e,tw,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)}function tb(e,t){for(var r=(0,c.XP)(e),n=r.length,o=0;o<n;o++)for(var a=e[r[o]],i=a.length,s=0;s<i;s++){var u=a[s];void 0===u.tokenTypeIdx&&this[u.name](u.children,t)}}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(a||(a={}));var tC=["constructor","visit","validateVisitor"],tx=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=(0,c.e$)(e,"nodeLocationTracking")?e.nodeLocationTracking:tK.nodeLocationTracking,this.outputCst){if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=tM,this.setNodeLocationFromNode=tM,this.cstPostRule=c.dG,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=c.dG,this.setNodeLocationFromNode=c.dG,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=tT,this.setNodeLocationFromNode=tT,this.cstPostRule=c.dG,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=c.dG,this.setNodeLocationFromNode=c.dG,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=c.dG,this.setNodeLocationFromNode=c.dG,this.cstPostRule=c.dG,this.setInitialNodeLocation=c.dG;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')}else this.cstInvocationStateUpdate=c.dG,this.cstFinallyStateUpdate=c.dG,this.cstPostTerminal=c.dG,this.cstPostNonTerminal=c.dG,this.cstPostRule=c.dG},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstInvocationStateUpdate=function(e,t){var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?r.endOffset=t.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[e]?r.children[e]=[t]:r.children[e].push(t),this.setNodeLocationFromToken(r.location,t)},e.prototype.cstPostNonTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[t]?r.children[t]=[e]:r.children[t].push(e),this.setNodeLocationFromNode(r.location,e.location)},e.prototype.getBaseCstVisitorConstructor=function(){if((0,c.o8)(this.baseCstVisitorConstructor)){var e,t,r,n=(e=this.className,t=(0,c.XP)(this.gastProductionsCache),tI(r=function(){},e+"BaseSemantics"),r.prototype={visit:function(e,t){if((0,c.kJ)(e)&&(e=e[0]),!(0,c.o8)(e))return this[e.name](e.children,t)},validateVisitor:function(){var e,r,n,o,i=(e=this,r=(0,c.UI)(t,function(t){if(!(0,c.mf)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+tO(e.constructor)+" CST Visitor.",type:a.MISSING_METHOD,methodName:t}}),n=(0,c.oA)(r),o=function(e,t){var r=[];for(var n in e)!(0,c.mf)(e[n])||(0,c.r3)(tC,n)||(0,c.r3)(t,n)||r.push({msg:"Redundant visitor method: <"+n+"> on "+tO(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\n",type:a.REDUNDANT_METHOD,methodName:n});return r}(this,t),n.concat(o));if(!(0,c.xb)(i)){var s=(0,c.UI)(i,function(e){return e.msg});throw Error("Errors Detected in CST Visitor <"+tO(this.constructor)+">:\n	"+s.join("\n\n").replace(/\n/g,"\n	"))}}},r.prototype.constructor=r,r._RULE_NAMES=t,r);return this.baseCstVisitorConstructor=n,n}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,c.o8)(this.baseCstVisitorWithDefaultsConstructor)){var e,t,r,n,o,a=(e=this.className,t=(0,c.XP)(this.gastProductionsCache),r=this.getBaseCstVisitorConstructor(),tI(n=function(){},e+"BaseSemanticsWithDefaults"),o=Object.create(r.prototype),(0,c.Ed)(t,function(e){o[e]=tb}),n.prototype=o,n.prototype.constructor=n,n);return this.baseCstVisitorWithDefaultsConstructor=a,a}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.getLastExplicitRuleShortName=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e}(),tS=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!1,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):tq},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?tq:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),tU=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},e.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=tz),(0,c.r3)(this.definedRulesNames,e)){var n={message:eB.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:i.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(n)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=tz);var n,o,a,s,u=[];u=u.concat((n=this.definedRulesNames,o=this.className,s=[],c.r3(n,e)||(a="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+o+"<-as it is not defined in any of the super grammars ",s.push({message:a,type:i.INVALID_RULE_OVERRIDE,ruleName:e})),s)),this.definitionErrors.push.apply(this.definitionErrors,u);var l=this.defineRule(e,t,r);return this[e]=l,l},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(tf(e))return!1;throw e}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return eA((0,c.VO)(this.gastProductionsCache))},e}(),t_=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=tO(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=B,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,c.e$)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n	For Further details.");if((0,c.kJ)(e)){if((0,c.xb)(e))throw Error("A Token Vocabulary cannot be empty.\n	Note that the first argument for the parser constructor\n	is no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n	For Further details.")}if((0,c.kJ)(e))this.tokensMap=(0,c.u4)(e,function(e,t){return e[t.name]=t,e},{});else if((0,c.e$)(e,"modes")&&(0,c.yW)((0,c.xH)((0,c.VO)(e.modes)),H)){var r=(0,c.xH)((0,c.VO)(e.modes)),n=(0,c.jj)(r);this.tokensMap=(0,c.u4)(n,function(e,t){return e[t.name]=t,e},{})}else if((0,c.Kn)(e))this.tokensMap=(0,c.Cl)(e);else throw Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=es;var o=(0,c.yW)((0,c.VO)(e),function(e){return(0,c.xb)(e.categoryMatches)});this.tokenMatcher=o?B:D,G((0,c.VO)(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var n,o=(0,c.e$)(r,"resyncEnabled")?r.resyncEnabled:tz.resyncEnabled,a=(0,c.e$)(r,"recoveryValueFunc")?r.recoveryValueFunc:tz.recoveryValueFunc,i=this.ruleShortNameIdx<<12;function s(e){try{if(!0!==this.outputCst)return t.apply(this,e);t.apply(this,e);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}catch(e){return this.invokeRuleCatch(e,o,a)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[i]=e,this.fullRuleNameToShort[e]=i,(n=function(t,r){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(i,e,t),s.call(this,r)}).ruleName=e,n.originalGrammarAction=t,n},e.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(tf(e)){if(o){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a)){if(e.resyncedTokens=this.reSyncTo(a),!this.outputCst)return r();var i=this.CST_STACK[this.CST_STACK.length-1];return i.recoveredNode=!0,i}if(this.outputCst){var i=this.CST_STACK[this.CST_STACK.length-1];i.recoveredNode=!0,e.partialCstResult=i}throw e}if(n)return this.moveToTerminatedState(),r()}throw e},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(512,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var s=i;i=function(){return o.call(a)&&s.call(a)}}}else n=e;if(!0===i.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(1024,e);return this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,a,i=this,s=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var c=s;s=function(){return a.call(i)&&c.call(i)}}}else n=t;if(!0===s.call(this))for(var u=this.doSingleRepetition(n);!0===s.call(this)&&!0===u;)u=this.doSingleRepetition(n);else throw this.raiseEarlyExitException(e,o.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,1024,e,eY)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(1536,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){a.call(this);for(var s=function(){return n.tokenMatcher(n.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,s,a,eq],s,1536,e,eq)}else throw this.raiseEarlyExitException(e,o.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(768,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(o=t.GATE)){var s=i;i=function(){return o.call(a)&&s.call(a)}}}else n=t;for(var c=!0;!0===i.call(this)&&!0===c;)c=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,768,e,eH,c)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(1280,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,o=t.DEF,a=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){o.call(this);for(var i=function(){return n.tokenMatcher(n.LA(1),a)};!0===this.tokenMatcher(this.LA(1),a);)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,i,o,eW],i,1280,e,eW)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,o){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,o],r,1536,e,o)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(256,t),n=(0,c.kJ)(e)?e:e.DEF,o=this.getLaFuncFromCache(r).call(this,n);if(void 0!==o)return n[o].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new tm(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var o=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,o),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){this.subruleInternalError(t,r,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,r){throw tf(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,r){var n;try{var o=this.LA(1);!0===this.tokenMatcher(o,e)?(this.consumeToken(),n=o):this.consumeInternalError(e,o,r)}catch(r){n=this.consumeInternalRecovery(e,t,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n},e.prototype.consumeInternalError=function(e,t,r){var n,o=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new tp(n,t,o))},e.prototype.consumeInternalRecovery=function(e,t,r){if(this.recoveryEnabled&&"MismatchedTokenException"===r.name&&!this.isBackTracking()){var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(e){if(e.name===tE)throw r;throw e}}else throw r},e.prototype.saveRecogState=function(){var e=this.errors,t=(0,c.Qw)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),es)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),tL=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=(0,c.e$)(e,"errorMessageProvider")?e.errorMessageProvider:tK.errorMessageProvider},e.prototype.SAVE_ERROR=function(e){if(tf(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,c.Qw)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return(0,c.Qw)(this._errors)},set:function(e){this._errors=e},enumerable:!1,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var n=this.getCurrRuleFullName(),o=e3(e,this.getGAstProductions()[n],t,this.maxLookahead)[0],a=[],i=1;i<=this.maxLookahead;i++)a.push(this.LA(i));var s=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:a,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new tv(s,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),n=e2(e,this.getGAstProductions()[r],this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var i=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:n,actual:o,previous:i,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new td(s,this.LA(1),i))},e}(),tk=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if((0,c.o8)(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return ez([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=(0,c.Ps)(e.ruleStack);return new eV(this.getGAstProductions()[t],e).startWalking()},e}(),tP={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(tP);var tD=ei({name:"RECORDING_PHASE_TOKEN",pattern:q.NA});G([tD]);var tB=ec(tD,"This IToken indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(tB);var tF={name:"This CSTNode indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}},tj=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(t){var r=t>0?t:"";e["CONSUME"+r]=function(e,r){return this.consumeInternalRecord(e,t,r)},e["SUBRULE"+r]=function(e,r){return this.subruleInternalRecord(e,t,r)},e["OPTION"+r]=function(e){return this.optionInternalRecord(e,t)},e["OR"+r]=function(e){return this.orInternalRecord(e,t)},e["MANY"+r]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+r]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+r]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+r]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},r=0;r<10;r++)t(r);e.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},e.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return tq},e.prototype.topLevelRuleRecord=function(e,t){try{var r=new ep({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n	 This error was thrown during the "grammar recording phase" For more info see:\n	https://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(e){}throw e}},e.prototype.optionInternalRecord=function(e,t){return tG.call(this,em,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){tG.call(this,ev,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){tG.call(this,eg,t,e,!0)},e.prototype.manyInternalRecord=function(e,t){tG.call(this,eE,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){tG.call(this,ey,t,e,!0)},e.prototype.orInternalRecord=function(e,t){return tV.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,r){if(tH(t),!e||!1===(0,c.e$)(e,"ruleName")){var n=Error("<SUBRULE"+t$(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=(0,c.fj)(this.recordingProdStack),a=new eh({idx:t,nonTerminalName:e.ruleName,referencedRule:void 0});return o.definition.push(a),this.outputCst?tF:tP},e.prototype.consumeInternalRecord=function(e,t,r){if(tH(t),!V(e)){var n=Error("<CONSUME"+t$(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=(0,c.fj)(this.recordingProdStack),a=new eR({idx:t,terminalType:e});return o.definition.push(a),tB},e}();function tG(e,t,r,n){void 0===n&&(n=!1),tH(r);var o=(0,c.fj)(this.recordingProdStack),a=(0,c.mf)(t)?t:t.DEF,i=new e({definition:[],idx:r});return n&&(i.separator=t.SEP),(0,c.e$)(t,"MAX_LOOKAHEAD")&&(i.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(i),a.call(this),o.definition.push(i),this.recordingProdStack.pop(),tP}function tV(e,t){var r=this;tH(t);var n=(0,c.fj)(this.recordingProdStack),o=!1===(0,c.kJ)(e),a=!1===o?e:e.DEF,i=new eN({definition:[],idx:t,ignoreAmbiguities:o&&!0===e.IGNORE_AMBIGUITIES});(0,c.e$)(e,"MAX_LOOKAHEAD")&&(i.maxLookahead=e.MAX_LOOKAHEAD);var s=(0,c.G)(a,function(e){return(0,c.mf)(e.GATE)});return i.hasPredicates=s,n.definition.push(i),(0,c.Ed)(a,function(e){var t=new ed({definition:[]});i.definition.push(t),(0,c.e$)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:(0,c.e$)(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()}),tP}function t$(e){return 0===e?"":""+e}function tH(e){if(e<0||e>255){var t=Error("Invalid DSL Method idx value: <"+e+">\n	Idx value must be a none negative value smaller than 256");throw t.KNOWN_RECORDER_ERROR=!0,t}}var tW=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if((0,c.e$)(e,"traceInitPerf")){var t=e.traceInitPerf,r="number"==typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=tK.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0!==this.traceInitPerf)return t();this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+e+">");var n=(0,c.HT)(t),o=n.time,a=n.value,i=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&i(r+"<-- <"+e+"> time: "+o+"ms"),this.traceInitIndent--,a},e}(),tY=function(){var e=function(t,r){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tq=ec(es,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(tq);var tK=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:eP,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),tz=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function tX(e){return void 0===e&&(e=void 0),function(){return e}}!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"}(i||(i={}));var tQ=function(){function e(e,t){if(this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),(0,c.e$)(t,"ignoredIssues"))throw Error("The <ignoredIssues> IParserConfig property has been deprecated.\n	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n	For further details.");this.skipValidations=(0,c.e$)(t,"skipValidations")?t.skipValidations:tK.skipValidations}return e.performSelfAnalysis=function(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",function(){t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",function(){(0,c.SV)(t)}),t.TRACE_INIT("Grammar Recording",function(){try{t.enableRecording(),(0,c.Ed)(t.definedRulesNames,function(e){var r=t[e].originalGrammarAction,n=void 0;t.TRACE_INIT(e+" Rule",function(){n=t.topLevelRuleRecord(e,r)}),t.gastProductionsCache[e]=n})}finally{t.disableRecording()}});var n=[];if(t.TRACE_INIT("Grammar Resolving",function(){n=tr({rules:(0,c.VO)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,n)}),t.TRACE_INIT("Grammar Validations",function(){if((0,c.xb)(n)&&!1===t.skipValidations){var e=tn({rules:(0,c.VO)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:(0,c.VO)(t.tokensMap),errMsgProvider:eB,grammarName:r});t.definitionErrors.push.apply(t.definitionErrors,e)}}),(0,c.xb)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",function(){var e,r,n=(e=(0,c.VO)(t.gastProductionsCache),r={},(0,c.Ed)(e,function(e){var t=new ek(e).startWalking();(0,c.f0)(r,t)}),r);t.resyncFollows=n}),t.TRACE_INIT("ComputeLookaheadFunctions",function(){t.preComputeLookaheadFunctions((0,c.VO)(t.gastProductionsCache))})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,c.xb)(t.definitionErrors))throw Error("Parser Definition Errors detected:\n "+(0,c.UI)(t.definitionErrors,function(e){return e.message}).join("\n-------------------------------\n"))})},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();(0,c.ef)(tQ,[tN,tA,tx,tS,t_,tU,tL,tk,tj,tW]);var tZ=function(e){function t(t,r){void 0===r&&(r=tK);var n=(0,c.Cl)(r);return n.outputCst=!0,e.call(this,t,n)||this}return tY(t,e),t}(tQ),tJ=function(e){function t(t,r){void 0===r&&(r=tK);var n=(0,c.Cl)(r);return n.outputCst=!1,e.call(this,t,n)||this}return tY(t,e),t}(tQ);function t0(e,t){var r=void 0===t?{}:t,n=r.resourceBase,o=void 0===n?"https://unpkg.com/chevrotain@"+s+"/diagrams/":n,a=r.css;return"\n<!-- This is a generated file -->\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===a?"https://unpkg.com/chevrotain@"+s+"/diagrams/diagrams.css":a)+"'>\n"+("\n<script src='"+o+"vendor/railroad-diagrams.js'></script>\n<script src='"+o+"src/diagrams_builder.js'></script>\n<script src='"+o)+"src/diagrams_behavior.js'></script>\n<script src='"+o+'src/main.js\'></script>\n\n<div id="diagrams" align="center"></div>    \n'+("\n<script>\n    window.serializedGrammar = "+JSON.stringify(e,null,"  "))+';\n</script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n</script>\n'}function t1(e){var t;return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+(t=e.rules,(0,c.UI)(t,function(e){var t;return t5(1,'$.RULE("'+e.name+'", function() {')+"\n"+t4(e.definition,2)+(t5(2,"})")+"\n")}).join("\n"))+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function t2(e,t,r){var n=t5(r,"$."+(e+t.idx)+"(");return t.separator?n+="{\n"+t5(r+1,"SEP: this.tokensMap."+t.separator.name)+",\nDEF: "+t3(t.definition,r+2)+"\n"+t5(r,"}")+"\n":n+=t3(t.definition,r+1),n+=t5(r,")")+"\n"}function t3(e,t){return"function() {\n"+t4(e,t)+(t5(t,"}")+"\n")}function t4(e,t){var r="";return(0,c.Ed)(e,function(e){r+=function(e,t){var r;if(e instanceof eh)return t5(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")\n");if(e instanceof em)return t2("OPTION",e,t);if(e instanceof ev)return t2("AT_LEAST_ONE",e,t);if(e instanceof eg)return t2("AT_LEAST_ONE_SEP",e,t);if(e instanceof ey)return t2("MANY_SEP",e,t);if(e instanceof eE)return t2("MANY",e,t);if(e instanceof eN)return t5(t,"$.OR"+e.idx+"([")+"\n"+(0,c.UI)(e.definition,function(e){var r,n;return t5(r=t+1,"{")+"\n"+(t5(r+1,"ALT: function() {")+"\n"+t4(e.definition,r+1)+t5(r+1,"}")+"\n")+t5(r,"}")}).join(",\n")+"\n"+t5(t,"])\n");else if(e instanceof eR)return r=e.terminalType.name,t5(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")\n");else if(e instanceof ed)return t4(e.definition,t);else throw Error("non exhaustive match")}(e,t+1)}),r}function t5(e,t){return Array(4*e+1).join(" ")+t}function t6(e){var t,n=Function("tokenVocabulary","config","chevrotain","    \n"+t1(t={name:e.name,rules:e.rules})+"\nreturn new "+t.name+"(tokenVocabulary, config)    \n");return function(t){return n(e.tokenVocabulary,t,r(75490))}}function t7(e){var t;return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+t1(t={name:e.name,rules:e.rules})+"\n    \nreturn {\n    "+t.name+": "+t.name+" \n}\n}));\n"}function t9(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n	 It performs no action other than printing this message.\n	 Please avoid using it as it will be completely removed in the future")}var t8=function(){throw Error("The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	\nSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0")}},76785:(e,t,r)=>{"use strict";function n(e){return e&&0===e.length}function o(e){return null==e?[]:Object.keys(e)}function a(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function i(e,t){for(var r=[],n=o(e),a=0;a<n.length;a++){var i=n[a];r.push(t.call(null,e[i],i))}return r}function s(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function c(e){return n(e)?void 0:e[0]}function u(e){var t=e&&e.length;return t?e[t-1]:void 0}function l(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else if(x(e))for(var n=o(e),r=0;r<n.length;r++){var a=n[r],i=e[a];t.call(null,i,a)}else throw Error("non exhaustive match")}function f(e){return"string"==typeof e}function h(e){return void 0===e}function p(e){return e instanceof Function}function d(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function m(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function v(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}function g(e,t){return v(e,function(e){return!t(e)})}function E(e,t){for(var r=Object.keys(e),n={},o=0;o<r.length;o++){var a=r[o],i=e[a];t(i)&&(n[a]=i)}return n}function y(e,t){return!!x(e)&&e.hasOwnProperty(t)}function N(e,t){return void 0!==T(e,function(e){return e===t})}function R(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function A(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function T(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function M(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];t.call(null,o)&&r.push(o)}return r}function w(e,t,r){for(var n=Array.isArray(e),i=n?e:a(e),s=n?[]:o(e),c=r,u=0;u<i.length;u++)c=t.call(null,c,i[u],n?u:s[u]);return c}function O(e){return g(e,function(e){return null==e})}function I(e,t){void 0===t&&(t=function(e){return e});var r=[];return w(e,function(e,n){var o=t(n);return N(r,o)?e:(r.push(o),e.concat(n))},[])}function b(e){return Array.isArray(e)}function C(e){return e instanceof RegExp}function x(e){return e instanceof Object}function S(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function U(e,t){return g(e,function(e){return N(t,e)})}function _(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function L(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return -1}function k(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var a=t[n],i=o(a),s=0;s<i.length;s++){var c=i[s];e[c]=a[c]}return e}function P(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var a=t[n],i=o(a),s=0;s<i.length;s++){var c=i[s];y(e,c)||(e[c]=a[c])}return e}function D(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P.apply(null,[{}].concat(e))}function B(e,t){var r={};return l(e,function(e){var n=t(e),o=r[n];o?o.push(e):r[n]=[e]}),r}function F(e,t){for(var r=A(e),n=o(t),a=0;a<n.length;a++){var i=n[a],s=t[i];r[i]=s}return r}function j(){}function G(e){return e}function V(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}function $(e){console&&console.error&&console.error("Error: "+e)}function H(e){console&&console.warn&&console.warn("Warning: "+e)}function W(){return"function"==typeof Map}function Y(e,t){t.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(n){if("constructor"!==n){var o=Object.getOwnPropertyDescriptor(r,n);o&&(o.get||o.set)?Object.defineProperty(e.prototype,n,o):e.prototype[n]=t.prototype[n]}})})}function q(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}function K(e){return e[e.length-1]}function z(e){var t=new Date().getTime(),r=e();return{time:new Date().getTime()-t,value:r}}r.d(t,{Cl:()=>A,Cw:()=>d,Ed:()=>l,G:()=>_,HD:()=>f,HT:()=>z,Kj:()=>C,Kn:()=>x,Oq:()=>M,Ps:()=>c,Q8:()=>i,Qw:()=>R,SV:()=>q,TS:()=>F,UI:()=>s,VO:()=>a,WB:()=>$,Wd:()=>G,X0:()=>V,XP:()=>o,Z$:()=>u,ce:()=>D,cq:()=>L,d1:()=>g,dG:()=>j,dU:()=>W,e$:()=>y,e5:()=>U,ef:()=>Y,ei:()=>E,f0:()=>k,fj:()=>K,hX:()=>v,j7:()=>m,jj:()=>I,kJ:()=>b,mf:()=>p,o8:()=>h,oA:()=>O,r3:()=>N,rr:()=>H,sE:()=>T,u4:()=>w,vM:()=>B,xH:()=>function e(t){for(var r=[],n=0;n<t.length;n++){var o=t[n];Array.isArray(o)?r=r.concat(e(o)):r.push(o)}return r},xb:()=>n,yW:()=>S})},77262:(e,t,r)=>{class n extends Error{constructor(e,t,r){if(super(t),null==t&&null==r&&n.errorMap.has(e))return n.errorMap.get(e);null==t&&null==r?(this._error=e,n.errorMap.set(e,this)):this._error=e,this.details=r}get error(){return this._error}get name(){return this._error}equals(e){return e instanceof n&&e._error===this._error}toString(){return this._error}}n.errorMap=new Map,n.DIV0=new n("#DIV/0!"),n.NA=new n("#N/A"),n.NAME=new n("#NAME?"),n.NULL=new n("#NULL!"),n.NUM=new n("#NUM!"),n.REF=new n("#REF!"),n.VALUE=new n("#VALUE!"),n.NOT_IMPLEMENTED=e=>new n("#NAME?",`Function ${e} is not implemented.`),n.TOO_MANY_ARGS=e=>new n("#N/A",`Function ${e} has too many arguments.`),n.ARG_MISSING=e=>{let{Types:t}=r(74998);return new n("#N/A",`Argument type ${e.map(e=>t[e]).join(", ")} is missing.`)},n.ERROR=(e,t)=>new n("#ERROR!",e,t),e.exports=n},86396:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i=new Date(Date.UTC(1900,0,1)),s=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],c=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],u=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],l=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,f=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,h=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,p=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function d(e){return Math.floor((e-i)/864e5)+(e>-22038912e5?2:1)}function m(e){if(e instanceof Date)return{date:e};e=o.accept(e);let t=!0,r;return isNaN(e)?(r=function(e){let t=e.match(l);if(!t)return;let r=t[2]?t[2]:":00",n=t[3]?t[3]:":00",o=t[4]?" "+t[4]:"",a=new Date(Date.parse(`1/1/1900 ${t[1]+r+n+o} UTC`)),i=new Date;return new Date(Date.UTC((i=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()))).getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()))}(e))?t=!1:r=function(e){let t=e.match(f),r=e.match(h),n=e.match(p);return t?e=t[1]+t[3]+new Date().getFullYear()+t[5]:r?e=r[1]+r[3]+new Date().getFullYear()+r[5]:n&&(e=n[1]+n[3]+new Date().getFullYear()+n[5]),new Date(Date.parse(`${e} UTC`))}(e):r=function(e){if(e<0)throw n.VALUE;return new Date(e<=60?i.getTime()+(e-1)*864e5:i.getTime()+(e-2)*864e5)}(e=Number(e)),{date:r,isDateGiven:t}}function v(e){return m(e).date}function g(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}let E={DATE:(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<0||e>=1e4)throw n.NUM;return e<1900&&(e+=1900),d(Date.UTC(e,t-1,r))},DATEDIF:(e,t,r)=>{if(e=v(e),t=v(t),r=o.accept(r,a.STRING).toLowerCase(),e>t)throw n.NUM;let i=t.getUTCFullYear()-e.getUTCFullYear(),s=t.getUTCMonth()-e.getUTCMonth(),c=t.getUTCDate()-e.getUTCDate();switch(r){case"y":return(s<0||0===s&&c<0?-1:0)+i;case"m":return 12*i+s+(c<0?-1:0);case"d":return Math.floor(t-e)/864e5;case"md":return e.setUTCFullYear(t.getUTCFullYear()),c<0?e.setUTCMonth(t.getUTCMonth()-1):e.setUTCMonth(t.getUTCMonth()),Math.floor(t-e)/864e5;case"ym":return((c<0?-1:0)+12*i+s)%12;case"yd":return s<0||0===s&&c<0?e.setUTCFullYear(t.getUTCFullYear()-1):e.setUTCFullYear(t.getUTCFullYear()),Math.floor(t-e)/864e5}},DATEVALUE:e=>{let{date:t,isDateGiven:r}=m(e=o.accept(e,a.STRING));if(!r)return 0;let i=d(t);if(i<0||i>2958465)throw n.VALUE;return i},DAY:e=>v(e).getUTCDate(),DAYS:(e,t)=>{e=v(e);let r=0;return(t=v(t))<-22038912e5&&-22038912e5<e&&(r=1),Math.floor(e-t)/864e5+r},DAYS360:(e,t,r)=>{e=v(e),t=v(t),r=o.accept(r,a.BOOLEAN,!1),31===e.getUTCDate()&&e.setUTCDate(30),!r&&30>e.getUTCDate()&&t.getUTCDate()>30?t.setUTCMonth(t.getUTCMonth()+1,1):31===t.getUTCDate()&&t.setUTCDate(30);let n=t.getUTCFullYear()-e.getUTCFullYear();return 30*(t.getUTCMonth()-e.getUTCMonth())+(t.getUTCDate()-e.getUTCDate())+360*n},EDATE:(e,t)=>(e=v(e),t=o.accept(t,a.NUMBER),e.setUTCMonth(e.getUTCMonth()+t),d(e)),EOMONTH:(e,t)=>(e=v(e),t=o.accept(t,a.NUMBER),e.setUTCMonth(e.getUTCMonth()+t+1,0),d(e)),HOUR:e=>v(e).getUTCHours(),ISOWEEKNUM:e=>{let t=v(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay();r.setUTCDate(r.getUTCDate()+4-n);let o=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r-o)/864e5+1)/7)},MINUTE:e=>v(e).getUTCMinutes(),MONTH:e=>v(e).getUTCMonth()+1,NETWORKDAYS:(e,t,r)=>{e=v(e);let n=1;if(e>(t=v(t))){n=-1;let r=e;e=t,t=r}let i=[];null!=r&&o.flattenParams([r],a.NUMBER,!1,e=>{i.push(v(e))});let s=0;for(;e<=t;){if(0!==e.getUTCDay()&&6!==e.getUTCDay()){let t=!1;for(let r=0;r<i.length;r++)if(g(e,i[r])){t=!0;break}!t&&s++}e.setUTCDate(e.getUTCDate()+1)}return n*s},"NETWORKDAYS.INTL":(e,t,r,i)=>{e=v(e);let s=1;if(e>(t=v(t))){s=-1;let r=e;e=t,t=r}if("1111111"===(r=o.accept(r,null,1)))return 0;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);let e=[];for(let t=0;t<r.length;t++)"1"===r.charAt(t)&&e.push(t);r=e}else{if("number"!=typeof r)throw n.VALUE;r=u[r]}let c=[];null!=i&&o.flattenParams([i],a.NUMBER,!1,e=>{c.push(v(e))});let l=0;for(;e<=t;){let t=!1;for(let n=0;n<r.length;n++)if(r[n]===e.getUTCDay()){t=!0;break}if(!t){let t=!1;for(let r=0;r<c.length;r++)if(g(e,c[r])){t=!0;break}!t&&l++}e.setUTCDate(e.getUTCDate()+1)}return s*l},NOW:()=>{let e=new Date;return d(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))+(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},SECOND:e=>v(e).getUTCSeconds(),TIME:(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<0||e>32767||t<0||t>32767||r<0||r>32767)throw n.NUM;return(3600*e+60*t+r)/86400},TIMEVALUE:e=>(3600*(e=v(e)).getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds())/86400,TODAY:()=>{let e=new Date;return d(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},WEEKDAY:(e,t)=>{let r=v(e);t=o.accept(t,a.NUMBER,1);let i=r.getUTCDay(),s=c[t];if(!s)throw n.NUM;return s[i]},WEEKNUM:(e,t)=>{let r=v(e);if(21===(t=o.accept(t,a.NUMBER,1)))return E.ISOWEEKNUM(e);let n=s[t],i=new Date(Date.UTC(r.getUTCFullYear(),0,1)),c=i.getUTCDay()<n?1:0;return Math.ceil(((r-i)/864e5+1)/7)+c},WORKDAY:(e,t,r)=>E["WORKDAY.INTL"](e,t,1,r),"WORKDAY.INTL":(e,t,r,i)=>{if(e=v(e),t=o.accept(t,a.NUMBER),"1111111"===(r=o.accept(r,null,1)))throw n.VALUE;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);let e=[];for(let t=0;t<r.length;t++)"1"===r.charAt(t)&&e.push(t);r=e}else{if("number"!=typeof r)throw n.VALUE;if(null==(r=u[r]))throw n.NUM}let s=[];null!=i&&o.flattenParams([i],a.NUMBER,!1,e=>{s.push(v(e))}),e.setUTCDate(e.getUTCDate()+1);let c=0;for(;c<t;){let t=!1;for(let n=0;n<r.length;n++)if(r[n]===e.getUTCDay()){t=!0;break}if(!t){let t=!1;for(let r=0;r<s.length;r++)if(g(e,s[r])){t=!0;break}!t&&c++}e.setUTCDate(e.getUTCDate()+1)}return d(e)-1},YEAR:e=>v(e).getUTCFullYear(),YEARFRAC:(e,t,r)=>{if((e=v(e))>(t=v(t))){let r=e;e=t,t=r}if((r=Math.trunc(r=o.accept(r,a.NUMBER,0)))<0||r>4)throw n.VALUE;let i=e.getUTCDate(),s=e.getUTCMonth()+1,c=e.getUTCFullYear(),u=t.getUTCDate(),l=t.getUTCMonth()+1,f=t.getUTCFullYear();switch(r){case 0:return 31===i&&31===u?(i=30,u=30):31===i?i=30:30===i&&31===u&&(u=30),Math.abs(u+30*l+360*f-(i+30*s+360*c))/360;case 1:if(f-c<2){let r=function(e){return 1900===e||1===new Date(e,1,29).getMonth()}(c)&&1900!==c?366:365;return E.DAYS(t,e)/r}{let r=f-c+1,n=(new Date(f+1,0,1)-new Date(c,0,1))/1e3/60/60/24;return E.DAYS(t,e)/(n/r)}case 2:return Math.abs(E.DAYS(t,e)/360);case 3:return Math.abs(E.DAYS(t,e)/365);case 4:return Math.abs(u+30*l+360*f-(i+30*s+360*c))/360}}};e.exports=E},7449:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i=r(61998),s=r(39300),c={"BETA.DIST":(e,t,r,s,c,u)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),c=o.accept(c,a.NUMBER,0),u=o.accept(u,a.NUMBER,1),t<=0||r<=0||e<c||e>u||c===u)throw n.NUM;return e=(e-c)/(u-c),s?i.beta.cdf(e,t,r):i.beta.pdf(e,t,r)/(u-c)},"BETA.INV":(e,t,r,s,c)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.NUMBER,0),c=o.accept(c,a.NUMBER,1),t<=0||r<=0||e<=0||e>1)throw n.NUM;return i.beta.inv(e,t,r)*(c-s)+s},"BINOM.DIST":(e,t,r,s)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),t<0||r<0||r>1||e<0||e>t)throw n.NUM;return s?i.binomial.cdf(e,t,r):i.binomial.pdf(e,t,r)},"BINOM.DIST.RANGE":(e,t,r,i)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.NUMBER,r),e<0||t<0||t>1||r<0||r>e||i<r||i>e)throw n.NUM;let c=0;for(let n=r;n<=i;n++)c+=s.COMBIN(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n);return c},"BINOM.INV":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<0||t<0||t>1||r<0||r>1)throw n.NUM;let s=0;for(;s<=e;){if(i.binomial.cdf(s,e,t)>=r)return s;s++}},"CHISQ.DIST":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),t=Math.trunc(t),e<0||t<1||t>1e10)throw n.NUM;return r?i.chisquare.cdf(e,t):i.chisquare.pdf(e,t)},"CHISQ.DIST.RT":(e,t)=>{if(e=o.accept(e,a.NUMBER),t=Math.trunc(t=o.accept(t,a.NUMBER)),e<0||t<1||t>1e10)throw n.NUM;return 1-i.chisquare.cdf(e,t)},"CHISQ.INV":(e,t)=>{if(e=o.accept(e,a.NUMBER),t=Math.trunc(t=o.accept(t,a.NUMBER)),e<0||e>1||t<1||t>1e10)throw n.NUM;return i.chisquare.inv(e,t)},"CHISQ.INV.RT":(e,t)=>{if(e=o.accept(e,a.NUMBER),t=Math.trunc(t=o.accept(t,a.NUMBER)),e<0||e>1||t<1||t>1e10)throw n.NUM;return i.chisquare.inv(1-e,t)},"CHISQ.TEST":(e,t)=>{let r=o.accept(e,a.ARRAY,void 0,!1,!1),i=o.accept(t,a.ARRAY,void 0,!1,!1);if(r.length!==i.length||r[0].length!==i[0].length||1===r.length&&1===r[0].length)throw n.NA;let s=r.length,c=r[0].length,u=(s-1)*(c-1);u=1===s?c-1:s-1;let l=0;for(let e=0;e<s;e++)for(let t=0;t<c;t++)if("number"==typeof r[e][t]&&"number"==typeof i[e][t]){if(0===i[e][t])throw n.DIV0;l+=Math.pow(r[e][t]-i[e][t],2)/i[e][t]}let f=Math.exp(-.5*l);u%2==1&&(f*=Math.sqrt(2*l/Math.PI));let h=u;for(;h>=2;)f=f*l/h,h-=2;let p=f,d=u;for(;p>1e-15*f;)d+=2,f+=p=p*l/d;return 1-f},"CONFIDENCE.NORM":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=Math.trunc(r=o.accept(r,a.NUMBER)),e<=0||e>=1||t<=0||r<1)throw n.NUM;return i.normalci(1,e,t,r)[1]-1},"CONFIDENCE.T":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=Math.trunc(r=o.accept(r,a.NUMBER)),e<=0||e>=1||t<=0||r<1)throw n.NUM;if(1===r)throw n.DIV0;return i.tci(1,e,t,r)[1]-1},CORREL:(e,t)=>{if(e=o.accept(e,a.ARRAY,void 0,!0,!0),t=o.accept(t,a.ARRAY,void 0,!0,!0),e.length!==t.length)throw n.NA;let r=[],s=[];for(let n=0;n<e.length;n++)"number"==typeof e[n]&&"number"==typeof t[n]&&(r.push(e[n]),s.push(t[n]));if(r.length<=1)throw n.DIV0;return i.corrcoeff(r,s)},"COVARIANCE.P":(e,t)=>{if(e=o.accept(e,a.ARRAY,void 0,!0,!0),t=o.accept(t,a.ARRAY,void 0,!0,!0),e.length!==t.length)throw n.NA;let r=[],s=[];for(let n=0;n<e.length;n++)"number"==typeof e[n]&&"number"==typeof t[n]&&(r.push(e[n]),s.push(t[n]));let c=i.mean(r),u=i.mean(s),l=0;for(let e=0;e<r.length;e++)l+=(r[e]-c)*(s[e]-u);return l/r.length},"COVARIANCE.S":(e,t)=>{if(e=o.accept(e,a.ARRAY,void 0,!0,!0),t=o.accept(t,a.ARRAY,void 0,!0,!0),e.length!==t.length)throw n.NA;let r=[],s=[];for(let n=0;n<e.length;n++)"number"==typeof e[n]&&"number"==typeof t[n]&&(r.push(e[n]),s.push(t[n]));if(r.length<=1)throw n.DIV0;return i.covariance(r,s)},DEVSQ:(...e)=>{let t=0,r=[];o.flattenParams(e,a.NUMBER,!0,(e,n)=>{"number"==typeof e&&(t+=e,r.push(e))});let n=t/r.length;t=0;for(let e=0;e<r.length;e++)t+=(r[e]-n)**2;return t},"EXPON.DIST":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.BOOLEAN),e<0||t<=0)throw n.NUM;return r?i.exponential.cdf(e,t):i.exponential.pdf(e,t)},"F.DIST":(e,t,r,s)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),e<0||t<1||r<1)throw n.NUM;return t=Math.trunc(t),r=Math.trunc(r),s?i.centralF.cdf(e,t,r):i.centralF.pdf(e,t,r)},"F.DIST.RT":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<0||t<1||r<1)throw n.NUM;return t=Math.trunc(t),r=Math.trunc(r),1-i.centralF.cdf(e,t,r)},"F.INV":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<0||e>1||t<1||r<1)throw n.NUM;return t=Math.trunc(t),r=Math.trunc(r),i.centralF.inv(e,t,r)},"F.INV.RT":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<0||e>1||t<1||t>=1e10||r<1||r>=1e10)throw n.NUM;return t=Math.trunc(t),r=Math.trunc(r),i.centralF.inv(1-e,t,r)},"F.TEST":(e,t)=>{e=o.accept(e,a.ARRAY,void 0,!0,!0),t=o.accept(t,a.ARRAY,void 0,!0,!0);let r=[],s=[],c=0,u=0;for(let n=0;n<Math.max(e.length,t.length);n++)"number"==typeof e[n]&&(r.push(e[n]),c+=e[n]),"number"==typeof t[n]&&(s.push(t[n]),u+=t[n]);if(r.length<=1||s.length<=1)throw n.DIV0;c/=r.length,u/=s.length;let l=0,f=0;for(let e=0;e<r.length;e++)l+=(c-r[e])**2;l/=r.length-1;for(let e=0;e<s.length;e++)f+=(u-s[e])**2;return f/=s.length-1,2*i.centralF.cdf(l/f,r.length-1,s.length-1)},FISHER:e=>{if((e=o.accept(e,a.NUMBER))<=-1||e>=1)throw n.NUM;return Math.log((1+e)/(1-e))/2},FISHERINV:e=>{let t=Math.exp(2*(e=o.accept(e,a.NUMBER)));return(t-1)/(t+1)},FORECAST:(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.ARRAY,void 0,!0,!0),(r=o.accept(r,a.ARRAY,void 0,!0,!0)).length!==t.length)throw n.NA;let s=[],c=[],u=!0;for(let e=0;e<t.length;e++)"number"==typeof t[e]&&"number"==typeof r[e]&&(s.push(t[e]),c.push(r[e]),r[e]!==r[0]&&(u=!1));if(u)throw n.DIV0;let l=i.mean(s),f=i.mean(c),h=0,p=0;for(let e=0;e<s.length;e++)h+=(c[e]-f)*(s[e]-l),p+=(c[e]-f)**2;let d=h/p;return l-d*f+d*e},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...e)=>c.FORECAST(...e),FREQUENCY:(e,t)=>{e=o.accept(e,a.ARRAY,void 0,!0,!0),t=o.accept(t,a.ARRAY,void 0,!0,!0);let r=[];for(let e=0;e<t.length;e++)"number"==typeof t[e]&&r.push(t[e]);r.sort(),r.push(1/0);let n=[];for(let t=0;t<r.length;t++){n[t]=[],n[t][0]=0;for(let o=0;o<e.length;o++)"number"==typeof e[o]&&e[o]<=r[t]&&(n[t][0]++,e[o]=null)}return n},GAMMA:e=>{if(0===(e=o.accept(e,a.NUMBER))||e<0&&e===Math.trunc(e))throw n.NUM;return i.gammafn(e)},"GAMMA.DIST":(e,t,r,s)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),e<0||t<=0||r<=0)throw n.NUM;return s?i.gamma.cdf(e,t,r,!0):i.gamma.pdf(e,t,r,!1)},"GAMMA.INV":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<0||e>1||t<=0||r<=0)throw n.NUM;return i.gamma.inv(e,t,r)},GAMMALN:e=>{if((e=o.accept(e,a.NUMBER))<=0)throw n.NUM;return i.gammaln(e)},"GAMMALN.PRECISE":e=>{if((e=o.accept(e,a.NUMBER))<=0)throw n.NUM;return i.gammaln(e)},GAUSS:e=>(e=o.accept(e,a.NUMBER),i.normal.cdf(e,0,1)-.5),GEOMEAN:(...e)=>{let t=[];return o.flattenParams(e,a.NUMBER,!0,(e,r)=>{"number"==typeof e&&t.push(e)}),i.geomean(t)},GROWTH:(e,t,r,i)=>{let s,c;e=o.accept(e,a.ARRAY,void 0,!0,!0);for(let t=0;t<e.length;t++)if("number"!=typeof e[t])throw n.VALUE;let u=null==(t=o.accept(t,a.ARRAY,null,!0,!0));if(null==t){t=[];for(let r=1;r<=e.length;r++)t.push(r)}else{if(t.length!==e.length)throw n.REF;for(let e=0;e<t.length;e++)if("number"!=typeof t[e])throw n.VALUE}if(null==(r=o.accept(r,a.ARRAY,null,!1,!0))&&u){r=[];for(let t=1;t<=e.length;t++)r.push(t);r=[r]}else null==r&&(r=Array.isArray(t[0])?t:[t]);i=o.accept(i,a.BOOLEAN,!0);let l=e.length,f=0,h=0,p=0,d=0;for(let r=0;r<l;r++){let n=t[r],o=Math.log(e[r]);f+=n,h+=o,p+=n*o,d+=n*n}f/=l,h/=l,p/=l,d/=l,i?(s=(p-f*h)/(d-f*f),c=h-s*f):(s=p/d,c=0);let m=[];for(let e=0;e<r.length;e++){m[e]=[];for(let t=0;t<r[0].length;t++){if("number"!=typeof r[e][t])throw n.VALUE;m[e][t]=Math.exp(c+s*r[e][t])}}return m},HARMEAN:(...e)=>{let t=0,r=0;return o.flattenParams(e,a.NUMBER,!0,(e,n)=>{"number"==typeof e&&(r+=1/e,t++)}),t/r},"HYPGEOM.DIST":(e,t,r,i,c)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.NUMBER),c=o.accept(c,a.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),(i=Math.trunc(i))<=0||e<0||t<=0||r<=0||t>i||r>i||t<e||r<e||e<t-i+r)throw n.NUM;function u(e,t,r,n){return s.COMBIN(r,e)*s.COMBIN(n-r,t-e)/s.COMBIN(n,t)}return c?function(e,t,r,n){let o=0;for(let a=0;a<=e;a++)o+=u(a,t,r,n);return o}(e,t,r,i):u(e,t,r,i)},INTERCEPT:(e,t)=>{if(e=o.accept(e,a.ARRAY,void 0,!0,!0),(t=o.accept(t,a.ARRAY,void 0,!0,!0)).length!==e.length)throw n.NA;let r=[],s=[];for(let n=0;n<e.length;n++)"number"==typeof e[n]&&"number"==typeof t[n]&&(r.push(e[n]),s.push(t[n]));if(r.length<=1)throw n.DIV0;let c=i.mean(r),u=i.mean(s),l=0,f=0;for(let e=0;e<r.length;e++)l+=(s[e]-u)*(r[e]-c),f+=(s[e]-u)**2;return c-l/f*u},KURT:(...e)=>{let t=0,r=[];o.flattenParams(e,a.NUMBER,!0,(e,n)=>{"number"==typeof e&&(t+=e,r.push(e))});let n=r.length;t/=n;let s=0;for(let e=0;e<n;e++)s+=Math.pow(r[e]-t,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(s/=Math.pow(i.stdev(r,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(e,t,r,s)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),e<=0||r<=0)throw n.NUM;return s?i.lognormal.cdf(e,t,r):i.lognormal.pdf(e,t,r)},"LOGNORM.INV":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<=0||e>=1||r<=0)throw n.NUM;return i.lognormal.inv(e,t,r)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(e,t,r,s)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),e=Math.trunc(e),t=Math.trunc(t),r<0||r>1||e<0||t<1)throw n.NUM;return s?i.negbin.cdf(e,t,r):i.negbin.pdf(e,t,r)},"NORM.DIST":(e,t,r,s)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),r<=0)throw n.NUM;return s?i.normal.cdf(e,t,r):i.normal.pdf(e,t,r)},"NORM.INV":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),e<=0||e>=1||r<=0)throw n.NUM;return i.normal.inv(e,t,r)},"NORM.S.DIST":(e,t)=>(e=o.accept(e,a.NUMBER),(t=o.accept(t,a.BOOLEAN))?i.normal.cdf(e,0,1):i.normal.pdf(e,0,1)),"NORM.S.INV":e=>{if((e=o.accept(e,a.NUMBER))<=0||e>=1)throw n.NUM;return i.normal.inv(e,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:e=>Math.exp(-.5*(e=o.accept(e,a.NUMBER))*e)/2.5066282746310002,"POISSON.DIST":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.BOOLEAN),e<0||t<0)throw n.NUM;return e=Math.trunc(e),r?i.poisson.cdf(e,t):i.poisson.pdf(e,t)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),(r=o.accept(r,a.NUMBER))<=0)throw n.NUM;return(e-t)/r},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.BOOLEAN),t<1)throw n.NUM;return r?i.studentt.cdf(e,t):i.studentt.pdf(e,t)},"T.DIST.2T":(e,t)=>{if(e=o.accept(e,a.NUMBER),(t=o.accept(t,a.NUMBER))<1||e<0)throw n.NUM;return(1-i.studentt.cdf(e,t))*2},"T.DIST.RT":(e,t)=>{if(e=o.accept(e,a.NUMBER),(t=o.accept(t,a.NUMBER))<1)throw n.NUM;return 1-i.studentt.cdf(e,t)},"T.INV":(e,t)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),e<=0||e>1||t<1)throw n.NUM;return t=t%1==0?t:Math.trunc(t),i.studentt.inv(e,t)},"T.INV.2T":(e,t)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),e<=0||e>1||t<1)throw n.NUM;return t=t%1==0?t:Math.trunc(t),Math.abs(i.studentt.inv(e/2,t))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(e,t,r,i)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.BOOLEAN),e<0||t<=0||r<=0)throw n.NUM;return i?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},"Z.TEST":()=>{}};e.exports={DistributionFunctions:c}},48327:(e,t,r)=>{let n=r(77262),o=r(32156),{FormulaHelpers:a,Types:i}=r(74998),s=r(51198),c=r(61998),u=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,l=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,f=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function h(e){e=a.accept(e);let t=0,r=0,o="i";if("number"==typeof e)return{real:e,im:r,unit:o};if("boolean"==typeof e)throw n.VALUE;let i=e.match(u);if(i)return{real:t=Number(i[0]),im:r,unit:o};if(i=e.match(l))return{real:t,im:r=Number(/^\s?[+-]?\s?$/.test(i[1])?i[1]+"1":i[1]),unit:o=i[0].slice(-1)};if(i=e.match(f))return{real:t=Number(i[1]),im:r=Number(/^\s?[+-]?\s?$/.test(i[3])?i[3]+"1":i[3]),unit:o=i[0].slice(-1)};throw n.NUM}let p={BESSELI:(e,t)=>{if(e=a.accept(e,i.NUMBER_NO_BOOLEAN),(t=Math.trunc(t=a.accept(t,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.besseli(e,t)},BESSELJ:(e,t)=>{if(e=a.accept(e,i.NUMBER_NO_BOOLEAN),(t=Math.trunc(t=a.accept(t,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.besselj(e,t)},BESSELK:(e,t)=>{if(e=a.accept(e,i.NUMBER_NO_BOOLEAN),(t=Math.trunc(t=a.accept(t,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.besselk(e,t)},BESSELY:(e,t)=>{if(e=a.accept(e,i.NUMBER_NO_BOOLEAN),(t=Math.trunc(t=a.accept(t,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.bessely(e,t)},BIN2DEC:e=>{let t=(e=a.accept(e,i.NUMBER_NO_BOOLEAN)).toString();if(t.length>10)throw n.NUM;return 10===t.length&&"1"===t.substring(0,1)?parseInt(t.substring(1),2)+-512:parseInt(t,2)},BIN2HEX:(e,t)=>{e=a.accept(e,i.NUMBER_NO_BOOLEAN),t=a.accept(t,i.NUMBER_NO_BOOLEAN,null);let r=e.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substring(0,1))return(parseInt(r.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();let s=parseInt(e,2).toString(16);if(null==t)return s.toUpperCase();if(t<0)throw n.NUM;if((t=Math.trunc(t))>=s.length)return(o.REPT("0",t-s.length)+s).toUpperCase();throw n.NUM},BIN2OCT:(e,t)=>{e=a.accept(e,i.NUMBER_NO_BOOLEAN),t=a.accept(t,i.NUMBER,null);let r=e.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substr(0,1))return(parseInt(r.substr(1),2)+1073741312).toString(8);let s=parseInt(e,2).toString(8);if(null==t)return s.toUpperCase();if(t<0)throw n.NUM;if((t=Math.trunc(t))>=s.length)return o.REPT("0",t-s.length)+s;throw n.NUM},BITAND:(e,t)=>{if(e=a.accept(e,i.NUMBER),t=a.accept(t,i.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw n.NUM;return e&t},BITLSHIFT:(e,t)=>{if(e=a.accept(e,i.NUMBER),Math.abs(t=Math.trunc(t=a.accept(t,i.NUMBER)))>53||e<0||Math.floor(e)!==e||e>0xffffffffffff)throw n.NUM;let r=t>=0?e*2**t:Math.trunc(e/2**-t);if(!(r>0xffffffffffff))return r;throw n.NUM},BITOR:(e,t)=>{if(e=a.accept(e,i.NUMBER),t=a.accept(t,i.NUMBER),e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff)throw n.NUM;return e|t},BITRSHIFT:(e,t)=>(e=a.accept(e,i.NUMBER),t=a.accept(t,i.NUMBER),p.BITLSHIFT(e,-t)),BITXOR:(e,t)=>{if(e=a.accept(e,i.NUMBER),t=a.accept(t,i.NUMBER),e<0||e>0xffffffffffff||Math.floor(e)!==e||t<0||t>0xffffffffffff||Math.floor(t)!==t)throw n.NUM;return e^t},COMPLEX:(e,t,r)=>{if(e=a.accept(e,i.NUMBER_NO_BOOLEAN),t=a.accept(t,i.NUMBER_NO_BOOLEAN),"i"!==(r=a.accept(r,i.STRING,"i"))&&"j"!==r)throw n.VALUE;if(0===e&&0===t)return 0;if(0===e)return 1===t?r:-1===t?"-"+r:t.toString()+r;if(0===t)return e.toString();{let n=t>0?"+":"";return 1===t?e.toString()+n+r:-1===t?e.toString()+n+"-"+r:e.toString()+n+t.toString()+r}},DEC2BIN:(e,t)=>{if(e=a.accept(e,i.NUMBER),t=a.accept(t,i.NUMBER,null),e<-512||e>511)throw n.NUM;if(e<0)return"1"+o.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);let r=parseInt(e,10).toString(2);if(null==t)return r;if((t=Math.trunc(t))<=0||t<r.length)throw n.NUM;return o.REPT("0",t-r.length)+r},DEC2HEX:(e,t)=>{if(e=a.accept(e,i.NUMBER),t=a.accept(t,i.NUMBER,null),e<-549755813888||e>549755813888)throw n.NUM;if(e<0)return(1099511627776+e).toString(16).toUpperCase();let r=parseInt(e,10).toString(16);if(null==t)return r.toUpperCase();if((t=Math.trunc(t))<=0||t<r.length)throw n.NUM;return o.REPT("0",t-r.length)+r.toUpperCase()},DEC2OCT:(e,t)=>{if(e=a.accept(e,i.NUMBER),t=a.accept(t,i.NUMBER,null),e<-536870912||e>536870912)throw n.NUM;if(e<0)return(e+1073741824).toString(8);let r=parseInt(e,10).toString(8);if(null==t)return r.toUpperCase();if((t=Math.trunc(t))<=0||t<r.length)throw n.NUM;return o.REPT("0",t-r.length)+r},DELTA:(e,t)=>(e=a.accept(e,i.NUMBER_NO_BOOLEAN))===(t=a.accept(t,i.NUMBER_NO_BOOLEAN,0))?1:0,ERF:(e,t)=>(e=a.accept(e,i.NUMBER_NO_BOOLEAN),t=a.accept(t,i.NUMBER_NO_BOOLEAN,0),c.erf(e)),ERFC:e=>(e=a.accept(e,i.NUMBER_NO_BOOLEAN),c.erfc(e)),GESTEP:(e,t)=>(e=a.accept(e,i.NUMBER_NO_BOOLEAN))>=(t=a.accept(t,i.NUMBER_NO_BOOLEAN,0))?1:0,HEX2BIN:(e,t)=>{if(e=a.accept(e,i.STRING),t=a.accept(t,i.NUMBER,null),e.length>10||!/^[0-9a-fA-F]*$/.test(e))throw n.NUM;let r=10===e.length&&"f"===e.substr(0,1).toLowerCase(),s=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(s<-512||s>511)throw n.NUM;if(r)return"1"+o.REPT("0",9-(s+512).toString(2).length)+(s+512).toString(2);let c=s.toString(2);if(null==t)return c;if((t=Math.trunc(t))<=0||t<c.length)throw n.NUM;return o.REPT("0",t-c.length)+c},HEX2DEC:e=>{if((e=a.accept(e,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(e))throw n.NUM;let t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},HEX2OCT:(e,t)=>{if((e=a.accept(e,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(e))throw n.NUM;let r=p.HEX2DEC(e);if(r>536870911||r<-536870912)throw n.NUM;return p.DEC2OCT(r,t)},IMABS:e=>{let{real:t,im:r}=h(e);return Math.sqrt(Math.pow(t,2)+Math.pow(r,2))},IMAGINARY:e=>h(e).im,IMARGUMENT:e=>{let{real:t,im:r}=h(e);if(0===t&&0===r)throw n.DIV0;return 0===t&&r>0?Math.PI/2:0===t&&r<0?-Math.PI/2:t<0&&0===r?Math.PI:t>0&&0===r?0:t>0?Math.atan(r/t):t<0&&r>0?Math.atan(r/t)+Math.PI:Math.atan(r/t)-Math.PI},IMCONJUGATE:e=>{let{real:t,im:r,unit:n}=h(e);return 0!==r?p.COMPLEX(t,-r,n):""+t},IMCOS:e=>{let{real:t,im:r,unit:n}=h(e),o=Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,a=-Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2;return p.COMPLEX(o,a,n)},IMCOSH:e=>{let{real:t,im:r,unit:n}=h(e),o=Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,a=-Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2;return p.COMPLEX(o,-a,n)},IMCOT:e=>{e=a.accept(e);let t=p.IMCOS(e),r=p.IMSIN(e);return p.IMDIV(t,r)},IMCSC:e=>(e=a.accept(e),p.IMDIV("1",p.IMSIN(e))),IMCSCH:e=>(e=a.accept(e),p.IMDIV("1",p.IMSINH(e))),IMDIV:(e,t)=>{let r=h(e),o=r.real,a=r.im,i=r.unit,s=h(t),c=s.real,u=s.im,l=s.unit;if(0===c&&0===u||i!==l)throw n.NUM;let f=Math.pow(c,2)+Math.pow(u,2);return p.COMPLEX((o*c+a*u)/f,(a*c-o*u)/f,i)},IMEXP:e=>{let{real:t,im:r,unit:n}=h(e),o=Math.exp(t);return p.COMPLEX(o*Math.cos(r),o*Math.sin(r),n)},IMLN:e=>{let{real:t,im:r,unit:n}=h(e);return p.COMPLEX(Math.log(Math.sqrt(Math.pow(t,2)+Math.pow(r,2))),Math.atan(r/t),n)},IMLOG10:e=>{let{real:t,im:r,unit:n}=h(e),o=Math.log(Math.sqrt(Math.pow(t,2)+Math.pow(r,2)))/Math.log(10),a=Math.atan(r/t)/Math.log(10);return p.COMPLEX(o,a,n)},IMLOG2:e=>{let{real:t,im:r,unit:n}=h(e),o=Math.log(Math.sqrt(Math.pow(t,2)+Math.pow(r,2)))/Math.log(2),a=Math.atan(r/t)/Math.log(2);return p.COMPLEX(o,a,n)},IMPOWER:(e,t)=>{let{unit:r}=h(e);t=a.accept(t,i.NUMBER_NO_BOOLEAN);let n=Math.pow(p.IMABS(e),t),o=p.IMARGUMENT(e),s=n*Math.cos(t*o),c=n*Math.sin(t*o);return p.COMPLEX(s,c,r)},IMPRODUCT:(...e)=>{let t;let r=0;return a.flattenParams(e,null,!1,e=>{if(0===r)h(t=a.accept(e));else{let r=h(t),o=r.real,a=r.im,i=r.unit,s=h(e),c=s.real,u=s.im;if(i!==s.unit)throw n.VALUE;t=p.COMPLEX(o*c-a*u,o*u+a*c)}r++},1),t},IMREAL:e=>h(e).real,IMSEC:e=>p.IMDIV("1",p.IMCOS(e)),IMSECH:e=>p.IMDIV("1",p.IMCOSH(e)),IMSIN:e=>{let{real:t,im:r,unit:n}=h(e),o=Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,a=Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2;return p.COMPLEX(o,a,n)},IMSINH:e=>{let{real:t,im:r,unit:n}=h(e),o=Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,a=Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2;return p.COMPLEX(o,a,n)},IMSQRT:e=>{let{unit:t}=h(e),r=Math.sqrt(p.IMABS(e)),n=p.IMARGUMENT(e);return p.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),t)},IMSUB:(e,t)=>{let r=h(e),o=r.real,a=r.im,i=r.unit,s=h(t),c=s.real,u=s.im;if(i!==s.unit)throw n.VALUE;return p.COMPLEX(o-c,a-u,i)},IMSUM:(...e)=>{let t=0,r=0,o;return a.flattenParams(e,null,!1,e=>{let{real:a,im:i,unit:s}=h(e);if(o||(o=s),o!==s)throw n.VALUE;t+=a,r+=i}),p.COMPLEX(t,r,o)},IMTAN:e=>{let{unit:t}=h(e);return p.IMDIV(p.IMSIN(e),p.IMCOS(e),t)},OCT2BIN:(e,t)=>{if(e=a.accept(e,i.STRING),t=a.accept(t,i.NUMBER,null),e.length>10||t>10||null!==t&&t<0)throw n.NUM;t=Math.trunc(t);let r=10===e.length&&"7"===e.substring(0,1),s=p.OCT2DEC(e);if(s<-512||s>511)return n.NUM;if(r)return"1"+o.REPT("0",9-(512+s).toString(2).length)+(512+s).toString(2);let c=s.toString(2);if(0===t)return c;if(t<c.length)throw n.NUM;return o.REPT("0",t-c.length)+c},OCT2DEC:e=>{if((e=a.accept(e,i.STRING)).length>10)throw n.NUM;for(let t of e)if(t<"0"||t>"7")throw n.NUM;let t=parseInt(e,8);return t>=536870912?t-1073741824:t},OCT2HEX:(e,t)=>{if(e=a.accept(e,i.STRING),t=a.accept(t,i.NUMBER_NO_BOOLEAN,null),e.length>10)throw n.NUM;for(let t of e)if(t<"0"||t>"7")throw n.NUM;if((t=Math.trunc(t))<0||t>10)throw n.NUM;let r=p.OCT2DEC(e),s=p.DEC2HEX(r);if(0===t)return s;if(!(t<s.length))return o.REPT("0",t-s.length)+s;throw n.NUM}};e.exports=p},41257:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},s={CELL:(e,t)=>{},"ERROR.TYPE":e=>{if((e=o.accept(e))instanceof n)return i[e.toString()];throw n.NA},INFO:()=>{},ISBLANK:e=>!!e.ref&&(null==e.value||""===e.value),ISERR:e=>(e=o.accept(e))instanceof n&&"#N/A"!==e.toString(),ISERROR:e=>(e=o.accept(e))instanceof n,ISEVEN:e=>(e=Math.trunc(e=o.accept(e,a.NUMBER)))%2==0,ISLOGICAL:e=>"boolean"==typeof(e=o.accept(e)),ISNA:e=>(e=o.accept(e))instanceof n&&"#N/A"===e.toString(),ISNONTEXT:e=>"string"!=typeof(e=o.accept(e)),ISNUMBER:e=>"number"==typeof(e=o.accept(e)),ISREF:e=>!(!e.ref||o.isCellRef(e)&&(e.ref.row>1048576||e.ref.col>16384)||o.isRangeRef(e)&&(e.ref.from.row>1048576||e.ref.from.col>16384||e.ref.to.row>1048576||e.ref.to.col>16384))&&!((e=o.accept(e))instanceof n&&"#REF!"===e.toString()),ISTEXT:e=>"string"==typeof(e=o.accept(e)),N:e=>{let t=typeof(e=o.accept(e));if("number"===t)return e;if("boolean"===t)return Number(e);if(e instanceof n)throw e;return 0},NA:()=>{throw n.NA},TYPE:e=>{if(e.ref){if(o.isRangeRef(e))return 16;if(o.isCellRef(e)&&"string"==typeof(e=o.accept(e))&&0===e.length)return 1}let t=typeof(e=o.accept(e));return"number"===t?1:"string"===t?2:"boolean"===t?4:e instanceof n?16:Array.isArray(e)?64:void 0}};e.exports=s},58462:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998);function i(e){let t=0,r=0;return o.flattenParams(e,null,!0,e=>{let n=typeof e;"string"===n?"TRUE"===e?e=!0:"FALSE"===e&&(e=!1):"number"===n&&(e=!!e),"boolean"==typeof e&&(!0===e?t++:r++)}),[t,r]}let s={AND:(...e)=>{let[t,r]=i(e);return 0===t&&0===r?n.VALUE:t>0&&0===r},FALSE:()=>!1,IF:(e,t,r,n)=>(t=o.accept(t,a.BOOLEAN),r=o.accept(r),n=o.accept(n,null,!1),t?r:n),IFERROR:(e,t)=>e.value instanceof n?o.accept(t):o.accept(e),IFNA:function(e,t){if(arguments.length>2)throw n.TOO_MANY_ARGS("IFNA");return n.NA.equals(e.value)?o.accept(t):o.accept(e)},IFS:(...e)=>{if(e.length%2!=0)return new n("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let t=0;t<e.length/2;t++){let r=o.accept(e[2*t],a.BOOLEAN),n=o.accept(e[2*t+1]);if(r)return n}return n.NA},NOT:e=>!(e=o.accept(e,a.BOOLEAN)),OR:(...e)=>{let[t,r]=i(e);return 0===t&&0===r?n.VALUE:t>0},SWITCH:(...e)=>{},TRUE:()=>!0,XOR:(...e)=>{let[t,r]=i(e);return 0===t&&0===r?n.VALUE:t%2==1}};e.exports=s},39300:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,Factorials:i,Criteria:s}=r(74998),{Infix:c}=r(69520),u=[],l=[];function f(e){return e<=100?i[e]:u[e]>0?u[e]:u[e]=f(e-1)*e}let h={ABS:e=>Math.abs(e=o.accept(e,a.NUMBER)),AGGREGATE:(e,t,r,...n)=>{},ARABIC:e=>{if(e=o.accept(e,a.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))throw new n("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+=({M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1})[e]}),t},BASE:(e,t,r)=>{if((e=o.accept(e,a.NUMBER))<0||e>=9007199254740992||(t=o.accept(t,a.NUMBER))<2||t>36||(r=o.accept(r,a.NUMBER,0))<0)throw n.NUM;let i=e.toString(t).toUpperCase();return Array(Math.max(r+1-i.length,0)).join("0")+i},CEILING:(e,t)=>{if(e=o.accept(e,a.NUMBER),0===(t=o.accept(t,a.NUMBER)))return 0;if(e/t%1==0)return e;let r=Math.abs(t),n=Math.floor(Math.abs(e)/r);return e<0?t<0?-r*(n+1):-r*n:(n+1)*r},"CEILING.MATH":(e,t,r)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER,e>0?1:-1),r=o.accept(r,a.NUMBER,0),e>=0)return h.CEILING(e,t);let n=r?t:0;return h.CEILING(e,t)-n},"CEILING.PRECISE":(e,t)=>(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER,1),h.CEILING(e,Math.abs(t))),COMBIN:(e,t)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),e<0||t<0||e<t)throw n.NUM;return h.FACT(e)/h.FACT(t)/h.FACT(e-t)},COMBINA:(e,t)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),(0===e||1===e)&&0===t)return 1;if(e<0||t<0)throw n.NUM;return h.COMBIN(e+t-1,e-1)},DECIMAL:(e,t)=>{if(e=o.accept(e,a.STRING),(t=Math.trunc(t=o.accept(t,a.NUMBER)))<2||t>36)throw n.NUM;let r=parseInt(e,t);if(isNaN(r))throw n.NUM;return r},DEGREES:e=>180/Math.PI*(e=o.accept(e,a.NUMBER)),EVEN:e=>h.CEILING(e,-2),EXP:e=>Math.exp(e=o.accept(e,a.NUMBER)),FACT:e=>{if((e=Math.trunc(e=o.accept(e,a.NUMBER)))>170||e<0)throw n.NUM;return e<=100?i[e]:f(e)},FACTDOUBLE:e=>{if((e=Math.trunc(e=o.accept(e,a.NUMBER)))<-1)throw n.NUM;return -1===e?1:function e(t){return 1===t||0===t?1:2===t?2:l[t]>0?l[t]:l[t]=e(t-2)*t}(e)},FLOOR:(e,t)=>{if(e=o.accept(e,a.NUMBER),0===(t=o.accept(t,a.NUMBER)))return 0;if(e>0&&t<0)throw n.NUM;if(e/t%1==0)return e;let r=Math.abs(t),i=Math.floor(Math.abs(e)/r);return e<0?t<0?-r*i:-r*(i+1):i*r},"FLOOR.MATH":(e,t,r)=>(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER,e>0?1:-1),0===(r=o.accept(r,a.NUMBER,0))||e>=0)?h.FLOOR(e,Math.abs(t)):h.FLOOR(e,t)+t,"FLOOR.PRECISE":(e,t)=>(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER,1),h.FLOOR(e,Math.abs(t))),GCD:(...e)=>{let t=[];o.flattenParams(e,null,!1,e=>{if(isNaN(e="boolean"==typeof e?NaN:Number(e)))throw n.VALUE;if(e<0||e>9007199254740990)throw n.NUM;t.push(Math.trunc(e))},0);let r,a,i=e.length,s=Math.abs(t[0]);for(r=1;r<i;r++){for(a=Math.abs(t[r]);s&&a;)s>a?s%=a:a%=s;s+=a}return s},INT:e=>Math.floor(e=o.accept(e,a.NUMBER)),"ISO.CEILING":(...e)=>h["CEILING.PRECISE"](...e),LCM:(...e)=>{let t=[];o.flattenParams(e,null,!1,e=>{if(isNaN(e="boolean"==typeof e?NaN:Number(e)))throw n.VALUE;if(e<0||e>9007199254740990)throw n.NUM;t.push(Math.trunc(e))},1);let r=t.length,a=Math.abs(t[0]);for(let e=1;e<r;e++){let r=Math.abs(t[e]),n=a;for(;a&&r;)a>r?a%=r:r%=a;a=Math.abs(n*t[e])/(a+r)}return a},LN:e=>Math.log(e=o.accept(e,a.NUMBER)),LOG:(e,t)=>Math.log(e=o.accept(e,a.NUMBER))/Math.log(t=o.accept(t,a.NUMBER,10)),LOG10:e=>Math.log10(e=o.accept(e,a.NUMBER)),MDETERM:e=>{if((e=o.accept(e,a.ARRAY,void 0,!1,!0))[0].length!==e.length)throw n.VALUE;let t=e.length,r=e[0].length,i=0,s,c;if(1===t)return e[0][0];if(2===t)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(let n=0;n<r;n++){s=e[0][n],c=e[0][n];for(let o=1;o<t;o++)c*=e[o][((n+o)%r+r)%r],s*=e[o][((n-o)%r+r)%r];i+=c-s}return i},MINVERSE:e=>{},MMULT:(e,t)=>{e=o.accept(e,a.ARRAY,void 0,!1,!0),t=o.accept(t,a.ARRAY,void 0,!1,!0);let r=e.length,i=e[0].length,s=t.length,c=t[0].length,u=Array(r);if(i!==s)throw n.VALUE;for(let o=0;o<r;o++){u[o]=Array(c);for(let r=0;r<c;r++){u[o][r]=0;for(let a=0;a<i;a++){let i=e[o][a],s=t[a][r];if("number"!=typeof i||"number"!=typeof s)throw n.VALUE;u[o][r]+=e[o][a]*t[a][r]}}}return u},MOD:(e,t)=>{if(e=o.accept(e,a.NUMBER),0===(t=o.accept(t,a.NUMBER)))throw n.DIV0;return e-t*h.INT(e/t)},MROUND:(e,t)=>{if(e=o.accept(e,a.NUMBER),0===(t=o.accept(t,a.NUMBER)))return 0;if(e>0&&t<0||e<0&&t>0)throw n.NUM;return e/t%1==0?e:Math.round(e/t)*t},MULTINOMIAL:(...e)=>{let t=0,r=1;return o.flattenParams(e,a.NUMBER,!1,e=>{if(e<0)throw n.NUM;t+=e,r*=f(e)}),f(t)/r},MUNIT:e=>{e=o.accept(e,a.NUMBER);let t=[];for(let r=0;r<e;r++){let n=[];for(let t=0;t<e;t++)r===t?n.push(1):n.push(0);t.push(n)}return t},ODD:e=>{if(0===(e=o.accept(e,a.NUMBER)))return 1;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},PI:()=>Math.PI,POWER:(e,t)=>(e=o.accept(e,a.NUMBER))**(t=o.accept(t,a.NUMBER)),PRODUCT:(...e)=>{let t=1;return o.flattenParams(e,null,!0,(e,r)=>{let n=Number(e);r.isLiteral&&!isNaN(n)?t*=n:"number"==typeof e&&(t*=e)},1),t},QUOTIENT:(e,t)=>Math.trunc((e=o.accept(e,a.NUMBER))/(t=o.accept(t,a.NUMBER))),RADIANS:e=>(e=o.accept(e,a.NUMBER))/180*Math.PI,RAND:()=>Math.random(),RANDBETWEEN:(e,t)=>(e=o.accept(e,a.NUMBER),Math.floor(Math.random()*((t=o.accept(t,a.NUMBER))-e+1)+e)),ROMAN:(e,t)=>{if(e=o.accept(e,a.NUMBER),0!==(t=o.accept(t,a.NUMBER,0)))throw Error("ROMAN: only allows form=0 (classic form).");let r=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",s=3;for(;s--;)i=(n[+r.pop()+10*s]||"")+i;return Array(+r.join("")+1).join("M")+i},ROUND:(e,t)=>{e=o.accept(e,a.NUMBER);let r=Math.pow(10,Math.abs(t=o.accept(t,a.NUMBER))),n=e>0?1:-1;return t>0?n*Math.round(Math.abs(e)*r)/r:0===t?n*Math.round(Math.abs(e)):n*Math.round(Math.abs(e)/r)*r},ROUNDDOWN:(e,t)=>{e=o.accept(e,a.NUMBER);let r=Math.pow(10,Math.abs(t=o.accept(t,a.NUMBER))),n=e>0?1:-1;return t>0?n*Math.round((Math.abs(e)-1/r*.5)*r)/r:0===t?n*Math.round(Math.abs(e)-.5):n*Math.round((Math.abs(e)-.5*r)/r)*r},ROUNDUP:(e,t)=>{e=o.accept(e,a.NUMBER);let r=Math.pow(10,Math.abs(t=o.accept(t,a.NUMBER))),n=e>0?1:-1;return t>0?n*Math.round((Math.abs(e)+1/r*.5)*r)/r:0===t?n*Math.round(Math.abs(e)+.5):n*Math.round((Math.abs(e)+.5*r)/r)*r},SERIESSUM:(e,t,r,i)=>{e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER);let s=0,c;return o.flattenParams([i],a.NUMBER,!1,o=>{if("number"!=typeof o)throw n.VALUE;0===s?c=o*Math.pow(e,t):c+=o*Math.pow(e,t+s*r),s++}),c},SIGN:e=>(e=o.accept(e,a.NUMBER))>0?1:0===e?0:-1,SQRT:e=>{if((e=o.accept(e,a.NUMBER))<0)throw n.NUM;return Math.sqrt(e)},SQRTPI:e=>{if((e=o.accept(e,a.NUMBER))<0)throw n.NUM;return Math.sqrt(e*Math.PI)},SUBTOTAL:()=>{},SUM:(...e)=>{let t=0;return o.flattenParams(e,a.NUMBER,!0,(e,r)=>{r.isLiteral?t+=e:"number"==typeof e&&(t+=e)}),t},SUMIF:(e,t,r,n)=>{let a=o.retrieveRanges(e,t,n);t=a[0],n=a[1];let i=(r=o.retrieveArg(e,r)).isArray;r=s.parse(o.accept(r));let u=0;return t.forEach((e,t)=>{e.forEach((e,o)=>{let a=n[t][o];"number"==typeof a&&("wc"===r.op?r.match===r.value.test(e)&&(u+=a):c.compareOp(e,r.op,r.value,Array.isArray(e),i)&&(u+=a))})}),u},SUMIFS:()=>{},SUMPRODUCT:(e,...t)=>{e=o.accept(e,a.ARRAY,void 0,!1,!0),t.forEach(t=>{if(t=o.accept(t,a.ARRAY,void 0,!1,!0),e[0].length!==t[0].length||e.length!==t.length)throw n.VALUE;for(let r=0;r<e.length;r++)for(let n=0;n<e[0].length;n++)"number"!=typeof e[r][n]&&(e[r][n]=0),"number"!=typeof t[r][n]&&(t[r][n]=0),e[r][n]*=t[r][n]});let r=0;return e.forEach(e=>{e.forEach(e=>{r+=e})}),r},SUMSQ:(...e)=>{let t=0;return o.flattenParams(e,a.NUMBER,!0,(e,r)=>{r.isLiteral?t+=e**2:"number"==typeof e&&(t+=e**2)}),t},SUMX2MY2:(e,t)=>{let r=[],a=[],i=0;if(o.flattenParams([e],null,!1,(e,t)=>{r.push(e)}),o.flattenParams([t],null,!1,(e,t)=>{a.push(e)}),r.length!==a.length)throw n.NA;for(let e=0;e<r.length;e++)"number"==typeof r[e]&&"number"==typeof a[e]&&(i+=r[e]**2-a[e]**2);return i},SUMX2PY2:(e,t)=>{let r=[],a=[],i=0;if(o.flattenParams([e],null,!1,(e,t)=>{r.push(e)}),o.flattenParams([t],null,!1,(e,t)=>{a.push(e)}),r.length!==a.length)throw n.NA;for(let e=0;e<r.length;e++)"number"==typeof r[e]&&"number"==typeof a[e]&&(i+=r[e]**2+a[e]**2);return i},SUMXMY2:(e,t)=>{let r=[],a=[],i=0;if(o.flattenParams([e],null,!1,(e,t)=>{r.push(e)}),o.flattenParams([t],null,!1,(e,t)=>{a.push(e)}),r.length!==a.length)throw n.NA;for(let e=0;e<r.length;e++)"number"==typeof r[e]&&"number"==typeof a[e]&&(i+=(r[e]-a[e])**2);return i},TRUNC:e=>Math.trunc(e=o.accept(e,a.NUMBER))};e.exports=h},58640:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,WildCard:i,Address:s}=r(74998),c=r(91577),u={ADDRESS:(e,t,r,i,c)=>{if(e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER,1),i=o.accept(i,a.BOOLEAN,!0),c=o.accept(c,a.STRING,""),e<1||t<1||r<1||r>4)throw n.VALUE;let u="";return c.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(c)?u+=`'${c}'!`:u+=c+"!"),i?u+=(1===r||3===r?"$":"")+s.columnNumberToName(t)+(1===r||2===r?"$":"")+e:u+="R"+(4===r||3===r?`[${e}]`:e)+"C"+(4===r||2===r?`[${t}]`:t),u},AREAS:e=>(e=o.accept(e))instanceof c?e.length:1,CHOOSE:(e,...t)=>{},COLUMN:(e,t)=>{if(null==t){if(null!=e.position.col)return e.position.col;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof t||Array.isArray(t))throw n.VALUE;if(o.isCellRef(t))return t.ref.col;if(o.isRangeRef(t))return t.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")},COLUMNS:(e,t)=>{if(null==t)throw Error("COLUMNS requires one argument");if("object"!=typeof t||Array.isArray(t))throw n.VALUE;if(o.isCellRef(t))return 1;if(o.isRangeRef(t))return Math.abs(t.ref.from.col-t.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(e,t,r,s)=>{e=o.accept(e);try{t=o.accept(t,a.ARRAY,void 0,!1)}catch(e){if(e instanceof n)throw n.NA;throw e}if(r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===t[r-1])throw n.REF;let c=typeof e;if(s){let o=c===typeof t[0][0]?t[0][0]:null;for(let a=1;a<t[0].length;a++){let i=t[0][a];if(typeof i===c){if(o>e&&i>e)throw n.NA;if(i===e)return t[r-1][a];if(null!=o&&i>e&&o<=e)return t[r-1][a-1];o=i}}if(null==o)throw n.NA;return o}{let o=-1;if(-1===(o=i.isWildCard(e)?t[0].findIndex(t=>i.toRegex(e,"i").test(t)):t[0].findIndex(t=>t===e)))throw n.NA;return t[r-1][o]}},INDEX:(e,t,r,i,s)=>{r={value:(r=e.utils.extractRefValue(r)).val,isArray:r.isArray},r=Math.trunc(r=o.accept(r,a.NUMBER)),null==i?i=1:(i={value:(i=e.utils.extractRefValue(i)).val,isArray:i.isArray},i=Math.trunc(i=o.accept(i,a.NUMBER,1))),null==s?s=1:(s={value:(s=e.utils.extractRefValue(s)).val,isArray:s.isArray},s=Math.trunc(s=o.accept(s,a.NUMBER,1)));let u=t;if(t instanceof c)u=t.refs[s-1];else if(s>1)throw n.REF;if(0===r&&0===i)return u;if(0===r){if(o.isRangeRef(u)){if(u.ref.to.col-u.ref.from.col<i-1)throw n.REF;return u.ref.from.col+=i-1,u.ref.to.col=u.ref.from.col,u}if(Array.isArray(u)){let e=[];return u.forEach(t=>e.push([t[i-1]])),e}}if(0===i){if(o.isRangeRef(u)){if(u.ref.to.row-u.ref.from.row<r-1)throw n.REF;return u.ref.from.row+=r-1,u.ref.to.row=u.ref.from.row,u}if(Array.isArray(u))return u[i-1]}if(0!==r&&0!==i){if(o.isRangeRef(u)){if((u=u.ref).to.row-u.from.row<r-1||u.to.col-u.from.col<i-1)throw n.REF;return{ref:{row:u.from.row+r-1,col:u.from.col+i-1}}}if(o.isCellRef(u)){if(u=u.ref,r>1||i>1)throw n.REF;return{ref:{row:u.row+r-1,col:u.col+i-1}}}if(Array.isArray(u)){if(u.length<r||u[0].length<i)throw n.REF;return u[r-1][i-1]}}},MATCH:()=>{},ROW:(e,t)=>{if(null==t){if(null!=e.position.row)return e.position.row;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof t||Array.isArray(t))throw n.VALUE;if(o.isCellRef(t))return t.ref.row;if(o.isRangeRef(t))return t.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")},ROWS:(e,t)=>{if(null==t)throw Error("ROWS requires one argument");if("object"!=typeof t||Array.isArray(t))throw n.VALUE;if(o.isCellRef(t))return 1;if(o.isRangeRef(t))return Math.abs(t.ref.from.row-t.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:e=>{e=o.accept(e,a.ARRAY,void 0,!1);let t=[];for(let r=0;r<e[0].length;r++){t[r]=[];for(let n=0;n<e.length;n++)t[r][n]=e[n][r]}return t},VLOOKUP:(e,t,r,s)=>{e=o.accept(e);try{t=o.accept(t,a.ARRAY,void 0,!1)}catch(e){if(e instanceof n)throw n.NA;throw e}if(r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===t[0][r-1])throw n.REF;let c=typeof e;if(s){let o=c===typeof t[0][0]?t[0][0]:null;for(let a=1;a<t.length;a++){let i=t[a],s=t[a][0];if(typeof s===c){if(o>e&&s>e)throw n.NA;if(s===e)return i[r-1];if(null!=o&&s>e&&o<=e)return t[a-1][r-1];o=s}}if(null==o)throw n.NA;return o}{let o=-1;if(-1===(o=i.isWildCard(e)?t.findIndex(t=>i.toRegex(e,"i").test(t[0])):t.findIndex(t=>t[0]===e)))throw n.NA;return t[o][r-1]}}};e.exports=u},91479:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,Criteria:i,Address:s}=r(74998),{Infix:c}=r(69520),{DistributionFunctions:u}=r(7449),l={AVEDEV:(...e)=>{let t=0,r=[];o.flattenParams(e,a.NUMBER,!0,(e,n)=>{"number"==typeof e&&(t+=e,r.push(e))});let n=t/r.length;t=0;for(let e=0;e<r.length;e++)t+=Math.abs(r[e]-n);return t/r.length},AVERAGE:(...e)=>{let t=0,r=0;return o.flattenParams(e,a.NUMBER,!0,(e,n)=>{"number"==typeof e&&(t+=e,r++)}),t/r},AVERAGEA:(...e)=>{let t=0,r=0;return o.flattenParams(e,a.NUMBER,!0,(e,n)=>{let o=typeof e;"number"===o?(t+=e,r++):"string"===o&&r++}),t/r},AVERAGEIF:(e,t,r,a)=>{let s=o.retrieveRanges(e,t,a);t=s[0],a=s[1];let u=(r=o.retrieveArg(e,r)).isArray;r=i.parse(o.accept(r));let l=0,f=0;if(t.forEach((e,t)=>{e.forEach((e,n)=>{let o=a[t][n];"number"==typeof o&&("wc"===r.op?r.match===r.value.test(e)&&(l+=o,f++):c.compareOp(e,r.op,r.value,Array.isArray(e),u)&&(l+=o,f++))})}),0===f)throw n.DIV0;return l/f},AVERAGEIFS:()=>{},COUNT:(...e)=>{let t=0;return o.flattenParams(e,null,!0,(e,r)=>{r.isLiteral&&!isNaN(e)?t++:"number"==typeof e&&t++}),t},COUNTIF:(e,t)=>{e=o.accept(e,a.ARRAY,void 0,!1,!0);let r=t.isArray;t=o.accept(t);let n=0;return t=i.parse(t),e.forEach(e=>{e.forEach(e=>{"wc"===t.op?t.match===t.value.test(e)&&n++:c.compareOp(e,t.op,t.value,Array.isArray(e),r)&&n++})}),n},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};e.exports=Object.assign(l,u)},32156:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,WildCard:i}=r(74998),s=r(83632),c=r(92629),u={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"｡｢｣､･ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ",full:"。「」、・ヲァィゥェォャュョッーアイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワン゛゜"},extras:{delta:0,half:"\xa2\xa3\xac\xaf\xa6\xa5₩ |←↑→↓■\xb0",full:"￠￡￢￣￤￥￦　￨￩￪￫￬￭￮"}},l=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)+e.delta):[...e.full][[...e.half].indexOf(t)],f=e=>t=>e.delta?String.fromCharCode(t.charCodeAt(0)-e.delta):[...e.half][[...e.full].indexOf(t)],h=(e,t)=>e[t+"RE"]||RegExp("["+e[t]+"]","g"),p=Object.keys(u).map(e=>u[e]),d=e=>p.reduce((e,t)=>e.replace(h(t,"half"),l(t)),e),m=e=>p.reduce((e,t)=>e.replace(h(t,"full"),f(t)),e),v={ASC:e=>m(e=o.accept(e,a.STRING)),BAHTTEXT:e=>{e=o.accept(e,a.NUMBER);try{return c(e)}catch(e){throw Error(`Error in https://github.com/jojoee/bahttext 
${e.toString()}`)}},CHAR:e=>{if((e=o.accept(e,a.NUMBER))>255||e<1)throw n.VALUE;return String.fromCharCode(e)},CLEAN:e=>(e=o.accept(e,a.STRING)).replace(/[\x00-\x1F]/g,""),CODE:e=>{if(0===(e=o.accept(e,a.STRING)).length)throw n.VALUE;return e.charCodeAt(0)},CONCAT:(...e)=>{let t="";return o.flattenParams(e,a.STRING,!1,e=>{e=o.accept(e,a.STRING),t+=e}),t},CONCATENATE:(...e)=>{let t="";if(0===e.length)throw Error("CONCATENATE need at least one argument.");return e.forEach(e=>{e=o.accept(e,a.STRING),t+=e}),t},DBCS:e=>d(e=o.accept(e,a.STRING)),DOLLAR:(e,t)=>{e=o.accept(e,a.NUMBER);let r=Array(t=o.accept(t,a.NUMBER,2)).fill("0").join("");return s.format(`$#,##0.${r}_);($#,##0.${r})`,e).trim()},EXACT:(e,t)=>(e=o.accept(e,[a.STRING]))===(t=o.accept(t,[a.STRING])),FIND:(e,t,r)=>{if(e=o.accept(e,a.STRING),t=o.accept(t,a.STRING),(r=o.accept(r,a.NUMBER,1))<1||r>t.length)throw n.VALUE;let i=t.indexOf(e,r-1);if(-1===i)throw n.VALUE;return i+1},FINDB:(...e)=>v.FIND(...e),FIXED:(e,t,r)=>{e=o.accept(e,a.NUMBER),t=o.accept(t,a.NUMBER,2),r=o.accept(r,a.BOOLEAN,!1);let n=Array(t).fill("0").join(""),i=r?"":"#,";return s.format(`${i}##0.${n}_);(${i}##0.${n})`,e).trim()},LEFT:(e,t)=>{if(e=o.accept(e,a.STRING),(t=o.accept(t,a.NUMBER,1))<0)throw n.VALUE;return t>e.length?e:e.slice(0,t)},LEFTB:(...e)=>v.LEFT(...e),LEN:e=>(e=o.accept(e,a.STRING)).length,LENB:(...e)=>v.LEN(...e),LOWER:e=>(e=o.accept(e,a.STRING)).toLowerCase(),MID:(e,t,r)=>{if(e=o.accept(e,a.STRING),t=o.accept(t,a.NUMBER),r=o.accept(r,a.NUMBER),t>e.length)return"";if(t<1||r<1)throw n.VALUE;return e.slice(t-1,t+r-1)},MIDB:(...e)=>v.MID(...e),NUMBERVALUE:(e,t,r)=>{if(e=o.accept(e,a.STRING),t=o.accept(t,a.STRING,"."),r=o.accept(r,a.STRING,","),0===e.length)return 0;if(0===t.length||0===r.length||(t=t[0])===(r=r[0])||e.indexOf(t)<e.lastIndexOf(r))throw n.VALUE;let i=e.replace(r,"").replace(t,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!i)throw n.VALUE;let s=i[1].length,c=i[3].length,u=i[4].length,l=Number(i[2]);if(s>1||s&&!c||!s&&c||isNaN(l))throw n.VALUE;return l/=100**u,s?-l:l},PHONETIC:()=>{},PROPER:e=>(e=(e=(e=o.accept(e,[a.STRING])).toLowerCase()).charAt(0).toUpperCase()+e.slice(1)).replace(/(?:[^a-zA-Z])([a-zA-Z])/g,e=>e.toUpperCase()),REPLACE:(e,t,r,n)=>{e=o.accept(e,[a.STRING]),t=o.accept(t,[a.NUMBER]),r=o.accept(r,[a.NUMBER]),n=o.accept(n,[a.STRING]);let i=e.split("");return i.splice(t-1,r,n),i.join("")},REPLACEB:(...e)=>v.REPLACE(...e),REPT:(e,t)=>{e=o.accept(e,a.STRING),t=o.accept(t,a.NUMBER);let r="";for(let n=0;n<t;n++)r+=e;return r},RIGHT:(e,t)=>{if(e=o.accept(e,a.STRING),(t=o.accept(t,a.NUMBER,1))<0)throw n.VALUE;let r=e.length;return t>r?e:e.slice(r-t)},RIGHTB:(...e)=>v.RIGHT(...e),SEARCH:(e,t,r)=>{if(e=o.accept(e,a.STRING),t=o.accept(t,a.STRING),(r=o.accept(r,a.NUMBER,1))<1||r>t.length)throw n.VALUE;let s=i.isWildCard(e)?i.toRegex(e,"i"):e,c=t.slice(r-1).search(s);if(-1===c)throw n.VALUE;return c+r},SEARCHB:(...e)=>v.SEARCH(...e),SUBSTITUTE:(...e)=>{},T:e=>"string"==typeof(e=o.accept(e))?e:"",TEXT:(e,t)=>{e=o.accept(e,a.NUMBER),t=o.accept(t,a.STRING);try{return s.format(t,e)}catch(e){throw console.error(e),n.VALUE}},TEXTJOIN:(...e)=>{},TRIM:e=>(e=o.accept(e,[a.STRING])).replace(/^\s+|\s+$/g,""),UNICHAR:e=>{if((e=o.accept(e,[a.NUMBER]))<=0)throw n.VALUE;return String.fromCharCode(e)},UNICODE:e=>v.CODE(e)};e.exports=v},5230:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i={ACOS:e=>{if((e=o.accept(e,a.NUMBER))>1||e<-1)throw n.NUM;return Math.acos(e)},ACOSH:e=>{if((e=o.accept(e,a.NUMBER))<1)throw n.NUM;return Math.acosh(e)},ACOT:e=>Math.PI/2-Math.atan(e=o.accept(e,a.NUMBER)),ACOTH:e=>{if(1>=Math.abs(e=o.accept(e,a.NUMBER)))throw n.NUM;return Math.atanh(1/e)},ASIN:e=>{if((e=o.accept(e,a.NUMBER))>1||e<-1)throw n.NUM;return Math.asin(e)},ASINH:e=>Math.asinh(e=o.accept(e,a.NUMBER)),ATAN:e=>Math.atan(e=o.accept(e,a.NUMBER)),ATAN2:(e,t)=>{if(e=o.accept(e,a.NUMBER),0===(t=o.accept(t,a.NUMBER))&&0===e)throw n.DIV0;return Math.atan2(t,e)},ATANH:e=>{if(Math.abs(e=o.accept(e,a.NUMBER))>1)throw n.NUM;return Math.atanh(e)},COS:e=>{if(Math.abs(e=o.accept(e,a.NUMBER))>134217727)throw n.NUM;return Math.cos(e)},COSH:e=>Math.cosh(e=o.accept(e,a.NUMBER)),COT:e=>{if(Math.abs(e=o.accept(e,a.NUMBER))>134217727)throw n.NUM;if(0===e)throw n.DIV0;return 1/Math.tan(e)},COTH:e=>{if(0===(e=o.accept(e,a.NUMBER)))throw n.DIV0;return 1/Math.tanh(e)},CSC:e=>{if(Math.abs(e=o.accept(e,a.NUMBER))>134217727)throw n.NUM;return 1/Math.sin(e)},CSCH:e=>{if(0===(e=o.accept(e,a.NUMBER)))throw n.DIV0;return 1/Math.sinh(e)},SEC:e=>{if(Math.abs(e=o.accept(e,a.NUMBER))>134217727)throw n.NUM;return 1/Math.cos(e)},SECH:e=>1/Math.cosh(e=o.accept(e,a.NUMBER)),SIN:e=>{if(Math.abs(e=o.accept(e,a.NUMBER))>134217727)throw n.NUM;return Math.sin(e)},SINH:e=>Math.sinh(e=o.accept(e,a.NUMBER)),TAN:e=>{if(Math.abs(e=o.accept(e,a.NUMBER))>134217727)throw n.NUM;return Math.tan(e)},TANH:e=>Math.tanh(e=o.accept(e,a.NUMBER))};e.exports=i},2307:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998);e.exports={ENCODEURL:e=>encodeURIComponent(o.accept(e,a.STRING)),FILTERXML:()=>{},WEBSERVICE:(e,t)=>{throw n.ERROR("WEBSERVICE is not supported in sync mode.")}}},74998:(e,t,r)=>{let n=r(77262),o=r(91577),a={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},i={};Object.keys(a).forEach(e=>{i[a[e]]=e});class s{constructor(){this.Types=a,this.type2Number={number:a.NUMBER,boolean:a.BOOLEAN,string:a.STRING,object:-1}}checkFunctionResult(e){if("number"==typeof e){if(isNaN(e))return n.VALUE;if(!isFinite(e))return n.NUM}return null==e?n.NULL:e}flattenDeep(e){return e.reduce((e,t)=>Array.isArray(t)?e.concat(this.flattenDeep(t)):e.concat(t),[])}acceptNumber(e,t=!0,r=!0){let o;if(e instanceof n)return e;if("number"==typeof e)o=e;else if("boolean"==typeof e){if(r)o=Number(e);else throw n.VALUE}else if("string"==typeof e){if(0===e.length||(o=Number(e))!=o)throw n.VALUE}else if(Array.isArray(e)){if(t)o=this.acceptNumber(e[0][0]);else if(1===e[0].length)o=this.acceptNumber(e[0][0]);else throw n.VALUE}else throw Error("Unknown type in FormulaHelpers.acceptNumber");return o}flattenParams(e,t,r,i,s=null,c=1){if(e.length<c)throw n.ARG_MISSING([t]);null==s&&(s=t===a.NUMBER?0:null==t?null:""),e.forEach(e=>{let{isCellRef:a,isRangeRef:c,isArray:u}=e,l=e.value instanceof o,f=!a&&!c&&!u&&!l,h={isLiteral:f,isCellRef:a,isRangeRef:c,isArray:u,isUnion:l};if(f)i(e=e.omitted?s:this.accept(e,t,s),h);else if(a)i(e.value,h);else if(l){if(!r)throw n.VALUE;e=e.value.data,(e=this.flattenDeep(e)).forEach(e=>{i(e,h)})}else(c||u)&&(e=this.flattenDeep(e.value)).forEach(e=>{i(e,h)})})}accept(e,t=null,r,i=!0,s=!1){if(Array.isArray(t)&&(t=t[0]),null==e&&void 0===r)throw n.ARG_MISSING([t]);if(null==e)return r;if("object"!=typeof e||Array.isArray(e))return e;let c=e.isArray;if(null!=e.value&&(e=e.value),null==t)return e;if(e instanceof n)throw e;if(t===a.ARRAY){if(Array.isArray(e))return i?this.flattenDeep(e):e;if(e instanceof o);else if(s)return i?[e]:[[e]];throw n.VALUE}if(t===a.COLLECTIONS)return e;c&&(e=e[0][0]);let u=this.type(e);if(t===a.STRING)e=u===a.BOOLEAN?e?"TRUE":"FALSE":`${e}`;else if(t===a.BOOLEAN){if(u===a.STRING)throw n.VALUE;u===a.NUMBER&&(e=!!e)}else if(t===a.NUMBER)e=this.acceptNumber(e,!1);else if(t===a.NUMBER_NO_BOOLEAN)e=this.acceptNumber(e,!1,!1);else throw n.VALUE;return e}type(e){let t=this.type2Number[typeof e];return -1===t&&(Array.isArray(e)?t=a.ARRAY:e.ref?t=e.ref.from?a.RANGE_REF:a.CELL_REF:e instanceof o&&(t=a.COLLECTIONS)),t}isRangeRef(e){return e.ref&&e.ref.from}isCellRef(e){return e.ref&&!e.ref.from}retrieveRanges(e,t,r){return r=l.extend(t,r),t=this.retrieveArg(e,t),t=c.accept(t,a.ARRAY,void 0,!1,!0),r!==t?(r=this.retrieveArg(e,r),r=c.accept(r,a.ARRAY,void 0,!1,!0)):r=t,[t,r]}retrieveArg(e,t){if(null===t)return{value:0,isArray:!1,omitted:!0};let r=e.utils.extractRefValue(t);return{value:r.val,isArray:r.isArray,ref:t.ref}}}let c=new s,u={isWildCard:e=>"string"==typeof e&&/[*?]/.test(e),toRegex:(e,t)=>RegExp(e.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),t)},l={columnNumberToName:e=>{let t=e,r="",n=0;for(;t>0;)r=String.fromCharCode(65+(n=(t-1)%26))+r,t=Math.floor((t-n)/26);return r},columnNameToNumber:e=>{let t=(e=e.toUpperCase()).length,r=0;for(let n=0;n<t;n++){let o=e.charCodeAt(n);isNaN(o)||(r+=(o-64)*26**(t-n-1))}return r},extend:(e,t)=>{let r,n;if(null==t)return e;if(c.isCellRef(e))r=0,n=0;else if(c.isRangeRef(e))r=e.ref.to.row-e.ref.from.row,n=e.ref.to.col-e.ref.from.col;else throw Error("Address.extend should not reach here.");return c.isCellRef(t)?(r>0||n>0)&&(t={ref:{from:{col:t.ref.col,row:t.ref.row},to:{row:t.ref.row+r,col:t.ref.col+n}}}):(t.ref.to.row=t.ref.from.row+r,t.ref.to.col=t.ref.from.col+n),t}};e.exports={FormulaHelpers:c,Types:a,ReversedTypes:i,Factorials:[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],WildCard:u,Criteria:{parse:e=>{let t=typeof e;if("string"===t){let t=e.toUpperCase();if("TRUE"===t||"FALSE"===t)return{op:"=",value:"TRUE"===t};let r=e.match(/(<>|>=|<=|>|<|=)(.*)/);if(r){let e=r[1],t;if(isNaN(r[2])){let o=r[2].toUpperCase();if("TRUE"===o||"FALSE"===o)t="TRUE"===o;else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(r[2]))t=new n(r[2]);else if(t=r[2],u.isWildCard(t))return{op:"wc",value:u.toRegex(t),match:"="===e}}else t=Number(r[2]);return{op:e,value:t}}return u.isWildCard(e)?{op:"wc",value:u.toRegex(e),match:!0}:{op:"=",value:e}}if("boolean"===t||"number"===t||Array.isArray(e)||e instanceof n)return{op:"=",value:e};throw Error(`Criteria.parse: type ${typeof e} not support`)}},Address:l}},69520:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o}=r(74998),a={unaryOp:(e,t,r)=>{let a=1;if(e.forEach(e=>{if("+"===e);else if("-"===e)a=-a;else throw Error(`Unrecognized prefix: ${e}`)}),null==t&&(t=0),1===a)return t;try{t=o.acceptNumber(t,r)}catch(e){if(e instanceof n)Array.isArray(t)&&(t=t[0][0]);else throw e}return"number"==typeof t&&isNaN(t)?n.VALUE:-t}},i={percentOp:(e,t,r)=>{try{e=o.acceptNumber(e,r)}catch(e){if(e instanceof n)return e;throw e}if("%"===t)return e/100;throw Error(`Unrecognized postfix: ${t}`)}},s={boolean:3,string:2,number:1},c={compareOp:(e,t,r,n,o)=>{null==e&&(e=0),null==r&&(r=0),n&&(e=e[0][0]),o&&(r=r[0][0]);let a=typeof e,i=typeof r;if(a===i)switch(t){case"=":return e===r;case">":return e>r;case"<":return e<r;case"<>":return e!==r;case"<=":return e<=r;case">=":return e>=r}else switch(t){case"=":return!1;case">":return s[a]>s[i];case"<":return s[a]<s[i];case"<>":return!0;case"<=":return s[a]<=s[i];case">=":return s[a]>=s[i]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(e,t,r,n,o)=>(null==e&&(e=""),null==r&&(r=""),n&&(e=e[0][0]),o&&(r=r[0][0]),"boolean"==typeof e&&(e=e?"TRUE":"FALSE"),"boolean"==typeof r&&(r=r?"TRUE":"FALSE"),""+e+r),mathOp:(e,t,r,a,i)=>{null==e&&(e=0),null==r&&(r=0);try{e=o.acceptNumber(e,a),r=o.acceptNumber(r,i)}catch(e){if(e instanceof n)return e;throw e}switch(t){case"+":return e+r;case"-":return e-r;case"*":return e*r;case"/":if(0===r)return n.DIV0;return e/r;case"^":return e**r}throw Error("Infix.mathOp: Should not reach here.")}};e.exports={Prefix:a,Postfix:i,Infix:c,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}}},8025:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o}=r(74998),{Parser:a}=r(83794),i=r(57661),s=r(69692),{formatChevrotainError:c}=r(20583);class u{constructor(e){this.data=[],this.utils=new s(this),e=Object.assign({onVariable:()=>null},e),this.utils=new s(this),this.onVariable=e.onVariable,this.functions={},this.parser=new a(this,this.utils)}getCell(e){return null!=e.row&&(null==e.sheet&&(e.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(t=>t.from&&t.from.row<=e.row&&t.to.row>=e.row&&t.from.col<=e.col&&t.to.col>=e.col||t.row===e.row&&t.col===e.col&&t.sheet===e.sheet)&&this.data.push(e)),0}getRange(e){return null!=e.from.row&&(null==e.sheet&&(e.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(t=>t.from&&t.from.row===e.from.row&&t.from.col===e.from.col&&t.to.row===e.to.row&&t.to.col===e.to.col)&&this.data.push(e)),[[0]]}getVariable(e){let t={ref:this.onVariable(e,this.position.sheet)};return null==t.ref?n.NAME:(o.isCellRef(t)?this.getCell(t.ref):this.getRange(t.ref),0)}retrieveRef(e){return o.isRangeRef(e)?this.getRange(e.ref):o.isCellRef(e)?this.getCell(e.ref):e}callFunction(e,t){return t.forEach(e=>{null!=e&&this.retrieveRef(e)}),{value:0,ref:{}}}checkFormulaResult(e){this.retrieveRef(e)}parse(e,t,r=!1){if(0===e.length)throw Error("Input must not be empty.");this.data=[],this.position=t;let o=i.lex(e);this.parser.input=o.tokens;try{let e=this.parser.formulaWithBinaryOp();this.checkFormulaResult(e)}catch(e){if(!r)throw n.ERROR(e.message,e)}if(this.parser.errors.length>0&&!r)throw c(this.parser.errors[0],e);return this.data}}e.exports={DepParser:u}},69692:(e,t,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,Address:i}=r(74998),{Prefix:s,Postfix:c,Infix:u,Operators:l}=r(69520),f=r(91577);class h{constructor(e){this.context=e}columnNameToNumber(e){return i.columnNameToNumber(e)}parseCellAddress(e){let t=e.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(t[2]),row:+t[4]}}}parseRow(e){if(!Number.isInteger(+e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+e}}}parseCol(e){return{ref:{col:this.columnNameToNumber(e),row:void 0}}}applyPrefix(e,t){return this.extractRefValue(t),0}applyPostfix(e,t){return this.extractRefValue(e),0}applyInfix(e,t,r){return this.extractRefValue(e),this.extractRefValue(r),0}applyIntersect(e){let t,r,o,a,i,s,c;if(this.isFormulaError(e[0]))return e[0];if(!e[0].ref)throw Error(`Expecting a reference, but got ${e[0]}.`);let u=e.shift().ref;if(i=u.sheet,u.from)t=Math.max(u.from.row,u.to.row),o=Math.min(u.from.row,u.to.row),r=Math.max(u.from.col,u.to.col),a=Math.min(u.from.col,u.to.col);else{if(void 0===u.row||void 0===u.col)throw Error("Cannot intersect the whole row or column.");t=o=u.row,r=a=u.col}return(e.forEach(e=>{if(this.isFormulaError(e))return e;if(!(e=e.ref))throw Error(`Expecting a reference, but got ${e}.`);if(e.from){let s=Math.max(e.from.row,e.to.row),u=Math.min(e.from.row,e.to.row),l=Math.max(e.from.col,e.to.col),f=Math.min(e.from.col,e.to.col);(u>t||s<o||f>r||l<a||i!==e.sheet)&&(c=n.NULL),t=Math.min(t,s),o=Math.max(o,u),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===e.row||void 0===e.col)throw Error("Cannot intersect the whole row or column.");(e.row>t||e.row<o||e.col>r||e.col<a||i!==e.sheet)&&(c=n.NULL),t=o=e.row,r=a=e.col}}),c)?c:((s=t===o&&r===a?{ref:{sheet:i,row:t,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:t,col:r}}}).ref.sheet||delete s.ref.sheet,s)}applyUnion(e){let t=new f;for(let r=0;r<e.length;r++){if(this.isFormulaError(e[r]))return e[r];t.add(this.extractRefValue(e[r]).val,e[r])}return t}applyRange(e){let t=-1,r=-1,n=1048577,o=16385;return e.forEach(e=>{if(this.isFormulaError(e))return e;"number"==typeof e&&(e=this.parseRow(e)),void 0===(e=e.ref).row&&(n=1,t=1048576),void 0===e.col&&(o=1,r=16384),e.row>t&&(t=e.row),e.row<n&&(n=e.row),e.col>r&&(r=e.col),e.col<o&&(o=e.col)}),t===n&&r===o?{ref:{row:t,col:r}}:{ref:{from:{row:n,col:o},to:{row:t,col:r}}}}extractRefValue(e){let t=Array.isArray(e);return e.ref?{val:this.context.retrieveRef(e),isArray:t}:{val:e,isArray:t}}toArray(e){return e}toNumber(e){return Number(e)}toString(e){return e.substring(1,e.length-1).replace(/""/g,'"')}toBoolean(e){return"TRUE"===e}toError(e){return new n(e.toUpperCase())}isFormulaError(e){return e instanceof n}}e.exports=h},28983:(e,t,r)=>{let n=r(32156),o=r(39300),a=r(5230),i=r(58462),s=r(48327),c=r(58640),u=r(41257),l=r(91479),f=r(86396),h=r(2307),p=r(77262),{FormulaHelpers:d}=r(74998),{Parser:m,allTokens:v}=r(83794),g=r(57661),E=r(20583);class y{constructor(e,t=!1){this.logs=[],this.isTest=t,this.utils=new E(this),e=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},e),this.onVariable=e.onVariable,this.functions=Object.assign({},f,l,u,c,s,i,n,o,a,h,e.functions,e.functionsNeedContext),this.onRange=e.onRange,this.onCell=e.onCell,this.funsNullAs0=Object.keys(o).concat(Object.keys(a)).concat(Object.keys(i)).concat(Object.keys(s)).concat(Object.keys(c)).concat(Object.keys(l)).concat(Object.keys(f)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(e.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(u),this.parser=new m(this,this.utils)}static get allTokens(){return v}getCell(e){return null==e.sheet&&(e.sheet=this.position?this.position.sheet:void 0),this.onCell(e)}getRange(e){return null==e.sheet&&(e.sheet=this.position?this.position.sheet:void 0),this.onRange(e)}getVariable(e){let t={ref:this.onVariable(e,this.position.sheet,this.position)};return null==t.ref?p.NAME:t}retrieveRef(e){return d.isRangeRef(e)?this.getRange(e.ref):d.isCellRef(e)?this.getCell(e.ref):e}_callFunction(e,t){0===e.indexOf("_xlfn.")&&(e=e.slice(6)),e=e.toUpperCase();let r=this.funsNullAs0.includes(e)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(e)||(t=t.map(t=>{if(null===t)return{value:r,isArray:!1,omitted:!0};let n=this.utils.extractRefValue(t);return this.funsPreserveRef.includes(e)?{value:n.val,isArray:n.isArray,ref:t.ref}:{value:n.val,isArray:n.isArray,isRangeRef:!!d.isRangeRef(t),isCellRef:!!d.isCellRef(t)}})),this.functions[e]){let r;try{r=this.funsNeedContextAndNoDataRetrieve.includes(e)||this.funsNeedContext.includes(e)?this.functions[e](this,...t):this.functions[e](...t)}catch(e){if(e instanceof p)return e;throw e}if(void 0===r){if(this.isTest)return this.logs.includes(e)||this.logs.push(e),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(e)}return r}if(this.isTest)return this.logs.includes(e)||this.logs.push(e),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(e)}async callFunctionAsync(e,t){let r=[];for(let e of t)r.push(await e);let n=await this._callFunction(e,r);return d.checkFunctionResult(n)}callFunction(e,t){if(this.async)return this.callFunctionAsync(e,t);{let r=this._callFunction(e,t);return d.checkFunctionResult(r)}}supportedFunctions(){let e=[];return Object.keys(this.functions).forEach(t=>{try{let r=this.functions[t](0,0,0,0,0,0,0,0,0,0,0);if(void 0===r)return;e.push(t)}catch(r){r instanceof Error&&e.push(t)}}),e.sort()}checkFormulaResult(e,t=!1){let r=typeof e;if("number"===r){if(isNaN(e))return p.VALUE;if(!isFinite(e))return p.NUM;e+=0}else if("object"===r){if(e instanceof p)return e;if(t){if(e.ref&&(e=this.retrieveRef(e)),"object"==typeof e&&!Array.isArray(e)&&null!=e)return p.VALUE}else if(e.ref&&e.ref.row&&!e.ref.from)e=this.retrieveRef(e);else if(e.ref&&e.ref.from&&e.ref.from.col===e.ref.to.col)e=this.retrieveRef({ref:{row:e.ref.from.row,col:e.ref.from.col}});else{if(!Array.isArray(e))return p.VALUE;e=e[0][0]}}return e}parse(e,t,r=!1){let n;if(0===e.length)throw Error("Input must not be empty.");this.position=t,this.async=!1;let o=g.lex(e);this.parser.input=o.tokens;try{if(n=this.parser.formulaWithBinaryOp(),(n=this.checkFormulaResult(n,r))instanceof p)return n}catch(e){throw p.ERROR(e.message,e)}if(this.parser.errors.length>0){let t=this.parser.errors[0];throw E.formatChevrotainError(t,e)}return n}async parseAsync(e,t,r=!1){let n;if(0===e.length)throw Error("Input must not be empty.");this.position=t,this.async=!0;let o=g.lex(e);this.parser.input=o.tokens;try{if(n=await this.parser.formulaWithBinaryOp(),(n=this.checkFormulaResult(n,r))instanceof p)return n}catch(e){throw p.ERROR(e.message,e)}if(this.parser.errors.length>0){let t=this.parser.errors[0];throw E.formatChevrotainError(t,e)}return n}}e.exports={FormulaParser:y,FormulaHelpers:d}},57661:(e,t,r)=>{let{createToken:n,Lexer:o}=r(75490),a=r(77262),i={},s=n({name:"WhiteSpace",pattern:/\s+/,group:o.SKIPPED}),c=n({name:"String",pattern:/"(""|[^"])*"/}),u=n({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),l=n({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),f=n({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),h=n({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),p=n({name:"RefError",pattern:/#REF!/}),d=n({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),m=n({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),v=n({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:d}),g=n({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),E=n({name:"Boolean",pattern:/TRUE|FALSE/i}),y=n({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:d}),N=n({name:"At",pattern:/@/}),R=n({name:"Comma",pattern:/,/}),A=n({name:"Colon",pattern:/:/}),T=n({name:"Semicolon",pattern:/;/}),M=n({name:"OpenParen",pattern:/\(/}),w=n({name:"CloseParen",pattern:/\)/}),O=n({name:"OpenSquareParen",pattern:/\[/}),I=n({name:"CloseSquareParen",pattern:/]/});n({name:"exclamationMark",pattern:/!/});let b=n({name:"OpenCurlyParen",pattern:/{/}),C=n({name:"CloseCurlyParen",pattern:/}/}),x=n({name:"QuoteS",pattern:/'/}),S=n({name:"MulOp",pattern:/\*/}),U=n({name:"PlusOp",pattern:/\+/}),_=n({name:"DivOp",pattern:/\//}),L=n({name:"MinOp",pattern:/-/}),k=n({name:"ConcatOp",pattern:/&/}),P=n({name:"ExOp",pattern:/\^/}),D=n({name:"PercentOp",pattern:/%/}),B=n({name:"GtOp",pattern:/>/}),F=n({name:"EqOp",pattern:/=/}),j=n({name:"LtOp",pattern:/</}),G=[s,c,l,u,f,h,p,m,v,E,y,d,g,N,R,A,T,M,w,O,I,b,C,x,S,U,_,L,k,P,S,D,n({name:"NeqOp",pattern:/<>/}),n({name:"GteOp",pattern:/>=/}),n({name:"LteOp",pattern:/<=/}),B,F,j],V=new o(G,{ensureOptimizations:!0});G.forEach(e=>{i[e.name]=e}),e.exports={tokenVocabulary:i,lex:function(e){let t=V.tokenize(e);if(t.errors.length>0){let r=t.errors[0],n=r.line,o=r.column,i="\n"+e.split("\n")[n-1]+"\n";throw i+=Array(o-1).fill(" ").join("")+"^\n",r.message=i+`Error at position ${n}:${o}
`+r.message,r.errorLocation={line:n,column:o},a.ERROR(r.message,r)}return t}}},83794:(e,t,r)=>{let n=r(57661),{EmbeddedActionsParser:o}=r(75490),a=n.tokenVocabulary,{String:i,SheetQuoted:s,ExcelRefFunction:c,ExcelConditionalRefFunction:u,Function:l,FormulaErrorT:f,RefError:h,Cell:p,Sheet:d,Name:m,Number:v,Boolean:g,Column:E,Comma:y,Colon:N,Semicolon:R,OpenParen:A,CloseParen:T,OpenCurlyParen:M,CloseCurlyParen:w,MulOp:O,PlusOp:I,DivOp:b,MinOp:C,ConcatOp:x,ExOp:S,PercentOp:U,NeqOp:_,GteOp:L,LteOp:k,GtOp:P,EqOp:D,LtOp:B}=n.tokenVocabulary;class F extends o{constructor(e,t){super(a,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=t,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];let r=this;r.RULE("formulaWithBinaryOp",()=>{let e=[],t=[r.SUBRULE(r.formulaWithPercentOp)];return r.MANY(()=>{e.push(r.OR(r.c1||(r.c1=[{ALT:()=>r.CONSUME(P).image},{ALT:()=>r.CONSUME(D).image},{ALT:()=>r.CONSUME(B).image},{ALT:()=>r.CONSUME(_).image},{ALT:()=>r.CONSUME(L).image},{ALT:()=>r.CONSUME(k).image},{ALT:()=>r.CONSUME(x).image},{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(C).image},{ALT:()=>r.CONSUME(O).image},{ALT:()=>r.CONSUME(b).image},{ALT:()=>r.CONSUME(S).image}]))),t.push(r.SUBRULE2(r.formulaWithPercentOp))}),r.ACTION(()=>{for(let r of this.binaryOperatorsPrecedence)for(let n=0,o=e.length;n<o;n++){let a=e[n];r.includes(a)&&(e.splice(n,1),t.splice(n,2,this.utils.applyInfix(t[n],a,t[n+1])),n--,o--)}}),t[0]}),r.RULE("plusMinusOp",()=>r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(C).image}])),r.RULE("formulaWithPercentOp",()=>{let e=r.SUBRULE(r.formulaWithUnaryOp);return r.OPTION(()=>{let t=r.CONSUME(U).image;e=r.ACTION(()=>this.utils.applyPostfix(e,t))}),e}),r.RULE("formulaWithUnaryOp",()=>{let e=[];r.MANY(()=>{let t=r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(C).image}]);e.push(t)});let t=r.SUBRULE(r.formulaWithIntersect);return e.length>0?r.ACTION(()=>this.utils.applyPrefix(e,t)):t}),r.RULE("formulaWithIntersect",()=>{let e=r.SUBRULE(r.formulaWithRange),t=[e];return(r.MANY({GATE:()=>{let e=r.LA(0);return r.LA(1).startOffset>e.endOffset+1},DEF:()=>{t.push(r.SUBRULE3(r.formulaWithRange))}}),t.length>1)?r.ACTION(()=>r.ACTION(()=>this.utils.applyIntersect(t))):e}),r.RULE("formulaWithRange",()=>{let e=r.SUBRULE(r.formula),t=[e];return(r.MANY(()=>{r.CONSUME(N),t.push(r.SUBRULE2(r.formula))}),t.length>1)?r.ACTION(()=>r.ACTION(()=>this.utils.applyRange(t))):e}),r.RULE("formula",()=>r.OR9([{ALT:()=>r.SUBRULE(r.referenceWithoutInfix)},{ALT:()=>r.SUBRULE(r.paren)},{ALT:()=>r.SUBRULE(r.constant)},{ALT:()=>r.SUBRULE(r.functionCall)},{ALT:()=>r.SUBRULE(r.constantArray)}])),r.RULE("paren",()=>{let e;r.CONSUME(A);let t=[];return t.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME(y),t.push(r.SUBRULE2(r.formulaWithBinaryOp))}),e=t.length>1?r.ACTION(()=>this.utils.applyUnion(t)):t[0],r.CONSUME(T),e}),r.RULE("constantArray",()=>{let e=[[]],t=0;return r.CONSUME(M),e[t].push(r.SUBRULE(r.constantForArray)),r.MANY(()=>{let n=r.OR([{ALT:()=>r.CONSUME(y).image},{ALT:()=>r.CONSUME(R).image}]),o=r.SUBRULE2(r.constantForArray);","===n||(e[++t]=[]),e[t].push(o)}),r.CONSUME(w),r.ACTION(()=>this.utils.toArray(e))}),r.RULE("constantForArray",()=>r.OR([{ALT:()=>{let e=r.OPTION(()=>r.SUBRULE(r.plusMinusOp)),t=r.CONSUME(v).image,n=r.ACTION(()=>this.utils.toNumber(t));return e?r.ACTION(()=>this.utils.applyPrefix([e],n)):n}},{ALT:()=>{let e=r.CONSUME(i).image;return r.ACTION(()=>this.utils.toString(e))}},{ALT:()=>{let e=r.CONSUME(g).image;return r.ACTION(()=>this.utils.toBoolean(e))}},{ALT:()=>{let e=r.CONSUME(f).image;return r.ACTION(()=>this.utils.toError(e))}},{ALT:()=>{let e=r.CONSUME(h).image;return r.ACTION(()=>this.utils.toError(e))}}])),r.RULE("constant",()=>r.OR([{ALT:()=>{let e=r.CONSUME(v).image;return r.ACTION(()=>this.utils.toNumber(e))}},{ALT:()=>{let e=r.CONSUME(i).image;return r.ACTION(()=>this.utils.toString(e))}},{ALT:()=>{let e=r.CONSUME(g).image;return r.ACTION(()=>this.utils.toBoolean(e))}},{ALT:()=>{let e=r.CONSUME(f).image;return r.ACTION(()=>this.utils.toError(e))}}])),r.RULE("functionCall",()=>{let t=r.CONSUME(l).image.slice(0,-1),n=r.SUBRULE(r.arguments);return r.CONSUME(T),r.ACTION(()=>e.callFunction(t,n))}),r.RULE("arguments",()=>{r.MANY2(()=>{r.CONSUME2(y)});let e=[];return r.OPTION(()=>{e.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME1(y),e.push(null),r.OPTION3(()=>{e.pop(),e.push(r.SUBRULE2(r.formulaWithBinaryOp))})})}),e}),r.RULE("referenceWithoutInfix",()=>r.OR([{ALT:()=>r.SUBRULE(r.referenceItem)},{ALT:()=>{let e=r.SUBRULE(r.prefixName),t=r.SUBRULE2(r.formulaWithRange);return r.ACTION(()=>{if(this.utils.isFormulaError(t))return t;t.ref.sheet=e}),t}}])),r.RULE("referenceItem",()=>r.OR([{ALT:()=>{let e=r.CONSUME(p).image;return r.ACTION(()=>this.utils.parseCellAddress(e))}},{ALT:()=>{let t=r.CONSUME(m).image;return r.ACTION(()=>e.getVariable(t))}},{ALT:()=>{let e=r.CONSUME(E).image;return r.ACTION(()=>this.utils.parseCol(e))}},{ALT:()=>{let e=r.CONSUME(h).image;return r.ACTION(()=>this.utils.toError(e))}}])),r.RULE("prefixName",()=>r.OR([{ALT:()=>r.CONSUME(d).image.slice(0,-1)},{ALT:()=>r.CONSUME(s).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}e.exports={Parser:F}},91577:e=>{class t{constructor(e,t){if(null==e&&null==t)this._data=[],this._refs=[];else{if(e.length!==t.length)throw Error("Collection: data length should match references length.");this._data=e,this._refs=t}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(e,t){this._data.push(e),this._refs.push(t)}}e.exports=t},20583:(e,t,r)=>{let n=r(77262),{Address:o}=r(74998),{Prefix:a,Postfix:i,Infix:s,Operators:c}=r(69520),u=r(91577),{NotAllInputParsedException:l}=r(75490);class f{constructor(e){this.context=e}columnNameToNumber(e){return o.columnNameToNumber(e)}parseCellAddress(e){let t=e.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:t[0],col:this.columnNameToNumber(t[2]),row:+t[4]}}}parseRow(e){if(!Number.isInteger(+e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+e}}}parseCol(e){return{ref:{col:this.columnNameToNumber(e),row:void 0}}}parseColRange(e,t){return e=this.columnNameToNumber(e),t=this.columnNameToNumber(t),{ref:{from:{col:Math.min(e,t),row:null},to:{col:Math.max(e,t),row:null}}}}parseRowRange(e,t){return{ref:{from:{col:null,row:Math.min(e,t)},to:{col:null,row:Math.max(e,t)}}}}_applyPrefix(e,t,r){return this.isFormulaError(t)?t:a.unaryOp(e,t,r)}async applyPrefixAsync(e,t){let{val:r,isArray:n}=this.extractRefValue(await t);return this._applyPrefix(e,r,n)}applyPrefix(e,t){if(this.context.async)return this.applyPrefixAsync(e,t);{let{val:r,isArray:n}=this.extractRefValue(t);return this._applyPrefix(e,r,n)}}_applyPostfix(e,t,r){return this.isFormulaError(e)?e:i.percentOp(e,r,t)}async applyPostfixAsync(e,t){let{val:r,isArray:n}=this.extractRefValue(await e);return this._applyPostfix(r,n,t)}applyPostfix(e,t){if(this.context.async)return this.applyPostfixAsync(e,t);{let{val:r,isArray:n}=this.extractRefValue(e);return this._applyPostfix(r,n,t)}}_applyInfix(e,t,r){let n=e.val,o=e.isArray,a=r.val,i=r.isArray;if(this.isFormulaError(n))return n;if(this.isFormulaError(a))return a;if(c.compareOp.includes(t))return s.compareOp(n,t,a,o,i);if(c.concatOp.includes(t))return s.concatOp(n,t,a,o,i);if(c.mathOp.includes(t))return s.mathOp(n,t,a,o,i);throw Error(`Unrecognized infix: ${t}`)}async applyInfixAsync(e,t,r){let n=this.extractRefValue(await e),o=this.extractRefValue(await r);return this._applyInfix(n,t,o)}applyInfix(e,t,r){if(this.context.async)return this.applyInfixAsync(e,t,r);{let n=this.extractRefValue(e),o=this.extractRefValue(r);return this._applyInfix(n,t,o)}}applyIntersect(e){let t,r,o,a,i,s,c;if(this.isFormulaError(e[0]))return e[0];if(!e[0].ref)throw Error(`Expecting a reference, but got ${e[0]}.`);let u=e.shift().ref;if(i=u.sheet,u.from)t=Math.max(u.from.row,u.to.row),o=Math.min(u.from.row,u.to.row),r=Math.max(u.from.col,u.to.col),a=Math.min(u.from.col,u.to.col);else{if(void 0===u.row||void 0===u.col)throw Error("Cannot intersect the whole row or column.");t=o=u.row,r=a=u.col}return(e.forEach(e=>{if(this.isFormulaError(e))return e;if(!(e=e.ref))throw Error(`Expecting a reference, but got ${e}.`);if(e.from){let s=Math.max(e.from.row,e.to.row),u=Math.min(e.from.row,e.to.row),l=Math.max(e.from.col,e.to.col),f=Math.min(e.from.col,e.to.col);(u>t||s<o||f>r||l<a||i!==e.sheet)&&(c=n.NULL),t=Math.min(t,s),o=Math.max(o,u),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===e.row||void 0===e.col)throw Error("Cannot intersect the whole row or column.");(e.row>t||e.row<o||e.col>r||e.col<a||i!==e.sheet)&&(c=n.NULL),t=o=e.row,r=a=e.col}}),c)?c:((s=t===o&&r===a?{ref:{sheet:i,row:t,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:t,col:r}}}).ref.sheet||delete s.ref.sheet,s)}applyUnion(e){let t=new u;for(let r=0;r<e.length;r++){if(this.isFormulaError(e[r]))return e[r];t.add(this.extractRefValue(e[r]).val,e[r])}return t}applyRange(e){let t=-1,r=-1,n=1048577,o=16385;return e.forEach(e=>{if(this.isFormulaError(e))return e;"number"==typeof e&&(e=this.parseRow(e)),void 0===(e=e.ref).row&&(n=1,t=1048576),void 0===e.col&&(o=1,r=16384),e.row>t&&(t=e.row),e.row<n&&(n=e.row),e.col>r&&(r=e.col),e.col<o&&(o=e.col)}),t===n&&r===o?{ref:{row:t,col:r}}:{ref:{from:{row:n,col:o},to:{row:t,col:r}}}}extractRefValue(e){let t=!1;return(Array.isArray(e)&&(t=!0),e.ref)?{val:this.context.retrieveRef(e),isArray:t}:{val:e,isArray:t}}toArray(e){return e}toNumber(e){return Number(e)}toString(e){return e.substring(1,e.length-1).replace(/""/g,'"')}toBoolean(e){return"TRUE"===e}toError(e){return new n(e.toUpperCase())}isFormulaError(e){return e instanceof n}static formatChevrotainError(e,t){let r,o,a="";return e instanceof l?(r=e.token.startLine,o=e.token.startColumn):(r=e.previousToken.startLine,o=e.previousToken.startColumn+1),a+="\n"+t.split("\n")[r-1]+"\n"+Array(o-1).fill(" ").join("")+"^\n"+`Error at position ${r}:${o}
`+e.message,e.errorLocation={line:r,column:o},n.ERROR(a,e)}}e.exports=f},24661:(e,t,r)=>{let{FormulaParser:n}=r(28983),{DepParser:o}=r(8025);Object.assign(n,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:r(83632),DepParser:o,FormulaError:r(77262),...r(74998)}),e.exports=n},83632:e=>{class t{}function r(e){let t="",r=e.length-1;for(;r>=0;)t+=e.charAt(r--);return t}function n(e,t){let r="";for(;r.length<t;)r+=e;return r}function o(e,t){let r=""+e;return r.length>=t?r:n("0",t-r.length)+r}function a(e,t){let r=""+e;return r.length>=t?r:n(" ",t-r.length)+r}function i(e,t){let r=""+e;return r.length>=t?r:r+n(" ",t-r.length)}function s(e,t){let r;if(e>4294967296||e<-4294967296){let r;return(r=""+Math.round(e)).length>=t?r:n("0",t-r.length)+r}return(r=""+Math.round(e)).length>=t?r:n("0",t-r.length)+r}function c(e,t){return t=t||0,e.length>=7+t&&(32|e.charCodeAt(t))==103&&(32|e.charCodeAt(t+1))==101&&(32|e.charCodeAt(t+2))==110&&(32|e.charCodeAt(t+3))==101&&(32|e.charCodeAt(t+4))==114&&(32|e.charCodeAt(t+5))==97&&(32|e.charCodeAt(t+6))==108}t.version="0.10.3";let u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],l=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function f(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}let h={};function p(e,t,r){let n=e<0?-1:1,o=e*n,a=0,i=1,s=0,c=1,u=0,l=0,f=Math.floor(o);for(;u<t&&(s=(f=Math.floor(o))*i+a,l=f*u+c,!(o-f<5e-8));)o=1/(o-f),a=i,i=s,c=u,u=l;if(l>t&&(u>t?(l=c,s=a):(l=u,s=i)),!r)return[0,n*s,l];let h=Math.floor(n*s/l);return[h,n*s-h*l,l]}function d(e,t,r){if(e>2958465||e<0)return null;let n=0|e,o=Math.floor(86400*(e-n)),a=0,i=[],s={D:n,T:o,u:86400*(e-n)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(1e-6>Math.abs(s.u)&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,86400==++o&&(s.T=o=0,++n,++s.D)),60===n)i=r?[1317,10,29]:[1900,2,29],a=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;let e=new Date(1900,0,1);e.setDate(e.getDate()+n-1),i=[e.getFullYear(),e.getMonth()+1,e.getDate()],a=e.getDay(),n<60&&(a=(a+6)%7),r&&(a=0)}return s.y=i[0],s.m=i[1],s.d=i[2],s.S=o%60,o=Math.floor(o/60),s.M=o%60,o=Math.floor(o/60),s.H=o,s.q=a,s}f(h),t.parse_date_code=d;let m=new Date(1899,11,31,0,0,0),v=m.getTime(),g=new Date(1900,2,1,0,0,0);function E(e,t){let r=e.getTime();return t?r-=1262304e5:e>=g&&(r+=864e5),(r-(v+(e.getTimezoneOffset()-m.getTimezoneOffset())*6e4))/864e5}function y(e){return e.toString(10)}t._general_int=y;let N=function(){let e=/\.(\d*[1-9])0+$/,t=/\.0*$/,r=/\.(\d*[1-9])0+/,n=/\.0*[Ee]/,o=/(E[+-])(\d)$/;function a(r){return r.indexOf(".")>-1?r.replace(t,"").replace(e,".$1"):r}return function(t){let i=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),s;if(i>=-4&&i<=-1)s=t.toPrecision(10+i);else if(9>=Math.abs(i))s=function(e){let t=e<0?12:11,r=a(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(t);else if(10===i)s=t.toFixed(10).substr(0,12);else{let r;(r=t.toFixed(11).replace(e,".$1")).length>(t<0?12:11)&&(r=t.toPrecision(6)),s=r}return a(function(e){for(let t=0;t!==e.length;++t)if((32|e.charCodeAt(t))==101)return e.replace(r,".$1").replace(n,"E").replace("e","E").replace(o,"$10$2");return e}(s))}}();function R(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?y(e):N(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return S(14,E(e,t&&t.date1904),t)}throw Error("unsupported value in General format: "+e)}function A(e){if(e.length<=3)return e;let t=e.length%3,r=e.substr(0,t);for(;t!==e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}t._general_num=N,t._general=R;let T=function(){let e=/%/g,t=/# (\?+)( ?)\/( ?)(\d+)/,c=/^#*0*\.([0#]+)/,u=/\).*[0#]/,l=/\(###\) ###\\?-####/;function f(e){let t="",r;for(let n=0;n!==e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function h(e,t){let r=Math.pow(10,t);return""+Math.round(e*r)/r}function d(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}return function(m,v,g){return(0|g)===g?function s(h,d,m){let v;if(40===h.charCodeAt(0)&&!d.match(u)){let e=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return m>=0?s("n",e,m):"("+s("n",e,-m)+")"}if(44===d.charCodeAt(d.length-1))return function(e,t,r){let n=t.length-1;for(;44===t.charCodeAt(n-1);)--n;return T(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(h,d,m);if(-1!==d.indexOf("%"))return function(t,r,o){let a=r.replace(e,""),i=r.length-a.length;return T(t,a,o*Math.pow(10,2*i))+n("%",i)}(h,d,m);if(-1!==d.indexOf("E"))return function e(t,r){let n;let o=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0===r)return"0.0E+0";if(r<0)return"-"+e(t,-r);let a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));let i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(r/Math.pow(10,i)).toPrecision(o+1+(a+i)%a)).match(/[Ee]/)){let e=Math.floor(Math.log(r)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(e-n.length+i):n+="E+"+(e-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"})}else n=r.toExponential(o);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}(d,m);if(36===d.charCodeAt(0))return"$"+s(h,d.substr(" "==d.charAt(1)?2:1),m);let g,E,y,N=Math.abs(m),R=m<0?"-":"";if(d.match(/^00+$/))return R+o(N,d.length);if(d.match(/^[#?]+$/))return v=""+m,0===m&&(v=""),v.length>d.length?v:f(d.substr(0,d.length-v.length))+v;if(g=d.match(t)){var M;return R+(0===N?"":""+N)+n(" ",(M=g)[1].length+2+M[4].length)}if(d.match(/^#+0+$/))return R+o(N,d.length-d.indexOf("0"));if(g=d.match(c))return v=(v=(""+m).replace(/^([^\.]+)$/,"$1."+f(g[1])).replace(/\.$/,"."+f(g[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+n("0",f(g[1]).length-t.length)}),-1!==d.indexOf("0.")?v:v.replace(/^0\./,".");if(g=(d=d.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return R+(""+N).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,g[1].length?"0.":".");if(g=d.match(/^#{1,3},##0(\.?)$/))return R+A(""+N);if(g=d.match(/^#,##0\.([#0]*0)$/))return m<0?"-"+s(h,d,-m):A(""+m)+"."+n("0",g[1].length);if(g=d.match(/^#,#*,#0/))return s(h,d.replace(/^#,#*,/,""),m);if(g=d.match(/^([0#]+)(\\?-([0#]+))+$/))return v=r(s(h,d.replace(/[\\-]/g,""),m)),E=0,r(r(d.replace(/\\/g,"")).replace(/[0#]/g,function(e){return E<v.length?v.charAt(E++):"0"===e?"0":""}));if(d.match(l))return"("+(v=s(h,"##########",m)).substr(0,3)+") "+v.substr(3,3)+"-"+v.substr(6);let w="";if(g=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return y=p(N,Math.pow(10,E=Math.min(g[4].length,7))-1,!1),v=""+R," "==(w=T("n",g[1],y[1])).charAt(w.length-1)&&(w=w.substr(0,w.length-1)+"0"),v+=w+g[2]+"/"+g[3],(w=i(y[2],E)).length<g[4].length&&(w=f(g[4].substr(g[4].length-w.length))+w),v+=w;if(g=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return R+((y=p(N,Math.pow(10,E=Math.min(Math.max(g[1].length,g[4].length),7))-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?a(y[1],E)+g[2]+"/"+g[3]+i(y[2],E):n(" ",2*E+1+g[2].length+g[3].length));if(g=d.match(/^[#0?]+$/))return(v=""+m,d.length<=v.length)?v:f(d.substr(0,d.length-v.length))+v;if(g=d.match(/^([#0]+)\.([#0]+)$/)){E=(v=""+m.toFixed(Math.min(g[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");let e=d.indexOf(".")-E,t=d.length-v.length-e;return f(d.substr(0,e)+v+d.substr(d.length-t))}if(g=d.match(/^00,000\.([#0]*0)$/))return m<0?"-"+s(h,d,-m):A(""+m).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?o(0,3-e.length):"")+e})+"."+o(0,g[1].length);switch(d){case"###,###":case"##,###":case"#,###":let O=A(""+N);return"0"!==O?R+O:"";default:if(d.match(/\.[0#?]*$/))return s(h,d.slice(0,d.lastIndexOf(".")),m)+f(d.slice(d.lastIndexOf(".")))}throw Error("unsupported format |"+d+"|")}(m,v,g):function m(v,g,E){var y;let N;if(40===v.charCodeAt(0)&&!g.match(u)){let e=g.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return E>=0?m("n",e,E):"("+m("n",e,-E)+")"}if(44===g.charCodeAt(g.length-1))return function(e,t,r){let n=t.length-1;for(;44===t.charCodeAt(n-1);)--n;return T(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(v,g,E);if(-1!==g.indexOf("%"))return function(t,r,o){let a=r.replace(e,""),i=r.length-a.length;return T(t,a,o*Math.pow(10,2*i))+n("%",i)}(v,g,E);if(-1!==g.indexOf("E"))return function e(t,r){let n;let o=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0===r)return"0.0E+0";if(r<0)return"-"+e(t,-r);let a=t.indexOf(".");-1===a&&(a=t.indexOf("E"));let i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(r/Math.pow(10,i)).toPrecision(o+1+(a+i)%a)).indexOf("e")){let e=Math.floor(Math.log(r)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(e-n.length+i):n+="E+"+(e-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"})}else n=r.toExponential(o);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}(g,E);if(36===g.charCodeAt(0))return"$"+m(v,g.substr(" "==g.charAt(1)?2:1),E);let R,M,w,O=Math.abs(E),I=E<0?"-":"";if(g.match(/^00+$/))return I+s(O,g.length);if(g.match(/^[#?]+$/))return"0"===(N=s(E,0))&&(N=""),N.length>g.length?N:f(g.substr(0,g.length-N.length))+N;if(R=g.match(t))return function(e,t,r){let i=parseInt(e[4],10),s=Math.round(t*i),c=Math.floor(s/i),u=s-c*i;return r+(0===c?"":""+c)+" "+(0===u?n(" ",e[1].length+1+e[4].length):a(u,e[1].length)+e[2]+"/"+e[3]+o(i,e[4].length))}(R,O,I);if(g.match(/^#+0+$/))return I+s(O,g.length-g.indexOf("0"));if(R=g.match(c))return N=h(E,R[1].length).replace(/^([^\.]+)$/,"$1."+f(R[1])).replace(/\.$/,"."+f(R[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+n("0",f(R[1]).length-t.length)}),-1!==g.indexOf("0.")?N:N.replace(/^0\./,".");if(R=(g=g.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return I+h(O,R[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,R[1].length?"0.":".");if(R=g.match(/^#{1,3},##0(\.?)$/))return I+A(s(O,0));if(R=g.match(/^#,##0\.([#0]*0)$/))return E<0?"-"+m(v,g,-E):A(""+(Math.floor(E)+((y=R[1].length)<(""+Math.round((E-Math.floor(E))*Math.pow(10,y))).length?1:0)))+"."+o(d(E,R[1].length),R[1].length);if(R=g.match(/^#,#*,#0/))return m(v,g.replace(/^#,#*,/,""),E);if(R=g.match(/^([0#]+)(\\?-([0#]+))+$/))return N=r(m(v,g.replace(/[\\-]/g,""),E)),M=0,r(r(g.replace(/\\/g,"")).replace(/[0#]/g,function(e){return M<N.length?N.charAt(M++):"0"===e?"0":""}));if(g.match(l))return"("+(N=m(v,"##########",E)).substr(0,3)+") "+N.substr(3,3)+"-"+N.substr(6);let b="";if(R=g.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return w=p(O,Math.pow(10,M=Math.min(R[4].length,7))-1,!1),N=""+I," "===(b=T("n",R[1],w[1])).charAt(b.length-1)&&(b=b.substr(0,b.length-1)+"0"),N+=b+R[2]+"/"+R[3],(b=i(w[2],M)).length<R[4].length&&(b=f(R[4].substr(R[4].length-b.length))+b),N+=b;if(R=g.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return I+((w=p(O,Math.pow(10,M=Math.min(Math.max(R[1].length,R[4].length),7))-1,!0))[0]||(w[1]?"":"0"))+" "+(w[1]?a(w[1],M)+R[2]+"/"+R[3]+i(w[2],M):n(" ",2*M+1+R[2].length+R[3].length));if(R=g.match(/^[#0?]+$/))return(N=s(E,0),g.length<=N.length)?N:f(g.substr(0,g.length-N.length))+N;if(R=g.match(/^([#0?]+)\.([#0]+)$/)){M=(N=""+E.toFixed(Math.min(R[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");let e=g.indexOf(".")-M,t=g.length-N.length-e;return f(g.substr(0,e)+N+g.substr(g.length-t))}if(R=g.match(/^00,000\.([#0]*0)$/))return M=d(E,R[1].length),E<0?"-"+m(v,g,-E):A(E<2147483647&&E>-2147483648?""+(E>=0?0|E:E-1|0):""+Math.floor(E)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?o(0,3-e.length):"")+e})+"."+o(M,R[1].length);switch(g){case"###,##0.00":return m(v,"#,##0.00",E);case"###,###":case"##,###":case"#,###":let C=A(s(O,0));return"0"!==C?I+C:"";case"###,###.00":return m(v,"###,##0.00",E).replace(/^0\./,".");case"#,###.00":return m(v,"#,##0.00",E).replace(/^0\./,".")}throw Error("unsupported format |"+g+"|")}(m,v,g)}}();function M(e){let t=[],r=!1,n=0;for(let o=0;o<e.length;++o)switch(e.charCodeAt(o)){case 34:r=!r;break;case 95:case 42:case 92:++o;break;case 59:t[t.length]=e.substr(n,o-n),n=o+1}if(t[t.length]=e.substr(n),!0===r)throw Error("Format |"+e+"| unterminated string ");return t}t._split=M;let w=/\[[HhMmSs]*\]/;function O(e){let t=0,r="",n="";for(;t<e.length;)switch(r=e.charAt(t)){case"G":c(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;)++t;++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase()||"AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(w))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(" "===e.charAt(t)||"*"===e.charAt(t))&&++t;break;case"(":case")":case" ":default:++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);}return!1}function I(e,t,r,n){let a=[],i="",s=0,f="",h="t",p,m,v,g="H";for(;s<e.length;)switch(f=e.charAt(s)){case"G":if(!c(e,s))throw Error("unrecognized character "+f+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";34!==(v=e.charCodeAt(++s))&&s<e.length;)i+=String.fromCharCode(v);a[a.length]={t:"t",v:i},++s;break;case"\\":let o=e.charAt(++s),u="("===o||")"===o?o:"t";a[a.length]={t:u,v:o},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if("1"===e.charAt(s+1)||"2"===e.charAt(s+1)){if(null==p&&null==(p=d(t,r,"2"===e.charAt(s+1))))return"";a[a.length]={t:"X",v:e.substr(s,2)},h=f,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||null==p&&null==(p=d(t,r)))return"";for(i=f;++s<e.length&&e.charAt(s).toLowerCase()===f;)i+=f;"m"===f&&"h"===h.toLowerCase()&&(f="M"),"h"===f&&(f=g),a[a.length]={t:f,v:i},h=f;break;case"A":case"a":let l={t:f,v:f};if(null==p&&(p=d(t,r)),"A/P"===e.substr(s,3).toUpperCase()?(null!=p&&(l.v=p.H>=12?"P":"A"),l.t="T",g="h",s+=3):"AM/PM"===e.substr(s,5).toUpperCase()?(null!=p&&(l.v=p.H>=12?"PM":"AM"),l.t="T",s+=5,g="h"):(l.t="t",++s),null==p&&"T"===l.t)return"";a[a.length]=l,h=f;break;case"[":for(i=f;"]"!==e.charAt(s++)&&s<e.length;)i+=e.charAt(s);if("]"!==i.slice(-1))throw'unterminated "[" block: |'+i+"|";if(i.match(w)){if(null==p&&null==(p=d(t,r)))return"";a[a.length]={t:"Z",v:i.toLowerCase()},h=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",O(e)||(a[a.length]={t:"t",v:i}));break;case".":if(null!=p){for(i=f;++s<e.length&&"0"===(f=e.charAt(s));)i+=f;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=f;++s<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(s))>-1||"\\"==f&&"-"==e.charAt(s+1)&&s<e.length-2&&"0#".indexOf(e.charAt(s+2))>-1;)i+=f;a[a.length]={t:"n",v:i};break;case"?":for(i=f;e.charAt(++s)===f;)i+=f;a[a.length]={t:f,v:i},h=f;break;case"*":++s,(" "===e.charAt(s)||"*"===e.charAt(s))&&++s;break;case"(":case")":a[a.length]={t:1===n||"number"==typeof t&&t<0?"t":f,v:f},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=f;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:f,v:f},++s;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(f))throw Error("unrecognized character "+f+" in "+e);a[a.length]={t:"t",v:f},++s}let E=0,y=0,N;for(s=a.length-1,h="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=g,h="h",E<1&&(E=1);break;case"s":(N=a[s].v.match(/\.0+$/))&&(y=Math.max(y,N[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=a[s].t;break;case"m":"s"===h&&(a[s].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[s].v.match(/[Hh]/)&&(E=1),E<2&&a[s].v.match(/[Mm]/)&&(E=2),E<3&&a[s].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M)}let A="",M;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=function(e,t,r,n){let a="",i=0,s=0,c=r.y,f,h=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4}break;case 109:switch(t.length){case 1:case 2:f=r.m,h=t.length;break;case 3:return l[r.m-1][1];case 5:return l[r.m-1][0];default:return l[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,h=t.length;break;case 3:return u[r.q][0];default:return u[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!==t&&"ss"!==t&&".0"!==t&&".00"!==t&&".000"!==t)throw"bad second format: "+t;if(0===r.u&&("s"===t||"ss"===t))return o(r.S,t.length);if((i=Math.round((s=n>=2?3===n?1e3:100:1===n?10:1)*(r.S+r.u)))>=60*s&&(i=0),"s"===t)return 0===i?"0":""+i/s;if(a=o(i,2+n),"ss"===t)return a.substr(0,2);return"."+a.substr(2,t.length-1);case 90:switch(t){case"[h]":case"[hh]":f=24*r.D+r.H;break;case"[m]":case"[mm]":f=(24*r.D+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((24*r.D+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=3===t.length?1:2;break;case 101:f=c,h=1}return h>0?o(f,h):""}(a[s].t.charCodeAt(0),a[s].v,p,y),a[s].t="t";break;case"n":case"(":case"?":for(M=s+1;null!=a[M]&&("?"===(f=a[M].t)||"D"===f||(" "===f||"t"===f)&&null!=a[M+1]&&("?"===a[M+1].t||"t"===a[M+1].t&&"/"===a[M+1].v)||"("===a[s].t&&(" "===f||"n"===f||")"===f)||"t"===f&&("/"===a[M].v||" "===a[M].v&&null!=a[M+1]&&"?"===a[M+1].t));)a[s].v+=a[M].v,a[M]={v:"",t:";"},++M;A+=a[s].v,s=M-1;break;case"G":a[s].t="t",a[s].v=R(t,r)}let I="",b,C;if(A.length>0){40===A.charCodeAt(0)?(b=t<0&&45===A.charCodeAt(0)?-t:t,C=T("(",A,b)):(C=T("n",A,b=t<0&&n>1?-t:t),b<0&&a[0]&&"t"===a[0].t&&(C=C.substr(1),a[0].v="-"+a[0].v)),M=C.length-1;let e=a.length;for(s=0;s<a.length;++s)if(null!=a[s]&&"t"!==a[s].t&&a[s].v.indexOf(".")>-1){e=s;break}let r=a.length;if(e===a.length&&-1===C.indexOf("E")){for(s=a.length-1;s>=0;--s)null!=a[s]&&-1!=="n?(".indexOf(a[s].t)&&(M>=a[s].v.length-1?(M-=a[s].v.length,a[s].v=C.substr(M+1,a[s].v.length)):M<0?a[s].v="":(a[s].v=C.substr(0,M+1),M=-1),a[s].t="t",r=s);M>=0&&r<a.length&&(a[r].v=C.substr(0,M+1)+a[r].v)}else if(e!==a.length&&-1===C.indexOf("E")){for(M=C.indexOf(".")-1,s=e;s>=0;--s)if(null!=a[s]&&-1!=="n?(".indexOf(a[s].t)){for(m=a[s].v.indexOf(".")>-1&&s===e?a[s].v.indexOf(".")-1:a[s].v.length-1,I=a[s].v.substr(m+1);m>=0;--m)M>=0&&("0"===a[s].v.charAt(m)||"#"===a[s].v.charAt(m))&&(I=C.charAt(M--)+I);a[s].v=I,a[s].t="t",r=s}for(M>=0&&r<a.length&&(a[r].v=C.substr(0,M+1)+a[r].v),M=C.indexOf(".")+1,s=e;s<a.length;++s)if(null!=a[s]&&(-1!=="n?(".indexOf(a[s].t)||s===e)){for(m=a[s].v.indexOf(".")>-1&&s===e?a[s].v.indexOf(".")+1:0,I=a[s].v.substr(0,m);m<a[s].v.length;++m)M<C.length&&(I+=C.charAt(M++));a[s].v=I,a[s].t="t",r=s}}}for(s=0;s<a.length;++s)null!=a[s]&&"n(?".indexOf(a[s].t)>-1&&(b=n>1&&t<0&&s>0&&"-"===a[s-1].v?-t:t,a[s].v=T(a[s].t,a[s].v,b),a[s].t="t");let x="";for(s=0;s!==a.length;++s)null!=a[s]&&(x+=a[s].v);return x}t.is_date=O,t._eval=I;let b=/\[[=<>]/,C=/\[([=<>]*)(-?\d+\.?\d*)\]/;function x(e,t){if(null==t)return!1;let r=parseFloat(t[2]);switch(t[1]){case"=":if(e===r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!==r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function S(e,t,r){null==r&&(r={});let n="";switch(typeof e){case"string":n="m/d/yy"===e&&r.dateNF?r.dateNF:e;break;case"number":n=14===e&&r.dateNF?r.dateNF:(null!=r.table?r.table:h)[e]}if(c(n,0))return R(t,r);t instanceof Date&&(t=E(t,r.date1904));let o=function(e,t){let r=M(e),n=r.length,o=r[n-1].indexOf("@");if(n<4&&o>-1&&--n,r.length>4)throw Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||o>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=o>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}let a=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,a];if(null!=r[0].match(b)||null!=r[1].match(b)){let e=r[0].match(C),o=r[1].match(C);return x(t,e)?[n,r[0]]:x(t,o)?[n,r[1]]:[n,r[null!=e&&null!=o?2:1]]}return[n,a]}(n,t);if(c(o[1]))return R(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return I(o[1],t,r,o[0])}function U(e,t){if("number"!=typeof t){t=+t||-1;for(let r=0;r<392;++r){if(void 0===h[r]){t<0&&(t=r);continue}if(h[r]===e){t=r;break}}t<0&&(t=391)}return h[t]=e,t}t.load=U,t._table=h,t.get_table=function(){return h},t.load_table=function(e){for(let t=0;392!==t;++t)void 0!==e[t]&&U(e[t],t)},t.init_table=f,t.format=S,e.exports=t},61998:function(e){var t;t=function(){var e,t=function(e,t){var r=Array.prototype.concat,n=Array.prototype.slice,o=Object.prototype.toString;function a(t,r){var n=t>r?t:r;return e.pow(10,17-~~(e.log(n>0?n:-n)*e.LOG10E))}var i=Array.isArray||function(e){return"[object Array]"===o.call(e)};function s(e){return"[object Function]"===o.call(e)}function c(e){return"number"==typeof e&&e-e==0}function u(){return new u._init(arguments)}function l(){return 0}function f(){return 1}function h(e,t){return e===t?1:0}u.fn=u.prototype,u._init=function(e){if(i(e[0])){if(i(e[0][0])){s(e[1])&&(e[0]=u.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=s(e[1])?u.map(e[0],e[1]):e[0],this.length=1}else if(c(e[0]))this[0]=u.seq.apply(null,e),this.length=1;else{if(e[0]instanceof u)return u(e[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:a,isArray:i,isFunction:s,isNumber:c,toVector:function(e){return r.apply([],e)}},u._random_fn=e.random,u.setRandom=function(e){if("function"!=typeof e)throw TypeError("fn is not a function");u._random_fn=e},u.extend=function(e){var t,r;if(1==arguments.length){for(r in e)u[r]=e[r];return this}for(t=1;t<arguments.length;t++)for(r in arguments[t])e[r]=arguments[t][r];return e},u.rows=function(e){return e.length||1},u.cols=function(e){return e[0].length||1},u.dimensions=function(e){return{rows:u.rows(e),cols:u.cols(e)}},u.row=function(e,t){return i(t)?t.map(function(t){return u.row(e,t)}):e[t]},u.rowa=function(e,t){return u.row(e,t)},u.col=function(e,t){if(i(t)){var r=u.arange(e.length).map(function(){return Array(t.length)});return t.forEach(function(t,n){u.arange(e.length).forEach(function(o){r[o][n]=e[o][t]})}),r}for(var n=Array(e.length),o=0;o<e.length;o++)n[o]=[e[o][t]];return n},u.cola=function(e,t){return u.col(e,t).map(function(e){return e[0]})},u.diag=function(e){for(var t=u.rows(e),r=Array(t),n=0;n<t;n++)r[n]=[e[n][n]];return r},u.antidiag=function(e){for(var t=u.rows(e)-1,r=Array(t),n=0;t>=0;t--,n++)r[n]=[e[n][t]];return r},u.transpose=function(e){var t,r,n,o,a,s=[];for(i(e[0])||(e=[e]),r=e.length,n=e[0].length,a=0;a<n;a++){for(o=0,t=Array(r);o<r;o++)t[o]=e[o][a];s.push(t)}return 1===s.length?s[0]:s},u.map=function(e,t,r){var n,o,a,s,c;for(i(e[0])||(e=[e]),o=e.length,a=e[0].length,s=r?e:Array(o),n=0;n<o;n++)for(s[n]||(s[n]=Array(a)),c=0;c<a;c++)s[n][c]=t(e[n][c],n,c);return 1===s.length?s[0]:s},u.cumreduce=function(e,t,r){var n,o,a,s,c;for(i(e[0])||(e=[e]),o=e.length,a=e[0].length,s=r?e:Array(o),n=0;n<o;n++)for(s[n]||(s[n]=Array(a)),a>0&&(s[n][0]=e[n][0]),c=1;c<a;c++)s[n][c]=t(s[n][c-1],e[n][c]);return 1===s.length?s[0]:s},u.alter=function(e,t){return u.map(e,t,!0)},u.create=function(e,t,r){var n,o,a=Array(e);for(s(t)&&(r=t,t=e),n=0;n<e;n++)for(o=0,a[n]=Array(t);o<t;o++)a[n][o]=r(n,o);return a},u.zeros=function(e,t){return c(t)||(t=e),u.create(e,t,l)},u.ones=function(e,t){return c(t)||(t=e),u.create(e,t,f)},u.rand=function(e,t){return c(t)||(t=e),u.create(e,t,u._random_fn)},u.identity=function(e,t){return c(t)||(t=e),u.create(e,t,h)},u.symmetric=function(e){var t,r,n=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<n;t++)for(r=0;r<n;r++)if(e[r][t]!==e[t][r])return!1;return!0},u.clear=function(e){return u.alter(e,l)},u.seq=function(e,t,r,n){s(n)||(n=!1);var o,i=[],c=a(e,t),u=(t*c-e*c)/((r-1)*c),l=e;for(o=0;l<=t&&o<r;l=(e*c+u*c*++o)/c)i.push(n?n(l,o):l);return i},u.arange=function(e,r,n){var o,a=[];if(n=n||1,t===r&&(r=e,e=0),e===r||0===n||e<r&&n<0||e>r&&n>0)return[];if(n>0)for(o=e;o<r;o+=n)a.push(o);else for(o=e;o>r;o+=n)a.push(o);return a},u.slice=function(){function e(e,r,n,o){var a,i=[],s=e.length;if(t===r&&t===n&&t===o)return u.copy(e);if(r=r||0,n=n||e.length,o=o||1,(r=r>=0?r:s+r)===(n=n>=0?n:s+n)||0===o||r<n&&o<0||r>n&&o>0)return[];if(o>0)for(a=r;a<n;a+=o)i.push(e[a]);else for(a=r;a>n;a+=o)i.push(e[a]);return i}return function(t,r){if(c((r=r||{}).row)){var n,o;return c(r.col)?t[r.row][r.col]:e(u.rowa(t,r.row),(n=r.col||{}).start,n.end,n.step)}return c(r.col)?e(u.cola(t,r.col),(o=r.row||{}).start,o.end,o.step):(o=r.row||{},n=r.col||{},e(t,o.start,o.end,o.step).map(function(t){return e(t,n.start,n.end,n.step)}))}}(),u.sliceAssign=function(r,n,o){var a,i;if(c(n.row)){if(c(n.col))return r[n.row][n.col]=o;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,a=u.arange(n.col.start,e.min(r.length,n.col.end),n.col.step);var s=n.row;return a.forEach(function(e,t){r[s][e]=o[t]}),r}if(c(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,i=u.arange(n.row.start,e.min(r[0].length,n.row.end),n.row.step);var l=n.col;return i.forEach(function(e,t){r[e][l]=o[t]}),r}return t===o[0].length&&(o=[o]),n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,i=u.arange(n.row.start,e.min(r.length,n.row.end),n.row.step),a=u.arange(n.col.start,e.min(r[0].length,n.col.end),n.col.step),i.forEach(function(e,t){a.forEach(function(n,a){r[e][n]=o[t][a]})}),r},u.diagonal=function(e){var t=u.zeros(e.length,e.length);return e.forEach(function(e,r){t[r][r]=e}),t},u.copy=function(e){return e.map(function(e){return c(e)?e:e.map(function(e){return e})})};var p=u.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},p.map=function(e,t){return u(u.map(this,e,t))},p.cumreduce=function(e,t){return u(u.cumreduce(this,e,t))},p.alter=function(e){return u.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t){var r,n=this;return t?(setTimeout(function(){t.call(n,p[e].call(n))}),this):i(r=u[e](this))?u(r):r}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t,r){var n=this;return r?(setTimeout(function(){r.call(n,p[e].call(n,t))}),this):u(u[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(){return u(u[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),u}(Math);return function(e,t){var r=e.utils.isFunction;function n(e,t){return e-t}function o(e,r,n){return t.max(r,t.min(e,n))}e.sum=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t},e.sumsqrd=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r]*e[r];return t},e.sumsqerr=function(t){for(var r,n=e.mean(t),o=0,a=t.length;--a>=0;)o+=(r=t[a]-n)*r;return o},e.sumrow=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t},e.product=function(e){for(var t=1,r=e.length;--r>=0;)t*=e[r];return t},e.min=function(e){for(var t=e[0],r=0;++r<e.length;)e[r]<t&&(t=e[r]);return t},e.max=function(e){for(var t=e[0],r=0;++r<e.length;)e[r]>t&&(t=e[r]);return t},e.unique=function(e){for(var t={},r=[],n=0;n<e.length;n++)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(r){var n=r.map(t.log),o=e.mean(n);return t.exp(o)},e.median=function(e){var t=e.length,r=e.slice().sort(n);return 1&t?r[t/2|0]:(r[t/2-1]+r[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,function(e,t){return e+t})},e.cumprod=function(t){return e.cumreduce(t,function(e,t){return e*t})},e.diff=function(e){var t,r=[],n=e.length;for(t=1;t<n;t++)r.push(e[t]-e[t-1]);return r},e.rank=function(e){var t,r=[],o={};for(t=0;t<e.length;t++){var a=e[t];o[a]?o[a]++:(o[a]=1,r.push(a))}var i=r.sort(n),s={},c=1;for(t=0;t<i.length;t++){var a=i[t],u=o[a],l=(c+(c+u-1))/2;s[a]=l,c+=u}return e.map(function(e){return s[e]})},e.mode=function(e){var t,r=e.length,o=e.slice().sort(n),a=1,i=0,s=0,c=[];for(t=0;t<r;t++)o[t]===o[t+1]?a++:(a>i?(c=[o[t]],i=a,s=0):a===i&&(c.push(o[t]),s++),a=1);return 0===s?c[0]:c},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,r){return e.sumsqerr(t)/(t.length-(r?1:0))},e.pooledvariance=function(t){return t.reduce(function(t,r){return t+e.sumsqerr(r)},0)/(t.reduce(function(e,t){return e+t.length},0)-t.length)},e.deviation=function(t){for(var r=e.mean(t),n=t.length,o=Array(n),a=0;a<n;a++)o[a]=t[a]-r;return o},e.stdev=function(r,n){return t.sqrt(e.variance(r,n))},e.pooledstdev=function(r){return t.sqrt(e.pooledvariance(r))},e.meandev=function(r){for(var n=e.mean(r),o=[],a=r.length-1;a>=0;a--)o.push(t.abs(r[a]-n));return e.mean(o)},e.meddev=function(r){for(var n=e.median(r),o=[],a=r.length-1;a>=0;a--)o.push(t.abs(r[a]-n));return e.median(o)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var r=e.length,o=e.slice().sort(n);return[o[t.round(r/4)-1],o[t.round(r/2)-1],o[t.round(3*r/4)-1]]},e.quantiles=function(e,r,a,i){var s,c,u,l,f,h,p=e.slice().sort(n),d=[r.length],m=e.length;for(void 0===a&&(a=3/8),void 0===i&&(i=3/8),s=0;s<r.length;s++)u=a+(c=r[s])*(1-a-i),l=m*c+u,f=t.floor(o(l,1,m-1)),h=o(l-f,0,1),d[s]=(1-h)*p[f-1]+h*p[f];return d},e.percentile=function(e,t,r){var o=e.slice().sort(n),a=t*(o.length+(r?1:-1))+(r?0:1),i=parseInt(a);return i+1<o.length?o[i-1]+(a-i)*(o[i]-o[i-1]):o[i-1]},e.percentileOfScore=function(e,t,r){var n,o,a=0,i=e.length,s=!1;for("strict"===r&&(s=!0),o=0;o<i;o++)n=e[o],(s&&n<t||!s&&n<=t)&&a++;return a/i},e.histogram=function(r,n){n=n||4;var o,a=e.min(r),i=(e.max(r)-a)/n,s=r.length,c=[];for(o=0;o<n;o++)c[o]=0;for(o=0;o<s;o++)c[t.min(t.floor((r[o]-a)/i),n-1)]+=1;return c},e.covariance=function(t,r){var n,o=e.mean(t),a=e.mean(r),i=t.length,s=Array(i);for(n=0;n<i;n++)s[n]=(t[n]-o)*(r[n]-a);return e.sum(s)/(i-1)},e.corrcoeff=function(t,r){return e.covariance(t,r)/e.stdev(t,1)/e.stdev(r,1)},e.spearmancoeff=function(t,r){return t=e.rank(t),r=e.rank(r),e.corrcoeff(t,r)},e.stanMoment=function(r,n){for(var o=e.mean(r),a=e.stdev(r),i=r.length,s=0,c=0;c<i;c++)s+=t.pow((r[c]-o)/a,n);return s/r.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var a=e.prototype;(function(t){for(var n=0;n<t.length;n++)!function(t){a[t]=function(n,o){var i=[],s=0,c=this;if(r(n)&&(o=n,n=!1),o)return setTimeout(function(){o.call(c,a[t].call(c,n))}),this;if(this.length>1){for(c=!0===n?this:this.transpose();s<c.length;s++)i[s]=e[t](c[s]);return i}return e[t](this[0],n)}}(t[n])})("cumsum cumprod".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){a[t]=function(n,o){var i=[],s=0,c=this;if(r(n)&&(o=n,n=!1),o)return setTimeout(function(){o.call(c,a[t].call(c,n))}),this;if(this.length>1){for("sumrow"!==t&&(c=!0===n?this:this.transpose());s<c.length;s++)i[s]=e[t](c[s]);return!0===n?e[t](e.utils.toVector(i)):i}return e[t](this[0],n)}}(t[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){a[t]=function(){var n,o=[],i=0,s=this,c=Array.prototype.slice.call(arguments);if(r(c[c.length-1])){n=c[c.length-1];var u=c.slice(0,c.length-1);return setTimeout(function(){n.call(s,a[t].apply(s,u))}),this}n=void 0;var l=function(r){return e[t].apply(s,[r].concat(c))};if(this.length>1){for(s=s.transpose();i<s.length;i++)o[i]=l(s[i]);return o}return l(this[0])}}(t[n])}("quantiles percentileOfScore".split(" "))}(t,Math),e=Math,t.gammaln=function(t){var r,n,o=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-.000005395239384953],i=1.000000000190015;for(n=(r=t)+5.5,n-=(t+.5)*e.log(n);o<6;o++)i+=a[o]/++r;return e.log(2.5066282746310007*i/t)-n},t.loggam=function(t){var r,n,o,a,i,s,c,u=[.08333333333333333,-.002777777777777778,7936507936507937e-19,-.0005952380952380952,8417508417508418e-19,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(r=t,c=0,1==t||2==t)return 0;for(t<=7&&(c=e.floor(7-t),r=t+c),n=1/(r*r),o=2*e.PI,i=-1.3924322169059,s=8;s>=0;s--)i*=n,i+=u[s];if(a=i/r+.5*e.log(o)+(r-.5)*e.log(r)-r,t<=7)for(s=1;s<=c;s++)a-=e.log(r-1),r-=1;return a},t.gammafn=function(t){var r,n,o,a,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],c=!1,u=0,l=0,f=0,h=t;if(t>171.6243769536076)return 1/0;if(h<=0){if(!(a=h%1+36e-17))return 1/0;c=(1&h?-1:1)*e.PI/e.sin(e.PI*a),h=1-h}for(r=0,o=h,n=h<1?h++:(h-=u=(0|h)-1)-1;r<8;++r)f=(f+i[r])*n,l=l*n+s[r];if(a=f/l+1,o<h)a/=o;else if(o>h)for(r=0;r<u;++r)a*=h,h++;return c&&(a=c/a),a},t.gammap=function(e,r){return t.lowRegGamma(e,r)*t.gammafn(e)},t.lowRegGamma=function(r,n){var o,a=t.gammaln(r),i=r,s=1/r,c=s,u=n+1-r,l=1/1e-30,f=1/u,h=f,p=1,d=-~(8.5*e.log(r>=1?r:1/r)+.4*r+17);if(n<0||r<=0)return NaN;if(n<r+1){for(;p<=d;p++)s+=c*=n/++i;return s*e.exp(-n+r*e.log(n)-a)}for(;p<=d;p++)u+=2,h*=(f=1/(f=(o=-p*(p-r))*f+u))*(l=u+o/l);return 1-h*e.exp(-n+r*e.log(n)-a)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(r,n){return r>170||n>170?e.exp(t.combinationln(r,n)):t.factorial(r)/t.factorial(n)/t.factorial(r-n)},t.combinationln=function(e,r){return t.factorialln(e)-t.factorialln(r)-t.factorialln(e-r)},t.permutation=function(e,r){return t.factorial(e)/t.factorial(e-r)},t.betafn=function(r,n){if(!(r<=0)&&!(n<=0))return r+n>170?e.exp(t.betaln(r,n)):t.gammafn(r)*t.gammafn(n)/t.gammafn(r+n)},t.betaln=function(e,r){return t.gammaln(e)+t.gammaln(r)-t.gammaln(e+r)},t.betacf=function(t,r,n){var o,a,i,s,c=1,u=r+n,l=r+1,f=r-1,h=1,p=1-u*t/l;for(1e-30>e.abs(p)&&(p=1e-30),s=p=1/p;c<=100&&(o=2*c,p=1+(a=c*(n-c)*t/((f+o)*(r+o)))*p,1e-30>e.abs(p)&&(p=1e-30),h=1+a/h,1e-30>e.abs(h)&&(h=1e-30),s*=(p=1/p)*h,p=1+(a=-(r+c)*(u+c)*t/((r+o)*(l+o)))*p,1e-30>e.abs(p)&&(p=1e-30),h=1+a/h,1e-30>e.abs(h)&&(h=1e-30),s*=i=(p=1/p)*h,!(3e-7>e.abs(i-1)));c++);return s},t.gammapinv=function(r,n){var o,a,i,s,c,u,l=0,f=n-1,h=t.gammaln(n);if(r>=1)return e.max(100,n+100*e.sqrt(n));if(r<=0)return 0;for(n>1?(c=e.log(f),u=e.exp(f*(c-1)-h),s=r<.5?r:1-r,o=(2.30753+.27061*(a=e.sqrt(-2*e.log(s))))/(1+a*(.99229+.04481*a))-a,r<.5&&(o=-o),o=e.max(.001,n*e.pow(1-1/(9*n)-o/(3*e.sqrt(n)),3))):o=r<(a=1-n*(.253+.12*n))?e.pow(r/a,1/n):1-e.log(1-(r-a)/(1-a));l<12;l++){if(o<=0)return 0;if(i=(t.lowRegGamma(n,o)-r)/(a=n>1?u*e.exp(-(o-f)+f*(e.log(o)-c)):e.exp(-o+f*e.log(o)-h)),(o-=a=i/(1-.5*e.min(1,i*((n-1)/o-1))))<=0&&(o=.5*(o+a)),e.abs(a)<1e-8*o)break}return o},t.erf=function(t){var r,n,o,a,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,366839497852761e-18,42523324806907e-18,-.000020278578112534,-.000001624290004647,130365583558e-17,15626441722e-18,-.000000085238095915,6529054439e-18,5059343495e-18,-.000000000991364156,-.000000000227365122,96467911e-18,2394038e-18,-.000000000006886027,894487e-18,313092e-18,-.000000000000112708,381e-18,7106e-18,-.000000000000001523,-.000000000000000094,121e-18,-.000000000000000028],s=i.length-1,c=!1,u=0,l=0;for(t<0&&(t=-t,c=!0),n=4*(r=2/(2+t))-2;s>0;s--)o=u,u=n*u-l+i[s],l=o;return a=r*e.exp(-t*t+.5*(i[0]+n*u)-l),c?a-1:1-a},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(r){var n,o,a,i,s=0;if(r>=2)return -100;if(r<=0)return 100;for(i=r<1?r:2-r,n=-.70711*((2.30753+.27061*(a=e.sqrt(-2*e.log(i/2))))/(1+a*(.99229+.04481*a))-a);s<2;s++)o=t.erfc(n)-i,n+=o/(1.1283791670955126*e.exp(-n*n)-n*o);return r<1?n:-n},t.ibetainv=function(r,n,o){var a,i,s,c,u,l,f,h,p,d,m=n-1,v=o-1,g=0;if(r<=0)return 0;if(r>=1)return 1;for(n>=1&&o>=1?(s=r<.5?r:1-r,l=(2.30753+.27061*(c=e.sqrt(-2*e.log(s))))/(1+c*(.99229+.04481*c))-c,r<.5&&(l=-l),f=(l*l-3)/6,h=2/(1/(2*n-1)+1/(2*o-1)),p=l*e.sqrt(f+h)/h-(1/(2*o-1)-1/(2*n-1))*(f+5/6-2/(3*h)),l=n/(n+o*e.exp(2*p))):(a=e.log(n/(n+o)),i=e.log(o/(n+o)),p=(c=e.exp(n*a)/n)+(u=e.exp(o*i)/o),l=r<c/p?e.pow(n*p*r,1/n):1-e.pow(o*p*(1-r),1/o)),d=-t.gammaln(n)-t.gammaln(o)+t.gammaln(n+o);g<10&&0!==l&&1!==l&&(u=(t.ibeta(l,n,o)-r)/(c=e.exp(m*e.log(l)+v*e.log(1-l)+d)),(l-=c=u/(1-.5*e.min(1,u*(m/l-v/(1-l)))))<=0&&(l=.5*(l+c)),l>=1&&(l=.5*(l+c+1)),!(e.abs(c)<1e-8*l)||!(g>0));g++);return l},t.ibeta=function(r,n,o){var a=0===r||1===r?0:e.exp(t.gammaln(n+o)-t.gammaln(n)-t.gammaln(o)+n*e.log(r)+o*e.log(1-r));return!(r<0)&&!(r>1)&&(r<(n+1)/(n+o+2)?a*t.betacf(r,n,o)/n:1-a*t.betacf(1-r,o,n)/o)},t.randn=function(r,n){var o,a,i,s,c;if(n||(n=r),r)return t.create(r,n,function(){return t.randn()});do o=t._random_fn(),a=1.7156*(t._random_fn()-.5),c=(i=o-.449871)*i+(s=e.abs(a)+.386595)*(.196*s-.25472*i);while(c>.27597&&(c>.27846||a*a>-4*e.log(o)*o*o));return a/o},t.randg=function(r,n,o){var a,i,s,c,u,l,f=r;if(o||(o=n),r||(r=1),n)return(l=t.zeros(n,o)).alter(function(){return t.randg(r)}),l;r<1&&(r+=1),a=r-1/3,i=1/e.sqrt(9*a);do{do c=1+i*(u=t.randn());while(c<=0);c=c*c*c,s=t._random_fn()}while(s>1-.331*e.pow(u,4)&&e.log(s)>.5*u*u+a*(1-c+e.log(c)));if(r==f)return a*c;do s=t._random_fn();while(0===s);return e.pow(s,1/f)*a*c},function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(){return t(t.map(this,function(r){return t[e](r)}))}}(e[r])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}}(e[r])}("randn".split(" ")),function(e,t){function r(e,r,n,o){for(var a,i=0,s=1,c=1,u=1,l=0,f=0;t.abs((c-f)/c)>o;)f=c,i=c+(a=-(r+l)*(r+n+l)*e/(r+2*l)/(r+2*l+1))*i,s=u+a*s,l+=1,c=i+(a=l*(n-l)*e/(r+2*l-1)/(r+2*l))*c,i/=u=s+a*u,s/=u,c/=u,u=1;return c/r}function n(r,n,o){var a=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],i=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*r;if(s>=8)return 1;var c=2*e.normal.cdf(s,0,1,1,0)-1;c=c>=t.exp(-50/o)?t.pow(c,o):0;for(var u=s,l=(8-s)/(y=r>3?2:3),f=u+l,h=0,p=o-1,d=1;d<=y;d++){for(var m=0,v=.5*(f+u),g=.5*(f-u),E=1;E<=12;E++){var y,N,R=v+g*(6<E?a[(N=12-E+1)-1]:-a[(N=E)-1]),A=R*R;if(A>60)break;var T=2*e.normal.cdf(R,0,1,1,0)*.5-2*e.normal.cdf(R,r,1,1,0)*.5;T>=t.exp(-30/p)&&(m+=T=i[N-1]*t.exp(-(.5*A))*t.pow(T,p))}m*=2*g*o/t.sqrt(2*t.PI),h+=m,u=f,f+=l}return(c+=h)<=t.exp(-30/n)?0:(c=t.pow(c,n))>=1?1:c}(function(t){for(var r=0;r<t.length;r++)!function(t){e[t]=function e(t,r,n){return this instanceof e?(this._a=t,this._b=r,this._c=n,this):new e(t,r,n)},e.fn[t]=function(r,n,o){var a=e[t](r,n,o);return a.data=this,a},e[t].prototype.sample=function(r){var n=this._a,o=this._b,a=this._c;return r?e.alter(r,function(){return e[t].sample(n,o,a)}):e[t].sample(n,o,a)},function(r){for(var n=0;n<r.length;n++)!function(r){e[t].prototype[r]=function(n){var o=this._a,a=this._b,i=this._c;return(n||0===n||(n=this.data),"number"!=typeof n)?e.fn.map.call(n,function(n){return e[t][r](n,o,a,i)}):e[t][r](n,o,a,i)}}(r[n])}("pdf cdf inv".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){e[t].prototype[r]=function(){return e[t][r](this._a,this._b,this._c)}}(r[n])}("mean median mode variance".split(" "))}(t[r])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(r,n,o){return r>1||r<0?0:1==n&&1==o?1:n<512&&o<512?t.pow(r,n-1)*t.pow(1-r,o-1)/e.betafn(n,o):t.exp((n-1)*t.log(r)+(o-1)*t.log(1-r)-e.betaln(n,o))},cdf:function(t,r,n){return t>1||t<0?(t>1)*1:e.ibeta(t,r,n)},inv:function(t,r,n){return e.ibetainv(t,r,n)},mean:function(e,t){return e/(e+t)},median:function(t,r){return e.ibetainv(.5,t,r)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,r){var n=e.randg(t);return n/(n+e.randg(r))},variance:function(e,r){return e*r/(t.pow(e+r,2)*(e+r+1))}}),e.extend(e.centralF,{pdf:function(r,n,o){var a,i;return r<0?0:n<=2?0===r&&n<2?1/0:0===r&&2===n?1:1/e.betafn(n/2,o/2)*t.pow(n/o,n/2)*t.pow(r,n/2-1)*t.pow(1+n/o*r,-(n+o)/2):(a=n*r/(o+r*n),i=o/(o+r*n),n*i/2*e.binomial.pdf((n-2)/2,(n+o-2)/2,a))},cdf:function(t,r,n){return t<0?0:e.ibeta(r*t/(r*t+n),r/2,n/2)},inv:function(t,r,n){return n/(r*(1/e.ibetainv(t,r/2,n/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,r){return 2*e.randg(t/2)/t/(2*e.randg(r/2)/r)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,r,n){return n<0?0:n/(t.pow(e-r,2)+t.pow(n,2))/t.PI},cdf:function(e,r,n){return t.atan((e-r)/n)/t.PI+.5},inv:function(e,r,n){return r+n*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(r,n){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*n+r}}),e.extend(e.chisquare,{pdf:function(r,n){return r<0?0:0===r&&2===n?.5:t.exp((n/2-1)*t.log(r)-r/2-n/2*t.log(2)-e.gammaln(n/2))},cdf:function(t,r){return t<0?0:e.lowRegGamma(r/2,t/2)},inv:function(t,r){return 2*e.gammapinv(t,.5*r)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,r){return e<0?0:r*t.exp(-r*e)},cdf:function(e,r){return e<0?0:1-t.exp(-r*e)},inv:function(e,r){return-t.log(1-e)/r},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(r){return -1/r*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(r,n,o){return r<0?0:0===r&&1===n?1/o:t.exp((n-1)*t.log(r)-r/o-e.gammaln(n)-n*t.log(o))},cdf:function(t,r,n){return t<0?0:e.lowRegGamma(r,t/n)},inv:function(t,r,n){return e.gammapinv(t,r)*n},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,r){return e.randg(t)*r},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(r,n,o){return r<=0?0:t.exp(-(n+1)*t.log(r)-o/r-e.gammaln(n)+n*t.log(o))},cdf:function(t,r,n){return t<=0?0:1-e.lowRegGamma(r,n/t)},inv:function(t,r,n){return n/e.gammapinv(1-t,r)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,r){return r/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,r,n){return 0===e&&1===r?n:1===e&&1===n?r:t.exp(t.log(r)+t.log(n)+(r-1)*t.log(e)+(n-1)*t.log(1-t.pow(e,r)))},cdf:function(e,r,n){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,r),n)},inv:function(e,r,n){return t.pow(1-t.pow(1-e,1/n),1/r)},mean:function(t,r){return r*e.gammafn(1+1/t)*e.gammafn(r)/e.gammafn(1+1/t+r)},median:function(e,r){return t.pow(1-t.pow(2,-1/r),1/e)},mode:function(e,r){if(e>=1&&r>=1&&1!==e&&1!==r)return t.pow((e-1)/(e*r-1),1/e)},variance:function(){throw Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,r,n){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(n)-t.pow(t.log(e)-r,2)/(2*n*n))},cdf:function(r,n,o){return r<0?0:.5+.5*e.erf((t.log(r)-n)/t.sqrt(2*o*o))},inv:function(r,n,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*r)+n)},mean:function(e,r){return t.exp(e+r*r/2)},median:function(e){return t.exp(e)},mode:function(e,r){return t.exp(e-r*r)},sample:function(r,n){return t.exp(e.randn()*n+r)},variance:function(e,r){return(t.exp(r*r)-1)*t.exp(2*e+r*r)}}),e.extend(e.noncentralt,{pdf:function(r,n,o){return 1e-14>t.abs(o)?e.studentt.pdf(r,n):1e-14>t.abs(r)?t.exp(e.gammaln((n+1)/2)-o*o/2-.5*t.log(t.PI*n)-e.gammaln(n/2)):n/r*(e.noncentralt.cdf(r*t.sqrt(1+2/n),n+2,o)-e.noncentralt.cdf(r,n,o))},cdf:function(r,n,o){if(1e-14>t.abs(o))return e.studentt.cdf(r,n);var a=!1;r<0&&(a=!0,o=-o);for(var i=e.normal.cdf(-o,0,1),s=1e-14+1,c=1e-14+1,u=r*r/(r*r+n),l=0,f=t.exp(-o*o/2),h=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(1.5))*o;l<200||c>1e-14||s>1e-14;)c=s,l>0&&(f*=o*o/(2*l),h*=o*o/(2*(l+.5))),i+=.5*(s=f*e.beta.cdf(u,l+.5,n/2)+h*e.beta.cdf(u,l+1,n/2)),l++;return a?1-i:i}}),e.extend(e.normal,{pdf:function(e,r,n){return t.exp(-.5*t.log(2*t.PI)-t.log(n)-t.pow(e-r,2)/(2*n*n))},cdf:function(r,n,o){return .5*(1+e.erf((r-n)/t.sqrt(2*o*o)))},inv:function(t,r,n){return -1.4142135623730951*n*e.erfcinv(2*t)+r},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,r){return e.randn()*r+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,r,n){return e<r?0:n*t.pow(r,n)/t.pow(e,n+1)},cdf:function(e,r,n){return e<r?0:1-t.pow(r/e,n)},inv:function(e,r,n){return r/t.pow(1-e,1/n)},mean:function(e,r){if(!(r<=1))return r*t.pow(e,r)/(r-1)},median:function(e,r){return r*t.SQRT2*e},mode:function(e){return e},variance:function(e,r){if(!(r<=2))return e*e*r/(t.pow(r-1,2)*(r-2))}}),e.extend(e.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(t.sqrt(n)*e.betafn(.5,n/2))*t.pow(1+r*r/n,-((n+1)/2))},cdf:function(r,n){var o=n/2;return e.ibeta((r+t.sqrt(r*r+n))/(2*t.sqrt(r*r+n)),o,o)},inv:function(r,n){var o=e.ibetainv(2*t.min(r,1-r),.5*n,.5);return o=t.sqrt(n*(1-o)/o),r>.5?o:-o},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return e.randn()*t.sqrt(r/(2*e.randg(r/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,r,n){return e<0||r<0||n<0?0:n/r*t.pow(e/r,n-1)*t.exp(-t.pow(e/r,n))},cdf:function(e,r,n){return e<0?0:1-t.exp(-t.pow(e/r,n))},inv:function(e,r,n){return r*t.pow(-t.log(1-e),1/n)},mean:function(t,r){return t*e.gammafn(1+1/r)},median:function(e,r){return e*t.pow(t.log(2),1/r)},mode:function(e,r){return r<=1?0:e*t.pow((r-1)/r,1/r)},sample:function(r,n){return r*t.pow(-t.log(e._random_fn()),1/n)},variance:function(r,n){return r*r*e.gammafn(1+2/n)-t.pow(e.weibull.mean(r,n),2)}}),e.extend(e.uniform,{pdf:function(e,t,r){return e<t||e>r?0:1/(r-t)},cdf:function(e,t,r){return e<t?0:e<r?(e-t)/(r-t):1},inv:function(e,t,r){return t+e*(r-t)},mean:function(e,t){return .5*(e+t)},median:function(t,r){return e.mean(t,r)},mode:function(){throw Error("mode is not yet implemented")},sample:function(t,r){return t/2+r/2+(r/2-t/2)*(2*e._random_fn()-1)},variance:function(e,r){return t.pow(r-e,2)/12}}),e.extend(e.binomial,{pdf:function(r,n,o){return 0===o||1===o?n*o===r?1:0:e.combination(n,r)*t.pow(o,r)*t.pow(1-o,n-r)},cdf:function(n,o,a){if(n<0)return 0;if(n>=o)return 1;if(a<0||a>1||o<=0)return NaN;var i,s=(n=t.floor(n))+1,c=o-n,u=s+c,l=t.exp(e.gammaln(u)-e.gammaln(c)-e.gammaln(s)+s*t.log(a)+c*t.log(1-a));return i=a<(s+1)/(u+2)?l*r(a,s,c,1e-10):1-l*r(1-a,c,s,1e-10),t.round(1e10*(1-i))/1e10}}),e.extend(e.negbin,{pdf:function(r,n,o){return r===r>>>0&&(r<0?0:e.combination(r+n-1,n-1)*t.pow(1-o,r)*t.pow(o,n))},cdf:function(t,r,n){var o=0,a=0;if(t<0)return 0;for(;a<=t;a++)o+=e.negbin.pdf(a,r,n);return o}}),e.extend(e.hypgeom,{pdf:function(r,n,o,a){if(r!=r|0)return!1;if(r<0||r<o-(n-a)||r>a||r>o)return 0;if(2*o>n)return 2*a>n?e.hypgeom.pdf(n-o-a+r,n,n-o,n-a):e.hypgeom.pdf(a-r,n,n-o,a);if(2*a>n)return e.hypgeom.pdf(o-r,n,o,n-a);if(o<a)return e.hypgeom.pdf(r,n,a,o);for(var i=1,s=0,c=0;c<r;c++){for(;i>1&&s<a;)i*=1-o/(n-s),s++;i*=(a-c)*(o-c)/((c+1)*(n-o-a+c+1))}for(;s<a;s++)i*=1-o/(n-s);return t.min(1,t.max(0,i))},cdf:function(r,n,o,a){if(r<0||r<o-(n-a))return 0;if(r>=a||r>=o)return 1;if(2*o>n)return 2*a>n?e.hypgeom.cdf(n-o-a+r,n,n-o,n-a):1-e.hypgeom.cdf(a-r-1,n,n-o,a);if(2*a>n)return 1-e.hypgeom.cdf(o-r-1,n,o,n-a);if(o<a)return e.hypgeom.cdf(r,n,a,o);for(var i=1,s=1,c=0,u=0;u<r;u++){for(;i>1&&c<a;){var l=1-o/(n-c);s*=l,i*=l,c++}s*=(a-u)*(o-u)/((u+1)*(n-o-a+u+1)),i+=s}for(;c<a;c++)i*=1-o/(n-c);return t.min(1,t.max(0,i))}}),e.extend(e.poisson,{pdf:function(r,n){return n<0||r%1!=0||r<0?0:t.pow(n,r)*t.exp(-n)/e.factorial(r)},cdf:function(t,r){var n=[],o=0;if(t<0)return 0;for(;o<=t;o++)n.push(e.poisson.pdf(o,r));return e.sum(n)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(r){var n=1,o=0,a=t.exp(-r);do o++,n*=e._random_fn();while(n>a);return o-1},sampleLarge:function(r){var n,o,a,i,s,c,u,l,f,h;for(i=t.sqrt(r),s=t.log(r),c=-.059+.02483*(u=.931+2.53*i),l=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;)if(o=t.random()-.5,a=t.random(),h=.5-t.abs(o),n=t.floor((2*c/h+u)*o+r+.43),h>=.07&&a<=f||!(n<0)&&(!(h<.013)||!(a>h))&&t.log(a)+t.log(l)-t.log(c/(h*h)+u)<=-r+n*s-e.loggam(n+1))return n},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,r,n){return r<=t||n<t||n>r?NaN:e<t||e>r?0:e<n?2*(e-t)/((r-t)*(n-t)):e===n?2/(r-t):2*(r-e)/((r-t)*(r-n))},cdf:function(e,r,n,o){return n<=r||o<r||o>n?NaN:e<=r?0:e>=n?1:e<=o?t.pow(e-r,2)/((n-r)*(o-r)):1-t.pow(n-e,2)/((n-r)*(n-o))},inv:function(e,r,n,o){return n<=r||o<r||o>n?NaN:e<=(o-r)/(n-r)?r+(n-r)*t.sqrt((o-r)/(n-r)*e):r+(n-r)*(1-t.sqrt((1-e)*(1-(o-r)/(n-r))))},mean:function(e,t,r){return(e+t+r)/3},median:function(e,r,n){return n<=(e+r)/2?r-t.sqrt((r-e)*(r-n))/t.sqrt(2):n>(e+r)/2?e+t.sqrt((r-e)*(n-e))/t.sqrt(2):void 0},mode:function(e,t,r){return r},sample:function(r,n,o){var a=e._random_fn();return a<(o-r)/(n-r)?r+t.sqrt(a*(n-r)*(o-r)):n-t.sqrt((1-a)*(n-r)*(n-o))},variance:function(e,t,r){return(e*e+t*t+r*r-e*t-e*r-t*r)/18}}),e.extend(e.arcsine,{pdf:function(e,r,n){return n<=r?NaN:e<=r||e>=n?0:2/t.PI*t.pow(t.pow(n-r,2)-t.pow(2*e-r-n,2),-.5)},cdf:function(e,r,n){return e<r?0:e<n?2/t.PI*t.asin(t.sqrt((e-r)/(n-r))):1},inv:function(e,r,n){return r+(.5-.5*t.cos(t.PI*e))*(n-r)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,r){return r<=e?NaN:t.pow(r-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,r,n){return n<=0?0:t.exp(-t.abs(e-r)/n)/(2*n)},cdf:function(e,r,n){return n<=0?0:e<r?.5*t.exp((e-r)/n):1-.5*t.exp(-(e-r)/n)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(r,n){var o=e._random_fn()-.5;return r-o/t.abs(o)*n*t.log(1-2*t.abs(o))}}),e.extend(e.tukey,{cdf:function(r,o,a){var i=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],s=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(a<2||o<2)return NaN;if(!Number.isFinite(r))return 1;if(a>25e3)return n(r,1,o);var c=.5*a,u=c*t.log(a)-a*t.log(2)-e.gammaln(c),l=c-1,f=.25*a;d=a<=100?1:a<=800?.5:a<=5e3?.25:.125,u+=t.log(d);for(var h=0,p=1;p<=50;p++){for(var d,m,v,g=0,E=(2*p-1)*d,y=1;y<=16;y++)8<y?(m=y-8-1,v=u+l*t.log(E+i[m]*d)-(i[m]*d+E)*f):(m=y-1,v=u+l*t.log(E-i[m]*d)+(i[m]*d-E)*f),v>=-30&&(g+=n(8<y?r*t.sqrt((i[m]*d+E)*.5):r*t.sqrt((-(i[m]*d)+E)*.5),1,o)*s[m]*t.exp(v));if(p*d>=1&&g<=1e-14)break;h+=g}if(g>1e-14)throw Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(r,n,o){if(o<2||n<2||r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var a,i,s,c,u,l,f=(s=.5-.5*r,u=(c=t.sqrt(t.log(1/(s*s))))+((((-.0000453642210148*c+-.204231210125)*c+-.342242088547)*c+-1)*c+.322232421088)/((((.0038560700634*c+.10353775285)*c+.531103462366)*c+.588581570495)*c+.099348462606),o<120&&(u+=(u*u*u+u)/o/4),l=.8832-.2368*u,o<120&&(l+=-1.214/o+1.208*u/o),u*(l*t.log(n-1)+1.4142)),h=e.tukey.cdf(f,n,o)-r;a=h>0?t.max(0,f-1):f+1;for(var p=e.tukey.cdf(a,n,o)-r,d=1;d<50;d++)if(i=a-p*(a-f)/(p-h),h=p,f=a,i<0&&(i=0,p=-r),p=e.tukey.cdf(i,n,o)-r,a=i,1e-4>t.abs(a-f))return i;throw Error("tukey.inv failed to converge")}})}(t,Math),function(e,t){var r,n,o=Array.prototype.push,a=e.utils.isArray;function i(t){return a(t)||t instanceof e}e.extend({add:function(t,r){return i(r)?(i(r[0])||(r=[r]),e.map(t,function(e,t,n){return e+r[t][n]})):e.map(t,function(e){return e+r})},subtract:function(t,r){return i(r)?(i(r[0])||(r=[r]),e.map(t,function(e,t,n){return e-r[t][n]||0})):e.map(t,function(e){return e-r})},divide:function(t,r){return i(r)?(i(r[0])||(r=[r]),e.multiply(t,e.inv(r))):e.map(t,function(e){return e/r})},multiply:function(t,r){var n,o,a,s,c,u,l,f;if(void 0===t.length&&void 0===r.length)return t*r;if(c=t.length,u=t[0].length,l=e.zeros(c,a=i(r)?r[0].length:u),f=0,i(r)){for(;f<a;f++)for(n=0;n<c;n++){for(o=0,s=0;o<u;o++)s+=t[n][o]*r[o][f];l[n][f]=s}return 1===c&&1===f?l[0][0]:l}return e.map(t,function(e){return e*r})},outer:function(t,r){return e.multiply(t.map(function(e){return[e]}),[r])},dot:function(t,r){i(t[0])||(t=[t]),i(r[0])||(r=[r]);for(var n,o,a=1===t[0].length&&1!==t.length?e.transpose(t):t,s=1===r[0].length&&1!==r.length?e.transpose(r):r,c=[],u=0,l=a.length,f=a[0].length;u<l;u++){for(o=0,c[u]=[],n=0;o<f;o++)n+=a[u][o]*s[u][o];c[u]=n}return 1===c.length?c[0]:c},pow:function(r,n){return e.map(r,function(e){return t.pow(e,n)})},exp:function(r){return e.map(r,function(e){return t.exp(e)})},log:function(r){return e.map(r,function(e){return t.log(e)})},abs:function(r){return e.map(r,function(e){return t.abs(e)})},norm:function(e,r){var n=0,o=0;for(isNaN(r)&&(r=2),i(e[0])&&(e=e[0]);o<e.length;o++)n+=t.pow(t.abs(e[o]),r);return t.pow(n,1/r)},angle:function(r,n){return t.acos(e.dot(r,n)/(e.norm(r)*e.norm(n)))},aug:function(e,t){var r,n=[];for(r=0;r<e.length;r++)n.push(e[r].slice());for(r=0;r<n.length;r++)o.apply(n[r],t[r]);return n},inv:function(t){for(var r,n=t.length,o=t[0].length,a=e.identity(n,o),i=e.gauss_jordan(t,a),s=[],c=0;c<n;c++)for(s[c]=[],r=o;r<i[0].length;r++)s[c][r-o]=i[c][r];return s},det:function e(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var r=0,n=0;n<t.length;n++){for(var o=[],a=1;a<t.length;a++){o[a-1]=[];for(var i=0;i<t.length;i++)i<n?o[a-1][i]=t[a][i]:i>n&&(o[a-1][i-1]=t[a][i])}var s=n%2?-1:1;r+=e(o)*t[0][n]*s}return r},gauss_elimination:function(r,n){var o,a,i,s,c=0,u=0,l=r.length,f=r[0].length,h=1,p=0,d=[];for(c=0,o=(r=e.aug(r,n))[0].length;c<l;c++){for(a=r[c][c],u=c,s=c+1;s<f;s++)a<t.abs(r[s][c])&&(a=r[s][c],u=s);if(u!=c)for(s=0;s<o;s++)i=r[c][s],r[c][s]=r[u][s],r[u][s]=i;for(u=c+1;u<l;u++)for(h=r[u][c]/r[c][c],s=c;s<o;s++)r[u][s]=r[u][s]-h*r[c][s]}for(c=l-1;c>=0;c--){for(p=0,u=c+1;u<=l-1;u++)p+=d[u]*r[c][u];d[c]=(r[c][o-1]-p)/r[c][c]}return d},gauss_jordan:function(r,n){var o,a,i,s=e.aug(r,n),c=s.length,u=s[0].length,l=0;for(a=0;a<c;a++){var f=a;for(i=a+1;i<c;i++)t.abs(s[i][a])>t.abs(s[f][a])&&(f=i);var h=s[a];for(s[a]=s[f],s[f]=h,i=a+1;i<c;i++)for(l=s[i][a]/s[a][a],o=a;o<u;o++)s[i][o]-=s[a][o]*l}for(a=c-1;a>=0;a--){for(i=0,l=s[a][a];i<a;i++)for(o=u-1;o>a-1;o--)s[i][o]-=s[a][o]*s[i][a]/l;for(s[a][a]/=l,o=c;o<u;o++)s[a][o]/=l}return s},triaUpSolve:function(t,r){var n,o=t[0].length,a=e.zeros(1,o)[0],i=!1;return(void 0!=r[0].length&&(r=r.map(function(e){return e[0]}),i=!0),e.arange(o-1,-1,-1).forEach(function(i){n=e.arange(i+1,o).map(function(e){return a[e]*t[i][e]}),a[i]=(r[i]-e.sum(n))/t[i][i]}),i)?a.map(function(e){return[e]}):a},triaLowSolve:function(t,r){var n,o=t[0].length,a=e.zeros(1,o)[0],i=!1;return(void 0!=r[0].length&&(r=r.map(function(e){return e[0]}),i=!0),e.arange(o).forEach(function(o){n=e.arange(o).map(function(e){return t[o][e]*a[e]}),a[o]=(r[o]-e.sum(n))/t[o][o]}),i)?a.map(function(e){return[e]}):a},lu:function(t){var r,n=t.length,o=e.identity(n),a=e.zeros(t.length,t[0].length);return e.arange(n).forEach(function(e){a[0][e]=t[0][e]}),e.arange(1,n).forEach(function(i){e.arange(i).forEach(function(n){r=e.arange(n).map(function(e){return o[i][e]*a[e][n]}),o[i][n]=(t[i][n]-e.sum(r))/a[n][n]}),e.arange(i,n).forEach(function(n){r=e.arange(i).map(function(e){return o[i][e]*a[e][n]}),a[i][n]=t[r.length][n]-e.sum(r)})}),[o,a]},cholesky:function(r){var n,o=r.length,a=e.zeros(r.length,r[0].length);return e.arange(o).forEach(function(i){n=e.arange(i).map(function(e){return t.pow(a[i][e],2)}),a[i][i]=t.sqrt(r[i][i]-e.sum(n)),e.arange(i+1,o).forEach(function(t){n=e.arange(i).map(function(e){return a[i][e]*a[t][e]}),a[t][i]=(r[i][t]-e.sum(n))/a[i][i]})}),a},gauss_jacobi:function(r,n,o,a){for(var i,s,c,u,l=0,f=0,h=r.length,p=[],d=[],m=[];l<h;l++)for(f=0,p[l]=[],d[l]=[],m[l]=[];f<h;f++)l>f?(p[l][f]=r[l][f],d[l][f]=m[l][f]=0):l<f?(d[l][f]=r[l][f],p[l][f]=m[l][f]=0):(m[l][f]=r[l][f],p[l][f]=d[l][f]=0);for(c=e.multiply(e.multiply(e.inv(m),e.add(p,d)),-1),s=e.multiply(e.inv(m),n),i=o,u=e.add(e.multiply(c,o),s),l=2;t.abs(e.norm(e.subtract(u,i)))>a;)i=u,u=e.add(e.multiply(c,i),s),l++;return u},gauss_seidel:function(r,n,o,a){for(var i,s,c,u,l,f=0,h=r.length,p=[],d=[],m=[];f<h;f++)for(i=0,p[f]=[],d[f]=[],m[f]=[];i<h;i++)f>i?(p[f][i]=r[f][i],d[f][i]=m[f][i]=0):f<i?(d[f][i]=r[f][i],p[f][i]=m[f][i]=0):(m[f][i]=r[f][i],p[f][i]=d[f][i]=0);for(u=e.multiply(e.multiply(e.inv(e.add(m,p)),d),-1),c=e.multiply(e.inv(e.add(m,p)),n),s=o,l=e.add(e.multiply(u,o),c),f=2;t.abs(e.norm(e.subtract(l,s)))>a;)s=l,l=e.add(e.multiply(u,s),c),f+=1;return l},SOR:function(r,n,o,a,i){for(var s,c,u,l,f,h=0,p=r.length,d=[],m=[],v=[];h<p;h++)for(s=0,d[h]=[],m[h]=[],v[h]=[];s<p;s++)h>s?(d[h][s]=r[h][s],m[h][s]=v[h][s]=0):h<s?(m[h][s]=r[h][s],d[h][s]=v[h][s]=0):(v[h][s]=r[h][s],d[h][s]=m[h][s]=0);for(l=e.multiply(e.inv(e.add(v,e.multiply(d,i))),e.subtract(e.multiply(v,1-i),e.multiply(m,i))),u=e.multiply(e.multiply(e.inv(e.add(v,e.multiply(d,i))),n),i),c=o,f=e.add(e.multiply(l,o),u),h=2;t.abs(e.norm(e.subtract(f,c)))>a;)c=f,f=e.add(e.multiply(l,c),u),h++;return f},householder:function(r){for(var n,o,a,i,s=r.length,c=r[0].length,u=0,l=[],f=[];u<s-1;u++){for(n=0,i=u+1;i<c;i++)n+=r[i][u]*r[i][u];for(n=(r[u+1][u]>0?-1:1)*t.sqrt(n),o=t.sqrt((n*n-r[u+1][u]*n)/2),(l=e.zeros(s,1))[u+1][0]=(r[u+1][u]-n)/(2*o),a=u+2;a<s;a++)l[a][0]=r[a][u]/(2*o);f=e.subtract(e.identity(s,c),e.multiply(e.multiply(l,e.transpose(l)),2)),r=e.multiply(f,e.multiply(r,f))}return r},QR:(r=e.sum,n=e.arange,function(o){var a,i,s,c=o.length,u=o[0].length,l=e.zeros(u,u);for(i=0,o=e.copy(o);i<u;i++){for(a=0,l[i][i]=t.sqrt(r(n(c).map(function(e){return o[e][i]*o[e][i]})));a<c;a++)o[a][i]=o[a][i]/l[i][i];for(s=i+1;s<u;s++)for(a=0,l[i][s]=r(n(c).map(function(e){return o[e][i]*o[e][s]}));a<c;a++)o[a][s]=o[a][s]-o[a][i]*l[i][s]}return[o,l]}),lstsq:function(t,r){var n,o,a,i=!1;void 0===r[0].length&&(r=r.map(function(e){return[e]}),i=!0);var s=e.QR(t),c=s[0],u=s[1],l=t[0].length,f=e.slice(c,{col:{end:l}}),h=(n=e.slice(u,{row:{end:l}}),o=(n=e.copy(n)).length,a=e.identity(o),e.arange(o-1,-1,-1).forEach(function(t){e.sliceAssign(a,{row:t},e.divide(e.slice(a,{row:t}),n[t][t])),e.sliceAssign(n,{row:t},e.divide(e.slice(n,{row:t}),n[t][t])),e.arange(t).forEach(function(r){var o=e.multiply(n[r][t],-1),i=e.slice(n,{row:r}),s=e.multiply(e.slice(n,{row:t}),o);e.sliceAssign(n,{row:r},e.add(i,s));var c=e.slice(a,{row:r}),u=e.multiply(e.slice(a,{row:t}),o);e.sliceAssign(a,{row:r},e.add(c,u))})}),a),p=e.transpose(f);void 0===p[0].length&&(p=[p]);var d=e.multiply(e.multiply(h,p),r);return(void 0===d.length&&(d=[[d]]),i)?d.map(function(e){return e[0]}):d},jacobi:function(r){for(var n,o,a,i,s,c,u,l=1,f=r.length,h=e.identity(f,f),p=[];1===l;){for(n=0,s=r[0][1],a=0,i=1;n<f;n++)for(o=0;o<f;o++)n!=o&&s<t.abs(r[n][o])&&(s=t.abs(r[n][o]),a=n,i=o);for(n=1,c=r[a][a]===r[i][i]?r[a][i]>0?t.PI/4:-t.PI/4:t.atan(2*r[a][i]/(r[a][a]-r[i][i]))/2,(u=e.identity(f,f))[a][a]=t.cos(c),u[a][i]=-t.sin(c),u[i][a]=t.sin(c),u[i][i]=t.cos(c),h=e.multiply(h,u),r=e.multiply(e.multiply(e.inv(u),r),u),l=0;n<f;n++)for(o=1;o<f;o++)n!=o&&t.abs(r[n][o])>.001&&(l=1)}for(n=0;n<f;n++)p.push(r[n][n]);return[h,p]},rungekutta:function(e,t,r,n,o,a){var i,s,c,u;if(2===a)for(;n<=r;)i=t*e(n,o),s=t*e(n+t,o+i),o+=(i+s)/2,n+=t;if(4===a)for(;n<=r;)i=t*e(n,o),s=t*e(n+t/2,o+i/2),c=t*e(n+t/2,o+s/2),u=t*e(n+t,o+c),o+=(i+2*s+2*c+u)/6,n+=t;return o},romberg:function(e,r,n,o){for(var a,i,s,c,u,l=0,f=(n-r)/2,h=[],p=[],d=[];l<o/2;){for(u=e(r),s=r,c=0;s<=n;s+=f,c++)h[c]=s;for(s=1,a=h.length;s<a-1;s++)u+=(s%2!=0?4:2)*e(h[s]);u=f/3*(u+e(n)),d[l]=u,f/=2,l++}for(i=d.length,a=1;1!==i;){for(s=0;s<i-1;s++)p[s]=(t.pow(4,a)*d[s+1]-d[s])/(t.pow(4,a)-1);i=p.length,d=p,p=[],a++}return d},richardson:function(e,r,n,o){function a(e,t){for(var r,n=0,o=e.length;n<o;n++)e[n]===t&&(r=n);return r}for(var i,s,c,u,l,f=t.abs(n-e[a(e,n)+1]),h=0,p=[],d=[];o>=f;)i=a(e,n+o),s=a(e,n),p[h]=(r[i]-2*r[s]+r[2*s-i])/(o*o),o/=2,h++;for(u=p.length,c=1;1!=u;){for(l=0;l<u-1;l++)d[l]=(t.pow(4,c)*p[l+1]-p[l])/(t.pow(4,c)-1);u=d.length,p=d,d=[],c++}return p},simpson:function(e,t,r,n){for(var o,a=(r-t)/n,i=e(t),s=[],c=t,u=0,l=1;c<=r;c+=a,u++)s[u]=c;for(o=s.length;l<o-1;l++)i+=(l%2!=0?4:2)*e(s[l]);return a/3*(i+e(r))},hermite:function(e,t,r,n){for(var o,a=e.length,i=0,s=0,c=[],u=[],l=[],f=[];s<a;s++){for(o=0,c[s]=1;o<a;o++)s!=o&&(c[s]*=(n-e[o])/(e[s]-e[o]));for(o=0,u[s]=0;o<a;o++)s!=o&&(u[s]+=1/(e[s]-e[o]));l[s]=(1-2*(n-e[s])*u[s])*(c[s]*c[s]),f[s]=(n-e[s])*(c[s]*c[s]),i+=l[s]*t[s]+f[s]*r[s]}return i},lagrange:function(e,t,r){for(var n,o,a=0,i=0,s=e.length;i<s;i++){for(n=0,o=t[i];n<s;n++)i!=n&&(o*=(r-e[n])/(e[i]-e[n]));a+=o}return a},cubic_spline:function(t,r,n){for(var o,a=t.length,i=0,s=[],c=[],u=[],l=[],f=[],h=[],p=[];i<a-1;i++)f[i]=t[i+1]-t[i];for(i=1,u[0]=0;i<a-1;i++)u[i]=3/f[i]*(r[i+1]-r[i])-3/f[i-1]*(r[i]-r[i-1]);for(i=1;i<a-1;i++)s[i]=[],c[i]=[],s[i][i-1]=f[i-1],s[i][i]=2*(f[i-1]+f[i]),s[i][i+1]=f[i],c[i][0]=u[i];for(o=0,l=e.multiply(e.inv(s),c);o<a-1;o++)h[o]=(r[o+1]-r[o])/f[o]-f[o]*(l[o+1][0]+2*l[o][0])/3,p[o]=(l[o+1][0]-l[o][0])/(3*f[o]);for(o=0;o<a&&!(t[o]>n);o++);return r[o-=1]+(n-t[o])*h[o]+e.sq(n-t[o])*l[o]+(n-t[o])*e.sq(n-t[o])*p[o]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented")},PCA:function(t){var r,n,o=t.length,a=t[0].length,i=0,s=[],c=[],u=[],l=[],f=[],h=[],p=[],d=[],m=[],v=[];for(i=0;i<o;i++)s[i]=e.sum(t[i])/a;for(i=0;i<a;i++)for(r=0,p[i]=[];r<o;r++)p[i][r]=t[r][i]-s[r];for(i=0,p=e.transpose(p);i<o;i++)for(r=0,d[i]=[];r<o;r++)d[i][r]=e.dot([p[i]],[p[r]])/(a-1);for(i=0,m=(u=e.jacobi(d))[0],c=u[1],v=e.transpose(m);i<c.length;i++)for(r=i;r<c.length;r++)c[i]<c[r]&&(n=c[i],c[i]=c[r],c[r]=n,l=v[i],v[i]=v[r],v[r]=l);for(i=0,h=e.transpose(p);i<o;i++)for(r=0,f[i]=[];r<h.length;r++)f[i][r]=e.dot([v[i]],[h[r]]);return[t,c,v,f]}}),function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(r,n){var o=this;return n?(setTimeout(function(){n.call(o,e.fn[t].call(o,r))},15),this):"number"==typeof e[t](this,r)?e[t](this,r):e(e[t](this,r))}}(t[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,t){var r=[].slice,n=e.utils.isNumber,o=e.utils.isArray;function a(e,r,n,o){if(e>1||n>1||e<=0||n<=0)throw Error("Proportions should be greater than 0 and less than 1");var a=(e*r+n*o)/(r+o);return(e-n)/t.sqrt(a*(1-a)*(1/r+1/o))}e.extend({zscore:function(){var t=r.call(arguments);return n(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var n,a=r.call(arguments);return o(a[1])?(n=e.zscore(a[0],a[1],a[3]),1===a[2]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):a.length>2?(n=e.zscore(a[0],a[1],a[2]),1===a[3]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):(n=a[0],1===a[1]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(r,n,o){var a=t.abs(this.zscore(r,o));return 1===n?e.normal.cdf(-a,0,1):2*e.normal.cdf(-a,0,1)}}),e.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/t.sqrt(n[1].length))},ttest:function(){var o,a=r.call(arguments);return 5===a.length?(o=t.abs(e.tscore(a[0],a[1],a[2],a[3])),1===a[4]?e.studentt.cdf(-o,a[3]-1):2*e.studentt.cdf(-o,a[3]-1)):n(a[1])?(o=t.abs(a[0]),1==a[2]?e.studentt.cdf(-o,a[1]-1):2*e.studentt.cdf(-o,a[1]-1)):(o=t.abs(e.tscore(a[0],a[1])),1==a[2]?e.studentt.cdf(-o,a[1].length-1):2*e.studentt.cdf(-o,a[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(r,n){return 1===n?1-e.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,o,a,i,s,c,u,l,f=r.call(arguments);if(1===f.length){for(u=0,s=Array(f[0].length);u<f[0].length;u++)s[u]=f[0][u];f=s}for(u=0,o=[];u<f.length;u++)o=o.concat(f[u]);for(u=0,a=e.mean(o),n=0;u<f.length;u++)n+=f[u].length*t.pow(e.mean(f[u])-a,2);for(n/=f.length-1,c=0,u=0;u<f.length;u++)for(l=0,i=e.mean(f[u]);l<f[u].length;l++)c+=t.pow(f[u][l]-i,2);return n/(c/=o.length-f.length)},anovaftest:function(){var t,o,a,i,s=r.call(arguments);if(n(s[0]))return 1-e.centralF.cdf(s[0],s[1],s[2]);var c=e.anovafscore(s);for(i=0,t=s.length-1,a=0;i<s.length;i++)a+=s[i].length;return o=a-t-1,1-e.centralF.cdf(c,t,o)},ftest:function(t,r,n){return 1-e.centralF.cdf(t,r,n)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,r=0;for(t=0;t<this.length;t++)r+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,r-this.length)}}),e.extend({qscore:function(){var o,a,i,s,c,u=r.call(arguments);return n(u[0])?(o=u[0],a=u[1],i=u[2],s=u[3],c=u[4]):(o=e.mean(u[0]),a=e.mean(u[1]),i=u[0].length,s=u[1].length,c=u[2]),t.abs(o-a)/(c*t.sqrt((1/i+1/s)/2))},qtest:function(){var t,n=r.call(arguments);3===n.length?(t=n[0],n=n.slice(1)):7===n.length?(t=e.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(t=e.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],a=n[1];return 1-e.tukey.cdf(t,a,o-a)},tukeyhsd:function(t){for(var r=e.pooledstdev(t),n=t.map(function(t){return e.mean(t)}),o=t.reduce(function(e,t){return e+t.length},0),a=[],i=0;i<t.length;++i)for(var s=i+1;s<t.length;++s){var c=e.qtest(n[i],n[s],t[i].length,t[s].length,r,o,t.length);a.push([[i,s],c])}return a}}),e.extend({normalci:function(){var n,o=r.call(arguments),a=[,,];return n=4===o.length?t.abs(e.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/t.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},tci:function(){var n,o=r.call(arguments),a=[,,];return n=4===o.length?t.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/t.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,r){return e.normalci(t,r,this.toArray())},tci:function(t,r){return e.tci(t,r,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,r,n,o){var i=a(t,r,n,o);return e.ztest(i,1)},twoSidedDifferenceOfProportions:function(t,r,n,o){var i=a(t,r,n,o);return e.ztest(i,2)}})}(t,Math),t.models=function(){function e(e,r){var n=e.length,o=r[0].length-1,a=t.lstsq(r,e),i=t.multiply(r,a.map(function(e){return[e]})).map(function(e){return e[0]}),s=t.subtract(e,i),c=t.mean(e),u=t.sum(i.map(function(e){return Math.pow(e-c,2)})),l=t.sum(e.map(function(e,t){return Math.pow(e-i[t],2)})),f=u+l;return{exog:r,endog:e,nobs:n,df_model:o,df_resid:n-o-1,coef:a,predict:i,resid:s,ybar:c,SST:f,SSE:u,SSR:l,R2:u/f}}return{ols:function(r,n){var o,a,i,s,c,u,l,f,h,p,d,m,v,g,E=e(r,n),y=(a=(o=E.exog)[0].length,i=t.arange(a).map(function(r){var n=t.arange(a).filter(function(e){return e!==r});return e(t.col(o,r).map(function(e){return e[0]}),t.col(o,n))}),s=Math.sqrt(E.SSR/E.df_resid),c=i.map(function(e){return s/Math.sqrt(e.SST*(1-e.R2))}),l=(u=E.coef.map(function(e,t){return(e-0)/c[t]})).map(function(e){var r=t.studentt.cdf(e,E.df_resid);return(r>.5?1-r:r)*2}),f=t.studentt.inv(.975,E.df_resid),h=E.coef.map(function(e,t){var r=f*c[t];return[e-r,e+r]}),{se:c,t:u,p:l,sigmaHat:s,interval95:h}),N=(g=1-(d=p=E.R2/E.df_model/((1-E.R2)/E.df_resid),m=E.df_model,v=E.df_resid,t.beta.cdf(d/(v/m+d),m/2,v/2)),{F_statistic:p,pvalue:g}),R=1-(1-E.R2)*((E.nobs-1)/E.df_resid);return E.t=y,E.f=N,E.adjust_R2=R,E}}}(),t.extend({buildxmatrix:function(){for(var e=Array(arguments.length),r=0;r<arguments.length;r++){var n=[1];e[r]=n.concat(arguments[r])}return t(e)},builddxmatrix:function(){for(var e=Array(arguments[0].length),r=0;r<arguments[0].length;r++){var n=[1];e[r]=n.concat(arguments[0][r])}return t(e)},buildjxmatrix:function(e){for(var r=Array(e.length),n=0;n<e.length;n++)r[n]=e[n];return t.builddxmatrix(r)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,r){var n,o,a,i,s;if(e.cols()==r.rows()){if(r.rows()>1){for(n=0,i=[];n<e.rows();n++)for(o=0,i[n]=[];o<r.cols();o++){for(a=0,s=0;a<e.cols();a++)s+=e.toArray()[n][a]*r.toArray()[a][o];i[n][o]=s}return t(i)}for(n=0,i=[];n<e.rows();n++)for(o=0,i[n]=[];o<r.cols();o++){for(a=0,s=0;a<e.cols();a++)s+=e.toArray()[n][a]*r.toArray()[o];i[n][o]=s}return t(i)}},regress:function(e,r){var n=t.xtranspxinv(e),o=e.transpose(),a=t.matrixmult(t(n),o);return t.matrixmult(a,r)},regresst:function(e,r,n){var o,a,i,s=t.regress(e,r),c={};c.anova={};var u=t.jMatYBar(e,s);c.yBar=u;var l=r.mean();c.anova.residuals=t.residuals(r,u),c.anova.ssr=t.ssr(u,l),c.anova.msr=c.anova.ssr/(e[0].length-1),c.anova.sse=t.sse(r,u),c.anova.mse=c.anova.sse/(r.length-(e[0].length-1)-1),c.anova.sst=t.sst(r,l),c.anova.mst=c.anova.sst/(r.length-1),c.anova.r2=1-c.anova.sse/c.anova.sst,c.anova.r2<0&&(c.anova.r2=0),c.anova.fratio=c.anova.msr/c.anova.mse,c.anova.pvalue=t.anovaftest(c.anova.fratio,e[0].length-1,r.length-(e[0].length-1)-1),c.anova.rmse=Math.sqrt(c.anova.mse),c.anova.r2adj=1-c.anova.mse/c.anova.mst,c.anova.r2adj<0&&(c.anova.r2adj=0),c.stats=Array(e[0].length);for(var f=t.xtranspxinv(e),h=0;h<s.length;h++)o=Math.sqrt(c.anova.mse*Math.abs(f[h][h])),a=Math.abs(s[h]/o),i=t.ttest(a,r.length-e[0].length-1,n),c.stats[h]=[s[h],o,a,i];return c.regress=s,c},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var r=t.matrixmult(e.transpose(),e);return t.inv(r)},jMatYBar:function(e,r){var n=t.matrixmult(e,r);return new t(n)},residuals:function(e,r){return t.matrixsubtract(e,r)},ssr:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},sse:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t[n],2);return r},sst:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},matrixsubtract:function(e,r){for(var n=Array(e.length),o=0;o<e.length;o++){n[o]=Array(e[o].length);for(var a=0;a<e[o].length;a++)n[o][a]=e[o][a]-r[o][a]}return t(n)}}),t.jStat=t,t},e.exports=t()},25975:function(e,t){var r,n,o;"undefined"!=typeof self&&self,n=[],void 0!==(o="function"==typeof(r=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(r,"global");break;case"i":s(r,"ignoreCase");break;case"m":s(r,"multiLine");break;case"u":s(r,"unicode");break;case"y":s(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t,loc:this.loc(0)}},e.prototype.disjunction=function(){var e=[],t=this.idx;for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(t)}},e.prototype.alternative=function(){for(var e=[],t=this.idx;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(t)}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){var e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":switch(this.consumeChar("?"),this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead"}c(t);var t,r=this.disjunction();return this.consumeChar(")"),{type:t,value:r,loc:this.loc(e)}}(function(){throw Error("Internal Error - Should never get here!")})()},e.prototype.quantifier=function(e){var t=this.idx;switch(this.popChar()){case"*":r={atLeast:0,atMost:1/0};break;case"+":r={atLeast:1,atMost:1/0};break;case"?":r={atLeast:0,atMost:1};break;case"{":var r,n=this.integerIncludingZero();switch(this.popChar()){case"}":r={atLeast:n,atMost:n};break;case",":r=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===r)return;c(r)}if(!0!==e||void 0!==r)return c(r),"?"===this.peekChar(0)?(this.consumeChar("?"),r.greedy=!1):r.greedy=!0,r.type="Quantifier",r.loc=this.loc(t),r},e.prototype.atom=function(){var e,t=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),c(e),e.loc=this.loc(t),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=u;break;case"D":e=u,t=!0;break;case"s":e=f;break;case"S":e=f,t=!0;break;case"w":e=l;break;case"W":e=l,t=!0}return c(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=a("\f");break;case"n":e=a("\n");break;case"r":e=a("\r");break;case"t":e=a("	");break;case"v":e=a("\v")}return c(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:n.value})}else i(r.value,e),e.push(a("-")),i(n.value,e)}else i(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;(this.consumeChar("("),"?"===this.peekChar(0))?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===o.test(e))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var o=this.popChar();if(!1===r.test(o))throw Error("Expecting a HexDecimal digits");t+=o}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},e.prototype.loc=function(e){return{begin:e,end:this.idx}};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,o=/[1-9]/;function a(e){return e.charCodeAt(0)}function i(e,t){void 0!==e.length?e.forEach(function(e){t.push(e)}):t.push(e)}function s(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function c(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var u=[];for(t=a("0");t<=a("9");t++)u.push(t);var l=[a("_")].concat(u);for(t=a("a");t<=a("z");t++)l.push(t);for(t=a("A");t<=a("Z");t++)l.push(t);var f=[a(" "),a("\f"),a("\n"),a("\r"),a("	"),a("\v"),a("	"),a("\xa0"),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a("\u2028"),a("\u2029"),a(" "),a(" "),a("　"),a("\uFEFF")];function h(){}return h.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach(function(e){this.visit(e)},this))}},h.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},h.prototype.visitPattern=function(e){},h.prototype.visitFlags=function(e){},h.prototype.visitDisjunction=function(e){},h.prototype.visitAlternative=function(e){},h.prototype.visitStartAnchor=function(e){},h.prototype.visitEndAnchor=function(e){},h.prototype.visitWordBoundary=function(e){},h.prototype.visitNonWordBoundary=function(e){},h.prototype.visitLookahead=function(e){},h.prototype.visitNegativeLookahead=function(e){},h.prototype.visitCharacter=function(e){},h.prototype.visitSet=function(e){},h.prototype.visitGroup=function(e){},h.prototype.visitGroupBackReference=function(e){},h.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:h,VERSION:"0.5.0"}})?r.apply(t,n):r)&&(e.exports=o)},76452:(e,t)=>{"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function r(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,o=e[n];if(0<a(o,t))e[n]=t,e[r]=o,r=n;else break}}function n(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,o=e.length,i=o>>>1;n<i;){var s=2*(n+1)-1,c=e[s],u=s+1,l=e[u];if(0>a(c,r))u<o&&0>a(l,c)?(e[n]=l,e[u]=r,n=u):(e[n]=c,e[s]=r,n=s);else if(u<o&&0>a(l,r))e[n]=l,e[u]=r,n=u;else break}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i,s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var l=[],f=[],h=1,p=null,d=3,m=!1,v=!1,g=!1,E="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,N="undefined"!=typeof setImmediate?setImmediate:null;function R(e){for(var t=n(f);null!==t;){if(null===t.callback)o(f);else if(t.startTime<=e)o(f),t.sortIndex=t.expirationTime,r(l,t);else break;t=n(f)}}function A(e){if(g=!1,R(e),!v){if(null!==n(l))v=!0,_(T);else{var t=n(f);null!==t&&L(A,t.startTime-e)}}}function T(e,r){v=!1,g&&(g=!1,y(O),O=-1),m=!0;var a=d;try{for(R(r),p=n(l);null!==p&&(!(p.expirationTime>r)||e&&!C());){var i=p.callback;if("function"==typeof i){p.callback=null,d=p.priorityLevel;var s=i(p.expirationTime<=r);r=t.unstable_now(),"function"==typeof s?p.callback=s:p===n(l)&&o(l),R(r)}else o(l);p=n(l)}if(null!==p)var c=!0;else{var u=n(f);null!==u&&L(A,u.startTime-r),c=!1}return c}finally{p=null,d=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var M=!1,w=null,O=-1,I=5,b=-1;function C(){return!(t.unstable_now()-b<I)}function x(){if(null!==w){var e=t.unstable_now();b=e;var r=!0;try{r=w(!0,e)}finally{r?i():(M=!1,w=null)}}else M=!1}if("function"==typeof N)i=function(){N(x)};else if("undefined"!=typeof MessageChannel){var S=new MessageChannel,U=S.port2;S.port1.onmessage=x,i=function(){U.postMessage(null)}}else i=function(){E(x,0)};function _(e){w=e,M||(M=!0,i())}function L(e,r){O=E(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,_(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var r=d;d=t;try{return e()}finally{d=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=d;d=e;try{return t()}finally{d=r}},t.unstable_scheduleCallback=function(e,o,a){var i=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?i+a:i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=a+s,e={id:h++,callback:o,priorityLevel:e,startTime:a,expirationTime:s,sortIndex:-1},a>i?(e.sortIndex=a,r(f,e),null===n(l)&&e===n(f)&&(g?(y(O),O=-1):g=!0,L(A,a-i))):(e.sortIndex=s,r(l,e),v||m||(v=!0,_(T))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=d;return function(){var r=d;d=t;try{return e.apply(this,arguments)}finally{d=r}}}},79111:(e,t,r)=>{"use strict";e.exports=r(76452)},14887:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>tM});var n,o=r(10326),a=r(50384),i=r(29752),s=r(17577),c=r(94224),u=r(49034),l=r(19075),f=r(29280),h=r(91664),p=r(59008),d=r(41190),m=r(74723),v=r(77506),g=r(56556),E=r(44099);r(24221);var y=r(35047),N=r(44384),R=r(98079),A=r(56627),T=r(48029),M=r.n(T),w=r(24661),O=r.n(w),I=r(79111),b=r(60962);let C=Symbol(),x=Symbol(),S="undefined"==typeof window||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?s.useEffect:s.useLayoutEffect,U=I.unstable_runWithPriority?e=>{try{(0,I.unstable_runWithPriority)(I.unstable_NormalPriority,e)}catch(t){if("Not implemented."===t.message)e();else throw t}}:e=>e(),_=e=>({value:t,children:r})=>{let n=(0,s.useRef)(t),o=(0,s.useRef)(0),[a,i]=(0,s.useState)(null);a&&(a(t),i(null));let c=(0,s.useRef)();if(!c.current){let e=new Set;c.current={[C]:{v:n,n:o,l:e,u:(t,r)=>{(0,b.unstable_batchedUpdates)(()=>{o.current+=1;let n={n:o.current};null!=r&&r.suspense&&(n.n*=-1,n.p=new Promise(e=>{i(()=>t=>{n.v=t,delete n.p,e(t)})})),e.forEach(e=>e(n)),t()})}}}}return S(()=>{n.current=t,o.current+=1,U(()=>{c.current[C].l.forEach(e=>{e({n:o.current,v:t})})})},[t]),(0,s.createElement)(e,{value:c.current},r)};function L(e,t){let{v:{current:r},n:{current:n},l:o}=(0,s.useContext)(e)[C],a=t(r),[i,c]=(0,s.useReducer)((e,o)=>{if(!o)return[r,a];if("p"in o)throw o.p;if(o.n===n)return Object.is(e[1],a)?e:[r,a];try{if("v"in o){if(Object.is(e[0],o.v))return e;let r=t(o.v);if(Object.is(e[1],r))return e;return[o.v,r]}}catch(e){}return[...e]},[r,a]);return Object.is(i[1],a)||c(),S(()=>(o.add(c),()=>{o.delete(c)}),[o]),i[1]}var k=function(e,t){return(k=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function P(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var D=function(){return(D=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function B(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function F(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function j(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function G(e,t,r){if(r||2==arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}var V="SET_DATA",$="SET_CREATE_FORMULA_PARSER",H="SELECT_ENTIRE_ROW",W="SELECT_ENTIRE_COLUMN",Y="SELECT_ENTIRE_WORKSHEET",q="SET_SELECTION",K="SELECT",z="ACTIVATE",X="SET_CELL_DATA",Q="SET_CELL_DIMENSIONS",Z="COPY",J="PASTE",ee="EDIT",et="VIEW",er="BLUR",en="KEY_PRESS",eo="KEY_DOWN",ea="DRAG_START",ei="DRAG_END",es="COMMIT";function ec(e,t){return{type:X,payload:{active:e,data:t}}}function eu(e,t){var r=t[e.row];if(void 0!==r)return r[e.column]}function el(e,t,r){for(var n=[],o=t.column-e.column,a=e.row;a<=t.row;a++){var i=a-e.row;n[i]=n[i]||Array(o);for(var s=e.column;s<=t.column;s++)n[i][s-e.column]=eu({row:a,column:s},r)}return n}function ef(e,t,r){var n=G([],j(r),!1),o=r[0],a=o?G([],j(o),!1):[];a.length-1<e.column&&(a[e.column]=void 0,n[0]=a);var i=r[e.row]?G([],j(r[e.row]),!1):[];return i[e.column]=t,n[e.row]=i,n}function eh(e,t){if(!ed(e,t))return t;var r=G([],j(t),!1),n=G([],j(t[e.row]),!1);return n[e.column]=void 0,r[e.row]=n,r}function ep(e){var t,r,n,o,a,i,s,c,u,l,f,h,p,d;return B(this,function(m){switch(m.label){case 0:m.trys.push([0,11,12,13]),r=(t=F(e.entries())).next(),m.label=1;case 1:if(r.done)return[3,10];o=(n=j(r.value,2))[0],a=n[1],m.label=2;case 2:m.trys.push([2,7,8,9]),p=void 0,s=(i=F(a.entries())).next(),m.label=3;case 3:if(s.done)return[3,6];return u=(c=j(s.value,2))[0],l=c[1],[4,[{row:o,column:u},l]];case 4:m.sent(),m.label=5;case 5:return s=i.next(),[3,3];case 6:return[3,9];case 7:return p={error:m.sent()},[3,9];case 8:try{s&&!s.done&&(d=i.return)&&d.call(i)}finally{if(p)throw p.error}return[7];case 9:return r=t.next(),[3,1];case 10:return[3,13];case 11:return f={error:m.sent()},[3,13];case 12:try{r&&!r.done&&(h=t.return)&&h.call(t)}finally{if(f)throw f.error}return[7];case 13:return[2]}})}function ed(e,t){var r=t[0];return r&&e.row>=0&&e.column>=0&&Number.isInteger(e.row)&&Number.isInteger(e.column)&&e.column<r.length&&e.row<t.length}function em(e){return{columns:eg(e),rows:ev(e)}}function ev(e){return e.length}function eg(e){var t=e[0];return t?t.length:0}function eE(e){var t=em(e);return{row:t.rows-1,column:t.columns-1}}var ey=function(){function e(e,t){this.start={row:Math.min(e.row,t.row),column:Math.min(e.column,t.column)},this.end={row:Math.max(e.row,t.row),column:Math.max(e.column,t.column)}}return e.prototype[Symbol.iterator]=function(){var e,t;return B(this,function(r){switch(r.label){case 0:e=this.start.row,r.label=1;case 1:if(!(e<=this.end.row))return[3,6];t=this.start.column,r.label=2;case 2:if(!(t<=this.end.column))return[3,5];return[4,{row:e,column:t}];case 3:r.sent(),r.label=4;case 4:return t++,[3,2];case 5:return e++,[3,1];case 6:return[2]}})},e.prototype.size=function(){return(this.end.row+1-this.start.row)*(this.end.column+1-this.start.column)},e.prototype.has=function(e){return e.row>=this.start.row&&e.column>=this.start.column&&e.row<=this.end.row&&e.column<=this.end.column},e.prototype.mask=function(t){return new e({row:t.start.row>this.start.row?t.start.row:this.start.row,column:t.start.column>this.start.column?t.start.column:this.start.column},{row:t.end.row<this.end.row?t.end.row:this.end.row,column:t.end.column<this.end.column?t.end.column:this.end.column})},e.prototype.equals=function(e){return this.start.row===e.start.row&&this.start.column===e.start.column&&this.end.row===e.end.row&&this.end.column===e.end.column},e}(),eN={row:0,column:0},eR=function(){},eA=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.toRange=function(e){return null},t.prototype.normalizeTo=function(e){return this},t.prototype.hasEntireRow=function(e){return!1},t.prototype.hasEntireColumn=function(e){return!1},t.prototype.size=function(){return 0},t.prototype.has=function(){return!1},t.prototype.equals=function(e){return e instanceof t},t}(eR),eT=function(e){function t(t){var r=e.call(this)||this;return r.range=t,r}return P(t,e),t.prototype.toRange=function(e){return this.range},t.prototype.normalizeTo=function(e){var r=eC(e);return new t(this.range.mask(r))},t.prototype.hasEntireRow=function(e){return!1},t.prototype.hasEntireColumn=function(e){return!1},t.prototype.size=function(e){var t=this.toRange(e);return t?t.size():0},t.prototype.has=function(e,t){var r=this.toRange(e);return null!==r&&r.has(t)},t.prototype.equals=function(e){return e instanceof t&&this.range.equals(e.range)},t}(eR),eM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(eR),ew=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.toRange=function(e){return eC(e)},t.prototype.normalizeTo=function(e){return this},t.prototype.hasEntireColumn=function(e){return!0},t.prototype.hasEntireRow=function(e){return!0},t.prototype.size=function(e){return eg(e)*ev(e)},t.prototype.has=function(e,t){return!0},t.prototype.equals=function(e){return e instanceof t},t}(eM),eO=function(e){function t(t,r){var n=this;if(!ex(t))throw new eS("start");if(!ex(r))throw new eS("end");return(n=e.call(this)||this).start=Math.min(t,r),n.end=Math.max(t,r),n}return P(t,e),t.prototype.equals=function(e){return e instanceof t&&this.constructor===e.constructor&&this.start===e.start&&this.end===e.end},t}(eM),eI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.toRange=function(e){var t=eE(e);return new ey({row:this.start,column:0},{row:this.end,column:t.column})},t.prototype.normalizeTo=function(e){var r=ev(e);return new t(Math.max(this.start,0),Math.min(this.end,r-1))},t.prototype.hasEntireRow=function(e){return e>=this.start&&e<=this.end},t.prototype.hasEntireColumn=function(e){return!1},t.prototype.size=function(e){return(this.end-this.start+1)*eg(e)},t.prototype.has=function(e,t){return t.row>=this.start&&t.row<=this.end},t}(eO),eb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.toRange=function(e){var t=eE(e);return new ey({row:0,column:this.start},{row:t.row,column:this.end})},t.prototype.normalizeTo=function(e){var r=eg(e);return new t(Math.max(this.start,0),Math.min(this.end,r-1))},t.prototype.hasEntireRow=function(e){return!1},t.prototype.hasEntireColumn=function(e){return e>=this.start&&e<=this.end},t.prototype.size=function(e){return(this.end-this.start+1)*ev(e)},t.prototype.has=function(e,t){return t.column>=this.start&&t.column<=this.end},t}(eO);function eC(e){return new ey(eN,eE(e))}function ex(e){return Number.isInteger(e)&&e>=0}var eS=function(e){function t(t){return e.call(this,"".concat(t," is not a valid index. It must be 0 or a positive integer"))||this}return P(t,e),t}(Error),eU="text/plain";function e_(e,t,r){void 0===t&&(t=0),void 0===r&&(r=1);var n=[];if(-1===Math.sign(e-t)){for(var o=t;o>e;o-=r)n.push(o);return n}for(var o=t;o<e;o+=r)n.push(o);return n}function eL(e,t){return!!(e&&t.column===e.column&&t.row===e.row)}function ek(e){return{width:e.offsetWidth,height:e.offsetHeight,left:e.offsetLeft,top:e.offsetTop}}function eP(e,t,r){var n=t&&t[e.row],o=r&&r[e.column];return n&&o&&D(D({},n),o)}function eD(e,t,r){var n=eP(r.start,e,t),o=eP(r.end,e,t);return n&&o&&{width:o.left+o.width-n.left,height:o.top+o.height-n.top,top:n.top,left:n.left}}function eB(e,t){return null!==e&&"view"===t&&eF(e)}function eF(e){return e.matches(":focus-within")}function ej(e){return"".concat(e.row,",").concat(e.column)}function eG(e){var t=j(e.split(","),2),r=t[0],n=t[1];return{row:Number(r),column:Number(n)}}var eV=function(){function e(e){this.set=e}return e.from=function(t){var r,n,o=new Set;try{for(var a=F(t),i=a.next();!i.done;i=a.next()){var s=i.value;o.add(ej(s))}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new e(o)},e.prototype.has=function(e){return this.set.has(ej(e))},Object.defineProperty(e.prototype,"size",{get:function(){return this.set.size},enumerable:!1,configurable:!0}),e.prototype.add=function(t){var r=new Set(this.set);return r.add(ej(t)),new e(r)},e.prototype.delete=function(t){var r=new Set(this.set);return r.delete(ej(t))?new e(r):this},e.prototype.difference=function(e){var t,r,n=this;try{for(var o=F(e),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.delete(i)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.union=function(e){var t,r,n=this;try{for(var o=F(e),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.add(i)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype[Symbol.iterator]=function(){var e,t,r,n;return B(this,function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=(e=F(this.set)).next(),o.label=1;case 1:if(t.done)return[3,4];return[4,eG(t.value)];case 2:o.sent(),o.label=3;case 3:return t=e.next(),[3,1];case 4:return[3,7];case 5:return r={error:o.sent()},[3,7];case 6:try{t&&!t.done&&(n=e.return)&&n.call(e)}finally{if(r)throw r.error}return[7];case 7:return[2]}})},e}();function e$(e){return"string"==typeof e&&e.startsWith("=")&&e.length>1}function eH(e){return e.slice(1)}function eW(e,t){return new(O())(D(D({},t),{onCell:function(t){var r=eu({row:t.row-1,column:t.col-1},e);return isNaN(null==r?void 0:r.value)?null==r?void 0:r.value:Number(null==r?void 0:r.value)},onRange:function(t){var r=em(e);return function(e,t){for(var r=[],n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++){var a=e[n][o];r.push(t?t(a,{row:n,column:o}):a)}return r}(el({row:t.from.row-1,column:t.from.col-1},{row:Math.min(t.to.row-1,r.rows-1),column:Math.min(t.to.col-1,r.columns-1)},e),function(e){return isNaN(null==e?void 0:e.value)?null==e?void 0:e.value:Number(null==e?void 0:e.value)})}}))}var eY=new w.DepParser;function eq(e,t,r){var n=em(r),o=n.rows,a=n.columns;try{var i=eY.parse(e,eK(t));return eV.from(i.flatMap(function(e){if("from"in e){var t=e.from,r=e.to,n={row:t.row-1,column:t.col-1},i={row:Math.min(r.row-1,o-1),column:Math.min(r.col-1,a-1)},s=new ey(n,i);return Array.from(s)}return{row:e.row-1,column:e.col-1}}))}catch(e){if(e instanceof w.FormulaError)return eV.from([]);throw e}}function eK(e){return{row:e.row+1,col:e.column+1,sheet:"Sheet1"}}var ez=function(){function e(e){void 0===e&&(e=new Map),this.forwards=e}return e.from=function(t){var r,n,o=new Map;try{for(var a=F(t),i=a.next();!i.done;i=a.next()){var s=j(i.value,2),c=s[0],u=s[1];o.set(ej(c),u)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new e(o)},e.prototype.set=function(t,r){var n=new e(new Map(this.forwards));return 0===r.size?n.forwards.delete(ej(t)):n.forwards.set(ej(t),r),n},e.prototype.get=function(e){return this.forwards.get(ej(e))||eV.from([])},e.prototype.getBackwards=function(e){var t,r,n=eV.from([]);try{for(var o=F(this.forwards),a=o.next();!a.done;a=o.next()){var i=j(a.value,2),s=i[0];i[1].has(e)&&(n=n.add(eG(s)))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.getBackwardsRecursive=function(e,t){void 0===t&&(t=eV.from([]));var r,n,o=this.getBackwards(e),a=t;try{for(var i=F(o),s=i.next();!s.done;s=i.next()){var c=s.value;a.has(c)||(a=a.add(c),o=o.union(this.getBackwardsRecursive(c,a)))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},e.prototype.hasCircularDependency=function(e){for(var t,r,n=eV.from([]),o=[e];o.length>0;){var a=o.pop();if(a){if(n.has(a))return!0;n=n.add(a);var i=this.get(a);if(i)try{for(var s=(t=void 0,F(i)),c=s.next();!c.done;c=s.next()){var u=c.value;o.push(u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}}}return!1},e.prototype[Symbol.iterator]=function(){var e,t,r,n,o,a,i,s,c,u,l,f,h,p,d;return B(this,function(m){switch(m.label){case 0:e=new Set,m.label=1;case 1:m.trys.push([1,13,14,15]),r=(t=F(this.forwards)).next(),m.label=2;case 2:if(r.done)return[3,12];return o=(n=j(r.value,2))[0],a=n[1],i=eG(o),e.add(o),[4,[i,a]];case 3:m.sent(),m.label=4;case 4:m.trys.push([4,9,10,11]),p=void 0,c=(s=F(a)).next(),m.label=5;case 5:if(c.done)return[3,8];if(l=ej(u=c.value),!(!e.has(l)&&!this.forwards.has(l)))return[3,7];return e.add(l),[4,[u,eV.from([])]];case 6:m.sent(),m.label=7;case 7:return c=s.next(),[3,5];case 8:return[3,11];case 9:return p={error:m.sent()},[3,11];case 10:try{c&&!c.done&&(d=s.return)&&d.call(s)}finally{if(p)throw p.error}return[7];case 11:return r=t.next(),[3,2];case 12:return[3,15];case 13:return f={error:m.sent()},[3,15];case 14:try{r&&!r.done&&(h=t.return)&&h.call(t)}finally{if(f)throw f.error}return[7];case 15:return[2]}})},e.prototype.traverseBFSBackwards=function(){var e,t,r,n,o,a,i,s,c,u,l,f,h,p,d;return B(this,function(m){switch(m.label){case 0:e=eV.from([]),t=[];try{for(n=(r=F(this)).next();!n.done;n=r.next())a=(o=j(n.value,2))[0],i=o[1],0===i.size&&(e=e.add(a),t.push(a))}catch(e){f={error:e}}finally{try{n&&!n.done&&(h=r.return)&&h.call(r)}finally{if(f)throw f.error}}m.label=1;case 1:if(!(t.length>0))return[3,3];if(!(a=t.shift()))return[3,1];return[4,a];case 2:if(m.sent(),0===(s=this.getBackwards(a)).size)return[3,1];try{for(p=void 0,u=(c=F(s)).next();!u.done;u=c.next())l=u.value,e.has(l)||0!==this.get(l).difference(e).size||(t.push(l),e=e.add(l))}catch(e){p={error:e}}finally{try{u&&!u.done&&(d=c.return)&&d.call(c)}finally{if(p)throw p.error}}return[3,1];case 3:return[2]}})},e}(),eX=function(e,t,r,n){this.createFormulaParser=e,this.data=t,this.referenceGraph=r||function(e){var t,r,n=[];try{for(var o=F(ep(e)),a=o.next();!a.done;a=o.next()){var i=j(a.value,2),s=i[0],c=i[1];if(c&&e$(c.value)){var u=eq(eH(c.value),s,e);n.push([s,u])}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return ez.from(n)}(t),this.evaluatedData=n||function(e,t,r){var n,o,a=e,i=r(a);try{for(var s=F(t.traverseBFSBackwards()),c=s.next();!c.done;c=s.next()){var u=c.value,l=eu(u,e);if(l&&e$(l.value)){var f=eQ(l.value,u,i);a=ef(u,D(D({},l),{value:f}),a),i=r(a)}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return a}(t,this.referenceGraph,this.createFormulaParser)};function eQ(e,t,r){var n=eH(e);try{return function(e,t,r){try{var n=eK(t),o=r.parse(e,n);return o instanceof w.FormulaError?o.toString():o}catch(e){if(e instanceof w.FormulaError)return e.toString();throw e}}(n,t,r)}catch(e){return w.FormulaError.REF}}var eZ={active:null,mode:"view",rowDimensions:{},columnDimensions:{},lastChanged:null,hasPasted:!1,cut:!1,dragging:!1,model:new eX(eW,[]),selected:new eA,copied:null,lastCommit:null};function eJ(e,t){var r,n,o,a,i,s;switch(t.type){case V:var c=t.payload.data,u=e.active&&ed(e.active,c)?e.active:null,l=e.selected.normalizeTo(c);return D(D({},e),{model:new eX(e.model.createFormulaParser,c),active:u,selected:l});case $:var f=t.payload.createFormulaParser;return D(D({},e),{model:new eX(f,e.model.data)});case H:var h=t.payload,p=h.row,d=h.extend,m=e.active;return D(D({},e),{selected:d&&m?new eI(m.row,p):new eI(p,p),active:d&&m?m:D(D({},eN),{row:p}),mode:"view"});case W:var v=t.payload,g=v.column,d=v.extend,m=e.active;return D(D({},e),{selected:d&&m?new eb(m.column,g):new eb(g,g),active:d&&m?m:D(D({},eN),{column:g}),mode:"view"});case Y:return D(D({},e),{selected:new ew,active:eN,mode:"view"});case q:var E=t.payload.selection,y=E.toRange(e.model.data),m=e.active&&E.has(e.model.data,e.active)?e.active:null==y?void 0:y.start;return D(D({},e),{selected:E,active:m||null,mode:"view"});case K:var N=t.payload.point;if(e.active&&!eL(e.active,N))return D(D({},e),{selected:new eT(new ey(N,e.active)),mode:"view"});return e;case z:var N=t.payload.point;return D(D({},e),{selected:new eT(new ey(N,N)),active:N,mode:eL(e.active,N)?"edit":"view"});case X:var R,A,T,M,O,I,b,C,x=t.payload,m=x.active,S=x.data;if(tn(e))return e;return D(D({},e),{model:(T=e.model,O=ef(M=m,S,T.data),I=e$(S.value)?(R=T.referenceGraph,A=eq(eH(S.value),M,O),R.set(M,A)):T.referenceGraph,b=T.createFormulaParser(O),C=function(e,t,r,n,o,a){if(r.hasCircularDependency(n)){var i,s,c,u,l=eV.from([n]),f=ef(n,D(D({},o),{value:w.FormulaError.REF}),e);try{for(var h=F(r.getBackwardsRecursive(n)),p=h.next();!p.done;p=h.next()){var d=p.value;if(l.has(d))break;l=l.add(d);var m=eu(d,t);m&&(f=ef(d,D(D({},m),{value:w.FormulaError.REF}),f))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}return f}var v=e,g=e$(o.value)?eQ(o.value,n,a):o.value;v=ef(n,D(D({},o),{value:g}),v);try{for(var E=F(r.getBackwardsRecursive(n)),y=E.next();!y.done;y=E.next()){var d=y.value,m=eu(d,t);if(m){var N=e$(m.value)?eQ(m.value,n,a):m.value,R=D(D({},m),{value:N});v=ef(d,R,v)}}}catch(e){c={error:e}}finally{try{y&&!y.done&&(u=E.return)&&u.call(E)}finally{if(c)throw c.error}}return v}(T.evaluatedData,O,I,M,S,b),new eX(T.createFormulaParser,O,I,C)),lastChanged:m});case Q:var U=t.payload,N=U.point,_=U.dimensions,L=e.rowDimensions[N.row],k=e.columnDimensions[N.column];if(L&&k&&L.top===_.top&&L.height===_.height&&k.left===_.left&&k.width===_.width)return e;return D(D({},e),{rowDimensions:D(D({},e.rowDimensions),((r={})[N.row]={top:_.top,height:_.height},r)),columnDimensions:D(D({},e.columnDimensions),((n={})[N.column]={left:_.left,width:_.width},n))});case Z:case"CUT":var P=e.selected.toRange(e.model.data);return D(D({},e),{copied:P,cut:"CUT"===t.type,hasPasted:!1});case J:var B,ec,el,ev=t.payload.data,m=e.active;if(!m)return e;var eg=(B=function(e){return{value:e}},void 0===ec&&(ec="	"),void 0===el&&(el=/\r\n|\n|\r/),ev.replace(/"([^"]*?)"/g,function(e,t){return t.replace(/\n/g,"\\n")}).split(el).map(function(e){return e.split(ec).map(function(e){return e.replace(/\\n/g,"\n")}).map(B)})),eE=em(eg),P=e.selected.toRange(e.model.data);if(P&&1===eE.rows&&1===eE.columns){var eR=eu({row:0,column:0},eg),eA=e.cut&&e.copied?eh(e.copied.start,e.model.data):e.model.data,eM=[];try{for(var eO=F(P||[]),eC=eO.next();!eC.done;eC=eO.next()){var N=eC.value,ex=eu(N,e.model.data);eM.push({prevCell:ex||null,nextCell:eR||null}),eA=ef(N,eR,eA)}}catch(e){o={error:e}}finally{try{eC&&!eC.done&&(a=eO.return)&&a.call(eO)}finally{if(o)throw o.error}}return D(D({},e),{model:new eX(eW,eA),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:eM})}var eS={rows:m.row+eE.rows,columns:m.column+eE.columns},eU=function(e,t){var r=em(e),n=r.rows,o=r.columns;if(n>=t.rows&&o>=t.columns)return e;var a={rows:t.rows>n?t.rows:n,columns:t.columns>o?t.columns:o},i=G([],j(e),!1);if(a.columns>o){var s=a.columns-o;i=i.map(function(e){return G(G([],j(e),!1),j(Array(s).fill(void 0)),!1)})}if(a.rows>n){var c=a.rows-n,u=Array(a.columns).fill(void 0);i=G(G([],j(i),!1),j(Array(c).fill(u)),!1)}return i}(e.model.data,eS),e_={data:eU,commit:[]};try{for(var ek=F(ep(eg)),eP=ek.next();!eP.done;eP=ek.next()){var eD=j(eP.value,2),N=eD[0],eR=eD[1],eB=e_.commit||[],eF={row:N.row+m.row,column:N.column+m.column},ej=e_.data;if(e.cut){if(e.copied){var eG={row:N.row+e.copied.start.row,column:N.column+e.copied.start.column};ej=eh(eG,e_.data)}eB=G(G([],j(eB),!1),[{prevCell:eR||null,nextCell:null}],!1)}ed(eF,eU)||(e_={data:ej,commit:eB});var ex=eu(eF,ej)||null;eB=G(G([],j(eB),!1),[{prevCell:ex,nextCell:eR||null}],!1),e_.data=ef(eF,D(D({value:void 0},ex),eR),ej),e_.commit=eB}}catch(e){i={error:e}}finally{try{eP&&!eP.done&&(s=ek.return)&&s.call(ek)}finally{if(i)throw i.error}}return D(D({},e),{model:new eX(eW,e_.data),selected:new eT(new ey(m,{row:m.row+eE.rows-1,column:m.column+eE.columns-1})),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:e_.commit});case ee:return e0(e);case et:return e3(e);case"CLEAR":return e1(e);case er:return e2(e);case en:var eY=t.payload.event;if(tn(e)||eY.metaKey)return e;if("view"===e.mode&&e.active)return e0(e);return e;case eo:var eK=t.payload.event,ez=tr(e,eK);if(ez)return D(D({},e),ez(e,eK));return e;case ea:return D(D({},e),{dragging:!0});case ei:return D(D({},e),{dragging:!1});case es:var eZ=t.payload.changes;return D(D({},e),e4(eZ));default:throw Error("Unknown action")}}function e0(e){return tn(e)?e:D(D({},e),{mode:"edit"})}function e1(e){if(!e.active)return e;var t,r,n=e.selected.toRange(e.model.data),o=[],a=e.model.data;try{for(var i=F(n||[]),s=i.next();!s.done;s=i.next()){var c,u=s.value,l=eu(u,e.model.data),f=(c=l)&&!c.readOnly?Object.assign({},c,{value:void 0}):c;o.push({prevCell:l||null,nextCell:f||null}),a=ef(u,f,a)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return D(D(D({},e),{model:new eX(eW,a)}),e4(o))}function e2(e){return D(D({},e),{active:null,selected:new eA})}function e3(e){return D(D({},e),{mode:"view"})}function e4(e){return{lastCommit:e}}var e5=function(e,t){return function(r){if(r.active){var n={row:r.active.row+e,column:r.active.column+t};return ed(n,r.model.data)?D(D({},r),{active:n,selected:new eT(new ey(n,n)),mode:"view"}):D(D({},r),{mode:"view"})}}},e6={ArrowUp:e5(-1,0),ArrowDown:e5(1,0),ArrowLeft:e5(0,-1),ArrowRight:e5(0,1),Tab:e5(0,1),Enter:e0,Backspace:e1,Delete:e1,Escape:e2},e7={Escape:e3,Tab:e6.Tab,Enter:e6.ArrowDown},e9={Tab:e5(0,-1)};!function(e){e.Left="Left",e.Right="Right",e.Top="Top",e.Bottom="Bottom"}(n||(n={}));var e8={ArrowUp:function(e){return D(D({},e),{selected:to(e.selected,e.active,e.model.data,n.Top)})},ArrowDown:function(e){return D(D({},e),{selected:to(e.selected,e.active,e.model.data,n.Bottom)})},ArrowLeft:function(e){return D(D({},e),{selected:to(e.selected,e.active,e.model.data,n.Left)})},ArrowRight:function(e){return D(D({},e),{selected:to(e.selected,e.active,e.model.data,n.Right)})},Tab:e5(0,-1)},te={},tt={};function tr(e,t){var r=t.key;return("edit"===e.mode?t.shiftKey?e9:e7:t.shiftKey&&t.metaKey?te:t.shiftKey?e8:t.metaKey?tt:e6)[r]}function tn(e){var t=e.active&&eu(e.active,e.model.data)||null;return!!(null==t?void 0:t.readOnly)}function to(e,t,r,o){var a,i,s,c,u,l;return t?e instanceof eT?(i=o===n.Left||o===n.Right?"column":"row",c="start"==(s=o===n.Left||o===n.Top?"start":"end")?-1:1,u=e.range.has(D(D({},t),((a={})[i]=t[i]+-1*c,a))),l=new ey(e.range.start,e.range.end),l[u?"start"===s?"end":"start":s][i]+=c,new eT(l).normalizeTo(r)):e instanceof eb?function(e,t,r,o){if(o===n.Top||o===n.Bottom)return e;var a=o===n.Left?-1:1,i=o===n.Left?"start":"end",s="start"===i?"end":"start",c=D({},e);return(o===n.Left?e.end>t.row:e.start<t.row)?c[s]=e[s]+a:c[i]=e[i]+a,new eb(Math.max(c.start,0),Math.max(c.end,0)).normalizeTo(r)}(e,t,r,o):e instanceof eI?function(e,t,r,o){if(o===n.Left||o===n.Right)return e;var a=o===n.Top?-1:1,i=o===n.Top?"start":"end",s="start"===i?"end":"start",c=D({},e);return(o===n.Top?e.end>t.row:e.start<t.row)?c[s]=e[s]+a:c[i]=e[i]+a,new eI(Math.max(c.start,0),Math.max(c.end,0)).normalizeTo(r)}(e,t,r,o):e:e}var ta=function(e){let t=(0,s.createContext)({[C]:{v:{current:e},n:{current:-1},l:new Set,u:e=>e()}});return t[x]=t.Provider,t.Provider=_(t.Provider),delete t.Consumer,t}([eZ,function(){}]),ti=function(e){var t=e.children,r=e_(e.columns+(e.hideColumnIndicators?0:1)).map(function(e){return s.createElement("col",{key:e})});return s.createElement("table",{className:"Spreadsheet__table"},s.createElement("colgroup",null,r),s.createElement("tbody",null,t))},ts=function(e){return s.createElement("tr",D({},e))},tc=function(e){return s.createElement("tr",D({},e))};function tu(){return L(ta,function(e){var t=j(e,2);return t[0],t[1]})}function tl(e){return L(ta,function(t){return e(j(t,1)[0])})}var tf=function(e){var t=e.selected,r=e.onSelect,n=s.useCallback(function(){r()},[r]);return s.createElement("th",{className:M()("Spreadsheet__header",{"Spreadsheet__header--selected":t}),onClick:n,tabIndex:0})},th=function(e){var t=e.column,r=e.label,n=e.selected,o=e.onSelect,a=s.useCallback(function(e){o(t,e.shiftKey)},[o,t]);return s.createElement("th",{className:M()("Spreadsheet__header",{"Spreadsheet__header--selected":n}),onClick:a,tabIndex:0},void 0!==r?r:function(e){for(var t="",r=e;r>=0;)t=String.fromCharCode(65+r%26)+t,r=Math.floor(r/26)-1;return t}(t))},tp=function(e){var t=e.row,r=e.label,n=e.selected,o=e.onSelect,a=s.useCallback(function(e){o(t,e.shiftKey)},[o,t]);return s.createElement("th",{className:M()("Spreadsheet__header",{"Spreadsheet__header--selected":n}),onClick:a,tabIndex:0},void 0!==r?r:t+1)},td=function(e){var t=e.row,r=e.column,n=e.DataViewer,o=e.selected,a=e.active,i=e.dragging,c=e.mode,u=e.data,l=e.evaluatedData,f=e.select,h=e.activate,p=e.setCellDimensions,d=e.setCellData,m=s.useRef(null),v=s.useMemo(function(){return{row:t,column:r}},[t,r]),g=s.useCallback(function(e){"view"===c&&(p(v,ek(e.currentTarget)),e.shiftKey?f(v):h(v))},[c,p,v,f,h]),E=s.useCallback(function(e){i&&(p(v,ek(e.currentTarget)),f(v))},[p,f,i,v]);return s.useEffect(function(){var e=m.current;o&&e&&p(v,ek(e)),e&&a&&"view"===c&&e.focus()},[p,o,a,c,v,u]),u&&u.DataViewer&&(n=u.DataViewer),s.createElement("td",{ref:m,className:M()("Spreadsheet__cell",null==u?void 0:u.className,{"Spreadsheet__cell--readonly":null==u?void 0:u.readOnly}),onMouseOver:E,onMouseDown:g,tabIndex:0},s.createElement(n,{row:t,column:r,cell:u,evaluatedCell:l,setCellData:d}))},tm=function(e){var t,r,n,o,a=(t=e.cell,(o=null!==(n=null==(r=e.evaluatedCell)?void 0:r.value)&&void 0!==n?n:null==t?void 0:t.value)&&"object"==typeof o?o.toString():o);return"boolean"==typeof a?s.createElement("span",{className:"Spreadsheet__data-viewer Spreadsheet__data-viewer--boolean"},a?"TRUE":"FALSE"):s.createElement("span",{className:M()("Spreadsheet__data-viewer",{"Spreadsheet__data-viewer--preserve-breaks":"string"==typeof a&&a.includes("\n")})},a)},tv=function(e){var t,r=e.onChange,n=e.cell,o=s.useRef(null),a=s.useCallback(function(e){r(D(D({},n),{value:e.target.value}))},[r,n]);s.useEffect(function(){if(o.current){var e;(e=o.current).selectionStart=e.selectionEnd=e.value.length}},[o]);var i=null!==(t=null==n?void 0:n.value)&&void 0!==t?t:"";return s.createElement("div",{className:"Spreadsheet__data-editor"},s.createElement("input",{ref:o,type:"text",onChange:a,value:i,autoFocus:!0}))},tg=function(e){var t=s.useRef(null),r=tu(),n=s.useCallback(function(e,t){return r(ec(e,t))},[r]),o=s.useCallback(function(){return r({type:ee})},[r]),a=s.useCallback(function(e){return r({type:es,payload:{changes:e}})},[r]),i=s.useCallback(function(){r({type:et})},[r]),c=tl(function(e){return e.active}),u=tl(function(e){return e.mode}),l=tl(function(e){return e.active?eu(e.active,e.model.data):void 0}),f=tl(function(e){return c?eP(c,e.rowDimensions,e.columnDimensions):void 0}),h=s.useMemo(function(){return!c||!f},[c,f]),p=s.useRef(void 0),d=s.useRef(null),m=s.useRef(void 0),v=s.useCallback(function(e){c&&n(c,e)},[n,c]);s.useEffect(function(){var e=t.current;!h&&e&&e.focus()},[t,h]),s.useEffect(function(){var e=d.current,t=m.current;if(d.current=c,m.current=l,e&&t){var r=(null==c?void 0:c.row)!==e.row||(null==c?void 0:c.column)!==e.column;if(r||"edit"!==u){var n=p.current;t!==n?a([{prevCell:n||null,nextCell:t}]):r||l===t||a([{prevCell:t,nextCell:l||null}]),p.current=l}}});var g=l&&l.DataEditor||e.DataEditor,E=l&&l.readOnly;return h?null:s.createElement("div",{ref:t,className:M()("Spreadsheet__active-cell","Spreadsheet__active-cell--".concat(u)),style:f,onClick:"view"!==u||E?void 0:o,tabIndex:0},"edit"===u&&c&&s.createElement(g,{row:c.row,column:c.column,cell:l,onChange:v,exitEditMode:i}))},tE=function(e){var t,r=e.dimensions,n=e.dragging,o=e.hidden,a=e.variant,i=r||{},c=i.width,u=i.height,l=i.top,f=i.left;return s.createElement("div",{className:M()("Spreadsheet__floating-rect",((t={})["Spreadsheet__floating-rect--".concat(a)]=a,t["Spreadsheet__floating-rect--dragging"]=n,t["Spreadsheet__floating-rect--hidden"]=o,t)),style:{width:c,height:u,top:l,left:f}})},ty=function(){var e=tl(function(e){return e.selected}),t=tl(function(t){var r,n,o,a;return e&&(r=t.rowDimensions,n=t.columnDimensions,o=t.model.data,(a=t.selected.toRange(o))?eD(r,n,a):void 0)}),r=tl(function(e){return e.dragging}),n=tl(function(e){return 2>e.selected.size(e.model.data)});return s.createElement(tE,{variant:"selected",dimensions:t,dragging:r,hidden:n})},tN=function(){var e=tl(function(e){return e.copied}),t=tl(function(t){return e&&eD(t.rowDimensions,t.columnDimensions,e)}),r=null===e;return s.createElement(tE,{variant:"copied",dimensions:t,hidden:r,dragging:!1})};!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".Spreadsheet {\n  --background-color: white;\n  --text-color: black;\n  --readonly-text-color: rgba(0, 0, 0, 0.4);\n  --outline-color: #4285f4;\n  --outline-background-color: rgba(160, 195, 255, 0.2);\n  --border-color: hsl(2deg, 0%, 91%);\n  --header-background-color: rgba(0, 0, 0, 0.04);\n  --elevation: 0 2px 5px rgba(0, 0, 0, 0.4);\n\n  position: relative;\n  overflow: visible;\n  background: var(--background-color);\n  color: var(--text-color);\n  display: inline-block;\n}\n\n.Spreadsheet--dark-mode {\n  --background-color: black;\n  --text-color: white;\n  --readonly-text-color: rgba(255, 255, 255, 0.4);\n  --header-background-color: rgba(255, 255, 255, 0.04);\n  --border-color: hsl(2deg, 0%, 19%);\n}\n\n.Spreadsheet__active-cell {\n  position: absolute;\n  border: 2px solid var(--outline-color);\n  box-sizing: border-box;\n}\n\n.Spreadsheet__active-cell--edit {\n  background: var(--background-color);\n  box-shadow: var(--elevation);\n}\n\n.Spreadsheet__table {\n  border-collapse: collapse;\n  table-layout: fixed;\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__active-cell {\n  cursor: cell;\n}\n\n.Spreadsheet__cell {\n  outline: none;\n}\n\n.Spreadsheet__cell--readonly {\n  color: var(--readonly-text-color);\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__header {\n  min-width: 6em;\n  min-height: 1.9em;\n  height: 1.9em;\n  max-height: 1.9em;\n  border: 1px solid var(--border-color);\n  overflow: hidden;\n  word-break: keep-all;\n  white-space: nowrap;\n  text-align: left;\n  box-sizing: border-box;\n  user-select: none;\n}\n\n.Spreadsheet__header {\n  background: var(--header-background-color);\n  color: var(--readonly-text-color);\n  text-align: center;\n  font: inherit;\n}\n\n.Spreadsheet__header--selected {\n  background: #5f6268;\n  color: #fff;\n}\n\n.Spreadsheet__header,\n.Spreadsheet__data-viewer,\n.Spreadsheet__data-editor input {\n  padding: 4px;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__data-viewer--preserve-breaks {\n  white-space: pre-wrap;\n}\n\n.Spreadsheet__data-editor,\n.Spreadsheet__data-editor input {\n  width: 100%;\n  height: 100%;\n}\n\n.Spreadsheet__data-editor input {\n  font: inherit;\n  color: inherit;\n  background: none;\n  border: none;\n  outline: none;\n  margin: 0;\n}\n\n.Spreadsheet__data-viewer--boolean {\n  text-align: center;\n}\n\n.Spreadsheet__floating-rect {\n  position: absolute;\n  pointer-events: none;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__floating-rect--hidden {\n  display: none;\n}\n\n.Spreadsheet__floating-rect--selected {\n  background: var(--outline-background-color);\n  border: 2px var(--outline-color) solid;\n}\n\n.Spreadsheet__floating-rect--dragging {\n  border: none;\n}\n\n.Spreadsheet__floating-rect--copied {\n  border: 2px var(--outline-color) dashed;\n}\n");var tR=function(e){var t=e.className,r=e.darkMode,n=e.columnLabels,o=e.rowLabels,a=e.hideColumnIndicators,i=e.hideRowIndicators,c=e.onKeyDown,u=e.Table,l=void 0===u?ti:u,f=e.Row,h=void 0===f?ts:f,p=e.HeaderRow,d=void 0===p?tc:p,m=e.DataEditor,v=void 0===m?tv:m,g=e.DataViewer,E=void 0===g?tm:g,y=e.onChange,N=void 0===y?function(){}:y,R=e.onModeChange,A=void 0===R?function(){}:R,T=e.onSelect,w=void 0===T?function(){}:T,O=e.onActivate,I=void 0===O?function(){}:O,b=e.onBlur,C=void 0===b?function(){}:b,x=e.onCellCommit,S=void 0===x?function(){}:x,U=s.useMemo(function(){var t=new eX(e.createFormulaParser||eW,e.data);return D(D({},eZ),{model:t,selected:e.selected||eZ.selected})},[e.createFormulaParser,e.data,e.selected]),_=s.useReducer(eJ,U),L=j(_,2),k=L[0],P=L[1],B=s.useMemo(function(){var e,t,r;return t=(e=em(k.model.data)).columns,r=e.rows,{rows:o?Math.max(r,o.length):r,columns:n?Math.max(t,n.length):t}},[k.model.data,o,n]),G=k.mode,X=s.useRef(null),ee=s.useCallback(function(){return P({type:Z})},[P]),et=s.useCallback(function(){return P({type:"CUT"})},[P]),es=s.useCallback(function(e){return P({type:J,payload:{data:e}})},[P]),ef=s.useCallback(function(e){return P({type:eo,payload:{event:e}})},[P]),eh=s.useCallback(function(e){return P({type:en,payload:{event:e}})},[P]),ed=s.useCallback(function(){return P({type:ea})},[P]),ev=s.useCallback(function(){return P({type:ei})},[P]),eg=s.useCallback(function(e){return P({type:V,payload:{data:e}})},[P]),eE=s.useCallback(function(e){return P({type:$,payload:{createFormulaParser:e}})},[P]),ey=s.useCallback(function(){return P({type:er})},[P]),eN=s.useCallback(function(e){return P({type:q,payload:{selection:e}})},[P]),eR=s.useRef(k.active);s.useEffect(function(){if(k.active!==eR.current){if(k.active)I(k.active);else{var e=X.current;e&&eF(e)&&document.activeElement&&document.activeElement.blur(),C()}}eR.current=k.active},[I,C,k.active]);var eA=s.useRef(k.model.data);s.useEffect(function(){k.model.data!==eA.current&&k.model.data!==e.data&&N(k.model.data),eA.current=k.model.data},[k.model.data,N,e.data]);var eT=s.useRef(k.selected);s.useEffect(function(){k.selected.equals(eT.current)||e.selected&&k.selected.equals(e.selected)||w(k.selected),eT.current=k.selected},[k.selected,w,e.selected]);var eM=s.useRef(k.mode);s.useEffect(function(){k.mode!==eM.current&&A(k.mode),eM.current=k.mode},[k.mode,A]);var eO=s.useRef(k.lastCommit);s.useEffect(function(){var e,t;if(k.lastCommit&&k.lastCommit!==eO.current)try{for(var r=F(k.lastCommit),n=r.next();!n.done;n=r.next()){var o=n.value;S(o.prevCell,o.nextCell,k.lastChanged)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},[S,k.lastChanged,k.lastCommit]);var eI=s.useRef(e.selected);s.useEffect(function(){e.selected&&eI.current&&!e.selected.equals(eI.current)&&eN(e.selected),eI.current=e.selected},[e.selected,eN]);var eb=s.useRef(e.data);s.useEffect(function(){e.data!==eb.current&&eg(e.data),eb.current=e.data},[e.data,eg]);var eC=s.useRef(e.createFormulaParser);s.useEffect(function(){e.createFormulaParser!==eC.current&&e.createFormulaParser&&eE(e.createFormulaParser),eC.current=e.createFormulaParser},[e.createFormulaParser,eE]);var ex=s.useCallback(function(e){var t=k.model,r=k.selected,n=t.data,o=r.toRange(n);if(o){var a,i=function(e,t,r){void 0===t&&(t="	"),void 0===r&&(r="\n");for(var n="",o=em(e),a=o.rows,i=o.columns,s=0;s<a;s++){s&&(n+=r);for(var c=0;c<i;c++)c&&(n+=t),e[s]&&c in e[s]&&(n+=String(e[s][c]))}return n}(function(e,t){var r,n,o=[];try{for(var a=F(ep(t)),i=a.next();!i.done;i=a.next()){var s=j(i.value,2),c=s[0],u=s[1];!function(e,t,r){var n=r[0];n||(n=[],r[0]=n),e.row in r||(r[e.row]=[]),e.column in n||(n[e.column]=void 0),r[e.row][e.column]=t}(c,e(u,c),o)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}(function(e){return(null==e?void 0:e.value)||""},el(o.start,o.end,n)));null===(a=e.clipboardData)||void 0===a||a.setData(eU,i)}},[k]),eS=s.useCallback(function(e){eB(X.current,G)&&(e.preventDefault(),e.stopPropagation(),ex(e),et())},[G,ex,et]),ek=s.useCallback(function(e){eB(X.current,G)&&(e.preventDefault(),e.stopPropagation(),ex(e),ee())},[G,ex,ee]),eP=s.useCallback(function(e){eB(X.current,G)&&(e.preventDefault(),e.stopPropagation(),e.clipboardData)&&es(window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?e.clipboardData.getData(eU):"")},[G,es]),eD=s.useCallback(function(e){e.persist(),c&&c(e),e.defaultPrevented||(void 0!==tr(k,e)&&e.nativeEvent.preventDefault(),ef(e))},[k,c,ef]),ej=s.useCallback(function(){ev(),document.removeEventListener("mouseup",ej)},[ev]),eG=s.useCallback(function(e){k.dragging||1!==e.buttons||(ed(),document.addEventListener("mouseup",ej))},[k,ed,ej]),eV=s.useCallback(function(e){e.currentTarget.contains(e.relatedTarget)||ey()},[ey]),e$=s.useMemo(function(){var t;return t=e.Cell||td,function(e){var r=e.row,n=e.column,o=tu(),a=s.useMemo(function(){return{row:r,column:n}},[r,n]),i=s.useCallback(function(e){return o(ec(a,e))},[o,a]),c=s.useCallback(function(e){return o({type:K,payload:{point:e}})},[o]),u=s.useCallback(function(e){return o({type:z,payload:{point:e}})},[o]),l=s.useCallback(function(e,t){return o({type:Q,payload:{point:e,dimensions:t}})},[o]),f=tl(function(e){return eL(e.active,a)}),h=tl(function(e){return f?e.mode:"view"}),p=tl(function(e){return eu(a,e.model.data)}),d=tl(function(e){return eu(a,e.model.evaluatedData)}),m=tl(function(e){return e.selected.has(e.model.data,a)}),v=tl(function(e){return e.dragging}),g=tl(function(e){var t;return(null===(t=e.copied)||void 0===t?void 0:t.has(a))||!1});return s.createElement(t,D({},e,{selected:m,active:f,copied:g,dragging:v,mode:h,evaluatedData:d,data:p,select:c,activate:u,setCellDimensions:l,setCellData:i}))}},[e.Cell]),eH=s.useMemo(function(){var t;return t=e.CornerIndicator||tf,function(e){var r=tu(),n=s.useCallback(function(){return r({type:Y})},[r]),o=tl(function(e){return e.selected instanceof ew});return s.createElement(t,D({},e,{selected:o,onSelect:n}))}},[e.CornerIndicator]),eY=s.useMemo(function(){var t;return t=e.RowIndicator||tp,function(e){var r=tu(),n=tl(function(t){return t.selected.hasEntireRow(e.row)}),o=s.useCallback(function(e,t){return r({type:H,payload:{row:e,extend:t}})},[r]);return s.createElement(t,D({},e,{selected:n,onSelect:o}))}},[e.RowIndicator]),eq=s.useMemo(function(){var t;return t=e.ColumnIndicator||th,function(e){var r=tu(),n=s.useCallback(function(e,t){return r({type:W,payload:{column:e,extend:t}})},[r]),o=tl(function(t){return t.selected.hasEntireColumn(e.column)});return s.createElement(t,D({},e,{selected:o,onSelect:n}))}},[e.ColumnIndicator]);s.useEffect(function(){return document.addEventListener("cut",eS),document.addEventListener("copy",ek),document.addEventListener("paste",eP),function(){document.removeEventListener("cut",eS),document.removeEventListener("copy",ek),document.removeEventListener("paste",eP)}},[eS,ek,eP]);var eK=s.useMemo(function(){return s.createElement(l,{columns:B.columns,hideColumnIndicators:a},s.createElement(d,null,!i&&!a&&s.createElement(eH,null),!a&&e_(B.columns).map(function(e){return n?s.createElement(eq,{key:e,column:e,label:e in n?n[e]:null}):s.createElement(eq,{key:e,column:e})})),e_(B.rows).map(function(e){return s.createElement(h,{key:e,row:e},!i&&(o?s.createElement(eY,{key:e,row:e,label:e in o?o[e]:null}):s.createElement(eY,{key:e,row:e})),e_(B.columns).map(function(t){return s.createElement(e$,{key:t,row:e,column:t,DataViewer:E})}))}))},[l,B.rows,B.columns,a,h,d,i,eH,n,eq,o,eY,e$,E]),ez=s.useMemo(function(){return s.createElement(tg,{DataEditor:v})},[v]),eQ=s.useMemo(function(){return s.createElement("div",{ref:X,className:M()("Spreadsheet",t,{"Spreadsheet--dark-mode":r}),onKeyPress:eh,onKeyDown:eD,onMouseMove:eG,onBlur:eV},eK,ez,s.createElement(ty,null),s.createElement(tN,null))},[t,r,eh,eD,eG,eV,eK,ez]);return s.createElement(ta.Provider,{value:_},eQ)};let tA=()=>o.jsx("div",{className:"w-full h-full",children:o.jsx(tR,{className:"w-full h-full overflow-auto",data:[[{value:"Treasury Shares Number"},{value:0}],[{value:"Ordinary Shares Number"},{value:2464e7}],[{value:"Share Issued"},{value:2464e7}],[{value:"Net Debt"},{value:2429e6}],[{value:"Total Debt"},{value:11056e6}],[{value:"Tangible Book Value"},{value:37436e6}],[{value:"Invested Capital"},{value:52687e6}],[{value:"Working Capital"},{value:33714e6}],[{value:"Net Tangible Assets"},{value:37436e6}],[{value:"Capital Lease Obligations"},{value:1347e6}],[{value:"Common Stock Equity"},{value:42978e6}],[{value:"Total Capitalization"},{value:51437e6}],[{value:"Total Equity Gross Minority Interest"},{value:42978e6}],[{value:"Stockholders Equity"},{value:42978e6}],[{value:"Gains Losses Not Affecting Retained Earnings"},{value:27e6}],[{value:"Other Equity Adjustments"},{value:27e6}],[{value:"Treasury Stock"},{value:0}],[{value:"Retained Earnings"},{value:29817e6}],[{value:"Additional Paid In Capital"},{value:13132e6}],[{value:"Capital Stock"},{value:2e6}],[{value:"Common Stock"},{value:2e6}],[{value:"Preferred Stock"},{value:0}],[{value:"Total Liabilities Net Minority Interest"},{value:2275e7}],[{value:"Total Non Current Liabilities Net Minority Interest"},{value:12119e6}],[{value:"Other Non Current Liabilities"},{value:65e6}],[{value:"Employee Benefits"},{value:0}],[{value:"Trade and Other Payables Non Current"},{value:1441e6}],[{value:"Non Current Deferred Liabilities"},{value:1035e6}],[{value:"Non Current Deferred Revenue"},{value:573e6}],[{value:"Non Current Deferred Taxes Liabilities"},{value:462e6}],[{value:"Long Term Debt And Capital Lease Obligation"},{value:9578e6}],[{value:"Long Term Capital Lease Obligation"},{value:1119e6}],[{value:"Long Term Debt"},{value:8459e6}],[{value:"Current Liabilities"},{value:10631e6}],[{value:"Other Current Liabilities"},{value:199e6}],[{value:"Current Deferred Liabilities"},{value:764e6}],[{value:"Current Deferred Revenue"},{value:764e6}],[{value:"Current Debt And Capital Lease Obligation"},{value:1478e6}],[{value:"Current Capital Lease Obligation"},{value:228e6}],[{value:"Current Debt"},{value:125e7}],[{value:"Other Current Borrowings"},{value:125e7}],[{value:"Current Provisions"},{value:415e6}],[{value:"Payables And Accrued Expenses"},{value:7775e6}],[{value:"Current Accrued Expenses"},{value:478e7}],[{value:"Interest Payable"},{value:0}],[{value:"Payables"},{value:2995e6}],[{value:"Other Payable"},{value:0}],[{value:"Total Tax Payable"},{value:296e6}],[{value:"Accounts Payable"},{value:2699e6}],[{value:"Total Assets"},{value:65728e6}],[{value:"Total Non Current Assets"},{value:21383e6}],[{value:"Other Non Current Assets"},{value:132e6}],[{value:"Non Current Prepaid Assets"},{value:2822e6}],[{value:"Non Current Deferred Assets"},{value:6081e6}],[{value:"Non Current Deferred Taxes Assets"},{value:6081e6}],[{value:"Investments And Advances"},{value:1546e6}],[{value:"Other Investments"},{value:1546e6}],[{value:"Goodwill And Other Intangible Assets"},{value:5542e6}],[{value:"Other Intangible Assets"},{value:1112e6}],[{value:"Goodwill"},{value:443e7}],[{value:"Net PPE"},{value:526e7}],[{value:"Accumulated Depreciation"},{value:-3509e6}],[{value:"Gross PPE"},{value:8769e6}],[{value:"Leases"},{value:0}],[{value:"Construction In Progress"},{value:189e6}],[{value:"Other Properties"},{value:1346e6}],[{value:"Machinery Furniture Equipment"},{value:52e8}],[{value:"Buildings And Improvements"},{value:1816e6}],[{value:"Land And Improvements"},{value:218e6}],[{value:"Properties"},{value:0}],[{value:"Current Assets"},{value:44345e6}],[{value:"Other Current Assets"},{value:308e7}],[{value:"Prepaid Assets"},{value:0}],[{value:"Inventory"},{value:5282e6}],[{value:"Finished Goods"},{value:2058e6}],[{value:"Work In Process"},{value:1505e6}],[{value:"Raw Materials"},{value:1719e6}],[{value:"Receivables"},{value:9999e6}],[{value:"Accounts Receivable"},{value:9999e6}],[{value:"Allowance For Doubtful Accounts Receivable"},{value:0}],[{value:"Gross Accounts Receivable"},{value:0}],[{value:"Cash Cash Equivalents And Short Term Investments"},{value:25984e6}],[{value:"Other Short Term Investments"},{value:18704e6}],[{value:"Cash And Cash Equivalents"},{value:728e7}]],columnLabels:["Metric","Value"]})});var tT=r(46226);let tM=function(){let[e,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(""),[T,M]=(0,s.useState)(""),[w,O]=(0,s.useState)(""),[I,b]=(0,s.useState)(""),[C,x]=(0,s.useState)(""),[S,U]=(0,s.useState)(),[_,L]=(0,s.useState)(""),[k,P]=(0,s.useState)(!1),[D,B]=(0,s.useState)(!1),[F,j]=(0,s.useState)(!0),{toast:G}=(0,A.pm)(),V=async e=>{console.log(e),P(!0);try{let t=await E.Z.post("http://98.70.9.194:8000/api/finance_agent",{ticker:e.ticker,value_proposition:e.value_proposition},{headers:{"Content-Type":"application/json"}});console.log(t.data),n(t.data.industry_landscape),M(t.data.msgp),O(t.data.tt),b(t.data.in),x(t.data.file),U(t.data.data),L(t.data.type)}catch(e){G({title:"ERROR API CALL",description:"There is an error in making the call",variant:"destructive"}),console.error("Error fetching data:",e)}P(!1),j(!1),W(!0)},$=(0,m.cI)({defaultValues:{language:"english",year:"2020",model:"llama3-70b-8192",ticker:"",value_proposition:""}});(0,y.useRouter)();let[H,W]=(0,s.useState)(!1),[Y,q]=(0,s.useState)(!1),[K,z]=(0,s.useState)(!1),[X,Q]=(0,s.useState)(""),Z=e=>{e.preventDefault();let t=window.getSelection()?.toString()||"";Q(t),t.length>0&&z(!0)};return(0,o.jsxs)(R.Z,{children:[o.jsx("div",{className:"w-full h-screen flex",children:(0,o.jsxs)("div",{className:"w-full",children:[o.jsx("div",{className:" w-full border-b-2 border-zinc-100"}),F?(0,o.jsxs)("div",{className:" the div containing the form  w-full h-screen flex items-center justify-around text-base text-zinc-800",children:[o.jsx("div",{className:"  w-[600px] overflow-hidden",children:o.jsx(p.l0,{...$,children:(0,o.jsxs)("form",{onSubmit:$.handleSubmit(V),className:"space-y-6 w-full",children:[o.jsx(p.Wi,{name:"ticker",control:$.control,render:({field:e})=>(0,o.jsxs)(p.xJ,{children:[o.jsx(p.lX,{className:"mb-2 text-2xl font-bold text-zinc-800",children:"Ticker symbol"}),o.jsx(d.I,{className:"overflow-y-auto mt-2 border border-zinc-400",...e}),o.jsx(p.zG,{})]})}),o.jsx(p.Wi,{name:"value_proposition",control:$.control,render:({field:e})=>(0,o.jsxs)(p.xJ,{children:[o.jsx(p.lX,{className:"text-lg font-semibold",children:"Value Proposition"}),o.jsx(d.I,{className:"h-24 border border-zinc-400 rounded w-full px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",...e}),o.jsx(p.zG,{})]})}),o.jsx(g.UQ,{className:"border border-gray-400",type:"single",collapsible:!0,children:(0,o.jsxs)(g.Qd,{value:"item-1",children:[o.jsx(g.o4,{className:"text-lg p-4",children:"Advanced Options"}),o.jsx(g.vF,{className:"border-t border-gray-300",children:(0,o.jsxs)("div",{className:"flex items-center justify-center gap-4 p-2",children:[o.jsx(p.Wi,{name:"language",control:$.control,render:({field:e})=>(0,o.jsxs)(p.xJ,{children:[o.jsx(p.lX,{className:"text-sm font-semibold mb-2",children:"Language"}),(0,o.jsxs)(f.Ph,{onValueChange:e.onChange,value:e.value,children:[o.jsx(f.i4,{className:"w-[120px] bg-gray-50 border border-gray-300 rounded-md",children:o.jsx(f.ki,{placeholder:"Select Language"})}),(0,o.jsxs)(f.Bw,{children:[o.jsx(f.Ql,{value:"english",children:"English (US)"}),o.jsx(f.Ql,{value:"hindi",children:"Hindi"}),o.jsx(f.Ql,{value:"german",children:"German"})]})]}),o.jsx(p.zG,{})]})}),o.jsx(p.Wi,{name:"model",control:$.control,render:({field:e})=>(0,o.jsxs)(p.xJ,{children:[o.jsx(p.lX,{className:"text-sm font-semibold mb-2",children:"Model"}),(0,o.jsxs)(f.Ph,{onValueChange:e.onChange,value:e.value,children:[o.jsx(f.i4,{className:"w-[120px] bg-gray-50 border border-gray-300 rounded-md",children:o.jsx(f.ki,{placeholder:"Select Model"})}),(0,o.jsxs)(f.Bw,{children:[o.jsx(f.Ql,{value:"llama3-70b-8192",children:"KareAI"}),o.jsx(f.Ql,{value:"gpt-4o",children:"OpenAI|GPT-4o"}),o.jsx(f.Ql,{value:"gemini-1.5-pro",children:"Google|Gemini"})]})]}),o.jsx(p.zG,{})]})}),o.jsx(p.Wi,{name:"year",control:$.control,render:({field:e})=>(0,o.jsxs)(p.xJ,{children:[o.jsx(p.lX,{className:"text-sm font-semibold mb-2",children:"Year"}),(0,o.jsxs)(f.Ph,{onValueChange:e.onChange,value:e.value,children:[o.jsx(f.i4,{className:"w-[120px] bg-gray-50 border border-gray-300 rounded-md",children:o.jsx(f.ki,{placeholder:"Select Year"})}),(0,o.jsxs)(f.Bw,{children:[o.jsx(f.Ql,{value:"2020",children:"2020"}),o.jsx(f.Ql,{value:"2021",children:"2021"}),o.jsx(f.Ql,{value:"2022",children:"2022"}),o.jsx(f.Ql,{value:"2023",children:"2023"}),o.jsx(f.Ql,{value:"2024",children:"2024"})]})]}),o.jsx(p.zG,{})]})})]})})]})}),o.jsx(h.z,{type:"submit",className:"w-full bg-gradient-to-r from-purple-700 to-[#540F66]",disabled:k,children:k?(0,o.jsxs)(o.Fragment,{children:[o.jsx(v.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait"]}):(0,o.jsxs)(o.Fragment,{children:[o.jsx(u.Z,{className:"m-2"}),"Run Agent"]})})]})})}),o.jsx(tT.default,{alt:"no image",width:400,height:400,src:"/img.avif"})]}):"",o.jsx("div",{className:`w-full py-5  h-full border-l-2 border-zinc-100 ${H?"block":"hidden"} justify-center text-zinc-900`,children:(0,o.jsxs)(a.mQ,{className:"w-full bg--200",defaultValue:"Balance sheet",children:[(0,o.jsxs)(a.dr,{className:"flex w-full justify-between px-6  text-zinc-900",children:[o.jsx(l.Z,{onClick:()=>{j(!0)},className:`cursor-pointer ${F?"hidden":"block"}`}),o.jsx(a.SP,{value:"Balance sheet",children:"Balance sheet"}),o.jsx(a.SP,{value:"Income Statement",children:"Income Statement"}),o.jsx(a.SP,{value:"Cash flow",children:"Cash flow"}),o.jsx(a.SP,{value:"Insights",children:"Insights"})]}),o.jsx(a.nU,{className:"flex-1 justify-center",value:"Balance sheet",children:(0,o.jsxs)(i.Zb,{className:"h-full ",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Balance sheet"}),o.jsx(i.SZ,{children:"Overview of the industry landscape."})]}),o.jsx(i.aY,{className:"h-full w-full ",id:"content1",children:k?o.jsx("div",{className:"w-full h-screen flex items-center justify-center",children:o.jsx(c.Z,{})}):o.jsx("div",{className:"w-full h-full ",id:"pdf",children:o.jsx(tA,{})})})]})}),o.jsx(a.nU,{className:"flex-1",value:"Income Statement",children:(0,o.jsxs)(i.Zb,{className:"h-full",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Income Statement"}),o.jsx(i.SZ,{children:"Overview of the industry landscape."})]}),o.jsx("div",{className:"sample",onMouseUp:Z,children:o.jsx(i.aY,{className:"h-full w-full",id:"content2",children:k?o.jsx("div",{className:"w-full h-screen flex items-center justify-center",children:o.jsx(c.Z,{})}):o.jsx("div",{className:"w-full h-full",id:"pdf",children:o.jsx("p",{children:"Table content here..."})})})})]})}),o.jsx(a.nU,{className:"flex-1",value:"Cash flow",children:(0,o.jsxs)(i.Zb,{className:"h-full",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Cash flow"}),o.jsx(i.SZ,{children:"Overview of the industry landscape."})]}),o.jsx("div",{className:"sample",onMouseUp:Z,children:o.jsx(i.aY,{className:"h-full w-full",id:"content3",children:k?o.jsx("div",{className:"w-full h-screen flex items-center justify-center",children:o.jsx(c.Z,{})}):o.jsx("div",{className:"w-full h-full",id:"pdf",children:o.jsx("p",{children:"Table content here..."})})})})]})}),o.jsx(a.nU,{className:"flex-1",value:"Insights",children:(0,o.jsxs)(i.Zb,{className:"h-full",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Insights"}),o.jsx(i.SZ,{children:"Overview of the industry landscape."})]}),o.jsx("div",{className:"sample",onMouseUp:Z,children:o.jsx(i.aY,{className:"h-full w-full",id:"content4",children:k?o.jsx("div",{className:"w-full h-screen flex items-center justify-center",children:o.jsx(c.Z,{})}):o.jsx("div",{className:"w-full h-full",id:"pdf",children:o.jsx("p",{children:"Table content here..."})})})})]})})]})})]})}),o.jsx(N.Z,{isOpen:Y,selectedText:X,handleClose:()=>{q(!1)}})]})}},74283:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>s});var n=r(68570);let o=(0,n.createProxy)(String.raw`C:\Users\Daniyal\Desktop\final\marketplace_kareai\src\app\financial_research_agent\page.tsx`),{__esModule:a,$$typeof:i}=o;o.default;let s=(0,n.createProxy)(String.raw`C:\Users\Daniyal\Desktop\final\marketplace_kareai\src\app\financial_research_agent\page.tsx#default`)},48029:(e,t)=>{var r;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=a(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=a(t,r));return t}(r)))}return e}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0!==(r=(function(){return o}).apply(t,[]))&&(e.exports=r)}()}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,922,621,550,256,627,825,266,854],()=>r(71327));module.exports=n})();