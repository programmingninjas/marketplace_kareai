(()=>{var t={};t.id=590,t.ids=[590],t.modules={47849:t=>{"use strict";t.exports=require("next/dist/client/components/action-async-storage.external")},72934:t=>{"use strict";t.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:t=>{"use strict";t.exports=require("next/dist/client/components/request-async-storage.external")},54580:t=>{"use strict";t.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:t=>{"use strict";t.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:t=>{"use strict";t.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:t=>{"use strict";t.exports=require("assert")},82361:t=>{"use strict";t.exports=require("events")},57147:t=>{"use strict";t.exports=require("fs")},13685:t=>{"use strict";t.exports=require("http")},95687:t=>{"use strict";t.exports=require("https")},22037:t=>{"use strict";t.exports=require("os")},71017:t=>{"use strict";t.exports=require("path")},12781:t=>{"use strict";t.exports=require("stream")},76224:t=>{"use strict";t.exports=require("tty")},57310:t=>{"use strict";t.exports=require("url")},73837:t=>{"use strict";t.exports=require("util")},59796:t=>{"use strict";t.exports=require("zlib")},9913:(t,e,r)=>{"use strict";r.r(e),r.d(e,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>f,pages:()=>l,routeModule:()=>p,tree:()=>u}),r(74283),r(2525),r(35866);var n=r(23191),o=r(88716),a=r(37922),i=r.n(a),s=r(95231),c={};for(let t in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(t)&&(c[t]=()=>s[t]);r.d(e,c);let u=["",{children:["financial_research_agent",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,74283)),"C:\\Users\\progr\\OneDrive\\Desktop\\KareAI MP\\finalkare\\src\\app\\financial_research_agent\\page.tsx"]}]},{metadata:{icon:[async t=>(await Promise.resolve().then(r.bind(r,73881))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,2525)),"C:\\Users\\progr\\OneDrive\\Desktop\\KareAI MP\\finalkare\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async t=>(await Promise.resolve().then(r.bind(r,73881))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["C:\\Users\\progr\\OneDrive\\Desktop\\KareAI MP\\finalkare\\src\\app\\financial_research_agent\\page.tsx"],f="/financial_research_agent/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new n.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/financial_research_agent/page",pathname:"/financial_research_agent",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},29198:(t,e,r)=>{Promise.resolve().then(r.bind(r,14887))},92629:t=>{let e="ศูนย์บาทถ้วน",r=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],n=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];function o(t){let e="",a=t.length;if(a>7){let e=a-7+1,r=t.slice(0,e),n=t.slice(e);return o(r)+"ล้าน"+o(n)}for(let o=0;o<a;o++){let i=t[o];i>0&&(e+=r[i]+n[a-o-1])}return e}function a(t){let e=t;return(e=(e=e.replace("หนึ่งสิบ","สิบ")).replace("สองสิบ","ยี่สิบ")).length>5&&e.length-e.lastIndexOf("หนึ่ง")==5&&(e=e.substr(0,e.length-5)+"เอ็ด"),e}null!=t.exports&&(t.exports=function(t){var r,n;let i=e;if(isNaN(t)||t>=Number.MAX_SAFE_INTEGER)return i;let s=Math.floor(t).toString(),c=Math.round(t%1*100).toString(),u=Array.from(s).map(Number),l=Array.from(c).map(Number),f=o(u),h=o(l);return f=a(f),h=a(h),r=f,n=h,i=""===r&&""===n?e:""!==r&&""===n?r+"บาทถ้วน":""===r&&""!==n?n+"สตางค์":r+"บาท"+n+"สตางค์"})},51198:(t,e)=>{!function(t){"undefined"==typeof DO_NOT_EXPORT_BESSEL?t(e):t({})}(function(t){t.version="1.0.2";var e,r,n,o,a,i,s,c,u,l,f,h,p,d,m,g,v=Math;function E(t,e){for(var r=0,n=0;r<t.length;++r)n=e*n+t[r];return n}function y(t,e,r,n,o){if(0===e)return r;if(1===e)return n;for(var a=2/t,i=n,s=1;s<e;++s)i=n*s*a+o*r,r=n,n=i;return i}function N(t,e,r,n,o){return function(r,a){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}if(0===a)return t(r);if(1===a)return e(r);if(a<0)return NaN;a|=0;var i=t(r),s=e(r);return y(r,a,i,s,o)}}var R=function(){var t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),e=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-.000002073370639,2093887211e-16].reverse(),n=[-.01562499995,1430488765e-13,-.000006911147651,7621095161e-16,-.0000000934935152].reverse();function o(o){var a=0,i=0,s=0,c=o*o;if(o<8)a=(i=E(t,c))/(s=E(e,c));else{var u=o-.785398164;i=E(r,c=64/c),s=E(n,c),a=v.sqrt(.636619772/o)*(v.cos(u)*i-v.sin(u)*s*8/o)}return a}var a=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),i=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-.00003516396496,2457520174e-15,-.000000240337019].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-.00000088228987,105787412e-15].reverse();function u(t){var e=0,r=0,n=0,o=t*t,u=v.abs(t)-2.356194491;return 8>Math.abs(t)?e=(r=t*E(a,o))/(n=E(i,o)):(r=E(s,o=64/o),n=E(c,o),e=v.sqrt(.636619772/v.abs(t))*(v.cos(u)*r-v.sin(u)*n*8/v.abs(t)),t<0&&(e=-e)),e}return function t(e,r){if(r=Math.round(r),!isFinite(e))return isNaN(e)?e:0;if(r<0)return(r%2?-1:1)*t(e,-r);if(e<0)return(r%2?-1:1)*t(-e,r);if(0===r)return o(e);if(1===r)return u(e);if(0===e)return 0;var n=0;if(e>r)n=y(e,r,o(e),u(e),-1);else{for(var a=2*v.floor((r+v.floor(v.sqrt(40*r)))/2),i=!1,s=0,c=0,l=1,f=0,h=2/e,p=a;p>0;p--)f=p*h*l-s,s=l,l=f,v.abs(l)>1e10&&(l*=1e-10,s*=1e-10,n*=1e-10,c*=1e-10),i&&(c+=l),i=!i,p==r&&(n=s);n/=c=2*c-l}return n}}(),T=(e=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),r=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-.000002073370639,2093887211e-16].reverse(),o=[-.01562499995,1430488765e-13,-.000006911147651,7621095161e-16,-.0000000934945152].reverse(),a=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),i=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),s=[1,.00183105,-.00003516396496,2457520174e-15,-.000000240337019].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-.00000088228987,105787412e-15].reverse(),N(function(t){var a=0,i=0,s=0,c=t*t,u=t-.785398164;return t<8?a=(i=E(e,c))/(s=E(r,c))+.636619772*R(t,0)*v.log(t):(i=E(n,c=64/c),s=E(o,c),a=v.sqrt(.636619772/t)*(v.sin(u)*i+v.cos(u)*s*8/t)),a},function(t){var e=0,r=0,n=0,o=t*t,u=t-2.356194491;return t<8?e=(r=t*E(a,o))/(n=E(i,o))+.636619772*(R(t,1)*v.log(t)-1/t):(r=E(s,o=64/o),n=E(c,o),e=v.sqrt(.636619772/t)*(v.sin(u)*r+v.cos(u)*n*8/t)),e},"BESSELY",1,-1)),A=(u=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),l=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),f=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),h=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function t(e,r){if(0===(r=Math.round(r)))return e<=3.75?E(u,e*e/14.0625):v.exp(v.abs(e))/v.sqrt(v.abs(e))*E(l,3.75/v.abs(e));if(1===r)return e<3.75?e*E(f,e*e/14.0625):(e<0?-1:1)*v.exp(v.abs(e))/v.sqrt(v.abs(e))*E(h,3.75/v.abs(e));if(r<0)return NaN;if(0===v.abs(e))return 0;if(e==1/0)return 1/0;var n,o=0,a=2/v.abs(e),i=0,s=1,c=0;for(n=2*v.round((r+v.round(v.sqrt(40*r)))/2);n>0;n--)c=n*a*s+i,i=s,s=c,v.abs(s)>1e10&&(s*=1e-10,i*=1e-10,o*=1e-10),n==r&&(o=i);return o*=t(e,0)/s,e<0&&r%2?-o:o}),M=(p=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),d=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),m=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-.00004686].reverse(),g=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-.00068245].reverse(),N(function(t){return t<=2?-v.log(t/2)*A(t,0)+E(p,t*t/4):v.exp(-t)/v.sqrt(t)*E(d,2/t)},function(t){return t<=2?v.log(t/2)*A(t,1)+1/t*E(m,t*t/4):v.exp(-t)/v.sqrt(t)*E(g,2/t)},"BESSELK",2,1));t.besselj=R,t.bessely=T,t.besseli=A,t.besselk=M})},75490:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Alternation:()=>tN,Alternative:()=>td,CstParser:()=>eZ,EMPTY_ALT:()=>eX,EOF:()=>ts,EarlyExitException:()=>eg,EmbeddedActionsParser:()=>eJ,GAstVisitor:()=>tx,Lexer:()=>q,LexerDefinitionErrorType:()=>n,MismatchedTokenException:()=>ep,NoViableAltException:()=>ed,NonTerminal:()=>th,NotAllInputParsedException:()=>em,Option:()=>tm,Parser:()=>e8,ParserDefinitionErrorType:()=>i,Repetition:()=>tE,RepetitionMandatory:()=>tg,RepetitionMandatoryWithSeparator:()=>tv,RepetitionWithSeparator:()=>ty,Rule:()=>tp,Terminal:()=>tR,VERSION:()=>s,assignOccurrenceIndices:()=>eo,clearCache:()=>e9,createSyntaxDiagramsCode:()=>e0,createToken:()=>ta,createTokenInstance:()=>tc,defaultGrammarResolverErrorProvider:()=>tD,defaultGrammarValidatorErrorProvider:()=>tB,defaultLexerErrorProvider:()=>W,defaultParserErrorProvider:()=>tP,generateParserFactory:()=>e6,generateParserModule:()=>e7,isRecognitionException:()=>ef,resolveGrammar:()=>er,serializeGrammar:()=>tT,serializeProduction:()=>tA,tokenLabel:()=>K,tokenMatcher:()=>tu,tokenName:()=>z,validateGrammar:()=>en});var n,o,a,i,s="7.1.2",c=r(76785),u=r(25975),l={},f=new u.RegExpParser;function h(t){var e=t.toString();if(l.hasOwnProperty(e))return l[e];var r=f.pattern(e);return l[e]=r,r}var p=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d="Complement Sets are not supported for first char optimization",m='Unable to use "first char" lexer optimizations:\n';function g(t,e,r){var n=k(t);e[n]=n,!0===r&&function(t,e){var r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){var o=k(n.charCodeAt(0));e[o]=o}else{var a=r.toLowerCase();if(a!==r){var o=k(a.charCodeAt(0));e[o]=o}}}(t,e)}function v(t,e){return(0,c.sE)(t.value,function(t){return"number"==typeof t?(0,c.r3)(e,t):void 0!==(0,c.sE)(e,function(e){return t.from<=e&&e<=t.to})})}var E=function(t){function e(e){var r=t.call(this)||this;return r.targetCharCodes=e,r.found=!1,r}return p(e,t),e.prototype.visitChildren=function(e){if(!0!==this.found){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}t.prototype.visitChildren.call(this,e)}},e.prototype.visitCharacter=function(t){(0,c.r3)(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?void 0===v(t,this.targetCharCodes)&&(this.found=!0):void 0!==v(t,this.targetCharCodes)&&(this.found=!0)},e}(u.BaseRegExpVisitor);function y(t,e){if(!(e instanceof RegExp))return void 0!==(0,c.sE)(e,function(e){return(0,c.r3)(t,e.charCodeAt(0))});var r=h(e),n=new E(t);return n.visit(r),n.found}var N=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R="PATTERN",T="defaultMode",A="modes",M="boolean"==typeof RegExp("(?:)").sticky,w=/[^\\][\$]/,x=/[^\\[][\^]|^\^/;function I(t){var e=t.ignoreCase?"i":"";return RegExp("^(?:"+t.source+")",e)}function O(t){var e=t.ignoreCase?"iy":"y";return RegExp(""+t.source,e)}function b(t){var e=t.PATTERN;if((0,c.Kj)(e))return!1;if((0,c.mf)(e)||(0,c.e$)(e,"exec"))return!0;if((0,c.HD)(e))return!1;throw Error("non exhaustive match")}function C(t){return!!(0,c.HD)(t)&&1===t.length&&t.charCodeAt(0)}var S={test:function(t){for(var e=t.length,r=this.lastIndex;r<e;r++){var n=t.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===t.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function U(t,e){if((0,c.e$)(t,"LINE_BREAKS"))return!1;if((0,c.Kj)(t.PATTERN)){try{y(e,t.PATTERN)}catch(t){return{issue:n.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}if((0,c.HD)(t.PATTERN))return!1;if(b(t))return{issue:n.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function _(t){return(0,c.UI)(t,function(t){return(0,c.HD)(t)&&t.length>0?t.charCodeAt(0):t})}function L(t,e,r){void 0===t[e]?t[e]=[r]:t[e].push(r)}function k(t){return t<256?t:P[t]}var P=[];function D(t,e){var r=t.tokenTypeIdx;return r===e.tokenTypeIdx||!0===e.isParent&&!0===e.categoryMatchesMap[r]}function B(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var F=1,j={};function V(t){var e=function(t){for(var e=(0,c.Qw)(t),r=t,n=!0;n;){r=(0,c.oA)((0,c.xH)((0,c.UI)(r,function(t){return t.CATEGORIES})));var o=(0,c.e5)(r,e);e=e.concat(o),(0,c.xb)(o)?n=!1:r=o}return e}(t);(0,c.Ed)(e,function(t){G(t)||(j[F]=t,t.tokenTypeIdx=F++),$(t)&&!(0,c.kJ)(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),$(t)||(t.CATEGORIES=[]),(0,c.e$)(t,"categoryMatches")||(t.categoryMatches=[]),(0,c.e$)(t,"categoryMatchesMap")||(t.categoryMatchesMap={})}),(0,c.Ed)(e,function(t){(function t(e,r){(0,c.Ed)(e,function(t){r.categoryMatchesMap[t.tokenTypeIdx]=!0}),(0,c.Ed)(r.CATEGORIES,function(n){var o=e.concat(r);(0,c.r3)(o,n)||t(o,n)})})([],t)}),(0,c.Ed)(e,function(t){t.categoryMatches=[],(0,c.Ed)(t.categoryMatchesMap,function(e,r){t.categoryMatches.push(j[r].tokenTypeIdx)})}),(0,c.Ed)(e,function(t){t.isParent=t.categoryMatches.length>0})}function G(t){return(0,c.e$)(t,"tokenTypeIdx")}function $(t){return(0,c.e$)(t,"CATEGORIES")}function H(t){return(0,c.e$)(t,"tokenTypeIdx")}var W={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,r,n,o){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+", skipped "+r+" characters."}};!function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(n||(n={}));var Y={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:W,traceInitPerf:!1,skipValidations:!1};Object.freeze(Y);var q=function(){function t(t,e){var r=this;if(void 0===e&&(e=Y),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof e)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,c.TS)(Y,e);var o=this.config.traceInitPerf;!0===o?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof o&&(this.traceInitMaxIdent=o,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var o,a=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===Y.lineTerminatorsPattern)r.config.lineTerminatorsPattern=S;else if(r.config.lineTerminatorCharacters===Y.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),(0,c.kJ)(t)?((o={modes:{}}).modes[T]=(0,c.Qw)(t),o[T]=T):(a=!1,o=(0,c.Cl)(t))}),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",function(){var t,e;r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat((t=o,r.trackStartLines,r.config.lineTerminatorCharacters,e=[],(0,c.e$)(t,T)||e.push({message:"A MultiMode Lexer cannot be initialized without a <"+T+"> property in its definition\n",type:n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,c.e$)(t,A)||e.push({message:"A MultiMode Lexer cannot be initialized without a <"+A+"> property in its definition\n",type:n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,c.e$)(t,A)&&(0,c.e$)(t,T)&&!(0,c.e$)(t.modes,t.defaultMode)&&e.push({message:"A MultiMode Lexer cannot be initialized with a "+T+": <"+t.defaultMode+">which does not exist\n",type:n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,c.e$)(t,A)&&(0,c.Ed)(t.modes,function(t,r){(0,c.Ed)(t,function(t,o){(0,c.o8)(t)&&e.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+r+"> at index: <"+o+">\n",type:n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),e))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){var t,e,a,i,s,u,l,f;r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat((t=o,e=r.trackStartLines,a=r.config.lineTerminatorCharacters,i=[],s=!1,u=(0,c.oA)((0,c.xH)((0,c.Q8)(t.modes,function(t){return t}))),l=(0,c.d1)(u,function(t){return t[R]===q.NA}),f=_(a),e&&(0,c.Ed)(l,function(t){var e=U(t,f);if(!1!==e){var r={message:function(t,e){if(e.issue===n.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n	The problem is in the <"+t.name+"> Token Type\n	 Root cause: "+e.errMsg+".\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===n.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n	The problem is in the <"+t.name+"> Token Type\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(t,e),type:e.issue,tokenType:t};i.push(r)}else(0,c.e$)(t,"LINE_BREAKS")?!0===t.LINE_BREAKS&&(s=!0):y(f,t.PATTERN)&&(s=!0)}),e&&!s&&i.push({message:"Warning: No LINE_BREAKS Found.\n	This Lexer has been defined to track line and column information,\n	But none of the Token Types can be identified as matching a line terminator.\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n	for details.",type:n.NO_LINE_BREAKS_FLAGS}),i))})),o.modes=o.modes?o.modes:{},(0,c.Ed)(o.modes,function(t,e){o.modes[e]=(0,c.d1)(t,function(t){return(0,c.o8)(t)})});var i=(0,c.XP)(o.modes);if((0,c.Ed)(o.modes,function(t,o){r.TRACE_INIT("Mode: <"+o+"> processing",function(){if(r.modes.push(o),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",function(){var e,o,a,s,l,f,p,d,m,g,v,E,y,T,A,M,I,O,b,C,S,U;r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat((e=[],l=(0,c.hX)(t,function(t){return!(0,c.e$)(t,R)}),o={errors:(0,c.UI)(l,function(t){return{message:"Token Type: ->"+t.name+"<- missing static 'PATTERN' property",type:n.MISSING_PATTERN,tokenTypes:[t]}}),valid:(0,c.e5)(t,l)},e=e.concat(o.errors),s=(f=o.valid,p=(0,c.hX)(f,function(t){var e=t[R];return!(0,c.Kj)(e)&&!(0,c.mf)(e)&&!(0,c.e$)(e,"exec")&&!(0,c.HD)(e)}),a={errors:(0,c.UI)(p,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:n.INVALID_PATTERN,tokenTypes:[t]}}),valid:(0,c.e5)(f,p)}).valid,e=(e=(e=(e=(e=e.concat(a.errors)).concat((d=[],m=(0,c.hX)(s,function(t){return(0,c.Kj)(t[R])}),(d=(d=(d=(d=d.concat((g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return N(e,t),e.prototype.visitEndAnchor=function(t){this.found=!0},e}(u.BaseRegExpVisitor),v=(0,c.hX)(m,function(t){var e=t[R];try{var r=h(e),n=new g;return n.visit(r),n.found}catch(t){return w.test(e.source)}}),(0,c.UI)(v,function(t){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+t.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:n.EOI_ANCHOR_FOUND,tokenTypes:[t]}})))).concat((E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return N(e,t),e.prototype.visitStartAnchor=function(t){this.found=!0},e}(u.BaseRegExpVisitor),y=(0,c.hX)(m,function(t){var e=t[R];try{var r=h(e),n=new E;return n.visit(r),n.found}catch(t){return x.test(e.source)}}),(0,c.UI)(y,function(t){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+t.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:n.SOI_ANCHOR_FOUND,tokenTypes:[t]}})))).concat((T=(0,c.hX)(m,function(t){var e=t[R];return e instanceof RegExp&&(e.multiline||e.global)}),(0,c.UI)(T,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:n.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[t]}})))).concat((A=[],M=(0,c.UI)(m,function(t){return(0,c.u4)(m,function(e,r){return t.PATTERN.source!==r.PATTERN.source||(0,c.r3)(A,r)||r.PATTERN===q.NA||(A.push(r),e.push(r)),e},[])}),M=(0,c.oA)(M),I=(0,c.hX)(M,function(t){return t.length>1}),(0,c.UI)(I,function(t){var e=(0,c.UI)(t,function(t){return t.name});return{message:"The same RegExp pattern ->"+(0,c.Ps)(t).PATTERN+"<-has been used in all of the following Token Types: "+e.join(", ")+" <-",type:n.DUPLICATE_PATTERNS_FOUND,tokenTypes:t}})))).concat((O=(0,c.hX)(m,function(t){return t[R].test("")}),(0,c.UI)(O,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' must not match an empty string",type:n.EMPTY_MATCH_PATTERN,tokenTypes:[t]}})))))).concat((b=(0,c.hX)(s,function(t){if(!(0,c.e$)(t,"GROUP"))return!1;var e=t.GROUP;return e!==q.SKIPPED&&e!==q.NA&&!(0,c.HD)(e)}),(0,c.UI)(b,function(t){return{message:"Token Type: ->"+t.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:n.INVALID_GROUP_TYPE_FOUND,tokenTypes:[t]}})))).concat((C=(0,c.hX)(s,function(t){return void 0!==t.PUSH_MODE&&!(0,c.r3)(i,t.PUSH_MODE)}),(0,c.UI)(C,function(t){return{message:"Token Type: ->"+t.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist",type:n.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[t]}})))).concat((S=[],U=(0,c.u4)(s,function(t,e,r){var n=e.PATTERN;return n===q.NA||((0,c.HD)(n)?t.push({str:n,idx:r,tokenType:e}):(0,c.Kj)(n)&&void 0===(0,c.sE)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],function(t){return -1!==n.source.indexOf(t)})&&t.push({str:n.source,idx:r,tokenType:e})),t},[]),(0,c.Ed)(s,function(t,e){(0,c.Ed)(U,function(r){var o=r.str,a=r.idx,i=r.tokenType;if(e<a&&function(t,e){if((0,c.Kj)(e)){var r=e.exec(t);return null!==r&&0===r.index}if((0,c.mf)(e))return e(t,0,[],{});if((0,c.e$)(e,"exec"))return e.exec(t,0,[],{});if("string"==typeof e)return e===t;throw Error("non exhaustive match")}(o,t.PATTERN)){var s="Token: ->"+i.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+t.name+"<-in the lexer's definition.\nSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE";S.push({message:s,type:n.UNREACHABLE_PATTERN,tokenTypes:[t,i]})}})}),S))))}),(0,c.xb)(r.lexerDefinitionErrors)){var a;V(t),r.TRACE_INIT("analyzeTokenTypes",function(){var n,o,i,s,l,f,p,v,E,N,T,A,w,x,S,D,B;n={lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:r.TRACE_INIT.bind(r)},(x=(n=(0,c.ce)(n,{useSticky:M,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(t,e){return e()}})).tracer)("initCharCodeToOptimizedIndexMap",function(){(function(){if((0,c.xb)(P)){P=Array(65536);for(var t=0;t<65536;t++)P[t]=t>255?255+~~(t/255):t}})()}),x("Reject Lexer.NA",function(){o=(0,c.d1)(t,function(t){return t[R]===q.NA})}),S=!1,x("Transform Patterns",function(){S=!1,i=(0,c.UI)(o,function(t){var e=t[R];if((0,c.Kj)(e)){var r=e.source;return 1!==r.length||"^"===r||"$"===r||"."===r||e.ignoreCase?2!==r.length||"\\"!==r[0]||(0,c.r3)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?n.useSticky?O(e):I(e):r[1]:r}if((0,c.mf)(e))return S=!0,{exec:e};if((0,c.e$)(e,"exec"))return S=!0,e;if("string"==typeof e){if(1===e.length)return e;var o=new RegExp(e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"));return n.useSticky?O(o):I(o)}throw Error("non exhaustive match")})}),x("misc mapping",function(){s=(0,c.UI)(o,function(t){return t.tokenTypeIdx}),l=(0,c.UI)(o,function(t){var e=t.GROUP;if(e!==q.SKIPPED){if((0,c.HD)(e))return e;if((0,c.o8)(e))return!1;throw Error("non exhaustive match")}}),f=(0,c.UI)(o,function(t){var e=t.LONGER_ALT;if(e)return(0,c.cq)(o,e)}),p=(0,c.UI)(o,function(t){return t.PUSH_MODE}),v=(0,c.UI)(o,function(t){return(0,c.e$)(t,"POP_MODE")})}),x("Line Terminator Handling",function(){var t=_(n.lineTerminatorCharacters);E=(0,c.UI)(o,function(t){return!1}),"onlyOffset"!==n.positionTracking&&(E=(0,c.UI)(o,function(e){return(0,c.e$)(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===U(e,t)?y(t,e.PATTERN):void 0}))}),x("Misc Mapping #2",function(){N=(0,c.UI)(o,b),T=(0,c.UI)(i,C),A=(0,c.u4)(o,function(t,e){var r=e.GROUP;return(0,c.HD)(r)&&r!==q.SKIPPED&&(t[r]=[]),t},{}),w=(0,c.UI)(i,function(t,e){return{pattern:i[e],longerAlt:f[e],canLineTerminator:E[e],isCustom:N[e],short:T[e],group:l[e],push:p[e],pop:v[e],tokenTypeIdx:s[e],tokenType:o[e]}})}),D=!0,B=[],n.safeMode||x("First Char Optimization",function(){B=(0,c.u4)(o,function(t,e,r){if("string"==typeof e.PATTERN){var o;L(t,k(e.PATTERN.charCodeAt(0)),w[r])}else if((0,c.kJ)(e.START_CHARS_HINT))(0,c.Ed)(e.START_CHARS_HINT,function(e){var n=k("string"==typeof e?e.charCodeAt(0):e);o!==n&&(o=n,L(t,n,w[r]))});else if((0,c.Kj)(e.PATTERN)){if(e.PATTERN.unicode)D=!1,n.ensureOptimizations&&(0,c.WB)(""+m+"	Unable to analyze < "+e.PATTERN.toString()+" > pattern.\n	The regexp unicode flag is not currently supported by the regexp-to-ast library.\n	This will disable the lexer's first char optimizations.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var a=function(t,e){void 0===e&&(e=!1);try{var r=h(t);return function t(e,r,n){switch(e.type){case"Disjunction":for(var o=0;o<e.value.length;o++)t(e.value[o],r,n);break;case"Alternative":for(var a=e.value,o=0;o<a.length;o++){var i=a[o];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}switch(i.type){case"Character":g(i.value,r,n);break;case"Set":if(!0===i.complement)throw Error(d);(0,c.Ed)(i.value,function(t){if("number"==typeof t)g(t,r,n);else if(!0===n)for(var e=t.from;e<=t.to;e++)g(e,r,n);else{for(var e=t.from;e<=t.to&&e<256;e++)g(e,r,n);if(t.to>=256)for(var o=t.from>=256?t.from:256,a=t.to,i=k(o),s=k(a),c=i;c<=s;c++)r[c]=c}});break;case"Group":t(i.value,r,n);break;default:throw Error("Non Exhaustive Match")}var s=void 0!==i.quantifier&&0===i.quantifier.atLeast;if("Group"===i.type&&!1===function t(e){return!!e.quantifier&&0===e.quantifier.atLeast||!!e.value&&((0,c.kJ)(e.value)?(0,c.yW)(e.value,t):t(e.value))}(i)||"Group"!==i.type&&!1===s)break}break;default:throw Error("non exhaustive match!")}return(0,c.VO)(r)}(r.value,{},r.flags.ignoreCase)}catch(r){if(r.message===d)e&&(0,c.rr)(""+m+"	Unable to optimize: < "+t.toString()+" >\n	Complement Sets cannot be automatically optimized.\n	This will disable the lexer's first char optimizations.\n	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";e&&(n="\n	This will disable the lexer's first char optimizations.\n	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),(0,c.WB)(m+"\n	Failed parsing: < "+t.toString()+" >\n	Using the regexp-to-ast library version: "+u.VERSION+"\n	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}(e.PATTERN,n.ensureOptimizations);(0,c.xb)(a)&&(D=!1),(0,c.Ed)(a,function(e){L(t,e,w[r])})}}else n.ensureOptimizations&&(0,c.WB)(""+m+"	TokenType: <"+e.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n	This will disable the lexer's first char optimizations.\n	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),D=!1;return t},[])}),x("ArrayPacking",function(){B=(0,c.X0)(B)}),a={emptyGroups:A,patternIdxToConfig:w,charCodeToPatternIdxToConfig:B,hasCustom:S,canBeOptimized:D}}),r.patternIdxToConfig[o]=a.patternIdxToConfig,r.charCodeToPatternIdxToConfig[o]=a.charCodeToPatternIdxToConfig,r.emptyGroups=(0,c.TS)(r.emptyGroups,a.emptyGroups),r.hasCustom=a.hasCustom||r.hasCustom,r.canModeBeOptimized[o]=a.canBeOptimized}})}),r.defaultMode=o.defaultMode,!(0,c.xb)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling)throw Error("Errors detected in definition of Lexer:\n"+(0,c.UI)(r.lexerDefinitionErrors,function(t){return t.message}).join("-----------------------\n"));(0,c.Ed)(r.lexerDefinitionWarning,function(t){(0,c.rr)(t.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(M?(r.chopInput=c.Wd,r.match=r.matchWithTest):(r.updateLastIndex=c.dG,r.match=r.matchWithExec),a&&(r.handleModes=c.dG),!1===r.trackStartLines&&(r.computeNewColumn=c.Wd),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=c.dG),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else if(/onlyOffset/i.test(r.config.positionTracking))r.createTokenInstance=r.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var t=(0,c.u4)(r.canModeBeOptimized,function(t,e,r){return!1===e&&t.push(r),t},[]);if(e.ensureOptimizations&&!(0,c.xb)(t))throw Error("Lexer Modes: < "+t.join(", ")+' > cannot be optimized.\n	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n	 Or inspect the console log for details on how to resolve these issues.')}),r.TRACE_INIT("clearRegExpParserCache",function(){l={}}),r.TRACE_INIT("toFastProperties",function(){(0,c.SV)(r)})})}return t.prototype.tokenize=function(t,e){if(void 0===e&&(e=this.defaultMode),!(0,c.xb)(this.lexerDefinitionErrors))throw Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+(0,c.UI)(this.lexerDefinitionErrors,function(t){return t.message}).join("-----------------------\n"));return this.tokenizeInternal(t,e)},t.prototype.tokenizeInternal=function(t,e){var r,n,o,a,i,s,u,l,f,h,p,d,m,g,v,E,y,N,R=this,T=t,A=T.length,M=0,w=0,x=Array(this.hasCustom?0:Math.floor(t.length/10)),I=[],O=this.trackStartLines?1:void 0,b=this.trackStartLines?1:void 0,C=(r=this.emptyGroups,n={},o=(0,c.XP)(r),(0,c.Ed)(o,function(t){var e=r[t];if((0,c.kJ)(e))n[t]=[];else throw Error("non exhaustive match")}),n),S=this.trackStartLines,U=this.config.lineTerminatorsPattern,_=0,L=[],P=[],D=[],B=[];Object.freeze(B);var F=void 0;function j(){return L}function V(t){var e=P[k(t)];return void 0===e?B:e}var G=function(t){if(1===D.length&&void 0===t.tokenType.PUSH_MODE){var e=R.config.errorMessageProvider.buildUnableToPopLexerModeMessage(t);I.push({offset:t.startOffset,line:void 0!==t.startLine?t.startLine:void 0,column:void 0!==t.startColumn?t.startColumn:void 0,length:t.image.length,message:e})}else{D.pop();var r=(0,c.Z$)(D);L=R.patternIdxToConfig[r],P=R.charCodeToPatternIdxToConfig[r],_=L.length;var n=R.canModeBeOptimized[r]&&!1===R.config.safeMode;F=P&&n?V:j}};function $(t){D.push(t),P=this.charCodeToPatternIdxToConfig[t],_=(L=this.patternIdxToConfig[t]).length,_=L.length;var e=this.canModeBeOptimized[t]&&!1===this.config.safeMode;F=P&&e?V:j}for($.call(this,e);M<A;){l=null;var H=T.charCodeAt(M),W=F(H),Y=W.length;for(a=0;a<Y;a++){var q=(N=W[a]).pattern;f=null;var K=N.short;if(!1!==K?H===K&&(l=q):!0===N.isCustom?null!==(y=q.exec(T,M,x,C))?(l=y[0],void 0!==y.payload&&(f=y.payload)):l=null:(this.updateLastIndex(q,M),l=this.match(q,t,M)),null!==l){if(void 0!==(u=N.longerAlt)){var z=L[u],X=z.pattern;h=null,!0===z.isCustom?null!==(y=X.exec(T,M,x,C))?(s=y[0],void 0!==y.payload&&(h=y.payload)):s=null:(this.updateLastIndex(X,M),s=this.match(X,t,M)),s&&s.length>l.length&&(l=s,f=h,N=z)}break}}if(null!==l){if(p=l.length,void 0!==(d=N.group)&&(m=N.tokenTypeIdx,g=this.createTokenInstance(l,M,m,N.tokenType,O,b,p),this.handlePayload(g,f),!1===d?w=this.addToken(x,w,g):C[d].push(g)),t=this.chopInput(t,p),M+=p,b=this.computeNewColumn(b,p),!0===S&&!0===N.canLineTerminator){var Q=0,Z=void 0,J=void 0;U.lastIndex=0;do!0===(Z=U.test(l))&&(J=U.lastIndex-1,Q++);while(!0===Z);0!==Q&&(O+=Q,b=p-J,this.updateTokenEndLineColumnLocation(g,d,J,Q,O,b,p))}this.handleModes(N,G,$,g)}else{for(var tt=M,te=O,tr=b,tn=!1;!tn&&M<A;)for(T.charCodeAt(M),t=this.chopInput(t,1),M++,i=0;i<_;i++){var to=L[i],q=to.pattern,K=to.short;if(!1!==K?T.charCodeAt(M)===K&&(tn=!0):!0===to.isCustom?tn=null!==q.exec(T,M,x,C):(this.updateLastIndex(q,M),tn=null!==q.exec(t)),!0===tn)break}v=M-tt,E=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(T,tt,v,te,tr),I.push({offset:tt,line:te,column:tr,length:v,message:E})}}return this.hasCustom||(x.length=w),{tokens:x,groups:C,errors:I}},t.prototype.handleModes=function(t,e,r,n){if(!0===t.pop){var o=t.push;e(n),void 0!==o&&r.call(this,o)}else void 0!==t.push&&r.call(this,t.push)},t.prototype.chopInput=function(t,e){return t.substring(e)},t.prototype.updateLastIndex=function(t,e){t.lastIndex=e},t.prototype.updateTokenEndLineColumnLocation=function(t,e,r,n,o,a,i){var s,c;void 0===e||(c=(s=r===i-1)?-1:0,1===n&&!0===s||(t.endLine=o+c,t.endColumn=a-1+-c))},t.prototype.computeNewColumn=function(t,e){return t+e},t.prototype.createTokenInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},t.prototype.createOffsetOnlyToken=function(t,e,r,n){return{image:t,startOffset:e,tokenTypeIdx:r,tokenType:n}},t.prototype.createStartOnlyToken=function(t,e,r,n,o,a){return{image:t,startOffset:e,startLine:o,startColumn:a,tokenTypeIdx:r,tokenType:n}},t.prototype.createFullToken=function(t,e,r,n,o,a,i){return{image:t,startOffset:e,endOffset:e+i-1,startLine:o,endLine:o,startColumn:a,endColumn:a+i-1,tokenTypeIdx:r,tokenType:n}},t.prototype.addToken=function(t,e,r){return 666},t.prototype.addTokenUsingPush=function(t,e,r){return t.push(r),e},t.prototype.addTokenUsingMemberAccess=function(t,e,r){return t[e]=r,++e},t.prototype.handlePayload=function(t,e){},t.prototype.handlePayloadNoCustom=function(t,e){},t.prototype.handlePayloadWithCustom=function(t,e){null!==e&&(t.payload=e)},t.prototype.match=function(t,e,r){return null},t.prototype.matchWithTest=function(t,e,r){return!0===t.test(e)?e.substring(r,t.lastIndex):null},t.prototype.matchWithExec=function(t,e){var r=t.exec(e);return null!==r?r[0]:r},t.prototype.TRACE_INIT=function(t,e){if(!0!==this.traceInitPerf)return e();this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var n=(0,c.HT)(e),o=n.time,a=n.value,i=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&i(r+"<-- <"+t+"> time: "+o+"ms"),this.traceInitIndent--,a},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function K(t){return X(t)?t.LABEL:t.name}function z(t){return t.name}function X(t){return(0,c.HD)(t.LABEL)&&""!==t.LABEL}var Q="categories",Z="label",J="group",tt="push_mode",te="pop_mode",tr="longer_alt",tn="line_breaks",to="start_chars_hint";function ta(t){return ti(t)}function ti(t){var e=t.pattern,r={};if(r.name=t.name,(0,c.o8)(e)||(r.PATTERN=e),(0,c.e$)(t,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,c.e$)(t,Q)&&(r.CATEGORIES=t[Q]),V([r]),(0,c.e$)(t,Z)&&(r.LABEL=t[Z]),(0,c.e$)(t,J)&&(r.GROUP=t[J]),(0,c.e$)(t,te)&&(r.POP_MODE=t[te]),(0,c.e$)(t,tt)&&(r.PUSH_MODE=t[tt]),(0,c.e$)(t,tr)&&(r.LONGER_ALT=t[tr]),(0,c.e$)(t,tn)&&(r.LINE_BREAKS=t[tn]),(0,c.e$)(t,to)&&(r.START_CHARS_HINT=t[to]),r}var ts=ti({name:"EOF",pattern:q.NA});function tc(t,e,r,n,o,a,i,s){return{image:e,startOffset:r,endOffset:n,startLine:o,endLine:a,startColumn:i,endColumn:s,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function tu(t,e){return D(t,e)}V([ts]);var tl=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tf=function(){function t(t){this._definition=t}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),t.prototype.accept=function(t){t.visit(this),(0,c.Ed)(this.definition,function(e){e.accept(t)})},t}(),th=function(t){function e(e){var r=t.call(this,[])||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(tf),tp=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.orgText="",(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),e}(tf),td=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.ignoreAmbiguities=!1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),e}(tf),tm=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),e}(tf),tg=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),e}(tf),tv=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),e}(tf),tE=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),e}(tf),ty=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),e}(tf),tN=function(t){function e(e){var r=t.call(this,e.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,(0,c.f0)(r,(0,c.ei)(e,function(t){return void 0!==t})),r}return tl(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(t){this._definition=t},enumerable:!1,configurable:!0}),e}(tf),tR=function(){function t(t){this.idx=1,(0,c.f0)(this,(0,c.ei)(t,function(t){return void 0!==t}))}return t.prototype.accept=function(t){t.visit(this)},t}();function tT(t){return(0,c.UI)(t,tA)}function tA(t){function e(t){return(0,c.UI)(t,tA)}if(t instanceof th)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof td)return{type:"Alternative",definition:e(t.definition)};if(t instanceof tm)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof tg)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof tv)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:tA(new tR({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof ty)return{type:"RepetitionWithSeparator",idx:t.idx,separator:tA(new tR({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof tE)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};else if(t instanceof tN)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};else if(t instanceof tR){var r={type:"Terminal",name:t.terminalType.name,label:K(t.terminalType),idx:t.idx},n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=(0,c.Kj)(n)?n.source:n),r}else if(t instanceof tp)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};else throw Error("non exhaustive match")}var tM=function(){function t(){}return t.prototype.walk=function(t,e){var r=this;void 0===e&&(e=[]),(0,c.Ed)(t.definition,function(n,o){var a=(0,c.Cw)(t.definition,o+1);if(n instanceof th)r.walkProdRef(n,a,e);else if(n instanceof tR)r.walkTerminal(n,a,e);else if(n instanceof td)r.walkFlat(n,a,e);else if(n instanceof tm)r.walkOption(n,a,e);else if(n instanceof tg)r.walkAtLeastOne(n,a,e);else if(n instanceof tv)r.walkAtLeastOneSep(n,a,e);else if(n instanceof ty)r.walkManySep(n,a,e);else if(n instanceof tE)r.walkMany(n,a,e);else if(n instanceof tN)r.walkOr(n,a,e);else throw Error("non exhaustive match")})},t.prototype.walkTerminal=function(t,e,r){},t.prototype.walkProdRef=function(t,e,r){},t.prototype.walkFlat=function(t,e,r){var n=e.concat(r);this.walk(t,n)},t.prototype.walkOption=function(t,e,r){var n=e.concat(r);this.walk(t,n)},t.prototype.walkAtLeastOne=function(t,e,r){var n=[new tm({definition:t.definition})].concat(e,r);this.walk(t,n)},t.prototype.walkAtLeastOneSep=function(t,e,r){var n=tw(t,e,r);this.walk(t,n)},t.prototype.walkMany=function(t,e,r){var n=[new tm({definition:t.definition})].concat(e,r);this.walk(t,n)},t.prototype.walkManySep=function(t,e,r){var n=tw(t,e,r);this.walk(t,n)},t.prototype.walkOr=function(t,e,r){var n=this,o=e.concat(r);(0,c.Ed)(t.definition,function(t){var e=new td({definition:[t]});n.walk(e,o)})},t}();function tw(t,e,r){return[new tm({definition:[new tR({terminalType:t.separator})].concat(t.definition)})].concat(e,r)}var tx=function(){function t(){}return t.prototype.visit=function(t){switch(t.constructor){case th:return this.visitNonTerminal(t);case td:return this.visitAlternative(t);case tm:return this.visitOption(t);case tg:return this.visitRepetitionMandatory(t);case tv:return this.visitRepetitionMandatoryWithSeparator(t);case ty:return this.visitRepetitionWithSeparator(t);case tE:return this.visitRepetition(t);case tN:return this.visitAlternation(t);case tR:return this.visitTerminal(t);case tp:return this.visitRule(t);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(t){},t.prototype.visitAlternative=function(t){},t.prototype.visitOption=function(t){},t.prototype.visitRepetition=function(t){},t.prototype.visitRepetitionMandatory=function(t){},t.prototype.visitRepetitionMandatoryWithSeparator=function(t){},t.prototype.visitRepetitionWithSeparator=function(t){},t.prototype.visitAlternation=function(t){},t.prototype.visitTerminal=function(t){},t.prototype.visitRule=function(t){},t}(),tI=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function tO(t,e){return void 0===e&&(e=[]),t instanceof tm||t instanceof tE||t instanceof ty||(t instanceof tN?(0,c.G)(t.definition,function(t){return tO(t,e)}):!(t instanceof th&&(0,c.r3)(e,t))&&t instanceof tf&&(t instanceof th&&e.push(t),(0,c.yW)(t.definition,function(t){return tO(t,e)})))}function tb(t){if(t instanceof th)return"SUBRULE";if(t instanceof tm)return"OPTION";if(t instanceof tN)return"OR";if(t instanceof tg)return"AT_LEAST_ONE";if(t instanceof tv)return"AT_LEAST_ONE_SEP";if(t instanceof ty)return"MANY_SEP";if(t instanceof tE)return"MANY";else if(t instanceof tR)return"CONSUME";else throw Error("non exhaustive match")}var tC=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}return tI(e,t),e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var e=t.terminalType.name+this.separator+"Terminal";(0,c.e$)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitNonTerminal=function(t){var e=t.nonTerminalName+this.separator+"Terminal";(0,c.e$)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(tx),tS=new tC;function tU(t){if(t instanceof th)return tU(t.referencedRule);if(t instanceof tR)return[t.terminalType];if(t instanceof td||t instanceof tm||t instanceof tE||t instanceof tg||t instanceof tv||t instanceof ty||t instanceof tR||t instanceof tp)return function(t){for(var e,r=[],n=t.definition,o=0,a=n.length>o,i=!0;a&&i;)i=tO(e=n[o]),r=r.concat(tU(e)),o+=1,a=n.length>o;return(0,c.jj)(r)}(t);if(t instanceof tN){var e;return e=(0,c.UI)(t.definition,function(t){return tU(t)}),(0,c.jj)((0,c.xH)(e))}throw Error("non exhaustive match")}var t_="_~IN~_",tL=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tk=function(t){function e(e){var r=t.call(this)||this;return r.topProd=e,r.follows={},r}return tL(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,e,r){},e.prototype.walkProdRef=function(t,e,r){var n,o,a=(n=t.referencedRule,o=t.idx,n.name+o+t_+this.topProd.name),i=tU(new td({definition:e.concat(r)}));this.follows[a]=i},e}(tM),tP={buildMismatchTokenMessage:function(t){var e=t.expected,r=t.actual;return t.previous,t.ruleName,"Expecting "+(X(e)?"--> "+K(e)+" <--":"token of type --> "+e.name+" <--")+" but found --> '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;return t.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,r=t.actual,n=(t.previous,t.customUserDescription);t.ruleName;var o="Expecting: ",a="\nbut found: '"+(0,c.Ps)(r).image+"'";if(n)return o+n+a;var i=(0,c.u4)(e,function(t,e){return t.concat(e)},[]),s=(0,c.UI)(i,function(t){return"["+(0,c.UI)(t,function(t){return K(t)}).join(", ")+"]"});return o+"one of these possible Token sequences:\n"+(0,c.UI)(s,function(t,e){return"  "+(e+1)+". "+t}).join("\n")+a},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,r=t.actual,n=t.customUserDescription;t.ruleName;var o="Expecting: ",a="\nbut found: '"+(0,c.Ps)(r).image+"'";return n?o+n+a:o+"expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+(0,c.UI)(e,function(t){return"["+(0,c.UI)(t,function(t){return K(t)}).join(",")+"]"}).join(" ,")+">"+a}};Object.freeze(tP);var tD={buildRuleNotFoundError:function(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+"<-\ninside top level rule: ->"+t.name+"<-"}},tB={buildDuplicateFoundError:function(t,e){var r=t.name,n=(0,c.Ps)(e),o=n.idx,a=tb(n),i=n instanceof tR?n.terminalType.name:n instanceof th?n.nonTerminalName:"",s="->"+a+(o>0?o:"")+"<- "+(i?"with argument: ->"+i+"<-":"")+"\n                  appears more than once ("+e.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return(s=s.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildNamespaceConflictError:function(t){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(t){var e=(0,c.UI)(t.prefixPath,function(t){return K(t)}).join(", "),r=0===t.alternation.idx?"":t.alternation.idx;return"Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\n"+("in <OR"+r)+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(t){var e=(0,c.UI)(t.prefixPath,function(t){return K(t)}).join(", "),r=0===t.alternation.idx?"":t.alternation.idx;return"Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(t){var e=tb(t.repetition);return 0!==t.repetition.idx&&(e+=t.repetition.idx),"The repetition <"+e+"> within Rule <"+t.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(t){return"deprecated"},buildEmptyAlternationError:function(t){return"Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+">"+(" in <OR"+t.alternation.idx)+"> inside <"+t.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(t){return"An Alternation cannot have more than 256 alternatives:\n"+("<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name)+"> Rule.\n has "+(t.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(t){var e=t.topLevelRule.name,r=e+" --> "+c.UI(t.leftRecursionPath,function(t){return t.name}).concat([e]).join(" --> ");return"Left Recursion found in grammar.\nrule: <"+e+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+r+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(t){return"deprecated"},buildDuplicateRuleNameError:function(t){return"Duplicate definition, rule: ->"+(t.topLevelRule instanceof tp?t.topLevelRule.name:t.topLevelRule)+"<- is already defined in the grammar: ->"+t.grammarName+"<-"}},tF=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tj=function(t){function e(e,r){var n=t.call(this)||this;return n.nameToTopRule=e,n.errMsgProvider=r,n.errors=[],n}return tF(e,t),e.prototype.resolveRefs=function(){var t=this;(0,c.Ed)((0,c.VO)(this.nameToTopRule),function(e){t.currTopLevel=e,e.accept(t)})},e.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule[t.nonTerminalName];if(e)t.referencedRule=e;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:r,type:i.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(tx),tV=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tG=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return tV(e,t),e.prototype.walkTerminal=function(t,e,r){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var n=new td({definition:e.concat(r)});this.possibleTokTypes=tU(n),this.found=!0}},e}(function(t){function e(e,r){var n=t.call(this)||this;return n.topProd=e,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return tV(e,t),e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,c.Qw)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,c.Qw)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(e,r){void 0===r&&(r=[]),this.found||t.prototype.walk.call(this,e,r)},e.prototype.walkProdRef=function(t,e,r){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var n=e.concat(r);this.updateExpectedNext(),this.walk(t.referencedRule,n)}},e.prototype.updateExpectedNext=function(){(0,c.xb)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(tM)),t$=function(t){function e(e,r){var n=t.call(this)||this;return n.topRule=e,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return tV(e,t),e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(tM),tH=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tV(e,t),e.prototype.walkMany=function(e,r,n){if(e.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkMany.call(this,e,r,n)},e}(t$),tW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tV(e,t),e.prototype.walkManySep=function(e,r,n){if(e.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkManySep.call(this,e,r,n)},e}(t$),tY=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tV(e,t),e.prototype.walkAtLeastOne=function(e,r,n){if(e.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOne.call(this,e,r,n)},e}(t$),tq=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tV(e,t),e.prototype.walkAtLeastOneSep=function(e,r,n){if(e.idx===this.occurrence){var o=(0,c.Ps)(r.concat(n));this.result.isEndOfRule=void 0===o,o instanceof tR&&(this.result.token=o.terminalType,this.result.occurrence=o.idx)}else t.prototype.walkAtLeastOneSep.call(this,e,r,n)},e}(t$);function tK(t,e,r){void 0===r&&(r=[]),r=(0,c.Qw)(r);var n=[],o=0;function a(a){var i=tK(a.concat((0,c.Cw)(t,o+1)),e,r);return n.concat(i)}for(;r.length<e&&o<t.length;){var i=t[o];if(i instanceof td||i instanceof th)return a(i.definition);if(i instanceof tm)n=a(i.definition);else if(i instanceof tg){var s=i.definition.concat([new tE({definition:i.definition})]);return a(s)}else if(i instanceof tv){var s=[new td({definition:i.definition}),new tE({definition:[new tR({terminalType:i.separator})].concat(i.definition)})];return a(s)}else if(i instanceof ty){var s=i.definition.concat([new tE({definition:[new tR({terminalType:i.separator})].concat(i.definition)})]);n=a(s)}else if(i instanceof tE){var s=i.definition.concat([new tE({definition:i.definition})]);n=a(s)}else if(i instanceof tN)return(0,c.Ed)(i.definition,function(t){!1===(0,c.xb)(t.definition)&&(n=a(t.definition))}),n;else if(i instanceof tR)r.push(i.terminalType);else throw Error("non exhaustive match");o++}return n.push({partialPath:r,suffixDef:(0,c.Cw)(t,o)}),n}function tz(t,e,r,n){var o="EXIT_NONE_TERMINAL",a=[o],i="EXIT_ALTERNATIVE",s=!1,u=e.length,l=u-n-1,f=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!(0,c.xb)(h);){var p=h.pop();if(p===i){s&&(0,c.Z$)(h).idx<=l&&h.pop();continue}var d=p.def,m=p.idx,g=p.ruleStack,v=p.occurrenceStack;if(!(0,c.xb)(d)){var E=d[0];if(E===o){var y={idx:m,def:(0,c.Cw)(d),ruleStack:(0,c.j7)(g),occurrenceStack:(0,c.j7)(v)};h.push(y)}else if(E instanceof tR){if(m<u-1){var N=m+1;if(r(e[N],E.terminalType)){var y={idx:N,def:(0,c.Cw)(d),ruleStack:g,occurrenceStack:v};h.push(y)}}else if(m===u-1)f.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:g,occurrenceStack:v}),s=!0;else throw Error("non exhaustive match")}else if(E instanceof th){var R=(0,c.Qw)(g);R.push(E.nonTerminalName);var T=(0,c.Qw)(v);T.push(E.idx);var y={idx:m,def:E.definition.concat(a,(0,c.Cw)(d)),ruleStack:R,occurrenceStack:T};h.push(y)}else if(E instanceof tm){var A={idx:m,def:(0,c.Cw)(d),ruleStack:g,occurrenceStack:v};h.push(A),h.push(i);var M={idx:m,def:E.definition.concat((0,c.Cw)(d)),ruleStack:g,occurrenceStack:v};h.push(M)}else if(E instanceof tg){var w=new tE({definition:E.definition,idx:E.idx}),x=E.definition.concat([w],(0,c.Cw)(d)),y={idx:m,def:x,ruleStack:g,occurrenceStack:v};h.push(y)}else if(E instanceof tv){var I=new tR({terminalType:E.separator}),w=new tE({definition:[I].concat(E.definition),idx:E.idx}),x=E.definition.concat([w],(0,c.Cw)(d)),y={idx:m,def:x,ruleStack:g,occurrenceStack:v};h.push(y)}else if(E instanceof ty){var A={idx:m,def:(0,c.Cw)(d),ruleStack:g,occurrenceStack:v};h.push(A),h.push(i);var I=new tR({terminalType:E.separator}),O=new tE({definition:[I].concat(E.definition),idx:E.idx}),x=E.definition.concat([O],(0,c.Cw)(d)),M={idx:m,def:x,ruleStack:g,occurrenceStack:v};h.push(M)}else if(E instanceof tE){var A={idx:m,def:(0,c.Cw)(d),ruleStack:g,occurrenceStack:v};h.push(A),h.push(i);var O=new tE({definition:E.definition,idx:E.idx}),x=E.definition.concat([O],(0,c.Cw)(d)),M={idx:m,def:x,ruleStack:g,occurrenceStack:v};h.push(M)}else if(E instanceof tN)for(var b=E.definition.length-1;b>=0;b--){var C={idx:m,def:E.definition[b].definition.concat((0,c.Cw)(d)),ruleStack:g,occurrenceStack:v};h.push(C),h.push(i)}else if(E instanceof td)h.push({idx:m,def:E.definition.concat((0,c.Cw)(d)),ruleStack:g,occurrenceStack:v});else if(E instanceof tp)h.push(function(t,e,r,n){var o=(0,c.Qw)(r);o.push(t.name);var a=(0,c.Qw)(n);return a.push(1),{idx:e,def:t.definition,ruleStack:o,occurrenceStack:a}}(E,m,g,v));else throw Error("non exhaustive match")}}return f}var tX=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"}(o||(o={}));var tQ=function(t){function e(e,r,n){var o=t.call(this)||this;return o.topProd=e,o.targetOccurrence=r,o.targetProdType=n,o}return tX(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,e,r,n){return t.idx===this.targetOccurrence&&this.targetProdType===e&&(this.restDef=r.concat(n),!0)},e.prototype.walkOption=function(e,r,n){this.checkIsTarget(e,o.OPTION,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkAtLeastOne=function(e,r,n){this.checkIsTarget(e,o.REPETITION_MANDATORY,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkAtLeastOneSep=function(e,r,n){this.checkIsTarget(e,o.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkMany=function(e,r,n){this.checkIsTarget(e,o.REPETITION,r,n)||t.prototype.walkOption.call(this,e,r,n)},e.prototype.walkManySep=function(e,r,n){this.checkIsTarget(e,o.REPETITION_WITH_SEPARATOR,r,n)||t.prototype.walkOption.call(this,e,r,n)},e}(tM),tZ=function(t){function e(e,r,n){var o=t.call(this)||this;return o.targetOccurrence=e,o.targetProdType=r,o.targetRef=n,o.result=[],o}return tX(e,t),e.prototype.checkIsTarget=function(t,e){t.idx===this.targetOccurrence&&this.targetProdType===e&&(void 0===this.targetRef||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,o.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,o.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,o.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,o.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,o.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,o.ALTERNATION)},e}(tx);function tJ(t){for(var e=Array(t),r=0;r<t;r++)e[r]=[];return e}function t0(t){for(var e=[""],r=0;r<t.length;r++){for(var n=t[r],o=[],a=0;a<e.length;a++){var i=e[a];o.push(i+"_"+n.tokenTypeIdx);for(var s=0;s<n.categoryMatches.length;s++){var c="_"+n.categoryMatches[s];o.push(i+c)}}e=o}return e}function t1(t,e){for(var r=(0,c.UI)(t,function(t){return tK([t],1)}),n=tJ(r.length),o=(0,c.UI)(r,function(t){var e={};return(0,c.Ed)(t,function(t){var r=t0(t.partialPath);(0,c.Ed)(r,function(t){e[t]=!0})}),e}),a=r,i=1;i<=e;i++){var s=a;a=tJ(s.length);for(var u=function(t){for(var r=s[t],u=0;u<r.length;u++){var l=r[u].partialPath,f=r[u].suffixDef,h=t0(l);if(function(t,e,r){for(var n=0;n<t.length;n++)if(n!==r){for(var o=t[n],a=0;a<e.length;a++)if(!0===o[e[a]])return!1}return!0}(o,h,t)||(0,c.xb)(f)||l.length===e){var p=n[t];if(!1===t4(p,l)){p.push(l);for(var d=0;d<h.length;d++){var m=h[d];o[t][m]=!0}}}else{var g=tK(f,i+1,l);a[t]=a[t].concat(g),(0,c.Ed)(g,function(e){var r=t0(e.partialPath);(0,c.Ed)(r,function(e){o[t][e]=!0})})}}},l=0;l<s.length;l++)u(l)}return n}function t2(t,e,r,n){var a=new tZ(t,o.ALTERNATION,n);return e.accept(a),t1(a.result,r)}function t3(t,e,r,n){var o=new tZ(t,r);e.accept(o);var a=o.result,i=new tQ(e,t,r).startWalking();return t1([new td({definition:a}),new td({definition:i})],n)}function t4(t,e){t:for(var r=0;r<t.length;r++){var n=t[r];if(n.length===e.length){for(var o=0;o<n.length;o++){var a=e[o],i=n[o];if(!1==(a===i||void 0!==i.categoryMatchesMap[a.tokenTypeIdx]))continue t}return!0}}return!1}function t5(t){return(0,c.yW)(t,function(t){return(0,c.yW)(t,function(t){return(0,c.yW)(t,function(t){return(0,c.xb)(t.categoryMatches)})})})}var t6=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function t7(t){return tb(t)+"_#_"+t.idx+"_#_"+t9(t)}function t9(t){return t instanceof tR?t.terminalType.name:t instanceof th?t.nonTerminalName:""}var t8=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return t6(e,t),e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(tx),et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alternations=[],e}return t6(e,t),e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(tx),ee=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return t6(e,t),e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(tx);function er(t){t=(0,c.ce)(t,{errMsgProvider:tD});var e,r={};return(0,c.Ed)(t.rules,function(t){r[t.name]=t}),(e=new tj(r,t.errMsgProvider)).resolveRefs(),e.errors}function en(t){var e,r,n,a,s,u,l,f,h,p,d,m,g,v,E;return e=(t=(0,c.ce)(t,{errMsgProvider:tB})).rules,r=t.maxLookahead,n=t.tokenTypes,a=t.errMsgProvider,s=t.grammarName,u=c.UI(e,function(t){return function(t,e){var r=new t8;t.accept(r);var n=r.allProductions,o=c.vM(n,t7),a=c.ei(o,function(t){return t.length>1});return c.UI(c.VO(a),function(r){var n=c.Ps(r),o=e.buildDuplicateFoundError(t,r),a=tb(n),s={message:o,type:i.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:a,occurrence:n.idx},u=t9(n);return u&&(s.parameter=u),s})}(t,a)}),l=c.UI(e,function(t){return function t(e,r,n,o){void 0===o&&(o=[]);var a=[],s=function t(e){var r=[];if(c.xb(e))return r;var n=c.Ps(e);if(n instanceof th)r.push(n.referencedRule);else if(n instanceof td||n instanceof tm||n instanceof tg||n instanceof tv||n instanceof ty||n instanceof tE)r=r.concat(t(n.definition));else if(n instanceof tN)r=c.xH(c.UI(n.definition,function(e){return t(e.definition)}));else if(n instanceof tR);else throw Error("non exhaustive match");var o=tO(n),a=e.length>1;if(!o||!a)return r;var i=c.Cw(e);return r.concat(t(i))}(r.definition);if(c.xb(s))return[];var u=e.name;c.r3(s,e)&&a.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:o}),type:i.LEFT_RECURSION,ruleName:u});var l=c.e5(s,o.concat([e])),f=c.UI(l,function(r){var a=c.Qw(o);return a.push(r),t(e,r,n,a)});return a.concat(c.xH(f))}(t,t,a)}),f=[],h=[],p=[],(0,c.yW)(l,c.xb)&&(f=(0,c.UI)(e,function(t){return function(t,e){var r=new et;t.accept(r);var n=r.alternations;return c.u4(n,function(r,n){var o=c.j7(n.definition),a=c.UI(o,function(r,o){var a=tz([r],[],null,1);return c.xb(a)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:n,emptyChoiceIdx:o}),type:i.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:n.idx,alternative:o+1}:null});return r.concat(c.oA(a))},[])}(t,a)}),h=(0,c.UI)(e,function(t){return function(t,e,r){var n=new et;t.accept(n);var o=n.alternations;return o=(0,c.d1)(o,function(t){return!0===t.ignoreAmbiguities}),c.u4(o,function(n,o){var a,s,u,l,f=t2(o.idx,t,o.maxLookahead||e,o),h=(a=[],s=(0,c.u4)(f,function(t,e,r){return!0===o.definition[r].ignoreAmbiguities||(0,c.Ed)(e,function(e){var n=[r];(0,c.Ed)(f,function(t,a){r!==a&&t4(t,e)&&!0!==o.definition[a].ignoreAmbiguities&&n.push(a)}),n.length>1&&!t4(a,e)&&(a.push(e),t.push({alts:n,path:e}))}),t},[]),c.UI(s,function(e){var n=(0,c.UI)(e.alts,function(t){return t+1});return{message:r.buildAlternationAmbiguityError({topLevelRule:t,alternation:o,ambiguityIndices:n,prefixPath:e.path}),type:i.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:o.idx,alternatives:[e.alts]}})),p=(u=[],l=(0,c.u4)(f,function(t,e,r){var n=(0,c.UI)(e,function(t){return{idx:r,path:t}});return t.concat(n)},[]),(0,c.Ed)(l,function(e){if(!0!==o.definition[e.idx].ignoreAmbiguities){var n=e.idx,a=e.path,s=(0,c.Oq)(l,function(t){var e;return!0!==o.definition[t.idx].ignoreAmbiguities&&t.idx<n&&(e=t.path).length<a.length&&(0,c.yW)(e,function(t,e){var r=a[e];return t===r||r.categoryMatchesMap[t.tokenTypeIdx]})}),f=(0,c.UI)(s,function(e){var a=[e.idx+1,n+1],s=0===o.idx?"":o.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:o,ambiguityIndices:a,prefixPath:e.path}),type:i.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:s,alternatives:a}});u=u.concat(f)}}),u);return n.concat(h,p)},[])}(t,r,a)}),g=[],(0,c.Ed)(e,function(t){var e=new ee;t.accept(e);var n=e.allProductions;(0,c.Ed)(n,function(e){var n=function(t){if(t instanceof tm)return o.OPTION;if(t instanceof tE)return o.REPETITION;if(t instanceof tg)return o.REPETITION_MANDATORY;if(t instanceof tv)return o.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof ty)return o.REPETITION_WITH_SEPARATOR;if(t instanceof tN)return o.ALTERNATION;throw Error("non exhaustive match")}(e),s=e.maxLookahead||r,u=t3(e.idx,t,n,s)[0];if((0,c.xb)((0,c.xH)(u))){var l=a.buildEmptyRepetitionError({topLevelRule:t,repetition:e});g.push({message:l,type:i.NO_NON_EMPTY_LOOKAHEAD,ruleName:t.name})}})}),p=g),v=[],E=(0,c.UI)(n,function(t){return t.name}),(0,c.Ed)(e,function(t){var e=t.name;if((0,c.r3)(E,e)){var r=a.buildNamespaceConflictError(t);v.push({message:r,type:i.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:e})}}),d=(0,c.UI)(e,function(t){return function(t,e){var r=new et;t.accept(r);var n=r.alternations;return c.u4(n,function(r,n){return n.definition.length>255&&r.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:n}),type:i.TOO_MANY_ALTS,ruleName:t.name,occurrence:n.idx}),r},[])}(t,a)}),m=(0,c.UI)(e,function(t){return function(t,e,r,n){var o=[];if((0,c.u4)(e,function(e,r){return r.name===t.name?e+1:e},0)>1){var a=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});o.push({message:a,type:i.DUPLICATE_RULE_NAME,ruleName:t.name})}return o}(t,e,s,a)}),c.xH(u.concat(p,l,f,h,v,d,m))}function eo(t){(0,c.Ed)(t.rules,function(t){var e=new tC;t.accept(e),(0,c.Ed)(e.dslMethods,function(t){(0,c.Ed)(t,function(t,e){t.idx=e+1})})})}var ea=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ei="MismatchedTokenException",es="NoViableAltException",ec="EarlyExitException",eu="NotAllInputParsedException",el=[ei,es,ec,eu];function ef(t){return(0,c.r3)(el,t.name)}Object.freeze(el);var eh=function(t){function e(e,r){var n=this.constructor,o=t.call(this,e)||this;return o.token=r,o.resyncedTokens=[],Object.setPrototypeOf(o,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,o.constructor),o}return ea(e,t),e}(Error),ep=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=ei,o}return ea(e,t),e}(eh),ed=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=es,o}return ea(e,t),e}(eh),em=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.name=eu,n}return ea(e,t),e}(eh),eg=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.previousToken=n,o.name=ec,o}return ea(e,t),e}(eh),ev={},eE="InRuleRecoveryException";function ey(t){this.name=eE,this.message=t}ey.prototype=Error.prototype;var eN=function(){function t(){}return t.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,c.e$)(t,"recoveryEnabled")?t.recoveryEnabled:eK.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=eR)},t.prototype.getTokenToInsert=function(t){var e=tc(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},t.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},t.prototype.tryInRepetitionRecovery=function(t,e,r,n){for(var o=this,a=this.findReSyncTokenType(),i=this.exportLexerState(),s=[],u=!1,l=this.LA(1),f=this.LA(1),h=function(){var t=o.LA(0),e=new ep(o.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:l,previous:t,ruleName:o.getCurrRuleFullName()}),l,o.LA(0));e.resyncedTokens=(0,c.j7)(s),o.SAVE_ERROR(e)};!u;){if(this.tokenMatcher(f,n)){h();return}if(r.call(this)){h(),t.apply(this,e);return}this.tokenMatcher(f,a)?u=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,s))}this.importLexerState(i)},t.prototype.shouldInRepetitionRecoveryBeTried=function(t,e,r){return!(!1===r||void 0===t||void 0===e||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e)))},t.prototype.getFollowsForInRuleRecovery=function(t,e){var r=this.getCurrentGrammarPath(t,e);return this.getNextPossibleTokenTypes(r)},t.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new ey("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},t.prototype.canRecoverWithSingleTokenInsertion=function(t,e){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(t)||(0,c.xb)(e))return!1;var n=this.LA(1);return void 0!==(0,c.sE)(e,function(t){return r.tokenMatcher(n,t)})},t.prototype.canRecoverWithSingleTokenDeletion=function(t){return this.tokenMatcher(this.LA(2),t)},t.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(e);return(0,c.r3)(r,t)},t.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),r=2;;){var n=e.tokenType;if((0,c.r3)(t,n))return n;e=this.LA(r),r++}},t.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return ev;var t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(r)}},t.prototype.buildFullFollowKeyStack=function(){var t=this,e=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return(0,c.UI)(e,function(n,o){return 0===o?ev:{ruleName:t.shortRuleNameToFullName(n),idxInCallingRule:r[o],inRule:t.shortRuleNameToFullName(e[o-1])}})},t.prototype.flattenFollowSet=function(){var t=this,e=(0,c.UI)(this.buildFullFollowKeyStack(),function(e){return t.getFollowSetFromFollowKey(e)});return(0,c.xH)(e)},t.prototype.getFollowSetFromFollowKey=function(t){if(t===ev)return[ts];var e=t.ruleName+t.idxInCallingRule+t_+t.inRule;return this.resyncFollows[e]},t.prototype.addToResyncTokens=function(t,e){return this.tokenMatcher(t,ts)||e.push(t),e},t.prototype.reSyncTo=function(t){for(var e=[],r=this.LA(1);!1===this.tokenMatcher(r,t);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,e);return(0,c.j7)(e)},t.prototype.attemptInRepetitionRecovery=function(t,e,r,n,o,a,i){},t.prototype.getCurrentGrammarPath=function(t,e){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:(0,c.Qw)(this.RULE_OCCURRENCE_STACK),lastTok:t,lastTokOccurrence:e}},t.prototype.getHumanReadableRuleStack=function(){var t=this;return(0,c.UI)(this.RULE_STACK,function(e){return t.shortRuleNameToFullName(e)})},t}();function eR(t,e,r,n,o,a,i){var s=this.getKeyForAutomaticLookahead(n,o),c=this.firstAfterRepMap[s];if(void 0===c){var u=this.getCurrRuleFullName();c=new a(this.getGAstProductions()[u],o).startWalking(),this.firstAfterRepMap[s]=c}var l=c.token,f=c.occurrence,h=c.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=ts,f=1),this.shouldInRepetitionRecoveryBeTried(l,f,i)&&this.tryInRepetitionRecovery(t,e,r,l)}var eT=function(){function t(){}return t.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=(0,c.e$)(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:eK.dynamicTokensEnabled,this.maxLookahead=(0,c.e$)(t,"maxLookahead")?t.maxLookahead:eK.maxLookahead,this.lookAheadFuncsCache=(0,c.dU)()?new Map:[],(0,c.dU)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(t){var e=this;(0,c.Ed)(t,function(t){e.TRACE_INIT(t.name+" Rule Lookahead",function(){var r,n=(tS.reset(),t.accept(tS),r=tS.dslMethods,tS.reset(),r),a=n.alternation,i=n.repetition,s=n.option,u=n.repetitionMandatory,l=n.repetitionMandatoryWithSeparator,f=n.repetitionWithSeparator;(0,c.Ed)(a,function(r){var n=0===r.idx?"":r.idx;e.TRACE_INIT(""+tb(r)+n,function(){var n,o,a,i,s,c,u,l,f=(n=r.idx,o=r.maxLookahead||e.maxLookahead,a=r.hasPredicates,i=e.dynamicTokensEnabled,s=e.lookAheadBuilderForAlternatives,u=t5(c=t2(n,t,o))?B:D,s(c,a,u,i)),h=(l=e.fullRuleNameToShort[t.name],256|r.idx|l);e.setLaFuncCache(h,f)})}),(0,c.Ed)(i,function(r){e.computeLookaheadFunc(t,r.idx,768,o.REPETITION,r.maxLookahead,tb(r))}),(0,c.Ed)(s,function(r){e.computeLookaheadFunc(t,r.idx,512,o.OPTION,r.maxLookahead,tb(r))}),(0,c.Ed)(u,function(r){e.computeLookaheadFunc(t,r.idx,1024,o.REPETITION_MANDATORY,r.maxLookahead,tb(r))}),(0,c.Ed)(l,function(r){e.computeLookaheadFunc(t,r.idx,1536,o.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,tb(r))}),(0,c.Ed)(f,function(r){e.computeLookaheadFunc(t,r.idx,1280,o.REPETITION_WITH_SEPARATOR,r.maxLookahead,tb(r))})})})},t.prototype.computeLookaheadFunc=function(t,e,r,n,o,a){var i=this;this.TRACE_INIT(""+a+(0===e?"":e),function(){var a,s,c,u,l,f=(a=o||i.maxLookahead,s=i.dynamicTokensEnabled,c=i.lookAheadBuilderForOptional,l=t5(u=t3(e,t,n,a))?B:D,c(u[0],l,s)),h=e|r|i.fullRuleNameToShort[t.name];i.setLaFuncCache(h,f)})},t.prototype.lookAheadBuilderForOptional=function(t,e,r){return function(t,e,r){var n=(0,c.yW)(t,function(t){return 1===t.length}),o=t.length;if(!n||r)return function(){e:for(var r=0;r<o;r++){for(var n=t[r],a=n.length,i=0;i<a;i++)if(!1===e(this.LA(i+1),n[i]))continue e;return!0}return!1};var a=(0,c.xH)(t);if(1===a.length&&(0,c.xb)(a[0].categoryMatches)){var i=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===i}}var s=(0,c.u4)(a,function(t,e,r){return t[e.tokenTypeIdx]=!0,(0,c.Ed)(e.categoryMatches,function(e){t[e]=!0}),t},[]);return function(){return!0===s[this.LA(1).tokenTypeIdx]}}(t,e,r)},t.prototype.lookAheadBuilderForAlternatives=function(t,e,r,n){return function(t,e,r,n){var o=t.length,a=(0,c.yW)(t,function(t){return(0,c.yW)(t,function(t){return 1===t.length})});if(e)return function(e){for(var n=(0,c.UI)(e,function(t){return t.GATE}),a=0;a<o;a++){var i=t[a],s=i.length,u=n[a];if(void 0===u||!1!==u.call(this))e:for(var l=0;l<s;l++){for(var f=i[l],h=f.length,p=0;p<h;p++)if(!1===r(this.LA(p+1),f[p]))continue e;return a}}};if(!a||n)return function(){for(var e=0;e<o;e++){var n=t[e],a=n.length;e:for(var i=0;i<a;i++){for(var s=n[i],c=s.length,u=0;u<c;u++)if(!1===r(this.LA(u+1),s[u]))continue e;return e}}};var i=(0,c.UI)(t,function(t){return(0,c.xH)(t)}),s=(0,c.u4)(i,function(t,e,r){return(0,c.Ed)(e,function(e){(0,c.e$)(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=r),(0,c.Ed)(e.categoryMatches,function(e){(0,c.e$)(t,e)||(t[e]=r)})}),t},[]);return function(){return s[this.LA(1).tokenTypeIdx]}}(t,e,r,n)},t.prototype.getKeyForAutomaticLookahead=function(t,e){return e|t|this.getLastExplicitRuleShortName()},t.prototype.getLaFuncFromCache=function(t){},t.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},t.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},t.prototype.setLaFuncCache=function(t,e){},t.prototype.setLaFuncCacheUsingMap=function(t,e){this.lookAheadFuncsCache.set(t,e)},t.prototype.setLaFuncUsingObj=function(t,e){this.lookAheadFuncsCache[t]=e},t}();function eA(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset)}function eM(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}var ew="name";function ex(t){return t.name||"anonymous"}function eI(t,e){var r=Object.getOwnPropertyDescriptor(t,ew);return(!!(0,c.o8)(r)||!!r.configurable)&&(Object.defineProperty(t,ew,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0)}function eO(t,e){for(var r=(0,c.XP)(t),n=r.length,o=0;o<n;o++)for(var a=t[r[o]],i=a.length,s=0;s<i;s++){var u=a[s];void 0===u.tokenTypeIdx&&this[u.name](u.children,e)}}!function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"}(a||(a={}));var eb=["constructor","visit","validateVisitor"],eC=function(){function t(){}return t.prototype.initTreeBuilder=function(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=(0,c.e$)(t,"nodeLocationTracking")?t.nodeLocationTracking:eK.nodeLocationTracking,this.outputCst){if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=eM,this.setNodeLocationFromNode=eM,this.cstPostRule=c.dG,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=c.dG,this.setNodeLocationFromNode=c.dG,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=eA,this.setNodeLocationFromNode=eA,this.cstPostRule=c.dG,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=c.dG,this.setNodeLocationFromNode=c.dG,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=c.dG,this.setNodeLocationFromNode=c.dG,this.cstPostRule=c.dG,this.setInitialNodeLocation=c.dG;else throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"')}else this.cstInvocationStateUpdate=c.dG,this.cstFinallyStateUpdate=c.dG,this.cstPostTerminal=c.dG,this.cstPostNonTerminal=c.dG,this.cstPostRule=c.dG},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(t){var e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstInvocationStateUpdate=function(t,e){var r={name:t,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},t.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},t.prototype.cstPostRuleFull=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset==!0?(r.endOffset=e.endOffset,r.endLine=e.endLine,r.endColumn=e.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(t){var e=this.LA(0),r=t.location;r.startOffset<=e.startOffset==!0?r.endOffset=e.endOffset:r.startOffset=NaN},t.prototype.cstPostTerminal=function(t,e){var r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[t]?r.children[t]=[e]:r.children[t].push(e),this.setNodeLocationFromToken(r.location,e)},t.prototype.cstPostNonTerminal=function(t,e){var r=this.CST_STACK[this.CST_STACK.length-1];void 0===r.children[e]?r.children[e]=[t]:r.children[e].push(t),this.setNodeLocationFromNode(r.location,t.location)},t.prototype.getBaseCstVisitorConstructor=function(){if((0,c.o8)(this.baseCstVisitorConstructor)){var t,e,r,n=(t=this.className,e=(0,c.XP)(this.gastProductionsCache),eI(r=function(){},t+"BaseSemantics"),r.prototype={visit:function(t,e){if((0,c.kJ)(t)&&(t=t[0]),!(0,c.o8)(t))return this[t.name](t.children,e)},validateVisitor:function(){var t,r,n,o,i=(t=this,r=(0,c.UI)(e,function(e){if(!(0,c.mf)(t[e]))return{msg:"Missing visitor method: <"+e+"> on "+ex(t.constructor)+" CST Visitor.",type:a.MISSING_METHOD,methodName:e}}),n=(0,c.oA)(r),o=function(t,e){var r=[];for(var n in t)!(0,c.mf)(t[n])||(0,c.r3)(eb,n)||(0,c.r3)(e,n)||r.push({msg:"Redundant visitor method: <"+n+"> on "+ex(t.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\n",type:a.REDUNDANT_METHOD,methodName:n});return r}(this,e),n.concat(o));if(!(0,c.xb)(i)){var s=(0,c.UI)(i,function(t){return t.msg});throw Error("Errors Detected in CST Visitor <"+ex(this.constructor)+">:\n	"+s.join("\n\n").replace(/\n/g,"\n	"))}}},r.prototype.constructor=r,r._RULE_NAMES=e,r);return this.baseCstVisitorConstructor=n,n}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,c.o8)(this.baseCstVisitorWithDefaultsConstructor)){var t,e,r,n,o,a=(t=this.className,e=(0,c.XP)(this.gastProductionsCache),r=this.getBaseCstVisitorConstructor(),eI(n=function(){},t+"BaseSemanticsWithDefaults"),o=Object.create(r.prototype),(0,c.Ed)(e,function(t){o[t]=eO}),n.prototype=o,n.prototype.constructor=n,n);return this.baseCstVisitorWithDefaultsConstructor=a,a}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.getLastExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var t=this.RULE_STACK;return t[t.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},t}(),eS=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!1,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):eq},t.prototype.LA=function(t){var e=this.currIdx+t;return e<0||this.tokVectorLength<=e?eq:this.tokVector[e]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(t){this.currIdx=t},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),eU=function(){function t(){}return t.prototype.ACTION=function(t){return t.call(this)},t.prototype.consume=function(t,e,r){return this.consumeInternal(e,t,r)},t.prototype.subrule=function(t,e,r){return this.subruleInternal(e,t,r)},t.prototype.option=function(t,e){return this.optionInternal(e,t)},t.prototype.or=function(t,e){return this.orInternal(e,t)},t.prototype.many=function(t,e){return this.manyInternal(t,e)},t.prototype.atLeastOne=function(t,e){return this.atLeastOneInternal(t,e)},t.prototype.CONSUME=function(t,e){return this.consumeInternal(t,0,e)},t.prototype.CONSUME1=function(t,e){return this.consumeInternal(t,1,e)},t.prototype.CONSUME2=function(t,e){return this.consumeInternal(t,2,e)},t.prototype.CONSUME3=function(t,e){return this.consumeInternal(t,3,e)},t.prototype.CONSUME4=function(t,e){return this.consumeInternal(t,4,e)},t.prototype.CONSUME5=function(t,e){return this.consumeInternal(t,5,e)},t.prototype.CONSUME6=function(t,e){return this.consumeInternal(t,6,e)},t.prototype.CONSUME7=function(t,e){return this.consumeInternal(t,7,e)},t.prototype.CONSUME8=function(t,e){return this.consumeInternal(t,8,e)},t.prototype.CONSUME9=function(t,e){return this.consumeInternal(t,9,e)},t.prototype.SUBRULE=function(t,e){return this.subruleInternal(t,0,e)},t.prototype.SUBRULE1=function(t,e){return this.subruleInternal(t,1,e)},t.prototype.SUBRULE2=function(t,e){return this.subruleInternal(t,2,e)},t.prototype.SUBRULE3=function(t,e){return this.subruleInternal(t,3,e)},t.prototype.SUBRULE4=function(t,e){return this.subruleInternal(t,4,e)},t.prototype.SUBRULE5=function(t,e){return this.subruleInternal(t,5,e)},t.prototype.SUBRULE6=function(t,e){return this.subruleInternal(t,6,e)},t.prototype.SUBRULE7=function(t,e){return this.subruleInternal(t,7,e)},t.prototype.SUBRULE8=function(t,e){return this.subruleInternal(t,8,e)},t.prototype.SUBRULE9=function(t,e){return this.subruleInternal(t,9,e)},t.prototype.OPTION=function(t){return this.optionInternal(t,0)},t.prototype.OPTION1=function(t){return this.optionInternal(t,1)},t.prototype.OPTION2=function(t){return this.optionInternal(t,2)},t.prototype.OPTION3=function(t){return this.optionInternal(t,3)},t.prototype.OPTION4=function(t){return this.optionInternal(t,4)},t.prototype.OPTION5=function(t){return this.optionInternal(t,5)},t.prototype.OPTION6=function(t){return this.optionInternal(t,6)},t.prototype.OPTION7=function(t){return this.optionInternal(t,7)},t.prototype.OPTION8=function(t){return this.optionInternal(t,8)},t.prototype.OPTION9=function(t){return this.optionInternal(t,9)},t.prototype.OR=function(t){return this.orInternal(t,0)},t.prototype.OR1=function(t){return this.orInternal(t,1)},t.prototype.OR2=function(t){return this.orInternal(t,2)},t.prototype.OR3=function(t){return this.orInternal(t,3)},t.prototype.OR4=function(t){return this.orInternal(t,4)},t.prototype.OR5=function(t){return this.orInternal(t,5)},t.prototype.OR6=function(t){return this.orInternal(t,6)},t.prototype.OR7=function(t){return this.orInternal(t,7)},t.prototype.OR8=function(t){return this.orInternal(t,8)},t.prototype.OR9=function(t){return this.orInternal(t,9)},t.prototype.MANY=function(t){this.manyInternal(0,t)},t.prototype.MANY1=function(t){this.manyInternal(1,t)},t.prototype.MANY2=function(t){this.manyInternal(2,t)},t.prototype.MANY3=function(t){this.manyInternal(3,t)},t.prototype.MANY4=function(t){this.manyInternal(4,t)},t.prototype.MANY5=function(t){this.manyInternal(5,t)},t.prototype.MANY6=function(t){this.manyInternal(6,t)},t.prototype.MANY7=function(t){this.manyInternal(7,t)},t.prototype.MANY8=function(t){this.manyInternal(8,t)},t.prototype.MANY9=function(t){this.manyInternal(9,t)},t.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},t.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},t.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},t.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},t.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},t.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},t.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},t.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},t.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},t.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},t.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},t.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},t.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},t.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},t.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},t.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},t.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},t.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},t.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},t.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},t.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},t.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},t.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},t.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},t.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},t.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},t.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},t.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},t.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},t.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},t.prototype.RULE=function(t,e,r){if(void 0===r&&(r=ez),(0,c.r3)(this.definedRulesNames,t)){var n={message:tB.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:i.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(n)}this.definedRulesNames.push(t);var o=this.defineRule(t,e,r);return this[t]=o,o},t.prototype.OVERRIDE_RULE=function(t,e,r){void 0===r&&(r=ez);var n,o,a,s,u=[];u=u.concat((n=this.definedRulesNames,o=this.className,s=[],c.r3(n,t)||(a="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+o+"<-as it is not defined in any of the super grammars ",s.push({message:a,type:i.INVALID_RULE_OVERRIDE,ruleName:t})),s)),this.definitionErrors.push.apply(this.definitionErrors,u);var l=this.defineRule(t,e,r);return this[t]=l,l},t.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return t.apply(this,e),!0}catch(t){if(ef(t))return!1;throw t}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return tT((0,c.VO)(this.gastProductionsCache))},t}(),e_=function(){function t(){}return t.prototype.initRecognizerEngine=function(t,e){if(this.className=ex(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=B,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,c.e$)(e,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n	For Further details.");if((0,c.kJ)(t)){if((0,c.xb)(t))throw Error("A Token Vocabulary cannot be empty.\n	Note that the first argument for the parser constructor\n	is no longer a Token vector (since v4.0).");if("number"==typeof t[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n	For Further details.")}if((0,c.kJ)(t))this.tokensMap=(0,c.u4)(t,function(t,e){return t[e.name]=e,t},{});else if((0,c.e$)(t,"modes")&&(0,c.yW)((0,c.xH)((0,c.VO)(t.modes)),H)){var r=(0,c.xH)((0,c.VO)(t.modes)),n=(0,c.jj)(r);this.tokensMap=(0,c.u4)(n,function(t,e){return t[e.name]=e,t},{})}else if((0,c.Kn)(t))this.tokensMap=(0,c.Cl)(t);else throw Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=ts;var o=(0,c.yW)((0,c.VO)(t),function(t){return(0,c.xb)(t.categoryMatches)});this.tokenMatcher=o?B:D,V((0,c.VO)(this.tokensMap))},t.prototype.defineRule=function(t,e,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var n,o=(0,c.e$)(r,"resyncEnabled")?r.resyncEnabled:ez.resyncEnabled,a=(0,c.e$)(r,"recoveryValueFunc")?r.recoveryValueFunc:ez.recoveryValueFunc,i=this.ruleShortNameIdx<<12;function s(t){try{if(!0!==this.outputCst)return e.apply(this,t);e.apply(this,t);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}catch(t){return this.invokeRuleCatch(t,o,a)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[i]=t,this.fullRuleNameToShort[t]=i,(n=function(e,r){return void 0===e&&(e=0),this.ruleInvocationStateUpdate(i,t,e),s.call(this,r)}).ruleName=t,n.originalGrammarAction=e,n},t.prototype.invokeRuleCatch=function(t,e,r){var n=1===this.RULE_STACK.length,o=e&&!this.isBackTracking()&&this.recoveryEnabled;if(ef(t)){if(o){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a)){if(t.resyncedTokens=this.reSyncTo(a),!this.outputCst)return r();var i=this.CST_STACK[this.CST_STACK.length-1];return i.recoveredNode=!0,i}if(this.outputCst){var i=this.CST_STACK[this.CST_STACK.length-1];i.recoveredNode=!0,t.partialCstResult=i}throw t}if(n)return this.moveToTerminatedState(),r()}throw t},t.prototype.optionInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(512,e);return this.optionInternalLogic(t,e,r)},t.prototype.optionInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(o=t.GATE)){var s=i;i=function(){return o.call(a)&&s.call(a)}}}else n=t;if(!0===i.call(this))return n.call(this)},t.prototype.atLeastOneInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(1024,t);return this.atLeastOneInternalLogic(t,e,r)},t.prototype.atLeastOneInternalLogic=function(t,e,r){var n,a,i=this,s=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(a=e.GATE)){var c=s;s=function(){return a.call(i)&&c.call(i)}}}else n=e;if(!0===s.call(this))for(var u=this.doSingleRepetition(n);!0===s.call(this)&&!0===u;)u=this.doSingleRepetition(n);else throw this.raiseEarlyExitException(t,o.REPETITION_MANDATORY,e.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],s,1024,t,tY)},t.prototype.atLeastOneSepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(1536,t);this.atLeastOneSepFirstInternalLogic(t,e,r)},t.prototype.atLeastOneSepFirstInternalLogic=function(t,e,r){var n=this,a=e.DEF,i=e.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){a.call(this);for(var s=function(){return n.tokenMatcher(n.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,i,s,a,tq],s,1536,t,tq)}else throw this.raiseEarlyExitException(t,o.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG)},t.prototype.manyInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(768,t);return this.manyInternalLogic(t,e,r)},t.prototype.manyInternalLogic=function(t,e,r){var n,o,a=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(o=e.GATE)){var s=i;i=function(){return o.call(a)&&s.call(a)}}}else n=e;for(var c=!0;!0===i.call(this)&&!0===c;)c=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],i,768,t,tH,c)},t.prototype.manySepFirstInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(1280,t);this.manySepFirstInternalLogic(t,e,r)},t.prototype.manySepFirstInternalLogic=function(t,e,r){var n=this,o=e.DEF,a=e.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){o.call(this);for(var i=function(){return n.tokenMatcher(n.LA(1),a)};!0===this.tokenMatcher(this.LA(1),a);)this.CONSUME(a),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,a,i,o,tW],i,1280,t,tW)}},t.prototype.repetitionSepSecondInternal=function(t,e,r,n,o){for(;r();)this.CONSUME(e),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,r,n,o],r,1536,t,o)},t.prototype.doSingleRepetition=function(t){var e=this.getLexerPosition();return t.call(this),this.getLexerPosition()>e},t.prototype.orInternal=function(t,e){var r=this.getKeyForAutomaticLookahead(256,e),n=(0,c.kJ)(t)?t:t.DEF,o=this.getLaFuncFromCache(r).call(this,n);if(void 0!==o)return n[o].ALT.call(this);this.raiseNoAltException(e,t.ERR_MSG)},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new em(e,t))}},t.prototype.subruleInternal=function(t,e,r){var n;try{var o=void 0!==r?r.ARGS:void 0;return n=t.call(this,e,o),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:t.ruleName),n}catch(e){this.subruleInternalError(e,r,t.ruleName)}},t.prototype.subruleInternalError=function(t,e,r){throw ef(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==e&&void 0!==e.LABEL?e.LABEL:r),delete t.partialCstResult),t},t.prototype.consumeInternal=function(t,e,r){var n;try{var o=this.LA(1);!0===this.tokenMatcher(o,t)?(this.consumeToken(),n=o):this.consumeInternalError(t,o,r)}catch(r){n=this.consumeInternalRecovery(t,e,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:t.name,n),n},t.prototype.consumeInternalError=function(t,e,r){var n,o=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new ep(n,e,o))},t.prototype.consumeInternalRecovery=function(t,e,r){if(this.recoveryEnabled&&"MismatchedTokenException"===r.name&&!this.isBackTracking()){var n=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,n)}catch(t){if(t.name===eE)throw r;throw t}}else throw r},t.prototype.saveRecogState=function(){var t=this.errors,e=(0,c.Qw)(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK}},t.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(t,e,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e,t)},t.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},t.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},t.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),ts)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),eL=function(){function t(){}return t.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=(0,c.e$)(t,"errorMessageProvider")?t.errorMessageProvider:eK.errorMessageProvider},t.prototype.SAVE_ERROR=function(t){if(ef(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,c.Qw)(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return(0,c.Qw)(this._errors)},set:function(t){this._errors=t},enumerable:!1,configurable:!0}),t.prototype.raiseEarlyExitException=function(t,e,r){for(var n=this.getCurrRuleFullName(),o=t3(t,this.getGAstProductions()[n],e,this.maxLookahead)[0],a=[],i=1;i<=this.maxLookahead;i++)a.push(this.LA(i));var s=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:a,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new eg(s,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(t,e){for(var r=this.getCurrRuleFullName(),n=t2(t,this.getGAstProductions()[r],this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var i=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:n,actual:o,previous:i,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new ed(s,this.LA(1),i))},t}(),ek=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(t,e){var r=this.gastProductionsCache[t];if((0,c.o8)(r))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return tz([r],e,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(t){var e=(0,c.Ps)(t.ruleStack);return new tG(this.getGAstProductions()[e],t).startWalking()},t}(),eP={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(eP);var eD=ti({name:"RECORDING_PHASE_TOKEN",pattern:q.NA});V([eD]);var eB=tc(eD,"This IToken indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(eB);var eF={name:"This CSTNode indicates the Parser is in Recording Phase\n	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}},ej=function(){function t(){}return t.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var e=function(e){var r=e>0?e:"";t["CONSUME"+r]=function(t,r){return this.consumeInternalRecord(t,e,r)},t["SUBRULE"+r]=function(t,r){return this.subruleInternalRecord(t,e,r)},t["OPTION"+r]=function(t){return this.optionInternalRecord(t,e)},t["OR"+r]=function(t){return this.orInternalRecord(t,e)},t["MANY"+r]=function(t){this.manyInternalRecord(e,t)},t["MANY_SEP"+r]=function(t){this.manySepFirstInternalRecord(e,t)},t["AT_LEAST_ONE"+r]=function(t){this.atLeastOneInternalRecord(e,t)},t["AT_LEAST_ONE_SEP"+r]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}},r=0;r<10;r++)e(r);t.consume=function(t,e,r){return this.consumeInternalRecord(e,t,r)},t.subrule=function(t,e,r){return this.subruleInternalRecord(e,t,r)},t.option=function(t,e){return this.optionInternalRecord(e,t)},t.or=function(t,e){return this.orInternalRecord(e,t)},t.many=function(t,e){this.manyInternalRecord(t,e)},t.atLeastOne=function(t,e){this.atLeastOneInternalRecord(t,e)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},t.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var e=0;e<10;e++){var r=e>0?e:"";delete t["CONSUME"+r],delete t["SUBRULE"+r],delete t["OPTION"+r],delete t["OR"+r],delete t["MANY"+r],delete t["MANY_SEP"+r],delete t["AT_LEAST_ONE"+r],delete t["AT_LEAST_ONE_SEP"+r]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})},t.prototype.ACTION_RECORD=function(t){},t.prototype.BACKTRACK_RECORD=function(t,e){return function(){return!0}},t.prototype.LA_RECORD=function(t){return eq},t.prototype.topLevelRuleRecord=function(t,e){try{var r=new tp({definition:[],name:t});return r.name=t,this.recordingProdStack.push(r),e.call(this),this.recordingProdStack.pop(),r}catch(t){if(!0!==t.KNOWN_RECORDER_ERROR)try{t.message=t.message+'\n	 This error was thrown during the "grammar recording phase" For more info see:\n	https://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(t){}throw t}},t.prototype.optionInternalRecord=function(t,e){return eV.call(this,tm,t,e)},t.prototype.atLeastOneInternalRecord=function(t,e){eV.call(this,tg,e,t)},t.prototype.atLeastOneSepFirstInternalRecord=function(t,e){eV.call(this,tv,e,t,!0)},t.prototype.manyInternalRecord=function(t,e){eV.call(this,tE,e,t)},t.prototype.manySepFirstInternalRecord=function(t,e){eV.call(this,ty,e,t,!0)},t.prototype.orInternalRecord=function(t,e){return eG.call(this,t,e)},t.prototype.subruleInternalRecord=function(t,e,r){if(eH(e),!t||!1===(0,c.e$)(t,"ruleName")){var n=Error("<SUBRULE"+e$(e)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=(0,c.fj)(this.recordingProdStack),a=new th({idx:e,nonTerminalName:t.ruleName,referencedRule:void 0});return o.definition.push(a),this.outputCst?eF:eP},t.prototype.consumeInternalRecord=function(t,e,r){if(eH(e),!G(t)){var n=Error("<CONSUME"+e$(e)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var o=(0,c.fj)(this.recordingProdStack),a=new tR({idx:e,terminalType:t});return o.definition.push(a),eB},t}();function eV(t,e,r,n){void 0===n&&(n=!1),eH(r);var o=(0,c.fj)(this.recordingProdStack),a=(0,c.mf)(e)?e:e.DEF,i=new t({definition:[],idx:r});return n&&(i.separator=e.SEP),(0,c.e$)(e,"MAX_LOOKAHEAD")&&(i.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(i),a.call(this),o.definition.push(i),this.recordingProdStack.pop(),eP}function eG(t,e){var r=this;eH(e);var n=(0,c.fj)(this.recordingProdStack),o=!1===(0,c.kJ)(t),a=!1===o?t:t.DEF,i=new tN({definition:[],idx:e,ignoreAmbiguities:o&&!0===t.IGNORE_AMBIGUITIES});(0,c.e$)(t,"MAX_LOOKAHEAD")&&(i.maxLookahead=t.MAX_LOOKAHEAD);var s=(0,c.G)(a,function(t){return(0,c.mf)(t.GATE)});return i.hasPredicates=s,n.definition.push(i),(0,c.Ed)(a,function(t){var e=new td({definition:[]});i.definition.push(e),(0,c.e$)(t,"IGNORE_AMBIGUITIES")?e.ignoreAmbiguities=t.IGNORE_AMBIGUITIES:(0,c.e$)(t,"GATE")&&(e.ignoreAmbiguities=!0),r.recordingProdStack.push(e),t.ALT.call(r),r.recordingProdStack.pop()}),eP}function e$(t){return 0===t?"":""+t}function eH(t){if(t<0||t>255){var e=Error("Invalid DSL Method idx value: <"+t+">\n	Idx value must be a none negative value smaller than 256");throw e.KNOWN_RECORDER_ERROR=!0,e}}var eW=function(){function t(){}return t.prototype.initPerformanceTracer=function(t){if((0,c.e$)(t,"traceInitPerf")){var e=t.traceInitPerf,r="number"==typeof e;this.traceInitMaxIdent=r?e:1/0,this.traceInitPerf=r?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=eK.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(t,e){if(!0!==this.traceInitPerf)return e();this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--> <"+t+">");var n=(0,c.HT)(e),o=n.time,a=n.value,i=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&i(r+"<-- <"+t+"> time: "+o+"ms"),this.traceInitIndent--,a},t}(),eY=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),eq=tc(ts,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(eq);var eK=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:tP,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),ez=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function eX(t){return void 0===t&&(t=void 0),function(){return t}}!function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"}(i||(i={}));var eQ=function(){function t(t,e){if(this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(e),this.initLexerAdapter(),this.initLooksAhead(e),this.initRecognizerEngine(t,e),this.initRecoverable(e),this.initTreeBuilder(e),this.initContentAssist(),this.initGastRecorder(e),this.initPerformanceTracer(e),(0,c.e$)(e,"ignoredIssues"))throw Error("The <ignoredIssues> IParserConfig property has been deprecated.\n	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n	For further details.");this.skipValidations=(0,c.e$)(e,"skipValidations")?e.skipValidations:eK.skipValidations}return t.performSelfAnalysis=function(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){e.selfAnalysisDone=!0;var r=e.className;e.TRACE_INIT("toFastProps",function(){(0,c.SV)(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),(0,c.Ed)(e.definedRulesNames,function(t){var r=e[t].originalGrammarAction,n=void 0;e.TRACE_INIT(t+" Rule",function(){n=e.topLevelRuleRecord(t,r)}),e.gastProductionsCache[t]=n})}finally{e.disableRecording()}});var n=[];if(e.TRACE_INIT("Grammar Resolving",function(){n=er({rules:(0,c.VO)(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,n)}),e.TRACE_INIT("Grammar Validations",function(){if((0,c.xb)(n)&&!1===e.skipValidations){var t=en({rules:(0,c.VO)(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:(0,c.VO)(e.tokensMap),errMsgProvider:tB,grammarName:r});e.definitionErrors.push.apply(e.definitionErrors,t)}}),(0,c.xb)(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var t,r,n=(t=(0,c.VO)(e.gastProductionsCache),r={},(0,c.Ed)(t,function(t){var e=new tk(t).startWalking();(0,c.f0)(r,e)}),r);e.resyncFollows=n}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions((0,c.VO)(e.gastProductionsCache))})),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,c.xb)(e.definitionErrors))throw Error("Parser Definition Errors detected:\n "+(0,c.UI)(e.definitionErrors,function(t){return t.message}).join("\n-------------------------------\n"))})},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();(0,c.ef)(eQ,[eN,eT,eC,eS,e_,eU,eL,ek,ej,eW]);var eZ=function(t){function e(e,r){void 0===r&&(r=eK);var n=(0,c.Cl)(r);return n.outputCst=!0,t.call(this,e,n)||this}return eY(e,t),e}(eQ),eJ=function(t){function e(e,r){void 0===r&&(r=eK);var n=(0,c.Cl)(r);return n.outputCst=!1,t.call(this,e,n)||this}return eY(e,t),e}(eQ);function e0(t,e){var r=void 0===e?{}:e,n=r.resourceBase,o=void 0===n?"https://unpkg.com/chevrotain@"+s+"/diagrams/":n,a=r.css;return"\n<!-- This is a generated file -->\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===a?"https://unpkg.com/chevrotain@"+s+"/diagrams/diagrams.css":a)+"'>\n"+("\n<script src='"+o+"vendor/railroad-diagrams.js'></script>\n<script src='"+o+"src/diagrams_builder.js'></script>\n<script src='"+o)+"src/diagrams_behavior.js'></script>\n<script src='"+o+'src/main.js\'></script>\n\n<div id="diagrams" align="center"></div>    \n'+("\n<script>\n    window.serializedGrammar = "+JSON.stringify(t,null,"  "))+';\n</script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n</script>\n'}function e1(t){var e;return"\nfunction "+t.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+(e=t.rules,(0,c.UI)(e,function(t){var e;return e5(1,'$.RULE("'+t.name+'", function() {')+"\n"+e4(t.definition,2)+(e5(2,"})")+"\n")}).join("\n"))+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+t.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+t.name+".prototype.constructor = "+t.name+"    \n    "}function e2(t,e,r){var n=e5(r,"$."+(t+e.idx)+"(");return e.separator?n+="{\n"+e5(r+1,"SEP: this.tokensMap."+e.separator.name)+",\nDEF: "+e3(e.definition,r+2)+"\n"+e5(r,"}")+"\n":n+=e3(e.definition,r+1),n+=e5(r,")")+"\n"}function e3(t,e){return"function() {\n"+e4(t,e)+(e5(e,"}")+"\n")}function e4(t,e){var r="";return(0,c.Ed)(t,function(t){r+=function(t,e){var r;if(t instanceof th)return e5(e,"$.SUBRULE"+t.idx+"($."+t.nonTerminalName+")\n");if(t instanceof tm)return e2("OPTION",t,e);if(t instanceof tg)return e2("AT_LEAST_ONE",t,e);if(t instanceof tv)return e2("AT_LEAST_ONE_SEP",t,e);if(t instanceof ty)return e2("MANY_SEP",t,e);if(t instanceof tE)return e2("MANY",t,e);if(t instanceof tN)return e5(e,"$.OR"+t.idx+"([")+"\n"+(0,c.UI)(t.definition,function(t){var r,n;return e5(r=e+1,"{")+"\n"+(e5(r+1,"ALT: function() {")+"\n"+e4(t.definition,r+1)+e5(r+1,"}")+"\n")+e5(r,"}")}).join(",\n")+"\n"+e5(e,"])\n");else if(t instanceof tR)return r=t.terminalType.name,e5(e,"$.CONSUME"+t.idx+"(this.tokensMap."+r+")\n");else if(t instanceof td)return e4(t.definition,e);else throw Error("non exhaustive match")}(t,e+1)}),r}function e5(t,e){return Array(4*t+1).join(" ")+e}function e6(t){var e,n=Function("tokenVocabulary","config","chevrotain","    \n"+e1(e={name:t.name,rules:t.rules})+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n");return function(e){return n(t.tokenVocabulary,e,r(75490))}}function e7(t){var e;return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+e1(e={name:t.name,rules:t.rules})+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}function e9(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n	 It performs no action other than printing this message.\n	 Please avoid using it as it will be completely removed in the future")}var e8=function(){throw Error("The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	\nSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0")}},76785:(t,e,r)=>{"use strict";function n(t){return t&&0===t.length}function o(t){return null==t?[]:Object.keys(t)}function a(t){for(var e=[],r=Object.keys(t),n=0;n<r.length;n++)e.push(t[r[n]]);return e}function i(t,e){for(var r=[],n=o(t),a=0;a<n.length;a++){var i=n[a];r.push(e.call(null,t[i],i))}return r}function s(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e.call(null,t[n],n));return r}function c(t){return n(t)?void 0:t[0]}function u(t){var e=t&&t.length;return e?t[e-1]:void 0}function l(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e.call(null,t[r],r);else if(C(t))for(var n=o(t),r=0;r<n.length;r++){var a=n[r],i=t[a];e.call(null,i,a)}else throw Error("non exhaustive match")}function f(t){return"string"==typeof t}function h(t){return void 0===t}function p(t){return t instanceof Function}function d(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function m(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function g(t,e){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n++){var o=t[n];e.call(null,o)&&r.push(o)}return r}function v(t,e){return g(t,function(t){return!e(t)})}function E(t,e){for(var r=Object.keys(t),n={},o=0;o<r.length;o++){var a=r[o],i=t[a];e(i)&&(n[a]=i)}return n}function y(t,e){return!!C(t)&&t.hasOwnProperty(e)}function N(t,e){return void 0!==A(t,function(t){return t===e})}function R(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}function T(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function A(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e.call(null,n))return n}}function M(t,e){for(var r=[],n=0;n<t.length;n++){var o=t[n];e.call(null,o)&&r.push(o)}return r}function w(t,e,r){for(var n=Array.isArray(t),i=n?t:a(t),s=n?[]:o(t),c=r,u=0;u<i.length;u++)c=e.call(null,c,i[u],n?u:s[u]);return c}function x(t){return v(t,function(t){return null==t})}function I(t,e){void 0===e&&(e=function(t){return t});var r=[];return w(t,function(t,n){var o=e(n);return N(r,o)?t:(r.push(o),t.concat(n))},[])}function O(t){return Array.isArray(t)}function b(t){return t instanceof RegExp}function C(t){return t instanceof Object}function S(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r))return!1;return!0}function U(t,e){return v(t,function(t){return N(e,t)})}function _(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}function L(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return -1}function k(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var a=e[n],i=o(a),s=0;s<i.length;s++){var c=i[s];t[c]=a[c]}return t}function P(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var a=e[n],i=o(a),s=0;s<i.length;s++){var c=i[s];y(t,c)||(t[c]=a[c])}return t}function D(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return P.apply(null,[{}].concat(t))}function B(t,e){var r={};return l(t,function(t){var n=e(t),o=r[n];o?o.push(t):r[n]=[t]}),r}function F(t,e){for(var r=T(t),n=o(e),a=0;a<n.length;a++){var i=n[a],s=e[i];r[i]=s}return r}function j(){}function V(t){return t}function G(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];e.push(void 0!==n?n:void 0)}return e}function $(t){console&&console.error&&console.error("Error: "+t)}function H(t){console&&console.warn&&console.warn("Warning: "+t)}function W(){return"function"==typeof Map}function Y(t,e){e.forEach(function(e){var r=e.prototype;Object.getOwnPropertyNames(r).forEach(function(n){if("constructor"!==n){var o=Object.getOwnPropertyDescriptor(r,n);o&&(o.get||o.set)?Object.defineProperty(t.prototype,n,o):t.prototype[n]=e.prototype[n]}})})}function q(t){function e(){}e.prototype=t;var r=new e;function n(){return typeof r.bar}return n(),n(),t}function K(t){return t[t.length-1]}function z(t){var e=new Date().getTime(),r=t();return{time:new Date().getTime()-e,value:r}}r.d(e,{Cl:()=>T,Cw:()=>d,Ed:()=>l,G:()=>_,HD:()=>f,HT:()=>z,Kj:()=>b,Kn:()=>C,Oq:()=>M,Ps:()=>c,Q8:()=>i,Qw:()=>R,SV:()=>q,TS:()=>F,UI:()=>s,VO:()=>a,WB:()=>$,Wd:()=>V,X0:()=>G,XP:()=>o,Z$:()=>u,ce:()=>D,cq:()=>L,d1:()=>v,dG:()=>j,dU:()=>W,e$:()=>y,e5:()=>U,ef:()=>Y,ei:()=>E,f0:()=>k,fj:()=>K,hX:()=>g,j7:()=>m,jj:()=>I,kJ:()=>O,mf:()=>p,o8:()=>h,oA:()=>x,r3:()=>N,rr:()=>H,sE:()=>A,u4:()=>w,vM:()=>B,xH:()=>function t(e){for(var r=[],n=0;n<e.length;n++){var o=e[n];Array.isArray(o)?r=r.concat(t(o)):r.push(o)}return r},xb:()=>n,yW:()=>S})},77262:(t,e,r)=>{class n extends Error{constructor(t,e,r){if(super(e),null==e&&null==r&&n.errorMap.has(t))return n.errorMap.get(t);null==e&&null==r?(this._error=t,n.errorMap.set(t,this)):this._error=t,this.details=r}get error(){return this._error}get name(){return this._error}equals(t){return t instanceof n&&t._error===this._error}toString(){return this._error}}n.errorMap=new Map,n.DIV0=new n("#DIV/0!"),n.NA=new n("#N/A"),n.NAME=new n("#NAME?"),n.NULL=new n("#NULL!"),n.NUM=new n("#NUM!"),n.REF=new n("#REF!"),n.VALUE=new n("#VALUE!"),n.NOT_IMPLEMENTED=t=>new n("#NAME?",`Function ${t} is not implemented.`),n.TOO_MANY_ARGS=t=>new n("#N/A",`Function ${t} has too many arguments.`),n.ARG_MISSING=t=>{let{Types:e}=r(74998);return new n("#N/A",`Argument type ${t.map(t=>e[t]).join(", ")} is missing.`)},n.ERROR=(t,e)=>new n("#ERROR!",t,e),t.exports=n},86396:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i=new Date(Date.UTC(1900,0,1)),s=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],c=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],u=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],l=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,f=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,h=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,p=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function d(t){return Math.floor((t-i)/864e5)+(t>-22038912e5?2:1)}function m(t){if(t instanceof Date)return{date:t};t=o.accept(t);let e=!0,r;return isNaN(t)?(r=function(t){let e=t.match(l);if(!e)return;let r=e[2]?e[2]:":00",n=e[3]?e[3]:":00",o=e[4]?" "+e[4]:"",a=new Date(Date.parse(`1/1/1900 ${e[1]+r+n+o} UTC`)),i=new Date;return new Date(Date.UTC((i=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()))).getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()))}(t))?e=!1:r=function(t){let e=t.match(f),r=t.match(h),n=t.match(p);return e?t=e[1]+e[3]+new Date().getFullYear()+e[5]:r?t=r[1]+r[3]+new Date().getFullYear()+r[5]:n&&(t=n[1]+n[3]+new Date().getFullYear()+n[5]),new Date(Date.parse(`${t} UTC`))}(t):r=function(t){if(t<0)throw n.VALUE;return new Date(t<=60?i.getTime()+(t-1)*864e5:i.getTime()+(t-2)*864e5)}(t=Number(t)),{date:r,isDateGiven:e}}function g(t){return m(t).date}function v(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}let E={DATE:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>=1e4)throw n.NUM;return t<1900&&(t+=1900),d(Date.UTC(t,e-1,r))},DATEDIF:(t,e,r)=>{if(t=g(t),e=g(e),r=o.accept(r,a.STRING).toLowerCase(),t>e)throw n.NUM;let i=e.getUTCFullYear()-t.getUTCFullYear(),s=e.getUTCMonth()-t.getUTCMonth(),c=e.getUTCDate()-t.getUTCDate();switch(r){case"y":return(s<0||0===s&&c<0?-1:0)+i;case"m":return 12*i+s+(c<0?-1:0);case"d":return Math.floor(e-t)/864e5;case"md":return t.setUTCFullYear(e.getUTCFullYear()),c<0?t.setUTCMonth(e.getUTCMonth()-1):t.setUTCMonth(e.getUTCMonth()),Math.floor(e-t)/864e5;case"ym":return((c<0?-1:0)+12*i+s)%12;case"yd":return s<0||0===s&&c<0?t.setUTCFullYear(e.getUTCFullYear()-1):t.setUTCFullYear(e.getUTCFullYear()),Math.floor(e-t)/864e5}},DATEVALUE:t=>{let{date:e,isDateGiven:r}=m(t=o.accept(t,a.STRING));if(!r)return 0;let i=d(e);if(i<0||i>2958465)throw n.VALUE;return i},DAY:t=>g(t).getUTCDate(),DAYS:(t,e)=>{t=g(t);let r=0;return(e=g(e))<-22038912e5&&-22038912e5<t&&(r=1),Math.floor(t-e)/864e5+r},DAYS360:(t,e,r)=>{t=g(t),e=g(e),r=o.accept(r,a.BOOLEAN,!1),31===t.getUTCDate()&&t.setUTCDate(30),!r&&30>t.getUTCDate()&&e.getUTCDate()>30?e.setUTCMonth(e.getUTCMonth()+1,1):31===e.getUTCDate()&&e.setUTCDate(30);let n=e.getUTCFullYear()-t.getUTCFullYear();return 30*(e.getUTCMonth()-t.getUTCMonth())+(e.getUTCDate()-t.getUTCDate())+360*n},EDATE:(t,e)=>(t=g(t),e=o.accept(e,a.NUMBER),t.setUTCMonth(t.getUTCMonth()+e),d(t)),EOMONTH:(t,e)=>(t=g(t),e=o.accept(e,a.NUMBER),t.setUTCMonth(t.getUTCMonth()+e+1,0),d(t)),HOUR:t=>g(t).getUTCHours(),ISOWEEKNUM:t=>{let e=g(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=r.getUTCDay();r.setUTCDate(r.getUTCDate()+4-n);let o=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r-o)/864e5+1)/7)},MINUTE:t=>g(t).getUTCMinutes(),MONTH:t=>g(t).getUTCMonth()+1,NETWORKDAYS:(t,e,r)=>{t=g(t);let n=1;if(t>(e=g(e))){n=-1;let r=t;t=e,e=r}let i=[];null!=r&&o.flattenParams([r],a.NUMBER,!1,t=>{i.push(g(t))});let s=0;for(;t<=e;){if(0!==t.getUTCDay()&&6!==t.getUTCDay()){let e=!1;for(let r=0;r<i.length;r++)if(v(t,i[r])){e=!0;break}!e&&s++}t.setUTCDate(t.getUTCDate()+1)}return n*s},"NETWORKDAYS.INTL":(t,e,r,i)=>{t=g(t);let s=1;if(t>(e=g(e))){s=-1;let r=t;t=e,e=r}if("1111111"===(r=o.accept(r,null,1)))return 0;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);let t=[];for(let e=0;e<r.length;e++)"1"===r.charAt(e)&&t.push(e);r=t}else{if("number"!=typeof r)throw n.VALUE;r=u[r]}let c=[];null!=i&&o.flattenParams([i],a.NUMBER,!1,t=>{c.push(g(t))});let l=0;for(;t<=e;){let e=!1;for(let n=0;n<r.length;n++)if(r[n]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let r=0;r<c.length;r++)if(v(t,c[r])){e=!0;break}!e&&l++}t.setUTCDate(t.getUTCDate()+1)}return s*l},NOW:()=>{let t=new Date;return d(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))+(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},SECOND:t=>g(t).getUTCSeconds(),TIME:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>32767||e<0||e>32767||r<0||r>32767)throw n.NUM;return(3600*t+60*e+r)/86400},TIMEVALUE:t=>(3600*(t=g(t)).getUTCHours()+60*t.getUTCMinutes()+t.getUTCSeconds())/86400,TODAY:()=>{let t=new Date;return d(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))},WEEKDAY:(t,e)=>{let r=g(t);e=o.accept(e,a.NUMBER,1);let i=r.getUTCDay(),s=c[e];if(!s)throw n.NUM;return s[i]},WEEKNUM:(t,e)=>{let r=g(t);if(21===(e=o.accept(e,a.NUMBER,1)))return E.ISOWEEKNUM(t);let n=s[e],i=new Date(Date.UTC(r.getUTCFullYear(),0,1)),c=i.getUTCDay()<n?1:0;return Math.ceil(((r-i)/864e5+1)/7)+c},WORKDAY:(t,e,r)=>E["WORKDAY.INTL"](t,e,1,r),"WORKDAY.INTL":(t,e,r,i)=>{if(t=g(t),e=o.accept(e,a.NUMBER),"1111111"===(r=o.accept(r,null,1)))throw n.VALUE;if("string"==typeof r&&Number(r).toString()!==r){if(7!==r.length)throw n.VALUE;r=r.charAt(6)+r.slice(0,6);let t=[];for(let e=0;e<r.length;e++)"1"===r.charAt(e)&&t.push(e);r=t}else{if("number"!=typeof r)throw n.VALUE;if(null==(r=u[r]))throw n.NUM}let s=[];null!=i&&o.flattenParams([i],a.NUMBER,!1,t=>{s.push(g(t))}),t.setUTCDate(t.getUTCDate()+1);let c=0;for(;c<e;){let e=!1;for(let n=0;n<r.length;n++)if(r[n]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let r=0;r<s.length;r++)if(v(t,s[r])){e=!0;break}!e&&c++}t.setUTCDate(t.getUTCDate()+1)}return d(t)-1},YEAR:t=>g(t).getUTCFullYear(),YEARFRAC:(t,e,r)=>{if((t=g(t))>(e=g(e))){let r=t;t=e,e=r}if((r=Math.trunc(r=o.accept(r,a.NUMBER,0)))<0||r>4)throw n.VALUE;let i=t.getUTCDate(),s=t.getUTCMonth()+1,c=t.getUTCFullYear(),u=e.getUTCDate(),l=e.getUTCMonth()+1,f=e.getUTCFullYear();switch(r){case 0:return 31===i&&31===u?(i=30,u=30):31===i?i=30:30===i&&31===u&&(u=30),Math.abs(u+30*l+360*f-(i+30*s+360*c))/360;case 1:if(f-c<2){let r=function(t){return 1900===t||1===new Date(t,1,29).getMonth()}(c)&&1900!==c?366:365;return E.DAYS(e,t)/r}{let r=f-c+1,n=(new Date(f+1,0,1)-new Date(c,0,1))/1e3/60/60/24;return E.DAYS(e,t)/(n/r)}case 2:return Math.abs(E.DAYS(e,t)/360);case 3:return Math.abs(E.DAYS(e,t)/365);case 4:return Math.abs(u+30*l+360*f-(i+30*s+360*c))/360}}};t.exports=E},7449:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i=r(61998),s=r(39300),c={"BETA.DIST":(t,e,r,s,c,u)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),c=o.accept(c,a.NUMBER,0),u=o.accept(u,a.NUMBER,1),e<=0||r<=0||t<c||t>u||c===u)throw n.NUM;return t=(t-c)/(u-c),s?i.beta.cdf(t,e,r):i.beta.pdf(t,e,r)/(u-c)},"BETA.INV":(t,e,r,s,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.NUMBER,0),c=o.accept(c,a.NUMBER,1),e<=0||r<=0||t<=0||t>1)throw n.NUM;return i.beta.inv(t,e,r)*(c-s)+s},"BINOM.DIST":(t,e,r,s)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),e<0||r<0||r>1||t<0||t>e)throw n.NUM;return s?i.binomial.cdf(t,e,r):i.binomial.pdf(t,e,r)},"BINOM.DIST.RANGE":(t,e,r,i)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.NUMBER,r),t<0||e<0||e>1||r<0||r>t||i<r||i>t)throw n.NUM;let c=0;for(let n=r;n<=i;n++)c+=s.COMBIN(t,n)*Math.pow(e,n)*Math.pow(1-e,t-n);return c},"BINOM.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||e<0||e>1||r<0||r>1)throw n.NUM;let s=0;for(;s<=t;){if(i.binomial.cdf(s,t,e)>=r)return s;s++}},"CHISQ.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),e=Math.trunc(e),t<0||e<1||e>1e10)throw n.NUM;return r?i.chisquare.cdf(t,e):i.chisquare.pdf(t,e)},"CHISQ.DIST.RT":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=Math.trunc(e=o.accept(e,a.NUMBER)),t<0||e<1||e>1e10)throw n.NUM;return 1-i.chisquare.cdf(t,e)},"CHISQ.INV":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=Math.trunc(e=o.accept(e,a.NUMBER)),t<0||t>1||e<1||e>1e10)throw n.NUM;return i.chisquare.inv(t,e)},"CHISQ.INV.RT":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=Math.trunc(e=o.accept(e,a.NUMBER)),t<0||t>1||e<1||e>1e10)throw n.NUM;return i.chisquare.inv(1-t,e)},"CHISQ.TEST":(t,e)=>{let r=o.accept(t,a.ARRAY,void 0,!1,!1),i=o.accept(e,a.ARRAY,void 0,!1,!1);if(r.length!==i.length||r[0].length!==i[0].length||1===r.length&&1===r[0].length)throw n.NA;let s=r.length,c=r[0].length,u=(s-1)*(c-1);u=1===s?c-1:s-1;let l=0;for(let t=0;t<s;t++)for(let e=0;e<c;e++)if("number"==typeof r[t][e]&&"number"==typeof i[t][e]){if(0===i[t][e])throw n.DIV0;l+=Math.pow(r[t][e]-i[t][e],2)/i[t][e]}let f=Math.exp(-.5*l);u%2==1&&(f*=Math.sqrt(2*l/Math.PI));let h=u;for(;h>=2;)f=f*l/h,h-=2;let p=f,d=u;for(;p>1e-15*f;)d+=2,f+=p=p*l/d;return 1-f},"CONFIDENCE.NORM":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=Math.trunc(r=o.accept(r,a.NUMBER)),t<=0||t>=1||e<=0||r<1)throw n.NUM;return i.normalci(1,t,e,r)[1]-1},"CONFIDENCE.T":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=Math.trunc(r=o.accept(r,a.NUMBER)),t<=0||t>=1||e<=0||r<1)throw n.NUM;if(1===r)throw n.DIV0;return i.tci(1,t,e,r)[1]-1},CORREL:(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;let r=[],s=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),s.push(e[n]));if(r.length<=1)throw n.DIV0;return i.corrcoeff(r,s)},"COVARIANCE.P":(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;let r=[],s=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),s.push(e[n]));let c=i.mean(r),u=i.mean(s),l=0;for(let t=0;t<r.length;t++)l+=(r[t]-c)*(s[t]-u);return l/r.length},"COVARIANCE.S":(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0),t.length!==e.length)throw n.NA;let r=[],s=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),s.push(e[n]));if(r.length<=1)throw n.DIV0;return i.covariance(r,s)},DEVSQ:(...t)=>{let e=0,r=[];o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r.push(t))});let n=e/r.length;e=0;for(let t=0;t<r.length;t++)e+=(r[t]-n)**2;return e},"EXPON.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.BOOLEAN),t<0||e<=0)throw n.NUM;return r?i.exponential.cdf(t,e):i.exponential.pdf(t,e)},"F.DIST":(t,e,r,s)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),t<0||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),s?i.centralF.cdf(t,e,r):i.centralF.pdf(t,e,r)},"F.DIST.RT":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),1-i.centralF.cdf(t,e,r)},"F.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>1||e<1||r<1)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),i.centralF.inv(t,e,r)},"F.INV.RT":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>1||e<1||e>=1e10||r<1||r>=1e10)throw n.NUM;return e=Math.trunc(e),r=Math.trunc(r),i.centralF.inv(1-t,e,r)},"F.TEST":(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0);let r=[],s=[],c=0,u=0;for(let n=0;n<Math.max(t.length,e.length);n++)"number"==typeof t[n]&&(r.push(t[n]),c+=t[n]),"number"==typeof e[n]&&(s.push(e[n]),u+=e[n]);if(r.length<=1||s.length<=1)throw n.DIV0;c/=r.length,u/=s.length;let l=0,f=0;for(let t=0;t<r.length;t++)l+=(c-r[t])**2;l/=r.length-1;for(let t=0;t<s.length;t++)f+=(u-s[t])**2;return f/=s.length-1,2*i.centralF.cdf(l/f,r.length-1,s.length-1)},FISHER:t=>{if((t=o.accept(t,a.NUMBER))<=-1||t>=1)throw n.NUM;return Math.log((1+t)/(1-t))/2},FISHERINV:t=>{let e=Math.exp(2*(t=o.accept(t,a.NUMBER)));return(e-1)/(e+1)},FORECAST:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.ARRAY,void 0,!0,!0),(r=o.accept(r,a.ARRAY,void 0,!0,!0)).length!==e.length)throw n.NA;let s=[],c=[],u=!0;for(let t=0;t<e.length;t++)"number"==typeof e[t]&&"number"==typeof r[t]&&(s.push(e[t]),c.push(r[t]),r[t]!==r[0]&&(u=!1));if(u)throw n.DIV0;let l=i.mean(s),f=i.mean(c),h=0,p=0;for(let t=0;t<s.length;t++)h+=(c[t]-f)*(s[t]-l),p+=(c[t]-f)**2;let d=h/p;return l-d*f+d*t},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...t)=>c.FORECAST(...t),FREQUENCY:(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!0,!0),e=o.accept(e,a.ARRAY,void 0,!0,!0);let r=[];for(let t=0;t<e.length;t++)"number"==typeof e[t]&&r.push(e[t]);r.sort(),r.push(1/0);let n=[];for(let e=0;e<r.length;e++){n[e]=[],n[e][0]=0;for(let o=0;o<t.length;o++)"number"==typeof t[o]&&t[o]<=r[e]&&(n[e][0]++,t[o]=null)}return n},GAMMA:t=>{if(0===(t=o.accept(t,a.NUMBER))||t<0&&t===Math.trunc(t))throw n.NUM;return i.gammafn(t)},"GAMMA.DIST":(t,e,r,s)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),t<0||e<=0||r<=0)throw n.NUM;return s?i.gamma.cdf(t,e,r,!0):i.gamma.pdf(t,e,r,!1)},"GAMMA.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<0||t>1||e<=0||r<=0)throw n.NUM;return i.gamma.inv(t,e,r)},GAMMALN:t=>{if((t=o.accept(t,a.NUMBER))<=0)throw n.NUM;return i.gammaln(t)},"GAMMALN.PRECISE":t=>{if((t=o.accept(t,a.NUMBER))<=0)throw n.NUM;return i.gammaln(t)},GAUSS:t=>(t=o.accept(t,a.NUMBER),i.normal.cdf(t,0,1)-.5),GEOMEAN:(...t)=>{let e=[];return o.flattenParams(t,a.NUMBER,!0,(t,r)=>{"number"==typeof t&&e.push(t)}),i.geomean(e)},GROWTH:(t,e,r,i)=>{let s,c;t=o.accept(t,a.ARRAY,void 0,!0,!0);for(let e=0;e<t.length;e++)if("number"!=typeof t[e])throw n.VALUE;let u=null==(e=o.accept(e,a.ARRAY,null,!0,!0));if(null==e){e=[];for(let r=1;r<=t.length;r++)e.push(r)}else{if(e.length!==t.length)throw n.REF;for(let t=0;t<e.length;t++)if("number"!=typeof e[t])throw n.VALUE}if(null==(r=o.accept(r,a.ARRAY,null,!1,!0))&&u){r=[];for(let e=1;e<=t.length;e++)r.push(e);r=[r]}else null==r&&(r=Array.isArray(e[0])?e:[e]);i=o.accept(i,a.BOOLEAN,!0);let l=t.length,f=0,h=0,p=0,d=0;for(let r=0;r<l;r++){let n=e[r],o=Math.log(t[r]);f+=n,h+=o,p+=n*o,d+=n*n}f/=l,h/=l,p/=l,d/=l,i?(s=(p-f*h)/(d-f*f),c=h-s*f):(s=p/d,c=0);let m=[];for(let t=0;t<r.length;t++){m[t]=[];for(let e=0;e<r[0].length;e++){if("number"!=typeof r[t][e])throw n.VALUE;m[t][e]=Math.exp(c+s*r[t][e])}}return m},HARMEAN:(...t)=>{let e=0,r=0;return o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(r+=1/t,e++)}),e/r},"HYPGEOM.DIST":(t,e,r,i,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.NUMBER),c=o.accept(c,a.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r=Math.trunc(r),(i=Math.trunc(i))<=0||t<0||e<=0||r<=0||e>i||r>i||e<t||r<t||t<e-i+r)throw n.NUM;function u(t,e,r,n){return s.COMBIN(r,t)*s.COMBIN(n-r,e-t)/s.COMBIN(n,e)}return c?function(t,e,r,n){let o=0;for(let a=0;a<=t;a++)o+=u(a,e,r,n);return o}(t,e,r,i):u(t,e,r,i)},INTERCEPT:(t,e)=>{if(t=o.accept(t,a.ARRAY,void 0,!0,!0),(e=o.accept(e,a.ARRAY,void 0,!0,!0)).length!==t.length)throw n.NA;let r=[],s=[];for(let n=0;n<t.length;n++)"number"==typeof t[n]&&"number"==typeof e[n]&&(r.push(t[n]),s.push(e[n]));if(r.length<=1)throw n.DIV0;let c=i.mean(r),u=i.mean(s),l=0,f=0;for(let t=0;t<r.length;t++)l+=(s[t]-u)*(r[t]-c),f+=(s[t]-u)**2;return c-l/f*u},KURT:(...t)=>{let e=0,r=[];o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r.push(t))});let n=r.length;e/=n;let s=0;for(let t=0;t<n;t++)s+=Math.pow(r[t]-e,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(s/=Math.pow(i.stdev(r,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(t,e,r,s)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),t<=0||r<=0)throw n.NUM;return s?i.lognormal.cdf(t,e,r):i.lognormal.pdf(t,e,r)},"LOGNORM.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<=0||t>=1||r<=0)throw n.NUM;return i.lognormal.inv(t,e,r)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(t,e,r,s)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r<0||r>1||t<0||e<1)throw n.NUM;return s?i.negbin.cdf(t,e,r):i.negbin.pdf(t,e,r)},"NORM.DIST":(t,e,r,s)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN),r<=0)throw n.NUM;return s?i.normal.cdf(t,e,r):i.normal.pdf(t,e,r)},"NORM.INV":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),t<=0||t>=1||r<=0)throw n.NUM;return i.normal.inv(t,e,r)},"NORM.S.DIST":(t,e)=>(t=o.accept(t,a.NUMBER),(e=o.accept(e,a.BOOLEAN))?i.normal.cdf(t,0,1):i.normal.pdf(t,0,1)),"NORM.S.INV":t=>{if((t=o.accept(t,a.NUMBER))<=0||t>=1)throw n.NUM;return i.normal.inv(t,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:t=>Math.exp(-.5*(t=o.accept(t,a.NUMBER))*t)/2.5066282746310002,"POISSON.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.BOOLEAN),t<0||e<0)throw n.NUM;return t=Math.trunc(t),r?i.poisson.cdf(t,e):i.poisson.pdf(t,e)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),(r=o.accept(r,a.NUMBER))<=0)throw n.NUM;return(t-e)/r},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.BOOLEAN),e<1)throw n.NUM;return r?i.studentt.cdf(t,e):i.studentt.pdf(t,e)},"T.DIST.2T":(t,e)=>{if(t=o.accept(t,a.NUMBER),(e=o.accept(e,a.NUMBER))<1||t<0)throw n.NUM;return(1-i.studentt.cdf(t,e))*2},"T.DIST.RT":(t,e)=>{if(t=o.accept(t,a.NUMBER),(e=o.accept(e,a.NUMBER))<1)throw n.NUM;return 1-i.studentt.cdf(t,e)},"T.INV":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),t<=0||t>1||e<1)throw n.NUM;return e=e%1==0?e:Math.trunc(e),i.studentt.inv(t,e)},"T.INV.2T":(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),t<=0||t>1||e<1)throw n.NUM;return e=e%1==0?e:Math.trunc(e),Math.abs(i.studentt.inv(t/2,e))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(t,e,r,i)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),i=o.accept(i,a.BOOLEAN),t<0||e<=0||r<=0)throw n.NUM;return i?1-Math.exp(-Math.pow(t/r,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/r,e))*e/Math.pow(r,e)},"Z.TEST":()=>{}};t.exports={DistributionFunctions:c}},48327:(t,e,r)=>{let n=r(77262),o=r(32156),{FormulaHelpers:a,Types:i}=r(74998),s=r(51198),c=r(61998),u=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,l=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,f=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function h(t){t=a.accept(t);let e=0,r=0,o="i";if("number"==typeof t)return{real:t,im:r,unit:o};if("boolean"==typeof t)throw n.VALUE;let i=t.match(u);if(i)return{real:e=Number(i[0]),im:r,unit:o};if(i=t.match(l))return{real:e,im:r=Number(/^\s?[+-]?\s?$/.test(i[1])?i[1]+"1":i[1]),unit:o=i[0].slice(-1)};if(i=t.match(f))return{real:e=Number(i[1]),im:r=Number(/^\s?[+-]?\s?$/.test(i[3])?i[3]+"1":i[3]),unit:o=i[0].slice(-1)};throw n.NUM}let p={BESSELI:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.besseli(t,e)},BESSELJ:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.besselj(t,e)},BESSELK:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.besselk(t,e)},BESSELY:(t,e)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),(e=Math.trunc(e=a.accept(e,i.NUMBER_NO_BOOLEAN)))<0)throw n.NUM;return s.bessely(t,e)},BIN2DEC:t=>{let e=(t=a.accept(t,i.NUMBER_NO_BOOLEAN)).toString();if(e.length>10)throw n.NUM;return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)+-512:parseInt(e,2)},BIN2HEX:(t,e)=>{t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER_NO_BOOLEAN,null);let r=t.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substring(0,1))return(parseInt(r.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();let s=parseInt(t,2).toString(16);if(null==e)return s.toUpperCase();if(e<0)throw n.NUM;if((e=Math.trunc(e))>=s.length)return(o.REPT("0",e-s.length)+s).toUpperCase();throw n.NUM},BIN2OCT:(t,e)=>{t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER,null);let r=t.toString();if(r.length>10)throw n.NUM;if(10===r.length&&"1"===r.substr(0,1))return(parseInt(r.substr(1),2)+1073741312).toString(8);let s=parseInt(t,2).toString(8);if(null==e)return s.toUpperCase();if(e<0)throw n.NUM;if((e=Math.trunc(e))>=s.length)return o.REPT("0",e-s.length)+s;throw n.NUM},BITAND:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>0xffffffffffff||e>0xffffffffffff)throw n.NUM;return t&e},BITLSHIFT:(t,e)=>{if(t=a.accept(t,i.NUMBER),Math.abs(e=Math.trunc(e=a.accept(e,i.NUMBER)))>53||t<0||Math.floor(t)!==t||t>0xffffffffffff)throw n.NUM;let r=e>=0?t*2**e:Math.trunc(t/2**-e);if(!(r>0xffffffffffff))return r;throw n.NUM},BITOR:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>0xffffffffffff||e>0xffffffffffff)throw n.NUM;return t|e},BITRSHIFT:(t,e)=>(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),p.BITLSHIFT(t,-e)),BITXOR:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),t<0||t>0xffffffffffff||Math.floor(t)!==t||e<0||e>0xffffffffffff||Math.floor(e)!==e)throw n.NUM;return t^e},COMPLEX:(t,e,r)=>{if(t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER_NO_BOOLEAN),"i"!==(r=a.accept(r,i.STRING,"i"))&&"j"!==r)throw n.VALUE;if(0===t&&0===e)return 0;if(0===t)return 1===e?r:-1===e?"-"+r:e.toString()+r;if(0===e)return t.toString();{let n=e>0?"+":"";return 1===e?t.toString()+n+r:-1===e?t.toString()+n+"-"+r:t.toString()+n+e.toString()+r}},DEC2BIN:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER,null),t<-512||t>511)throw n.NUM;if(t<0)return"1"+o.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);let r=parseInt(t,10).toString(2);if(null==e)return r;if((e=Math.trunc(e))<=0||e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r},DEC2HEX:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER,null),t<-549755813888||t>549755813888)throw n.NUM;if(t<0)return(1099511627776+t).toString(16).toUpperCase();let r=parseInt(t,10).toString(16);if(null==e)return r.toUpperCase();if((e=Math.trunc(e))<=0||e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r.toUpperCase()},DEC2OCT:(t,e)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER,null),t<-536870912||t>536870912)throw n.NUM;if(t<0)return(t+1073741824).toString(8);let r=parseInt(t,10).toString(8);if(null==e)return r.toUpperCase();if((e=Math.trunc(e))<=0||e<r.length)throw n.NUM;return o.REPT("0",e-r.length)+r},DELTA:(t,e)=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN))===(e=a.accept(e,i.NUMBER_NO_BOOLEAN,0))?1:0,ERF:(t,e)=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN),e=a.accept(e,i.NUMBER_NO_BOOLEAN,0),c.erf(t)),ERFC:t=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN),c.erfc(t)),GESTEP:(t,e)=>(t=a.accept(t,i.NUMBER_NO_BOOLEAN))>=(e=a.accept(e,i.NUMBER_NO_BOOLEAN,0))?1:0,HEX2BIN:(t,e)=>{if(t=a.accept(t,i.STRING),e=a.accept(e,i.NUMBER,null),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let r=10===t.length&&"f"===t.substr(0,1).toLowerCase(),s=r?parseInt(t,16)-1099511627776:parseInt(t,16);if(s<-512||s>511)throw n.NUM;if(r)return"1"+o.REPT("0",9-(s+512).toString(2).length)+(s+512).toString(2);let c=s.toString(2);if(null==e)return c;if((e=Math.trunc(e))<=0||e<c.length)throw n.NUM;return o.REPT("0",e-c.length)+c},HEX2DEC:t=>{if((t=a.accept(t,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},HEX2OCT:(t,e)=>{if((t=a.accept(t,i.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw n.NUM;let r=p.HEX2DEC(t);if(r>536870911||r<-536870912)throw n.NUM;return p.DEC2OCT(r,e)},IMABS:t=>{let{real:e,im:r}=h(t);return Math.sqrt(Math.pow(e,2)+Math.pow(r,2))},IMAGINARY:t=>h(t).im,IMARGUMENT:t=>{let{real:e,im:r}=h(t);if(0===e&&0===r)throw n.DIV0;return 0===e&&r>0?Math.PI/2:0===e&&r<0?-Math.PI/2:e<0&&0===r?Math.PI:e>0&&0===r?0:e>0?Math.atan(r/e):e<0&&r>0?Math.atan(r/e)+Math.PI:Math.atan(r/e)-Math.PI},IMCONJUGATE:t=>{let{real:e,im:r,unit:n}=h(t);return 0!==r?p.COMPLEX(e,-r,n):""+e},IMCOS:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.cos(e)*(Math.exp(r)+Math.exp(-r))/2,a=-Math.sin(e)*(Math.exp(r)-Math.exp(-r))/2;return p.COMPLEX(o,a,n)},IMCOSH:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.cos(r)*(Math.exp(e)+Math.exp(-e))/2,a=-Math.sin(r)*(Math.exp(e)-Math.exp(-e))/2;return p.COMPLEX(o,-a,n)},IMCOT:t=>{t=a.accept(t);let e=p.IMCOS(t),r=p.IMSIN(t);return p.IMDIV(e,r)},IMCSC:t=>(t=a.accept(t),p.IMDIV("1",p.IMSIN(t))),IMCSCH:t=>(t=a.accept(t),p.IMDIV("1",p.IMSINH(t))),IMDIV:(t,e)=>{let r=h(t),o=r.real,a=r.im,i=r.unit,s=h(e),c=s.real,u=s.im,l=s.unit;if(0===c&&0===u||i!==l)throw n.NUM;let f=Math.pow(c,2)+Math.pow(u,2);return p.COMPLEX((o*c+a*u)/f,(a*c-o*u)/f,i)},IMEXP:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.exp(e);return p.COMPLEX(o*Math.cos(r),o*Math.sin(r),n)},IMLN:t=>{let{real:e,im:r,unit:n}=h(t);return p.COMPLEX(Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2))),Math.atan(r/e),n)},IMLOG10:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(10),a=Math.atan(r/e)/Math.log(10);return p.COMPLEX(o,a,n)},IMLOG2:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(2),a=Math.atan(r/e)/Math.log(2);return p.COMPLEX(o,a,n)},IMPOWER:(t,e)=>{let{unit:r}=h(t);e=a.accept(e,i.NUMBER_NO_BOOLEAN);let n=Math.pow(p.IMABS(t),e),o=p.IMARGUMENT(t),s=n*Math.cos(e*o),c=n*Math.sin(e*o);return p.COMPLEX(s,c,r)},IMPRODUCT:(...t)=>{let e;let r=0;return a.flattenParams(t,null,!1,t=>{if(0===r)h(e=a.accept(t));else{let r=h(e),o=r.real,a=r.im,i=r.unit,s=h(t),c=s.real,u=s.im;if(i!==s.unit)throw n.VALUE;e=p.COMPLEX(o*c-a*u,o*u+a*c)}r++},1),e},IMREAL:t=>h(t).real,IMSEC:t=>p.IMDIV("1",p.IMCOS(t)),IMSECH:t=>p.IMDIV("1",p.IMCOSH(t)),IMSIN:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.sin(e)*(Math.exp(r)+Math.exp(-r))/2,a=Math.cos(e)*(Math.exp(r)-Math.exp(-r))/2;return p.COMPLEX(o,a,n)},IMSINH:t=>{let{real:e,im:r,unit:n}=h(t),o=Math.cos(r)*(Math.exp(e)-Math.exp(-e))/2,a=Math.sin(r)*(Math.exp(e)+Math.exp(-e))/2;return p.COMPLEX(o,a,n)},IMSQRT:t=>{let{unit:e}=h(t),r=Math.sqrt(p.IMABS(t)),n=p.IMARGUMENT(t);return p.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),e)},IMSUB:(t,e)=>{let r=h(t),o=r.real,a=r.im,i=r.unit,s=h(e),c=s.real,u=s.im;if(i!==s.unit)throw n.VALUE;return p.COMPLEX(o-c,a-u,i)},IMSUM:(...t)=>{let e=0,r=0,o;return a.flattenParams(t,null,!1,t=>{let{real:a,im:i,unit:s}=h(t);if(o||(o=s),o!==s)throw n.VALUE;e+=a,r+=i}),p.COMPLEX(e,r,o)},IMTAN:t=>{let{unit:e}=h(t);return p.IMDIV(p.IMSIN(t),p.IMCOS(t),e)},OCT2BIN:(t,e)=>{if(t=a.accept(t,i.STRING),e=a.accept(e,i.NUMBER,null),t.length>10||e>10||null!==e&&e<0)throw n.NUM;e=Math.trunc(e);let r=10===t.length&&"7"===t.substring(0,1),s=p.OCT2DEC(t);if(s<-512||s>511)return n.NUM;if(r)return"1"+o.REPT("0",9-(512+s).toString(2).length)+(512+s).toString(2);let c=s.toString(2);if(0===e)return c;if(e<c.length)throw n.NUM;return o.REPT("0",e-c.length)+c},OCT2DEC:t=>{if((t=a.accept(t,i.STRING)).length>10)throw n.NUM;for(let e of t)if(e<"0"||e>"7")throw n.NUM;let e=parseInt(t,8);return e>=536870912?e-1073741824:e},OCT2HEX:(t,e)=>{if(t=a.accept(t,i.STRING),e=a.accept(e,i.NUMBER_NO_BOOLEAN,null),t.length>10)throw n.NUM;for(let e of t)if(e<"0"||e>"7")throw n.NUM;if((e=Math.trunc(e))<0||e>10)throw n.NUM;let r=p.OCT2DEC(t),s=p.DEC2HEX(r);if(0===e)return s;if(!(e<s.length))return o.REPT("0",e-s.length)+s;throw n.NUM}};t.exports=p},41257:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},s={CELL:(t,e)=>{},"ERROR.TYPE":t=>{if((t=o.accept(t))instanceof n)return i[t.toString()];throw n.NA},INFO:()=>{},ISBLANK:t=>!!t.ref&&(null==t.value||""===t.value),ISERR:t=>(t=o.accept(t))instanceof n&&"#N/A"!==t.toString(),ISERROR:t=>(t=o.accept(t))instanceof n,ISEVEN:t=>(t=Math.trunc(t=o.accept(t,a.NUMBER)))%2==0,ISLOGICAL:t=>"boolean"==typeof(t=o.accept(t)),ISNA:t=>(t=o.accept(t))instanceof n&&"#N/A"===t.toString(),ISNONTEXT:t=>"string"!=typeof(t=o.accept(t)),ISNUMBER:t=>"number"==typeof(t=o.accept(t)),ISREF:t=>!(!t.ref||o.isCellRef(t)&&(t.ref.row>1048576||t.ref.col>16384)||o.isRangeRef(t)&&(t.ref.from.row>1048576||t.ref.from.col>16384||t.ref.to.row>1048576||t.ref.to.col>16384))&&!((t=o.accept(t))instanceof n&&"#REF!"===t.toString()),ISTEXT:t=>"string"==typeof(t=o.accept(t)),N:t=>{let e=typeof(t=o.accept(t));if("number"===e)return t;if("boolean"===e)return Number(t);if(t instanceof n)throw t;return 0},NA:()=>{throw n.NA},TYPE:t=>{if(t.ref){if(o.isRangeRef(t))return 16;if(o.isCellRef(t)&&"string"==typeof(t=o.accept(t))&&0===t.length)return 1}let e=typeof(t=o.accept(t));return"number"===e?1:"string"===e?2:"boolean"===e?4:t instanceof n?16:Array.isArray(t)?64:void 0}};t.exports=s},58462:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998);function i(t){let e=0,r=0;return o.flattenParams(t,null,!0,t=>{let n=typeof t;"string"===n?"TRUE"===t?t=!0:"FALSE"===t&&(t=!1):"number"===n&&(t=!!t),"boolean"==typeof t&&(!0===t?e++:r++)}),[e,r]}let s={AND:(...t)=>{let[e,r]=i(t);return 0===e&&0===r?n.VALUE:e>0&&0===r},FALSE:()=>!1,IF:(t,e,r,n)=>(e=o.accept(e,a.BOOLEAN),r=o.accept(r),n=o.accept(n,null,!1),e?r:n),IFERROR:(t,e)=>t.value instanceof n?o.accept(e):o.accept(t),IFNA:function(t,e){if(arguments.length>2)throw n.TOO_MANY_ARGS("IFNA");return n.NA.equals(t.value)?o.accept(e):o.accept(t)},IFS:(...t)=>{if(t.length%2!=0)return new n("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let e=0;e<t.length/2;e++){let r=o.accept(t[2*e],a.BOOLEAN),n=o.accept(t[2*e+1]);if(r)return n}return n.NA},NOT:t=>!(t=o.accept(t,a.BOOLEAN)),OR:(...t)=>{let[e,r]=i(t);return 0===e&&0===r?n.VALUE:e>0},SWITCH:(...t)=>{},TRUE:()=>!0,XOR:(...t)=>{let[e,r]=i(t);return 0===e&&0===r?n.VALUE:e%2==1}};t.exports=s},39300:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,Factorials:i,Criteria:s}=r(74998),{Infix:c}=r(69520),u=[],l=[];function f(t){return t<=100?i[t]:u[t]>0?u[t]:u[t]=f(t-1)*t}let h={ABS:t=>Math.abs(t=o.accept(t,a.NUMBER)),AGGREGATE:(t,e,r,...n)=>{},ARABIC:t=>{if(t=o.accept(t,a.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))throw new n("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(t){e+=({M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1})[t]}),e},BASE:(t,e,r)=>{if((t=o.accept(t,a.NUMBER))<0||t>=9007199254740992||(e=o.accept(e,a.NUMBER))<2||e>36||(r=o.accept(r,a.NUMBER,0))<0)throw n.NUM;let i=t.toString(e).toUpperCase();return Array(Math.max(r+1-i.length,0)).join("0")+i},CEILING:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))return 0;if(t/e%1==0)return t;let r=Math.abs(e),n=Math.floor(Math.abs(t)/r);return t<0?e<0?-r*(n+1):-r*n:(n+1)*r},"CEILING.MATH":(t,e,r)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,t>0?1:-1),r=o.accept(r,a.NUMBER,0),t>=0)return h.CEILING(t,e);let n=r?e:0;return h.CEILING(t,e)-n},"CEILING.PRECISE":(t,e)=>(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,1),h.CEILING(t,Math.abs(e))),COMBIN:(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),t<0||e<0||t<e)throw n.NUM;return h.FACT(t)/h.FACT(e)/h.FACT(t-e)},COMBINA:(t,e)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),(0===t||1===t)&&0===e)return 1;if(t<0||e<0)throw n.NUM;return h.COMBIN(t+e-1,t-1)},DECIMAL:(t,e)=>{if(t=o.accept(t,a.STRING),(e=Math.trunc(e=o.accept(e,a.NUMBER)))<2||e>36)throw n.NUM;let r=parseInt(t,e);if(isNaN(r))throw n.NUM;return r},DEGREES:t=>180/Math.PI*(t=o.accept(t,a.NUMBER)),EVEN:t=>h.CEILING(t,-2),EXP:t=>Math.exp(t=o.accept(t,a.NUMBER)),FACT:t=>{if((t=Math.trunc(t=o.accept(t,a.NUMBER)))>170||t<0)throw n.NUM;return t<=100?i[t]:f(t)},FACTDOUBLE:t=>{if((t=Math.trunc(t=o.accept(t,a.NUMBER)))<-1)throw n.NUM;return -1===t?1:function t(e){return 1===e||0===e?1:2===e?2:l[e]>0?l[e]:l[e]=t(e-2)*e}(t)},FLOOR:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))return 0;if(t>0&&e<0)throw n.NUM;if(t/e%1==0)return t;let r=Math.abs(e),i=Math.floor(Math.abs(t)/r);return t<0?e<0?-r*i:-r*(i+1):i*r},"FLOOR.MATH":(t,e,r)=>(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,t>0?1:-1),0===(r=o.accept(r,a.NUMBER,0))||t>=0)?h.FLOOR(t,Math.abs(e)):h.FLOOR(t,e)+e,"FLOOR.PRECISE":(t,e)=>(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,1),h.FLOOR(t,Math.abs(e))),GCD:(...t)=>{let e=[];o.flattenParams(t,null,!1,t=>{if(isNaN(t="boolean"==typeof t?NaN:Number(t)))throw n.VALUE;if(t<0||t>9007199254740990)throw n.NUM;e.push(Math.trunc(t))},0);let r,a,i=t.length,s=Math.abs(e[0]);for(r=1;r<i;r++){for(a=Math.abs(e[r]);s&&a;)s>a?s%=a:a%=s;s+=a}return s},INT:t=>Math.floor(t=o.accept(t,a.NUMBER)),"ISO.CEILING":(...t)=>h["CEILING.PRECISE"](...t),LCM:(...t)=>{let e=[];o.flattenParams(t,null,!1,t=>{if(isNaN(t="boolean"==typeof t?NaN:Number(t)))throw n.VALUE;if(t<0||t>9007199254740990)throw n.NUM;e.push(Math.trunc(t))},1);let r=e.length,a=Math.abs(e[0]);for(let t=1;t<r;t++){let r=Math.abs(e[t]),n=a;for(;a&&r;)a>r?a%=r:r%=a;a=Math.abs(n*e[t])/(a+r)}return a},LN:t=>Math.log(t=o.accept(t,a.NUMBER)),LOG:(t,e)=>Math.log(t=o.accept(t,a.NUMBER))/Math.log(e=o.accept(e,a.NUMBER,10)),LOG10:t=>Math.log10(t=o.accept(t,a.NUMBER)),MDETERM:t=>{if((t=o.accept(t,a.ARRAY,void 0,!1,!0))[0].length!==t.length)throw n.VALUE;let e=t.length,r=t[0].length,i=0,s,c;if(1===e)return t[0][0];if(2===e)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(let n=0;n<r;n++){s=t[0][n],c=t[0][n];for(let o=1;o<e;o++)c*=t[o][((n+o)%r+r)%r],s*=t[o][((n-o)%r+r)%r];i+=c-s}return i},MINVERSE:t=>{},MMULT:(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!1,!0),e=o.accept(e,a.ARRAY,void 0,!1,!0);let r=t.length,i=t[0].length,s=e.length,c=e[0].length,u=Array(r);if(i!==s)throw n.VALUE;for(let o=0;o<r;o++){u[o]=Array(c);for(let r=0;r<c;r++){u[o][r]=0;for(let a=0;a<i;a++){let i=t[o][a],s=e[a][r];if("number"!=typeof i||"number"!=typeof s)throw n.VALUE;u[o][r]+=t[o][a]*e[a][r]}}}return u},MOD:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))throw n.DIV0;return t-e*h.INT(t/e)},MROUND:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER)))return 0;if(t>0&&e<0||t<0&&e>0)throw n.NUM;return t/e%1==0?t:Math.round(t/e)*e},MULTINOMIAL:(...t)=>{let e=0,r=1;return o.flattenParams(t,a.NUMBER,!1,t=>{if(t<0)throw n.NUM;e+=t,r*=f(t)}),f(e)/r},MUNIT:t=>{t=o.accept(t,a.NUMBER);let e=[];for(let r=0;r<t;r++){let n=[];for(let e=0;e<t;e++)r===e?n.push(1):n.push(0);e.push(n)}return e},ODD:t=>{if(0===(t=o.accept(t,a.NUMBER)))return 1;let e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},PI:()=>Math.PI,POWER:(t,e)=>(t=o.accept(t,a.NUMBER))**(e=o.accept(e,a.NUMBER)),PRODUCT:(...t)=>{let e=1;return o.flattenParams(t,null,!0,(t,r)=>{let n=Number(t);r.isLiteral&&!isNaN(n)?e*=n:"number"==typeof t&&(e*=t)},1),e},QUOTIENT:(t,e)=>Math.trunc((t=o.accept(t,a.NUMBER))/(e=o.accept(e,a.NUMBER))),RADIANS:t=>(t=o.accept(t,a.NUMBER))/180*Math.PI,RAND:()=>Math.random(),RANDBETWEEN:(t,e)=>(t=o.accept(t,a.NUMBER),Math.floor(Math.random()*((e=o.accept(e,a.NUMBER))-t+1)+t)),ROMAN:(t,e)=>{if(t=o.accept(t,a.NUMBER),0!==(e=o.accept(e,a.NUMBER,0)))throw Error("ROMAN: only allows form=0 (classic form).");let r=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",s=3;for(;s--;)i=(n[+r.pop()+10*s]||"")+i;return Array(+r.join("")+1).join("M")+i},ROUND:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Math.pow(10,Math.abs(e=o.accept(e,a.NUMBER))),n=t>0?1:-1;return e>0?n*Math.round(Math.abs(t)*r)/r:0===e?n*Math.round(Math.abs(t)):n*Math.round(Math.abs(t)/r)*r},ROUNDDOWN:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Math.pow(10,Math.abs(e=o.accept(e,a.NUMBER))),n=t>0?1:-1;return e>0?n*Math.round((Math.abs(t)-1/r*.5)*r)/r:0===e?n*Math.round(Math.abs(t)-.5):n*Math.round((Math.abs(t)-.5*r)/r)*r},ROUNDUP:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Math.pow(10,Math.abs(e=o.accept(e,a.NUMBER))),n=t>0?1:-1;return e>0?n*Math.round((Math.abs(t)+1/r*.5)*r)/r:0===e?n*Math.round(Math.abs(t)+.5):n*Math.round((Math.abs(t)+.5*r)/r)*r},SERIESSUM:(t,e,r,i)=>{t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER);let s=0,c;return o.flattenParams([i],a.NUMBER,!1,o=>{if("number"!=typeof o)throw n.VALUE;0===s?c=o*Math.pow(t,e):c+=o*Math.pow(t,e+s*r),s++}),c},SIGN:t=>(t=o.accept(t,a.NUMBER))>0?1:0===t?0:-1,SQRT:t=>{if((t=o.accept(t,a.NUMBER))<0)throw n.NUM;return Math.sqrt(t)},SQRTPI:t=>{if((t=o.accept(t,a.NUMBER))<0)throw n.NUM;return Math.sqrt(t*Math.PI)},SUBTOTAL:()=>{},SUM:(...t)=>{let e=0;return o.flattenParams(t,a.NUMBER,!0,(t,r)=>{r.isLiteral?e+=t:"number"==typeof t&&(e+=t)}),e},SUMIF:(t,e,r,n)=>{let a=o.retrieveRanges(t,e,n);e=a[0],n=a[1];let i=(r=o.retrieveArg(t,r)).isArray;r=s.parse(o.accept(r));let u=0;return e.forEach((t,e)=>{t.forEach((t,o)=>{let a=n[e][o];"number"==typeof a&&("wc"===r.op?r.match===r.value.test(t)&&(u+=a):c.compareOp(t,r.op,r.value,Array.isArray(t),i)&&(u+=a))})}),u},SUMIFS:()=>{},SUMPRODUCT:(t,...e)=>{t=o.accept(t,a.ARRAY,void 0,!1,!0),e.forEach(e=>{if(e=o.accept(e,a.ARRAY,void 0,!1,!0),t[0].length!==e[0].length||t.length!==e.length)throw n.VALUE;for(let r=0;r<t.length;r++)for(let n=0;n<t[0].length;n++)"number"!=typeof t[r][n]&&(t[r][n]=0),"number"!=typeof e[r][n]&&(e[r][n]=0),t[r][n]*=e[r][n]});let r=0;return t.forEach(t=>{t.forEach(t=>{r+=t})}),r},SUMSQ:(...t)=>{let e=0;return o.flattenParams(t,a.NUMBER,!0,(t,r)=>{r.isLiteral?e+=t**2:"number"==typeof t&&(e+=t**2)}),e},SUMX2MY2:(t,e)=>{let r=[],a=[],i=0;if(o.flattenParams([t],null,!1,(t,e)=>{r.push(t)}),o.flattenParams([e],null,!1,(t,e)=>{a.push(t)}),r.length!==a.length)throw n.NA;for(let t=0;t<r.length;t++)"number"==typeof r[t]&&"number"==typeof a[t]&&(i+=r[t]**2-a[t]**2);return i},SUMX2PY2:(t,e)=>{let r=[],a=[],i=0;if(o.flattenParams([t],null,!1,(t,e)=>{r.push(t)}),o.flattenParams([e],null,!1,(t,e)=>{a.push(t)}),r.length!==a.length)throw n.NA;for(let t=0;t<r.length;t++)"number"==typeof r[t]&&"number"==typeof a[t]&&(i+=r[t]**2+a[t]**2);return i},SUMXMY2:(t,e)=>{let r=[],a=[],i=0;if(o.flattenParams([t],null,!1,(t,e)=>{r.push(t)}),o.flattenParams([e],null,!1,(t,e)=>{a.push(t)}),r.length!==a.length)throw n.NA;for(let t=0;t<r.length;t++)"number"==typeof r[t]&&"number"==typeof a[t]&&(i+=(r[t]-a[t])**2);return i},TRUNC:t=>Math.trunc(t=o.accept(t,a.NUMBER))};t.exports=h},58640:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,WildCard:i,Address:s}=r(74998),c=r(91577),u={ADDRESS:(t,e,r,i,c)=>{if(t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER,1),i=o.accept(i,a.BOOLEAN,!0),c=o.accept(c,a.STRING,""),t<1||e<1||r<1||r>4)throw n.VALUE;let u="";return c.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(c)?u+=`'${c}'!`:u+=c+"!"),i?u+=(1===r||3===r?"$":"")+s.columnNumberToName(e)+(1===r||2===r?"$":"")+t:u+="R"+(4===r||3===r?`[${t}]`:t)+"C"+(4===r||2===r?`[${e}]`:e),u},AREAS:t=>(t=o.accept(t))instanceof c?t.length:1,CHOOSE:(t,...e)=>{},COLUMN:(t,e)=>{if(null==e){if(null!=t.position.col)return t.position.col;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return e.ref.col;if(o.isRangeRef(e))return e.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")},COLUMNS:(t,e)=>{if(null==e)throw Error("COLUMNS requires one argument");if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return 1;if(o.isRangeRef(e))return Math.abs(e.ref.from.col-e.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(t,e,r,s)=>{t=o.accept(t);try{e=o.accept(e,a.ARRAY,void 0,!1)}catch(t){if(t instanceof n)throw n.NA;throw t}if(r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===e[r-1])throw n.REF;let c=typeof t;if(s){let o=c===typeof e[0][0]?e[0][0]:null;for(let a=1;a<e[0].length;a++){let i=e[0][a];if(typeof i===c){if(o>t&&i>t)throw n.NA;if(i===t)return e[r-1][a];if(null!=o&&i>t&&o<=t)return e[r-1][a-1];o=i}}if(null==o)throw n.NA;return o}{let o=-1;if(-1===(o=i.isWildCard(t)?e[0].findIndex(e=>i.toRegex(t,"i").test(e)):e[0].findIndex(e=>e===t)))throw n.NA;return e[r-1][o]}},INDEX:(t,e,r,i,s)=>{r={value:(r=t.utils.extractRefValue(r)).val,isArray:r.isArray},r=Math.trunc(r=o.accept(r,a.NUMBER)),null==i?i=1:(i={value:(i=t.utils.extractRefValue(i)).val,isArray:i.isArray},i=Math.trunc(i=o.accept(i,a.NUMBER,1))),null==s?s=1:(s={value:(s=t.utils.extractRefValue(s)).val,isArray:s.isArray},s=Math.trunc(s=o.accept(s,a.NUMBER,1)));let u=e;if(e instanceof c)u=e.refs[s-1];else if(s>1)throw n.REF;if(0===r&&0===i)return u;if(0===r){if(o.isRangeRef(u)){if(u.ref.to.col-u.ref.from.col<i-1)throw n.REF;return u.ref.from.col+=i-1,u.ref.to.col=u.ref.from.col,u}if(Array.isArray(u)){let t=[];return u.forEach(e=>t.push([e[i-1]])),t}}if(0===i){if(o.isRangeRef(u)){if(u.ref.to.row-u.ref.from.row<r-1)throw n.REF;return u.ref.from.row+=r-1,u.ref.to.row=u.ref.from.row,u}if(Array.isArray(u))return u[i-1]}if(0!==r&&0!==i){if(o.isRangeRef(u)){if((u=u.ref).to.row-u.from.row<r-1||u.to.col-u.from.col<i-1)throw n.REF;return{ref:{row:u.from.row+r-1,col:u.from.col+i-1}}}if(o.isCellRef(u)){if(u=u.ref,r>1||i>1)throw n.REF;return{ref:{row:u.row+r-1,col:u.col+i-1}}}if(Array.isArray(u)){if(u.length<r||u[0].length<i)throw n.REF;return u[r-1][i-1]}}},MATCH:()=>{},ROW:(t,e)=>{if(null==e){if(null!=t.position.row)return t.position.row;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return e.ref.row;if(o.isRangeRef(e))return e.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")},ROWS:(t,e)=>{if(null==e)throw Error("ROWS requires one argument");if("object"!=typeof e||Array.isArray(e))throw n.VALUE;if(o.isCellRef(e))return 1;if(o.isRangeRef(e))return Math.abs(e.ref.from.row-e.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:t=>{t=o.accept(t,a.ARRAY,void 0,!1);let e=[];for(let r=0;r<t[0].length;r++){e[r]=[];for(let n=0;n<t.length;n++)e[r][n]=t[n][r]}return e},VLOOKUP:(t,e,r,s)=>{t=o.accept(t);try{e=o.accept(e,a.ARRAY,void 0,!1)}catch(t){if(t instanceof n)throw n.NA;throw t}if(r=o.accept(r,a.NUMBER),s=o.accept(s,a.BOOLEAN,!0),r<1)throw n.VALUE;if(void 0===e[0][r-1])throw n.REF;let c=typeof t;if(s){let o=c===typeof e[0][0]?e[0][0]:null;for(let a=1;a<e.length;a++){let i=e[a],s=e[a][0];if(typeof s===c){if(o>t&&s>t)throw n.NA;if(s===t)return i[r-1];if(null!=o&&s>t&&o<=t)return e[a-1][r-1];o=s}}if(null==o)throw n.NA;return o}{let o=-1;if(-1===(o=i.isWildCard(t)?e.findIndex(e=>i.toRegex(t,"i").test(e[0])):e.findIndex(e=>e[0]===t)))throw n.NA;return e[o][r-1]}}};t.exports=u},91479:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,Criteria:i,Address:s}=r(74998),{Infix:c}=r(69520),{DistributionFunctions:u}=r(7449),l={AVEDEV:(...t)=>{let e=0,r=[];o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r.push(t))});let n=e/r.length;e=0;for(let t=0;t<r.length;t++)e+=Math.abs(r[t]-n);return e/r.length},AVERAGE:(...t)=>{let e=0,r=0;return o.flattenParams(t,a.NUMBER,!0,(t,n)=>{"number"==typeof t&&(e+=t,r++)}),e/r},AVERAGEA:(...t)=>{let e=0,r=0;return o.flattenParams(t,a.NUMBER,!0,(t,n)=>{let o=typeof t;"number"===o?(e+=t,r++):"string"===o&&r++}),e/r},AVERAGEIF:(t,e,r,a)=>{let s=o.retrieveRanges(t,e,a);e=s[0],a=s[1];let u=(r=o.retrieveArg(t,r)).isArray;r=i.parse(o.accept(r));let l=0,f=0;if(e.forEach((t,e)=>{t.forEach((t,n)=>{let o=a[e][n];"number"==typeof o&&("wc"===r.op?r.match===r.value.test(t)&&(l+=o,f++):c.compareOp(t,r.op,r.value,Array.isArray(t),u)&&(l+=o,f++))})}),0===f)throw n.DIV0;return l/f},AVERAGEIFS:()=>{},COUNT:(...t)=>{let e=0;return o.flattenParams(t,null,!0,(t,r)=>{r.isLiteral&&!isNaN(t)?e++:"number"==typeof t&&e++}),e},COUNTIF:(t,e)=>{t=o.accept(t,a.ARRAY,void 0,!1,!0);let r=e.isArray;e=o.accept(e);let n=0;return e=i.parse(e),t.forEach(t=>{t.forEach(t=>{"wc"===e.op?e.match===e.value.test(t)&&n++:c.compareOp(t,e.op,e.value,Array.isArray(t),r)&&n++})}),n},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};t.exports=Object.assign(l,u)},32156:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,WildCard:i}=r(74998),s=r(83632),c=r(92629),u={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"｡｢｣､･ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ",full:"。「」、・ヲァィゥェォャュョッーアイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワン゛゜"},extras:{delta:0,half:"\xa2\xa3\xac\xaf\xa6\xa5₩ |←↑→↓■\xb0",full:"￠￡￢￣￤￥￦　￨￩￪￫￬￭￮"}},l=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)+t.delta):[...t.full][[...t.half].indexOf(e)],f=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)-t.delta):[...t.half][[...t.full].indexOf(e)],h=(t,e)=>t[e+"RE"]||RegExp("["+t[e]+"]","g"),p=Object.keys(u).map(t=>u[t]),d=t=>p.reduce((t,e)=>t.replace(h(e,"half"),l(e)),t),m=t=>p.reduce((t,e)=>t.replace(h(e,"full"),f(e)),t),g={ASC:t=>m(t=o.accept(t,a.STRING)),BAHTTEXT:t=>{t=o.accept(t,a.NUMBER);try{return c(t)}catch(t){throw Error(`Error in https://github.com/jojoee/bahttext 
${t.toString()}`)}},CHAR:t=>{if((t=o.accept(t,a.NUMBER))>255||t<1)throw n.VALUE;return String.fromCharCode(t)},CLEAN:t=>(t=o.accept(t,a.STRING)).replace(/[\x00-\x1F]/g,""),CODE:t=>{if(0===(t=o.accept(t,a.STRING)).length)throw n.VALUE;return t.charCodeAt(0)},CONCAT:(...t)=>{let e="";return o.flattenParams(t,a.STRING,!1,t=>{t=o.accept(t,a.STRING),e+=t}),e},CONCATENATE:(...t)=>{let e="";if(0===t.length)throw Error("CONCATENATE need at least one argument.");return t.forEach(t=>{t=o.accept(t,a.STRING),e+=t}),e},DBCS:t=>d(t=o.accept(t,a.STRING)),DOLLAR:(t,e)=>{t=o.accept(t,a.NUMBER);let r=Array(e=o.accept(e,a.NUMBER,2)).fill("0").join("");return s.format(`$#,##0.${r}_);($#,##0.${r})`,t).trim()},EXACT:(t,e)=>(t=o.accept(t,[a.STRING]))===(e=o.accept(e,[a.STRING])),FIND:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.STRING),(r=o.accept(r,a.NUMBER,1))<1||r>e.length)throw n.VALUE;let i=e.indexOf(t,r-1);if(-1===i)throw n.VALUE;return i+1},FINDB:(...t)=>g.FIND(...t),FIXED:(t,e,r)=>{t=o.accept(t,a.NUMBER),e=o.accept(e,a.NUMBER,2),r=o.accept(r,a.BOOLEAN,!1);let n=Array(e).fill("0").join(""),i=r?"":"#,";return s.format(`${i}##0.${n}_);(${i}##0.${n})`,t).trim()},LEFT:(t,e)=>{if(t=o.accept(t,a.STRING),(e=o.accept(e,a.NUMBER,1))<0)throw n.VALUE;return e>t.length?t:t.slice(0,e)},LEFTB:(...t)=>g.LEFT(...t),LEN:t=>(t=o.accept(t,a.STRING)).length,LENB:(...t)=>g.LEN(...t),LOWER:t=>(t=o.accept(t,a.STRING)).toLowerCase(),MID:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.NUMBER),r=o.accept(r,a.NUMBER),e>t.length)return"";if(e<1||r<1)throw n.VALUE;return t.slice(e-1,e+r-1)},MIDB:(...t)=>g.MID(...t),NUMBERVALUE:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.STRING,"."),r=o.accept(r,a.STRING,","),0===t.length)return 0;if(0===e.length||0===r.length||(e=e[0])===(r=r[0])||t.indexOf(e)<t.lastIndexOf(r))throw n.VALUE;let i=t.replace(r,"").replace(e,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!i)throw n.VALUE;let s=i[1].length,c=i[3].length,u=i[4].length,l=Number(i[2]);if(s>1||s&&!c||!s&&c||isNaN(l))throw n.VALUE;return l/=100**u,s?-l:l},PHONETIC:()=>{},PROPER:t=>(t=(t=(t=o.accept(t,[a.STRING])).toLowerCase()).charAt(0).toUpperCase()+t.slice(1)).replace(/(?:[^a-zA-Z])([a-zA-Z])/g,t=>t.toUpperCase()),REPLACE:(t,e,r,n)=>{t=o.accept(t,[a.STRING]),e=o.accept(e,[a.NUMBER]),r=o.accept(r,[a.NUMBER]),n=o.accept(n,[a.STRING]);let i=t.split("");return i.splice(e-1,r,n),i.join("")},REPLACEB:(...t)=>g.REPLACE(...t),REPT:(t,e)=>{t=o.accept(t,a.STRING),e=o.accept(e,a.NUMBER);let r="";for(let n=0;n<e;n++)r+=t;return r},RIGHT:(t,e)=>{if(t=o.accept(t,a.STRING),(e=o.accept(e,a.NUMBER,1))<0)throw n.VALUE;let r=t.length;return e>r?t:t.slice(r-e)},RIGHTB:(...t)=>g.RIGHT(...t),SEARCH:(t,e,r)=>{if(t=o.accept(t,a.STRING),e=o.accept(e,a.STRING),(r=o.accept(r,a.NUMBER,1))<1||r>e.length)throw n.VALUE;let s=i.isWildCard(t)?i.toRegex(t,"i"):t,c=e.slice(r-1).search(s);if(-1===c)throw n.VALUE;return c+r},SEARCHB:(...t)=>g.SEARCH(...t),SUBSTITUTE:(...t)=>{},T:t=>"string"==typeof(t=o.accept(t))?t:"",TEXT:(t,e)=>{t=o.accept(t,a.NUMBER),e=o.accept(e,a.STRING);try{return s.format(e,t)}catch(t){throw console.error(t),n.VALUE}},TEXTJOIN:(...t)=>{},TRIM:t=>(t=o.accept(t,[a.STRING])).replace(/^\s+|\s+$/g,""),UNICHAR:t=>{if((t=o.accept(t,[a.NUMBER]))<=0)throw n.VALUE;return String.fromCharCode(t)},UNICODE:t=>g.CODE(t)};t.exports=g},5230:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998),i={ACOS:t=>{if((t=o.accept(t,a.NUMBER))>1||t<-1)throw n.NUM;return Math.acos(t)},ACOSH:t=>{if((t=o.accept(t,a.NUMBER))<1)throw n.NUM;return Math.acosh(t)},ACOT:t=>Math.PI/2-Math.atan(t=o.accept(t,a.NUMBER)),ACOTH:t=>{if(1>=Math.abs(t=o.accept(t,a.NUMBER)))throw n.NUM;return Math.atanh(1/t)},ASIN:t=>{if((t=o.accept(t,a.NUMBER))>1||t<-1)throw n.NUM;return Math.asin(t)},ASINH:t=>Math.asinh(t=o.accept(t,a.NUMBER)),ATAN:t=>Math.atan(t=o.accept(t,a.NUMBER)),ATAN2:(t,e)=>{if(t=o.accept(t,a.NUMBER),0===(e=o.accept(e,a.NUMBER))&&0===t)throw n.DIV0;return Math.atan2(e,t)},ATANH:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>1)throw n.NUM;return Math.atanh(t)},COS:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return Math.cos(t)},COSH:t=>Math.cosh(t=o.accept(t,a.NUMBER)),COT:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;if(0===t)throw n.DIV0;return 1/Math.tan(t)},COTH:t=>{if(0===(t=o.accept(t,a.NUMBER)))throw n.DIV0;return 1/Math.tanh(t)},CSC:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return 1/Math.sin(t)},CSCH:t=>{if(0===(t=o.accept(t,a.NUMBER)))throw n.DIV0;return 1/Math.sinh(t)},SEC:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return 1/Math.cos(t)},SECH:t=>1/Math.cosh(t=o.accept(t,a.NUMBER)),SIN:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return Math.sin(t)},SINH:t=>Math.sinh(t=o.accept(t,a.NUMBER)),TAN:t=>{if(Math.abs(t=o.accept(t,a.NUMBER))>134217727)throw n.NUM;return Math.tan(t)},TANH:t=>Math.tanh(t=o.accept(t,a.NUMBER))};t.exports=i},2307:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a}=r(74998);t.exports={ENCODEURL:t=>encodeURIComponent(o.accept(t,a.STRING)),FILTERXML:()=>{},WEBSERVICE:(t,e)=>{throw n.ERROR("WEBSERVICE is not supported in sync mode.")}}},74998:(t,e,r)=>{let n=r(77262),o=r(91577),a={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},i={};Object.keys(a).forEach(t=>{i[a[t]]=t});class s{constructor(){this.Types=a,this.type2Number={number:a.NUMBER,boolean:a.BOOLEAN,string:a.STRING,object:-1}}checkFunctionResult(t){if("number"==typeof t){if(isNaN(t))return n.VALUE;if(!isFinite(t))return n.NUM}return null==t?n.NULL:t}flattenDeep(t){return t.reduce((t,e)=>Array.isArray(e)?t.concat(this.flattenDeep(e)):t.concat(e),[])}acceptNumber(t,e=!0,r=!0){let o;if(t instanceof n)return t;if("number"==typeof t)o=t;else if("boolean"==typeof t){if(r)o=Number(t);else throw n.VALUE}else if("string"==typeof t){if(0===t.length||(o=Number(t))!=o)throw n.VALUE}else if(Array.isArray(t)){if(e)o=this.acceptNumber(t[0][0]);else if(1===t[0].length)o=this.acceptNumber(t[0][0]);else throw n.VALUE}else throw Error("Unknown type in FormulaHelpers.acceptNumber");return o}flattenParams(t,e,r,i,s=null,c=1){if(t.length<c)throw n.ARG_MISSING([e]);null==s&&(s=e===a.NUMBER?0:null==e?null:""),t.forEach(t=>{let{isCellRef:a,isRangeRef:c,isArray:u}=t,l=t.value instanceof o,f=!a&&!c&&!u&&!l,h={isLiteral:f,isCellRef:a,isRangeRef:c,isArray:u,isUnion:l};if(f)i(t=t.omitted?s:this.accept(t,e,s),h);else if(a)i(t.value,h);else if(l){if(!r)throw n.VALUE;t=t.value.data,(t=this.flattenDeep(t)).forEach(t=>{i(t,h)})}else(c||u)&&(t=this.flattenDeep(t.value)).forEach(t=>{i(t,h)})})}accept(t,e=null,r,i=!0,s=!1){if(Array.isArray(e)&&(e=e[0]),null==t&&void 0===r)throw n.ARG_MISSING([e]);if(null==t)return r;if("object"!=typeof t||Array.isArray(t))return t;let c=t.isArray;if(null!=t.value&&(t=t.value),null==e)return t;if(t instanceof n)throw t;if(e===a.ARRAY){if(Array.isArray(t))return i?this.flattenDeep(t):t;if(t instanceof o);else if(s)return i?[t]:[[t]];throw n.VALUE}if(e===a.COLLECTIONS)return t;c&&(t=t[0][0]);let u=this.type(t);if(e===a.STRING)t=u===a.BOOLEAN?t?"TRUE":"FALSE":`${t}`;else if(e===a.BOOLEAN){if(u===a.STRING)throw n.VALUE;u===a.NUMBER&&(t=!!t)}else if(e===a.NUMBER)t=this.acceptNumber(t,!1);else if(e===a.NUMBER_NO_BOOLEAN)t=this.acceptNumber(t,!1,!1);else throw n.VALUE;return t}type(t){let e=this.type2Number[typeof t];return -1===e&&(Array.isArray(t)?e=a.ARRAY:t.ref?e=t.ref.from?a.RANGE_REF:a.CELL_REF:t instanceof o&&(e=a.COLLECTIONS)),e}isRangeRef(t){return t.ref&&t.ref.from}isCellRef(t){return t.ref&&!t.ref.from}retrieveRanges(t,e,r){return r=l.extend(e,r),e=this.retrieveArg(t,e),e=c.accept(e,a.ARRAY,void 0,!1,!0),r!==e?(r=this.retrieveArg(t,r),r=c.accept(r,a.ARRAY,void 0,!1,!0)):r=e,[e,r]}retrieveArg(t,e){if(null===e)return{value:0,isArray:!1,omitted:!0};let r=t.utils.extractRefValue(e);return{value:r.val,isArray:r.isArray,ref:e.ref}}}let c=new s,u={isWildCard:t=>"string"==typeof t&&/[*?]/.test(t),toRegex:(t,e)=>RegExp(t.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),e)},l={columnNumberToName:t=>{let e=t,r="",n=0;for(;e>0;)r=String.fromCharCode(65+(n=(e-1)%26))+r,e=Math.floor((e-n)/26);return r},columnNameToNumber:t=>{let e=(t=t.toUpperCase()).length,r=0;for(let n=0;n<e;n++){let o=t.charCodeAt(n);isNaN(o)||(r+=(o-64)*26**(e-n-1))}return r},extend:(t,e)=>{let r,n;if(null==e)return t;if(c.isCellRef(t))r=0,n=0;else if(c.isRangeRef(t))r=t.ref.to.row-t.ref.from.row,n=t.ref.to.col-t.ref.from.col;else throw Error("Address.extend should not reach here.");return c.isCellRef(e)?(r>0||n>0)&&(e={ref:{from:{col:e.ref.col,row:e.ref.row},to:{row:e.ref.row+r,col:e.ref.col+n}}}):(e.ref.to.row=e.ref.from.row+r,e.ref.to.col=e.ref.from.col+n),e}};t.exports={FormulaHelpers:c,Types:a,ReversedTypes:i,Factorials:[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],WildCard:u,Criteria:{parse:t=>{let e=typeof t;if("string"===e){let e=t.toUpperCase();if("TRUE"===e||"FALSE"===e)return{op:"=",value:"TRUE"===e};let r=t.match(/(<>|>=|<=|>|<|=)(.*)/);if(r){let t=r[1],e;if(isNaN(r[2])){let o=r[2].toUpperCase();if("TRUE"===o||"FALSE"===o)e="TRUE"===o;else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(r[2]))e=new n(r[2]);else if(e=r[2],u.isWildCard(e))return{op:"wc",value:u.toRegex(e),match:"="===t}}else e=Number(r[2]);return{op:t,value:e}}return u.isWildCard(t)?{op:"wc",value:u.toRegex(t),match:!0}:{op:"=",value:t}}if("boolean"===e||"number"===e||Array.isArray(t)||t instanceof n)return{op:"=",value:t};throw Error(`Criteria.parse: type ${typeof t} not support`)}},Address:l}},69520:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o}=r(74998),a={unaryOp:(t,e,r)=>{let a=1;if(t.forEach(t=>{if("+"===t);else if("-"===t)a=-a;else throw Error(`Unrecognized prefix: ${t}`)}),null==e&&(e=0),1===a)return e;try{e=o.acceptNumber(e,r)}catch(t){if(t instanceof n)Array.isArray(e)&&(e=e[0][0]);else throw t}return"number"==typeof e&&isNaN(e)?n.VALUE:-e}},i={percentOp:(t,e,r)=>{try{t=o.acceptNumber(t,r)}catch(t){if(t instanceof n)return t;throw t}if("%"===e)return t/100;throw Error(`Unrecognized postfix: ${e}`)}},s={boolean:3,string:2,number:1},c={compareOp:(t,e,r,n,o)=>{null==t&&(t=0),null==r&&(r=0),n&&(t=t[0][0]),o&&(r=r[0][0]);let a=typeof t,i=typeof r;if(a===i)switch(e){case"=":return t===r;case">":return t>r;case"<":return t<r;case"<>":return t!==r;case"<=":return t<=r;case">=":return t>=r}else switch(e){case"=":return!1;case">":return s[a]>s[i];case"<":return s[a]<s[i];case"<>":return!0;case"<=":return s[a]<=s[i];case">=":return s[a]>=s[i]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(t,e,r,n,o)=>(null==t&&(t=""),null==r&&(r=""),n&&(t=t[0][0]),o&&(r=r[0][0]),"boolean"==typeof t&&(t=t?"TRUE":"FALSE"),"boolean"==typeof r&&(r=r?"TRUE":"FALSE"),""+t+r),mathOp:(t,e,r,a,i)=>{null==t&&(t=0),null==r&&(r=0);try{t=o.acceptNumber(t,a),r=o.acceptNumber(r,i)}catch(t){if(t instanceof n)return t;throw t}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":if(0===r)return n.DIV0;return t/r;case"^":return t**r}throw Error("Infix.mathOp: Should not reach here.")}};t.exports={Prefix:a,Postfix:i,Infix:c,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}}},8025:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o}=r(74998),{Parser:a}=r(83794),i=r(57661),s=r(69692),{formatChevrotainError:c}=r(20583);class u{constructor(t){this.data=[],this.utils=new s(this),t=Object.assign({onVariable:()=>null},t),this.utils=new s(this),this.onVariable=t.onVariable,this.functions={},this.parser=new a(this,this.utils)}getCell(t){return null!=t.row&&(null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(e=>e.from&&e.from.row<=t.row&&e.to.row>=t.row&&e.from.col<=t.col&&e.to.col>=t.col||e.row===t.row&&e.col===t.col&&e.sheet===t.sheet)&&this.data.push(t)),0}getRange(t){return null!=t.from.row&&(null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(e=>e.from&&e.from.row===t.from.row&&e.from.col===t.from.col&&e.to.row===t.to.row&&e.to.col===t.to.col)&&this.data.push(t)),[[0]]}getVariable(t){let e={ref:this.onVariable(t,this.position.sheet)};return null==e.ref?n.NAME:(o.isCellRef(e)?this.getCell(e.ref):this.getRange(e.ref),0)}retrieveRef(t){return o.isRangeRef(t)?this.getRange(t.ref):o.isCellRef(t)?this.getCell(t.ref):t}callFunction(t,e){return e.forEach(t=>{null!=t&&this.retrieveRef(t)}),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,e,r=!1){if(0===t.length)throw Error("Input must not be empty.");this.data=[],this.position=e;let o=i.lex(t);this.parser.input=o.tokens;try{let t=this.parser.formulaWithBinaryOp();this.checkFormulaResult(t)}catch(t){if(!r)throw n.ERROR(t.message,t)}if(this.parser.errors.length>0&&!r)throw c(this.parser.errors[0],t);return this.data}}t.exports={DepParser:u}},69692:(t,e,r)=>{let n=r(77262),{FormulaHelpers:o,Types:a,Address:i}=r(74998),{Prefix:s,Postfix:c,Infix:u,Operators:l}=r(69520),f=r(91577);class h{constructor(t){this.context=t}columnNameToNumber(t){return i.columnNameToNumber(t)}parseCellAddress(t){let e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){if(!Number.isInteger(+t))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,e){return this.extractRefValue(e),0}applyPostfix(t,e){return this.extractRefValue(t),0}applyInfix(t,e,r){return this.extractRefValue(t),this.extractRefValue(r),0}applyIntersect(t){let e,r,o,a,i,s,c;if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let u=t.shift().ref;if(i=u.sheet,u.from)e=Math.max(u.from.row,u.to.row),o=Math.min(u.from.row,u.to.row),r=Math.max(u.from.col,u.to.col),a=Math.min(u.from.col,u.to.col);else{if(void 0===u.row||void 0===u.col)throw Error("Cannot intersect the whole row or column.");e=o=u.row,r=a=u.col}return(t.forEach(t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){let s=Math.max(t.from.row,t.to.row),u=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(u>e||s<o||f>r||l<a||i!==t.sheet)&&(c=n.NULL),e=Math.min(e,s),o=Math.max(o,u),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>r||t.col<a||i!==t.sheet)&&(c=n.NULL),e=o=t.row,r=a=t.col}}),c)?c:((s=e===o&&r===a?{ref:{sheet:i,row:e,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:e,col:r}}}).ref.sheet||delete s.ref.sheet,s)}applyUnion(t){let e=new f;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];e.add(this.extractRefValue(t[r]).val,t[r])}return e}applyRange(t){let e=-1,r=-1,n=1048577,o=16385;return t.forEach(t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(n=1,e=1048576),void 0===t.col&&(o=1,r=16384),t.row>e&&(e=t.row),t.row<n&&(n=t.row),t.col>r&&(r=t.col),t.col<o&&(o=t.col)}),e===n&&r===o?{ref:{row:e,col:r}}:{ref:{from:{row:n,col:o},to:{row:e,col:r}}}}extractRefValue(t){let e=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:e}:{val:t,isArray:e}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new n(t.toUpperCase())}isFormulaError(t){return t instanceof n}}t.exports=h},28983:(t,e,r)=>{let n=r(32156),o=r(39300),a=r(5230),i=r(58462),s=r(48327),c=r(58640),u=r(41257),l=r(91479),f=r(86396),h=r(2307),p=r(77262),{FormulaHelpers:d}=r(74998),{Parser:m,allTokens:g}=r(83794),v=r(57661),E=r(20583);class y{constructor(t,e=!1){this.logs=[],this.isTest=e,this.utils=new E(this),t=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},t),this.onVariable=t.onVariable,this.functions=Object.assign({},f,l,u,c,s,i,n,o,a,h,t.functions,t.functionsNeedContext),this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(o).concat(Object.keys(a)).concat(Object.keys(i)).concat(Object.keys(s)).concat(Object.keys(c)).concat(Object.keys(l)).concat(Object.keys(f)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(t.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(u),this.parser=new m(this,this.utils)}static get allTokens(){return g}getCell(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){let e={ref:this.onVariable(t,this.position.sheet,this.position)};return null==e.ref?p.NAME:e}retrieveRef(t){return d.isRangeRef(t)?this.getRange(t.ref):d.isCellRef(t)?this.getCell(t.ref):t}_callFunction(t,e){0===t.indexOf("_xlfn.")&&(t=t.slice(6)),t=t.toUpperCase();let r=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(e=e.map(e=>{if(null===e)return{value:r,isArray:!1,omitted:!0};let n=this.utils.extractRefValue(e);return this.funsPreserveRef.includes(t)?{value:n.val,isArray:n.isArray,ref:e.ref}:{value:n.val,isArray:n.isArray,isRangeRef:!!d.isRangeRef(e),isCellRef:!!d.isCellRef(e)}})),this.functions[t]){let r;try{r=this.funsNeedContextAndNoDataRetrieve.includes(t)||this.funsNeedContext.includes(t)?this.functions[t](this,...e):this.functions[t](...e)}catch(t){if(t instanceof p)return t;throw t}if(void 0===r){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}return r}if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw p.NOT_IMPLEMENTED(t)}async callFunctionAsync(t,e){let r=[];for(let t of e)r.push(await t);let n=await this._callFunction(t,r);return d.checkFunctionResult(n)}callFunction(t,e){if(this.async)return this.callFunctionAsync(t,e);{let r=this._callFunction(t,e);return d.checkFunctionResult(r)}}supportedFunctions(){let t=[];return Object.keys(this.functions).forEach(e=>{try{let r=this.functions[e](0,0,0,0,0,0,0,0,0,0,0);if(void 0===r)return;t.push(e)}catch(r){r instanceof Error&&t.push(e)}}),t.sort()}checkFormulaResult(t,e=!1){let r=typeof t;if("number"===r){if(isNaN(t))return p.VALUE;if(!isFinite(t))return p.NUM;t+=0}else if("object"===r){if(t instanceof p)return t;if(e){if(t.ref&&(t=this.retrieveRef(t)),"object"==typeof t&&!Array.isArray(t)&&null!=t)return p.VALUE}else if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else{if(!Array.isArray(t))return p.VALUE;t=t[0][0]}}return t}parse(t,e,r=!1){let n;if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!1;let o=v.lex(t);this.parser.input=o.tokens;try{if(n=this.parser.formulaWithBinaryOp(),(n=this.checkFormulaResult(n,r))instanceof p)return n}catch(t){throw p.ERROR(t.message,t)}if(this.parser.errors.length>0){let e=this.parser.errors[0];throw E.formatChevrotainError(e,t)}return n}async parseAsync(t,e,r=!1){let n;if(0===t.length)throw Error("Input must not be empty.");this.position=e,this.async=!0;let o=v.lex(t);this.parser.input=o.tokens;try{if(n=await this.parser.formulaWithBinaryOp(),(n=this.checkFormulaResult(n,r))instanceof p)return n}catch(t){throw p.ERROR(t.message,t)}if(this.parser.errors.length>0){let e=this.parser.errors[0];throw E.formatChevrotainError(e,t)}return n}}t.exports={FormulaParser:y,FormulaHelpers:d}},57661:(t,e,r)=>{let{createToken:n,Lexer:o}=r(75490),a=r(77262),i={},s=n({name:"WhiteSpace",pattern:/\s+/,group:o.SKIPPED}),c=n({name:"String",pattern:/"(""|[^"])*"/}),u=n({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),l=n({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),f=n({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),h=n({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),p=n({name:"RefError",pattern:/#REF!/}),d=n({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),m=n({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),g=n({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:d}),v=n({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),E=n({name:"Boolean",pattern:/TRUE|FALSE/i}),y=n({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:d}),N=n({name:"At",pattern:/@/}),R=n({name:"Comma",pattern:/,/}),T=n({name:"Colon",pattern:/:/}),A=n({name:"Semicolon",pattern:/;/}),M=n({name:"OpenParen",pattern:/\(/}),w=n({name:"CloseParen",pattern:/\)/}),x=n({name:"OpenSquareParen",pattern:/\[/}),I=n({name:"CloseSquareParen",pattern:/]/});n({name:"exclamationMark",pattern:/!/});let O=n({name:"OpenCurlyParen",pattern:/{/}),b=n({name:"CloseCurlyParen",pattern:/}/}),C=n({name:"QuoteS",pattern:/'/}),S=n({name:"MulOp",pattern:/\*/}),U=n({name:"PlusOp",pattern:/\+/}),_=n({name:"DivOp",pattern:/\//}),L=n({name:"MinOp",pattern:/-/}),k=n({name:"ConcatOp",pattern:/&/}),P=n({name:"ExOp",pattern:/\^/}),D=n({name:"PercentOp",pattern:/%/}),B=n({name:"GtOp",pattern:/>/}),F=n({name:"EqOp",pattern:/=/}),j=n({name:"LtOp",pattern:/</}),V=[s,c,l,u,f,h,p,m,g,E,y,d,v,N,R,T,A,M,w,x,I,O,b,C,S,U,_,L,k,P,S,D,n({name:"NeqOp",pattern:/<>/}),n({name:"GteOp",pattern:/>=/}),n({name:"LteOp",pattern:/<=/}),B,F,j],G=new o(V,{ensureOptimizations:!0});V.forEach(t=>{i[t.name]=t}),t.exports={tokenVocabulary:i,lex:function(t){let e=G.tokenize(t);if(e.errors.length>0){let r=e.errors[0],n=r.line,o=r.column,i="\n"+t.split("\n")[n-1]+"\n";throw i+=Array(o-1).fill(" ").join("")+"^\n",r.message=i+`Error at position ${n}:${o}
`+r.message,r.errorLocation={line:n,column:o},a.ERROR(r.message,r)}return e}}},83794:(t,e,r)=>{let n=r(57661),{EmbeddedActionsParser:o}=r(75490),a=n.tokenVocabulary,{String:i,SheetQuoted:s,ExcelRefFunction:c,ExcelConditionalRefFunction:u,Function:l,FormulaErrorT:f,RefError:h,Cell:p,Sheet:d,Name:m,Number:g,Boolean:v,Column:E,Comma:y,Colon:N,Semicolon:R,OpenParen:T,CloseParen:A,OpenCurlyParen:M,CloseCurlyParen:w,MulOp:x,PlusOp:I,DivOp:O,MinOp:b,ConcatOp:C,ExOp:S,PercentOp:U,NeqOp:_,GteOp:L,LteOp:k,GtOp:P,EqOp:D,LtOp:B}=n.tokenVocabulary;class F extends o{constructor(t,e){super(a,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=e,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];let r=this;r.RULE("formulaWithBinaryOp",()=>{let t=[],e=[r.SUBRULE(r.formulaWithPercentOp)];return r.MANY(()=>{t.push(r.OR(r.c1||(r.c1=[{ALT:()=>r.CONSUME(P).image},{ALT:()=>r.CONSUME(D).image},{ALT:()=>r.CONSUME(B).image},{ALT:()=>r.CONSUME(_).image},{ALT:()=>r.CONSUME(L).image},{ALT:()=>r.CONSUME(k).image},{ALT:()=>r.CONSUME(C).image},{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(b).image},{ALT:()=>r.CONSUME(x).image},{ALT:()=>r.CONSUME(O).image},{ALT:()=>r.CONSUME(S).image}]))),e.push(r.SUBRULE2(r.formulaWithPercentOp))}),r.ACTION(()=>{for(let r of this.binaryOperatorsPrecedence)for(let n=0,o=t.length;n<o;n++){let a=t[n];r.includes(a)&&(t.splice(n,1),e.splice(n,2,this.utils.applyInfix(e[n],a,e[n+1])),n--,o--)}}),e[0]}),r.RULE("plusMinusOp",()=>r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(b).image}])),r.RULE("formulaWithPercentOp",()=>{let t=r.SUBRULE(r.formulaWithUnaryOp);return r.OPTION(()=>{let e=r.CONSUME(U).image;t=r.ACTION(()=>this.utils.applyPostfix(t,e))}),t}),r.RULE("formulaWithUnaryOp",()=>{let t=[];r.MANY(()=>{let e=r.OR([{ALT:()=>r.CONSUME(I).image},{ALT:()=>r.CONSUME(b).image}]);t.push(e)});let e=r.SUBRULE(r.formulaWithIntersect);return t.length>0?r.ACTION(()=>this.utils.applyPrefix(t,e)):e}),r.RULE("formulaWithIntersect",()=>{let t=r.SUBRULE(r.formulaWithRange),e=[t];return(r.MANY({GATE:()=>{let t=r.LA(0);return r.LA(1).startOffset>t.endOffset+1},DEF:()=>{e.push(r.SUBRULE3(r.formulaWithRange))}}),e.length>1)?r.ACTION(()=>r.ACTION(()=>this.utils.applyIntersect(e))):t}),r.RULE("formulaWithRange",()=>{let t=r.SUBRULE(r.formula),e=[t];return(r.MANY(()=>{r.CONSUME(N),e.push(r.SUBRULE2(r.formula))}),e.length>1)?r.ACTION(()=>r.ACTION(()=>this.utils.applyRange(e))):t}),r.RULE("formula",()=>r.OR9([{ALT:()=>r.SUBRULE(r.referenceWithoutInfix)},{ALT:()=>r.SUBRULE(r.paren)},{ALT:()=>r.SUBRULE(r.constant)},{ALT:()=>r.SUBRULE(r.functionCall)},{ALT:()=>r.SUBRULE(r.constantArray)}])),r.RULE("paren",()=>{let t;r.CONSUME(T);let e=[];return e.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME(y),e.push(r.SUBRULE2(r.formulaWithBinaryOp))}),t=e.length>1?r.ACTION(()=>this.utils.applyUnion(e)):e[0],r.CONSUME(A),t}),r.RULE("constantArray",()=>{let t=[[]],e=0;return r.CONSUME(M),t[e].push(r.SUBRULE(r.constantForArray)),r.MANY(()=>{let n=r.OR([{ALT:()=>r.CONSUME(y).image},{ALT:()=>r.CONSUME(R).image}]),o=r.SUBRULE2(r.constantForArray);","===n||(t[++e]=[]),t[e].push(o)}),r.CONSUME(w),r.ACTION(()=>this.utils.toArray(t))}),r.RULE("constantForArray",()=>r.OR([{ALT:()=>{let t=r.OPTION(()=>r.SUBRULE(r.plusMinusOp)),e=r.CONSUME(g).image,n=r.ACTION(()=>this.utils.toNumber(e));return t?r.ACTION(()=>this.utils.applyPrefix([t],n)):n}},{ALT:()=>{let t=r.CONSUME(i).image;return r.ACTION(()=>this.utils.toString(t))}},{ALT:()=>{let t=r.CONSUME(v).image;return r.ACTION(()=>this.utils.toBoolean(t))}},{ALT:()=>{let t=r.CONSUME(f).image;return r.ACTION(()=>this.utils.toError(t))}},{ALT:()=>{let t=r.CONSUME(h).image;return r.ACTION(()=>this.utils.toError(t))}}])),r.RULE("constant",()=>r.OR([{ALT:()=>{let t=r.CONSUME(g).image;return r.ACTION(()=>this.utils.toNumber(t))}},{ALT:()=>{let t=r.CONSUME(i).image;return r.ACTION(()=>this.utils.toString(t))}},{ALT:()=>{let t=r.CONSUME(v).image;return r.ACTION(()=>this.utils.toBoolean(t))}},{ALT:()=>{let t=r.CONSUME(f).image;return r.ACTION(()=>this.utils.toError(t))}}])),r.RULE("functionCall",()=>{let e=r.CONSUME(l).image.slice(0,-1),n=r.SUBRULE(r.arguments);return r.CONSUME(A),r.ACTION(()=>t.callFunction(e,n))}),r.RULE("arguments",()=>{r.MANY2(()=>{r.CONSUME2(y)});let t=[];return r.OPTION(()=>{t.push(r.SUBRULE(r.formulaWithBinaryOp)),r.MANY(()=>{r.CONSUME1(y),t.push(null),r.OPTION3(()=>{t.pop(),t.push(r.SUBRULE2(r.formulaWithBinaryOp))})})}),t}),r.RULE("referenceWithoutInfix",()=>r.OR([{ALT:()=>r.SUBRULE(r.referenceItem)},{ALT:()=>{let t=r.SUBRULE(r.prefixName),e=r.SUBRULE2(r.formulaWithRange);return r.ACTION(()=>{if(this.utils.isFormulaError(e))return e;e.ref.sheet=t}),e}}])),r.RULE("referenceItem",()=>r.OR([{ALT:()=>{let t=r.CONSUME(p).image;return r.ACTION(()=>this.utils.parseCellAddress(t))}},{ALT:()=>{let e=r.CONSUME(m).image;return r.ACTION(()=>t.getVariable(e))}},{ALT:()=>{let t=r.CONSUME(E).image;return r.ACTION(()=>this.utils.parseCol(t))}},{ALT:()=>{let t=r.CONSUME(h).image;return r.ACTION(()=>this.utils.toError(t))}}])),r.RULE("prefixName",()=>r.OR([{ALT:()=>r.CONSUME(d).image.slice(0,-1)},{ALT:()=>r.CONSUME(s).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}t.exports={Parser:F}},91577:t=>{class e{constructor(t,e){if(null==t&&null==e)this._data=[],this._refs=[];else{if(t.length!==e.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=e}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,e){this._data.push(t),this._refs.push(e)}}t.exports=e},20583:(t,e,r)=>{let n=r(77262),{Address:o}=r(74998),{Prefix:a,Postfix:i,Infix:s,Operators:c}=r(69520),u=r(91577),{NotAllInputParsedException:l}=r(75490);class f{constructor(t){this.context=t}columnNameToNumber(t){return o.columnNameToNumber(t)}parseCellAddress(t){let e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:e[0],col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){if(!Number.isInteger(+t))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,e){return t=this.columnNameToNumber(t),e=this.columnNameToNumber(e),{ref:{from:{col:Math.min(t,e),row:null},to:{col:Math.max(t,e),row:null}}}}parseRowRange(t,e){return{ref:{from:{col:null,row:Math.min(t,e)},to:{col:null,row:Math.max(t,e)}}}}_applyPrefix(t,e,r){return this.isFormulaError(e)?e:a.unaryOp(t,e,r)}async applyPrefixAsync(t,e){let{val:r,isArray:n}=this.extractRefValue(await e);return this._applyPrefix(t,r,n)}applyPrefix(t,e){if(this.context.async)return this.applyPrefixAsync(t,e);{let{val:r,isArray:n}=this.extractRefValue(e);return this._applyPrefix(t,r,n)}}_applyPostfix(t,e,r){return this.isFormulaError(t)?t:i.percentOp(t,r,e)}async applyPostfixAsync(t,e){let{val:r,isArray:n}=this.extractRefValue(await t);return this._applyPostfix(r,n,e)}applyPostfix(t,e){if(this.context.async)return this.applyPostfixAsync(t,e);{let{val:r,isArray:n}=this.extractRefValue(t);return this._applyPostfix(r,n,e)}}_applyInfix(t,e,r){let n=t.val,o=t.isArray,a=r.val,i=r.isArray;if(this.isFormulaError(n))return n;if(this.isFormulaError(a))return a;if(c.compareOp.includes(e))return s.compareOp(n,e,a,o,i);if(c.concatOp.includes(e))return s.concatOp(n,e,a,o,i);if(c.mathOp.includes(e))return s.mathOp(n,e,a,o,i);throw Error(`Unrecognized infix: ${e}`)}async applyInfixAsync(t,e,r){let n=this.extractRefValue(await t),o=this.extractRefValue(await r);return this._applyInfix(n,e,o)}applyInfix(t,e,r){if(this.context.async)return this.applyInfixAsync(t,e,r);{let n=this.extractRefValue(t),o=this.extractRefValue(r);return this._applyInfix(n,e,o)}}applyIntersect(t){let e,r,o,a,i,s,c;if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let u=t.shift().ref;if(i=u.sheet,u.from)e=Math.max(u.from.row,u.to.row),o=Math.min(u.from.row,u.to.row),r=Math.max(u.from.col,u.to.col),a=Math.min(u.from.col,u.to.col);else{if(void 0===u.row||void 0===u.col)throw Error("Cannot intersect the whole row or column.");e=o=u.row,r=a=u.col}return(t.forEach(t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){let s=Math.max(t.from.row,t.to.row),u=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(u>e||s<o||f>r||l<a||i!==t.sheet)&&(c=n.NULL),e=Math.min(e,s),o=Math.max(o,u),r=Math.min(r,l),a=Math.max(a,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>r||t.col<a||i!==t.sheet)&&(c=n.NULL),e=o=t.row,r=a=t.col}}),c)?c:((s=e===o&&r===a?{ref:{sheet:i,row:e,col:r}}:{ref:{sheet:i,from:{row:o,col:a},to:{row:e,col:r}}}).ref.sheet||delete s.ref.sheet,s)}applyUnion(t){let e=new u;for(let r=0;r<t.length;r++){if(this.isFormulaError(t[r]))return t[r];e.add(this.extractRefValue(t[r]).val,t[r])}return e}applyRange(t){let e=-1,r=-1,n=1048577,o=16385;return t.forEach(t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(n=1,e=1048576),void 0===t.col&&(o=1,r=16384),t.row>e&&(e=t.row),t.row<n&&(n=t.row),t.col>r&&(r=t.col),t.col<o&&(o=t.col)}),e===n&&r===o?{ref:{row:e,col:r}}:{ref:{from:{row:n,col:o},to:{row:e,col:r}}}}extractRefValue(t){let e=!1;return(Array.isArray(t)&&(e=!0),t.ref)?{val:this.context.retrieveRef(t),isArray:e}:{val:t,isArray:e}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new n(t.toUpperCase())}isFormulaError(t){return t instanceof n}static formatChevrotainError(t,e){let r,o,a="";return t instanceof l?(r=t.token.startLine,o=t.token.startColumn):(r=t.previousToken.startLine,o=t.previousToken.startColumn+1),a+="\n"+e.split("\n")[r-1]+"\n"+Array(o-1).fill(" ").join("")+"^\n"+`Error at position ${r}:${o}
`+t.message,t.errorLocation={line:r,column:o},n.ERROR(a,t)}}t.exports=f},24661:(t,e,r)=>{let{FormulaParser:n}=r(28983),{DepParser:o}=r(8025);Object.assign(n,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:r(83632),DepParser:o,FormulaError:r(77262),...r(74998)}),t.exports=n},83632:t=>{class e{}function r(t){let e="",r=t.length-1;for(;r>=0;)e+=t.charAt(r--);return e}function n(t,e){let r="";for(;r.length<e;)r+=t;return r}function o(t,e){let r=""+t;return r.length>=e?r:n("0",e-r.length)+r}function a(t,e){let r=""+t;return r.length>=e?r:n(" ",e-r.length)+r}function i(t,e){let r=""+t;return r.length>=e?r:r+n(" ",e-r.length)}function s(t,e){let r;if(t>4294967296||t<-4294967296){let r;return(r=""+Math.round(t)).length>=e?r:n("0",e-r.length)+r}return(r=""+Math.round(t)).length>=e?r:n("0",e-r.length)+r}function c(t,e){return e=e||0,t.length>=7+e&&(32|t.charCodeAt(e))==103&&(32|t.charCodeAt(e+1))==101&&(32|t.charCodeAt(e+2))==110&&(32|t.charCodeAt(e+3))==101&&(32|t.charCodeAt(e+4))==114&&(32|t.charCodeAt(e+5))==97&&(32|t.charCodeAt(e+6))==108}e.version="0.10.3";let u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],l=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function f(t){t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t[65535]="General"}let h={};function p(t,e,r){let n=t<0?-1:1,o=t*n,a=0,i=1,s=0,c=1,u=0,l=0,f=Math.floor(o);for(;u<e&&(s=(f=Math.floor(o))*i+a,l=f*u+c,!(o-f<5e-8));)o=1/(o-f),a=i,i=s,c=u,u=l;if(l>e&&(u>e?(l=c,s=a):(l=u,s=i)),!r)return[0,n*s,l];let h=Math.floor(n*s/l);return[h,n*s-h*l,l]}function d(t,e,r){if(t>2958465||t<0)return null;let n=0|t,o=Math.floor(86400*(t-n)),a=0,i=[],s={D:n,T:o,u:86400*(t-n)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(1e-6>Math.abs(s.u)&&(s.u=0),e&&e.date1904&&(n+=1462),s.u>.9999&&(s.u=0,86400==++o&&(s.T=o=0,++n,++s.D)),60===n)i=r?[1317,10,29]:[1900,2,29],a=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;let t=new Date(1900,0,1);t.setDate(t.getDate()+n-1),i=[t.getFullYear(),t.getMonth()+1,t.getDate()],a=t.getDay(),n<60&&(a=(a+6)%7),r&&(a=0)}return s.y=i[0],s.m=i[1],s.d=i[2],s.S=o%60,o=Math.floor(o/60),s.M=o%60,o=Math.floor(o/60),s.H=o,s.q=a,s}f(h),e.parse_date_code=d;let m=new Date(1899,11,31,0,0,0),g=m.getTime(),v=new Date(1900,2,1,0,0,0);function E(t,e){let r=t.getTime();return e?r-=1262304e5:t>=v&&(r+=864e5),(r-(g+(t.getTimezoneOffset()-m.getTimezoneOffset())*6e4))/864e5}function y(t){return t.toString(10)}e._general_int=y;let N=function(){let t=/\.(\d*[1-9])0+$/,e=/\.0*$/,r=/\.(\d*[1-9])0+/,n=/\.0*[Ee]/,o=/(E[+-])(\d)$/;function a(r){return r.indexOf(".")>-1?r.replace(e,"").replace(t,".$1"):r}return function(e){let i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),s;if(i>=-4&&i<=-1)s=e.toPrecision(10+i);else if(9>=Math.abs(i))s=function(t){let e=t<0?12:11,r=a(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10)).length<=e?r:t.toExponential(5)}(e);else if(10===i)s=e.toFixed(10).substr(0,12);else{let r;(r=e.toFixed(11).replace(t,".$1")).length>(e<0?12:11)&&(r=e.toPrecision(6)),s=r}return a(function(t){for(let e=0;e!==t.length;++e)if((32|t.charCodeAt(e))==101)return t.replace(r,".$1").replace(n,"E").replace("e","E").replace(o,"$10$2");return t}(s))}}();function R(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?y(t):N(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return S(14,E(t,e&&e.date1904),e)}throw Error("unsupported value in General format: "+t)}function T(t){if(t.length<=3)return t;let e=t.length%3,r=t.substr(0,e);for(;e!==t.length;e+=3)r+=(r.length>0?",":"")+t.substr(e,3);return r}e._general_num=N,e._general=R;let A=function(){let t=/%/g,e=/# (\?+)( ?)\/( ?)(\d+)/,c=/^#*0*\.([0#]+)/,u=/\).*[0#]/,l=/\(###\) ###\\?-####/;function f(t){let e="",r;for(let n=0;n!==t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function h(t,e){let r=Math.pow(10,e);return""+Math.round(t*r)/r}function d(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?0:Math.round((t-Math.floor(t))*Math.pow(10,e))}return function(m,g,v){return(0|v)===v?function s(h,d,m){let g;if(40===h.charCodeAt(0)&&!d.match(u)){let t=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return m>=0?s("n",t,m):"("+s("n",t,-m)+")"}if(44===d.charCodeAt(d.length-1))return function(t,e,r){let n=e.length-1;for(;44===e.charCodeAt(n-1);)--n;return A(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}(h,d,m);if(-1!==d.indexOf("%"))return function(e,r,o){let a=r.replace(t,""),i=r.length-a.length;return A(e,a,o*Math.pow(10,2*i))+n("%",i)}(h,d,m);if(-1!==d.indexOf("E"))return function t(e,r){let n;let o=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0===r)return"0.0E+0";if(r<0)return"-"+t(e,-r);let a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));let i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(r/Math.pow(10,i)).toPrecision(o+1+(a+i)%a)).match(/[Ee]/)){let t=Math.floor(Math.log(r)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(t-n.length+i):n+="E+"+(t-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(t,e,r,n){return e+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"})}else n=r.toExponential(o);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}(d,m);if(36===d.charCodeAt(0))return"$"+s(h,d.substr(" "==d.charAt(1)?2:1),m);let v,E,y,N=Math.abs(m),R=m<0?"-":"";if(d.match(/^00+$/))return R+o(N,d.length);if(d.match(/^[#?]+$/))return g=""+m,0===m&&(g=""),g.length>d.length?g:f(d.substr(0,d.length-g.length))+g;if(v=d.match(e)){var M;return R+(0===N?"":""+N)+n(" ",(M=v)[1].length+2+M[4].length)}if(d.match(/^#+0+$/))return R+o(N,d.length-d.indexOf("0"));if(v=d.match(c))return g=(g=(""+m).replace(/^([^\.]+)$/,"$1."+f(v[1])).replace(/\.$/,"."+f(v[1]))).replace(/\.(\d*)$/,function(t,e){return"."+e+n("0",f(v[1]).length-e.length)}),-1!==d.indexOf("0.")?g:g.replace(/^0\./,".");if(v=(d=d.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return R+(""+N).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,v[1].length?"0.":".");if(v=d.match(/^#{1,3},##0(\.?)$/))return R+T(""+N);if(v=d.match(/^#,##0\.([#0]*0)$/))return m<0?"-"+s(h,d,-m):T(""+m)+"."+n("0",v[1].length);if(v=d.match(/^#,#*,#0/))return s(h,d.replace(/^#,#*,/,""),m);if(v=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=r(s(h,d.replace(/[\\-]/g,""),m)),E=0,r(r(d.replace(/\\/g,"")).replace(/[0#]/g,function(t){return E<g.length?g.charAt(E++):"0"===t?"0":""}));if(d.match(l))return"("+(g=s(h,"##########",m)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);let w="";if(v=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return y=p(N,Math.pow(10,E=Math.min(v[4].length,7))-1,!1),g=""+R," "==(w=A("n",v[1],y[1])).charAt(w.length-1)&&(w=w.substr(0,w.length-1)+"0"),g+=w+v[2]+"/"+v[3],(w=i(y[2],E)).length<v[4].length&&(w=f(v[4].substr(v[4].length-w.length))+w),g+=w;if(v=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return R+((y=p(N,Math.pow(10,E=Math.min(Math.max(v[1].length,v[4].length),7))-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?a(y[1],E)+v[2]+"/"+v[3]+i(y[2],E):n(" ",2*E+1+v[2].length+v[3].length));if(v=d.match(/^[#0?]+$/))return(g=""+m,d.length<=g.length)?g:f(d.substr(0,d.length-g.length))+g;if(v=d.match(/^([#0]+)\.([#0]+)$/)){E=(g=""+m.toFixed(Math.min(v[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");let t=d.indexOf(".")-E,e=d.length-g.length-t;return f(d.substr(0,t)+g+d.substr(d.length-e))}if(v=d.match(/^00,000\.([#0]*0)$/))return m<0?"-"+s(h,d,-m):T(""+m).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t})+"."+o(0,v[1].length);switch(d){case"###,###":case"##,###":case"#,###":let x=T(""+N);return"0"!==x?R+x:"";default:if(d.match(/\.[0#?]*$/))return s(h,d.slice(0,d.lastIndexOf(".")),m)+f(d.slice(d.lastIndexOf(".")))}throw Error("unsupported format |"+d+"|")}(m,g,v):function m(g,v,E){var y;let N;if(40===g.charCodeAt(0)&&!v.match(u)){let t=v.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return E>=0?m("n",t,E):"("+m("n",t,-E)+")"}if(44===v.charCodeAt(v.length-1))return function(t,e,r){let n=e.length-1;for(;44===e.charCodeAt(n-1);)--n;return A(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}(g,v,E);if(-1!==v.indexOf("%"))return function(e,r,o){let a=r.replace(t,""),i=r.length-a.length;return A(e,a,o*Math.pow(10,2*i))+n("%",i)}(g,v,E);if(-1!==v.indexOf("E"))return function t(e,r){let n;let o=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0===r)return"0.0E+0";if(r<0)return"-"+t(e,-r);let a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));let i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(r/Math.pow(10,i)).toPrecision(o+1+(a+i)%a)).indexOf("e")){let t=Math.floor(Math.log(r)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(t-n.length+i):n+="E+"+(t-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(t,e,r,n){return e+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"})}else n=r.toExponential(o);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}(v,E);if(36===v.charCodeAt(0))return"$"+m(g,v.substr(" "==v.charAt(1)?2:1),E);let R,M,w,x=Math.abs(E),I=E<0?"-":"";if(v.match(/^00+$/))return I+s(x,v.length);if(v.match(/^[#?]+$/))return"0"===(N=s(E,0))&&(N=""),N.length>v.length?N:f(v.substr(0,v.length-N.length))+N;if(R=v.match(e))return function(t,e,r){let i=parseInt(t[4],10),s=Math.round(e*i),c=Math.floor(s/i),u=s-c*i;return r+(0===c?"":""+c)+" "+(0===u?n(" ",t[1].length+1+t[4].length):a(u,t[1].length)+t[2]+"/"+t[3]+o(i,t[4].length))}(R,x,I);if(v.match(/^#+0+$/))return I+s(x,v.length-v.indexOf("0"));if(R=v.match(c))return N=h(E,R[1].length).replace(/^([^\.]+)$/,"$1."+f(R[1])).replace(/\.$/,"."+f(R[1])).replace(/\.(\d*)$/,function(t,e){return"."+e+n("0",f(R[1]).length-e.length)}),-1!==v.indexOf("0.")?N:N.replace(/^0\./,".");if(R=(v=v.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return I+h(x,R[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,R[1].length?"0.":".");if(R=v.match(/^#{1,3},##0(\.?)$/))return I+T(s(x,0));if(R=v.match(/^#,##0\.([#0]*0)$/))return E<0?"-"+m(g,v,-E):T(""+(Math.floor(E)+((y=R[1].length)<(""+Math.round((E-Math.floor(E))*Math.pow(10,y))).length?1:0)))+"."+o(d(E,R[1].length),R[1].length);if(R=v.match(/^#,#*,#0/))return m(g,v.replace(/^#,#*,/,""),E);if(R=v.match(/^([0#]+)(\\?-([0#]+))+$/))return N=r(m(g,v.replace(/[\\-]/g,""),E)),M=0,r(r(v.replace(/\\/g,"")).replace(/[0#]/g,function(t){return M<N.length?N.charAt(M++):"0"===t?"0":""}));if(v.match(l))return"("+(N=m(g,"##########",E)).substr(0,3)+") "+N.substr(3,3)+"-"+N.substr(6);let O="";if(R=v.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return w=p(x,Math.pow(10,M=Math.min(R[4].length,7))-1,!1),N=""+I," "===(O=A("n",R[1],w[1])).charAt(O.length-1)&&(O=O.substr(0,O.length-1)+"0"),N+=O+R[2]+"/"+R[3],(O=i(w[2],M)).length<R[4].length&&(O=f(R[4].substr(R[4].length-O.length))+O),N+=O;if(R=v.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return I+((w=p(x,Math.pow(10,M=Math.min(Math.max(R[1].length,R[4].length),7))-1,!0))[0]||(w[1]?"":"0"))+" "+(w[1]?a(w[1],M)+R[2]+"/"+R[3]+i(w[2],M):n(" ",2*M+1+R[2].length+R[3].length));if(R=v.match(/^[#0?]+$/))return(N=s(E,0),v.length<=N.length)?N:f(v.substr(0,v.length-N.length))+N;if(R=v.match(/^([#0?]+)\.([#0]+)$/)){M=(N=""+E.toFixed(Math.min(R[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");let t=v.indexOf(".")-M,e=v.length-N.length-t;return f(v.substr(0,t)+N+v.substr(v.length-e))}if(R=v.match(/^00,000\.([#0]*0)$/))return M=d(E,R[1].length),E<0?"-"+m(g,v,-E):T(E<2147483647&&E>-2147483648?""+(E>=0?0|E:E-1|0):""+Math.floor(E)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(t){return"00,"+(t.length<3?o(0,3-t.length):"")+t})+"."+o(M,R[1].length);switch(v){case"###,##0.00":return m(g,"#,##0.00",E);case"###,###":case"##,###":case"#,###":let b=T(s(x,0));return"0"!==b?I+b:"";case"###,###.00":return m(g,"###,##0.00",E).replace(/^0\./,".");case"#,###.00":return m(g,"#,##0.00",E).replace(/^0\./,".")}throw Error("unsupported format |"+v+"|")}(m,g,v)}}();function M(t){let e=[],r=!1,n=0;for(let o=0;o<t.length;++o)switch(t.charCodeAt(o)){case 34:r=!r;break;case 95:case 42:case 92:++o;break;case 59:e[e.length]=t.substr(n,o-n),n=o+1}if(e[e.length]=t.substr(n),!0===r)throw Error("Format |"+t+"| unterminated string ");return e}e._split=M;let w=/\[[HhMmSs]*\]/;function x(t){let e=0,r="",n="";for(;e<t.length;)switch(r=t.charAt(e)){case"G":c(t,e)&&(e+=6),e++;break;case'"':for(;34!==t.charCodeAt(++e)&&e<t.length;)++e;++e;break;case"\\":case"_":e+=2;break;case"@":++e;break;case"B":case"b":if("1"===t.charAt(e+1)||"2"===t.charAt(e+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===t.substr(e,3).toUpperCase()||"AM/PM"===t.substr(e,5).toUpperCase())return!0;++e;break;case"[":for(n=r;"]"!==t.charAt(e++)&&e<t.length;)n+=t.charAt(e);if(n.match(w))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||"\\"==r&&"-"==t.charAt(e+1)&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(" "===t.charAt(e)||"*"===t.charAt(e))&&++e;break;case"(":case")":case" ":default:++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);}return!1}function I(t,e,r,n){let a=[],i="",s=0,f="",h="t",p,m,g,v="H";for(;s<t.length;)switch(f=t.charAt(s)){case"G":if(!c(t,s))throw Error("unrecognized character "+f+" in "+t);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";34!==(g=t.charCodeAt(++s))&&s<t.length;)i+=String.fromCharCode(g);a[a.length]={t:"t",v:i},++s;break;case"\\":let o=t.charAt(++s),u="("===o||")"===o?o:"t";a[a.length]={t:u,v:o},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:e},++s;break;case"B":case"b":if("1"===t.charAt(s+1)||"2"===t.charAt(s+1)){if(null==p&&null==(p=d(e,r,"2"===t.charAt(s+1))))return"";a[a.length]={t:"X",v:t.substr(s,2)},h=f,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||null==p&&null==(p=d(e,r)))return"";for(i=f;++s<t.length&&t.charAt(s).toLowerCase()===f;)i+=f;"m"===f&&"h"===h.toLowerCase()&&(f="M"),"h"===f&&(f=v),a[a.length]={t:f,v:i},h=f;break;case"A":case"a":let l={t:f,v:f};if(null==p&&(p=d(e,r)),"A/P"===t.substr(s,3).toUpperCase()?(null!=p&&(l.v=p.H>=12?"P":"A"),l.t="T",v="h",s+=3):"AM/PM"===t.substr(s,5).toUpperCase()?(null!=p&&(l.v=p.H>=12?"PM":"AM"),l.t="T",s+=5,v="h"):(l.t="t",++s),null==p&&"T"===l.t)return"";a[a.length]=l,h=f;break;case"[":for(i=f;"]"!==t.charAt(s++)&&s<t.length;)i+=t.charAt(s);if("]"!==i.slice(-1))throw'unterminated "[" block: |'+i+"|";if(i.match(w)){if(null==p&&null==(p=d(e,r)))return"";a[a.length]={t:"Z",v:i.toLowerCase()},h=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",x(t)||(a[a.length]={t:"t",v:i}));break;case".":if(null!=p){for(i=f;++s<t.length&&"0"===(f=t.charAt(s));)i+=f;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=f;++s<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(s))>-1||"\\"==f&&"-"==t.charAt(s+1)&&s<t.length-2&&"0#".indexOf(t.charAt(s+2))>-1;)i+=f;a[a.length]={t:"n",v:i};break;case"?":for(i=f;t.charAt(++s)===f;)i+=f;a[a.length]={t:f,v:i},h=f;break;case"*":++s,(" "===t.charAt(s)||"*"===t.charAt(s))&&++s;break;case"(":case")":a[a.length]={t:1===n||"number"==typeof e&&e<0?"t":f,v:f},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=f;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)i+=t.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:f,v:f},++s;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(f))throw Error("unrecognized character "+f+" in "+t);a[a.length]={t:"t",v:f},++s}let E=0,y=0,N;for(s=a.length-1,h="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=v,h="h",E<1&&(E=1);break;case"s":(N=a[s].v.match(/\.0+$/))&&(y=Math.max(y,N[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=a[s].t;break;case"m":"s"===h&&(a[s].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[s].v.match(/[Hh]/)&&(E=1),E<2&&a[s].v.match(/[Mm]/)&&(E=2),E<3&&a[s].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M)}let T="",M;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=function(t,e,r,n){let a="",i=0,s=0,c=r.y,f,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4}break;case 109:switch(e.length){case 1:case 2:f=r.m,h=e.length;break;case 3:return l[r.m-1][1];case 5:return l[r.m-1][0];default:return l[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,h=e.length;break;case 3:return u[r.q][0];default:return u[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if("s"!==e&&"ss"!==e&&".0"!==e&&".00"!==e&&".000"!==e)throw"bad second format: "+e;if(0===r.u&&("s"===e||"ss"===e))return o(r.S,e.length);if((i=Math.round((s=n>=2?3===n?1e3:100:1===n?10:1)*(r.S+r.u)))>=60*s&&(i=0),"s"===e)return 0===i?"0":""+i/s;if(a=o(i,2+n),"ss"===e)return a.substr(0,2);return"."+a.substr(2,e.length-1);case 90:switch(e){case"[h]":case"[hh]":f=24*r.D+r.H;break;case"[m]":case"[mm]":f=(24*r.D+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((24*r.D+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=3===e.length?1:2;break;case 101:f=c,h=1}return h>0?o(f,h):""}(a[s].t.charCodeAt(0),a[s].v,p,y),a[s].t="t";break;case"n":case"(":case"?":for(M=s+1;null!=a[M]&&("?"===(f=a[M].t)||"D"===f||(" "===f||"t"===f)&&null!=a[M+1]&&("?"===a[M+1].t||"t"===a[M+1].t&&"/"===a[M+1].v)||"("===a[s].t&&(" "===f||"n"===f||")"===f)||"t"===f&&("/"===a[M].v||" "===a[M].v&&null!=a[M+1]&&"?"===a[M+1].t));)a[s].v+=a[M].v,a[M]={v:"",t:";"},++M;T+=a[s].v,s=M-1;break;case"G":a[s].t="t",a[s].v=R(e,r)}let I="",O,b;if(T.length>0){40===T.charCodeAt(0)?(O=e<0&&45===T.charCodeAt(0)?-e:e,b=A("(",T,O)):(b=A("n",T,O=e<0&&n>1?-e:e),O<0&&a[0]&&"t"===a[0].t&&(b=b.substr(1),a[0].v="-"+a[0].v)),M=b.length-1;let t=a.length;for(s=0;s<a.length;++s)if(null!=a[s]&&"t"!==a[s].t&&a[s].v.indexOf(".")>-1){t=s;break}let r=a.length;if(t===a.length&&-1===b.indexOf("E")){for(s=a.length-1;s>=0;--s)null!=a[s]&&-1!=="n?(".indexOf(a[s].t)&&(M>=a[s].v.length-1?(M-=a[s].v.length,a[s].v=b.substr(M+1,a[s].v.length)):M<0?a[s].v="":(a[s].v=b.substr(0,M+1),M=-1),a[s].t="t",r=s);M>=0&&r<a.length&&(a[r].v=b.substr(0,M+1)+a[r].v)}else if(t!==a.length&&-1===b.indexOf("E")){for(M=b.indexOf(".")-1,s=t;s>=0;--s)if(null!=a[s]&&-1!=="n?(".indexOf(a[s].t)){for(m=a[s].v.indexOf(".")>-1&&s===t?a[s].v.indexOf(".")-1:a[s].v.length-1,I=a[s].v.substr(m+1);m>=0;--m)M>=0&&("0"===a[s].v.charAt(m)||"#"===a[s].v.charAt(m))&&(I=b.charAt(M--)+I);a[s].v=I,a[s].t="t",r=s}for(M>=0&&r<a.length&&(a[r].v=b.substr(0,M+1)+a[r].v),M=b.indexOf(".")+1,s=t;s<a.length;++s)if(null!=a[s]&&(-1!=="n?(".indexOf(a[s].t)||s===t)){for(m=a[s].v.indexOf(".")>-1&&s===t?a[s].v.indexOf(".")+1:0,I=a[s].v.substr(0,m);m<a[s].v.length;++m)M<b.length&&(I+=b.charAt(M++));a[s].v=I,a[s].t="t",r=s}}}for(s=0;s<a.length;++s)null!=a[s]&&"n(?".indexOf(a[s].t)>-1&&(O=n>1&&e<0&&s>0&&"-"===a[s-1].v?-e:e,a[s].v=A(a[s].t,a[s].v,O),a[s].t="t");let C="";for(s=0;s!==a.length;++s)null!=a[s]&&(C+=a[s].v);return C}e.is_date=x,e._eval=I;let O=/\[[=<>]/,b=/\[([=<>]*)(-?\d+\.?\d*)\]/;function C(t,e){if(null==e)return!1;let r=parseFloat(e[2]);switch(e[1]){case"=":if(t===r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!==r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0}return!1}function S(t,e,r){null==r&&(r={});let n="";switch(typeof t){case"string":n="m/d/yy"===t&&r.dateNF?r.dateNF:t;break;case"number":n=14===t&&r.dateNF?r.dateNF:(null!=r.table?r.table:h)[t]}if(c(n,0))return R(e,r);e instanceof Date&&(e=E(e,r.date1904));let o=function(t,e){let r=M(t),n=r.length,o=r[n-1].indexOf("@");if(n<4&&o>-1&&--n,r.length>4)throw Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof e)return[4,4===r.length||o>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=o>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}let a=e>0?r[0]:e<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,a];if(null!=r[0].match(O)||null!=r[1].match(O)){let t=r[0].match(b),o=r[1].match(b);return C(e,t)?[n,r[0]]:C(e,o)?[n,r[1]]:[n,r[null!=t&&null!=o?2:1]]}return[n,a]}(n,e);if(c(o[1]))return R(e,r);if(!0===e)e="TRUE";else if(!1===e)e="FALSE";else if(""===e||null==e)return"";return I(o[1],e,r,o[0])}function U(t,e){if("number"!=typeof e){e=+e||-1;for(let r=0;r<392;++r){if(void 0===h[r]){e<0&&(e=r);continue}if(h[r]===t){e=r;break}}e<0&&(e=391)}return h[e]=t,e}e.load=U,e._table=h,e.get_table=function(){return h},e.load_table=function(t){for(let e=0;392!==e;++e)void 0!==t[e]&&U(t[e],e)},e.init_table=f,e.format=S,t.exports=e},61998:function(t){var e;e=function(){var t,e=function(t,e){var r=Array.prototype.concat,n=Array.prototype.slice,o=Object.prototype.toString;function a(e,r){var n=e>r?e:r;return t.pow(10,17-~~(t.log(n>0?n:-n)*t.LOG10E))}var i=Array.isArray||function(t){return"[object Array]"===o.call(t)};function s(t){return"[object Function]"===o.call(t)}function c(t){return"number"==typeof t&&t-t==0}function u(){return new u._init(arguments)}function l(){return 0}function f(){return 1}function h(t,e){return t===e?1:0}u.fn=u.prototype,u._init=function(t){if(i(t[0])){if(i(t[0][0])){s(t[1])&&(t[0]=u.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=s(t[1])?u.map(t[0],t[1]):t[0],this.length=1}else if(c(t[0]))this[0]=u.seq.apply(null,t),this.length=1;else{if(t[0]instanceof u)return u(t[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:a,isArray:i,isFunction:s,isNumber:c,toVector:function(t){return r.apply([],t)}},u._random_fn=t.random,u.setRandom=function(t){if("function"!=typeof t)throw TypeError("fn is not a function");u._random_fn=t},u.extend=function(t){var e,r;if(1==arguments.length){for(r in t)u[r]=t[r];return this}for(e=1;e<arguments.length;e++)for(r in arguments[e])t[r]=arguments[e][r];return t},u.rows=function(t){return t.length||1},u.cols=function(t){return t[0].length||1},u.dimensions=function(t){return{rows:u.rows(t),cols:u.cols(t)}},u.row=function(t,e){return i(e)?e.map(function(e){return u.row(t,e)}):t[e]},u.rowa=function(t,e){return u.row(t,e)},u.col=function(t,e){if(i(e)){var r=u.arange(t.length).map(function(){return Array(e.length)});return e.forEach(function(e,n){u.arange(t.length).forEach(function(o){r[o][n]=t[o][e]})}),r}for(var n=Array(t.length),o=0;o<t.length;o++)n[o]=[t[o][e]];return n},u.cola=function(t,e){return u.col(t,e).map(function(t){return t[0]})},u.diag=function(t){for(var e=u.rows(t),r=Array(e),n=0;n<e;n++)r[n]=[t[n][n]];return r},u.antidiag=function(t){for(var e=u.rows(t)-1,r=Array(e),n=0;e>=0;e--,n++)r[n]=[t[n][e]];return r},u.transpose=function(t){var e,r,n,o,a,s=[];for(i(t[0])||(t=[t]),r=t.length,n=t[0].length,a=0;a<n;a++){for(o=0,e=Array(r);o<r;o++)e[o]=t[o][a];s.push(e)}return 1===s.length?s[0]:s},u.map=function(t,e,r){var n,o,a,s,c;for(i(t[0])||(t=[t]),o=t.length,a=t[0].length,s=r?t:Array(o),n=0;n<o;n++)for(s[n]||(s[n]=Array(a)),c=0;c<a;c++)s[n][c]=e(t[n][c],n,c);return 1===s.length?s[0]:s},u.cumreduce=function(t,e,r){var n,o,a,s,c;for(i(t[0])||(t=[t]),o=t.length,a=t[0].length,s=r?t:Array(o),n=0;n<o;n++)for(s[n]||(s[n]=Array(a)),a>0&&(s[n][0]=t[n][0]),c=1;c<a;c++)s[n][c]=e(s[n][c-1],t[n][c]);return 1===s.length?s[0]:s},u.alter=function(t,e){return u.map(t,e,!0)},u.create=function(t,e,r){var n,o,a=Array(t);for(s(e)&&(r=e,e=t),n=0;n<t;n++)for(o=0,a[n]=Array(e);o<e;o++)a[n][o]=r(n,o);return a},u.zeros=function(t,e){return c(e)||(e=t),u.create(t,e,l)},u.ones=function(t,e){return c(e)||(e=t),u.create(t,e,f)},u.rand=function(t,e){return c(e)||(e=t),u.create(t,e,u._random_fn)},u.identity=function(t,e){return c(e)||(e=t),u.create(t,e,h)},u.symmetric=function(t){var e,r,n=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<n;e++)for(r=0;r<n;r++)if(t[r][e]!==t[e][r])return!1;return!0},u.clear=function(t){return u.alter(t,l)},u.seq=function(t,e,r,n){s(n)||(n=!1);var o,i=[],c=a(t,e),u=(e*c-t*c)/((r-1)*c),l=t;for(o=0;l<=e&&o<r;l=(t*c+u*c*++o)/c)i.push(n?n(l,o):l);return i},u.arange=function(t,r,n){var o,a=[];if(n=n||1,e===r&&(r=t,t=0),t===r||0===n||t<r&&n<0||t>r&&n>0)return[];if(n>0)for(o=t;o<r;o+=n)a.push(o);else for(o=t;o>r;o+=n)a.push(o);return a},u.slice=function(){function t(t,r,n,o){var a,i=[],s=t.length;if(e===r&&e===n&&e===o)return u.copy(t);if(r=r||0,n=n||t.length,o=o||1,(r=r>=0?r:s+r)===(n=n>=0?n:s+n)||0===o||r<n&&o<0||r>n&&o>0)return[];if(o>0)for(a=r;a<n;a+=o)i.push(t[a]);else for(a=r;a>n;a+=o)i.push(t[a]);return i}return function(e,r){if(c((r=r||{}).row)){var n,o;return c(r.col)?e[r.row][r.col]:t(u.rowa(e,r.row),(n=r.col||{}).start,n.end,n.step)}return c(r.col)?t(u.cola(e,r.col),(o=r.row||{}).start,o.end,o.step):(o=r.row||{},n=r.col||{},t(e,o.start,o.end,o.step).map(function(e){return t(e,n.start,n.end,n.step)}))}}(),u.sliceAssign=function(r,n,o){var a,i;if(c(n.row)){if(c(n.col))return r[n.row][n.col]=o;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,a=u.arange(n.col.start,t.min(r.length,n.col.end),n.col.step);var s=n.row;return a.forEach(function(t,e){r[s][t]=o[e]}),r}if(c(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,i=u.arange(n.row.start,t.min(r[0].length,n.row.end),n.row.step);var l=n.col;return i.forEach(function(t,e){r[t][l]=o[e]}),r}return e===o[0].length&&(o=[o]),n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,i=u.arange(n.row.start,t.min(r.length,n.row.end),n.row.step),a=u.arange(n.col.start,t.min(r[0].length,n.col.end),n.col.step),i.forEach(function(t,e){a.forEach(function(n,a){r[t][n]=o[e][a]})}),r},u.diagonal=function(t){var e=u.zeros(t.length,t.length);return t.forEach(function(t,r){e[r][r]=t}),e},u.copy=function(t){return t.map(function(t){return c(t)?t:t.map(function(t){return t})})};var p=u.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},p.map=function(t,e){return u(u.map(this,t,e))},p.cumreduce=function(t,e){return u(u.cumreduce(this,t,e))},p.alter=function(t){return u.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e){var r,n=this;return e?(setTimeout(function(){e.call(n,p[t].call(n))}),this):i(r=u[t](this))?u(r):r}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e,r){var n=this;return r?(setTimeout(function(){r.call(n,p[t].call(n,e))}),this):u(u[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(){return u(u[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),u}(Math);return function(t,e){var r=t.utils.isFunction;function n(t,e){return t-e}function o(t,r,n){return e.max(r,e.min(t,n))}t.sum=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.sumsqrd=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r]*t[r];return e},t.sumsqerr=function(e){for(var r,n=t.mean(e),o=0,a=e.length;--a>=0;)o+=(r=e[a]-n)*r;return o},t.sumrow=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.product=function(t){for(var e=1,r=t.length;--r>=0;)e*=t[r];return e},t.min=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]<e&&(e=t[r]);return e},t.max=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]>e&&(e=t[r]);return e},t.unique=function(t){for(var e={},r=[],n=0;n<t.length;n++)e[t[n]]||(e[t[n]]=!0,r.push(t[n]));return r},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(r){var n=r.map(e.log),o=t.mean(n);return e.exp(o)},t.median=function(t){var e=t.length,r=t.slice().sort(n);return 1&e?r[e/2|0]:(r[e/2-1]+r[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,function(t,e){return t+e})},t.cumprod=function(e){return t.cumreduce(e,function(t,e){return t*e})},t.diff=function(t){var e,r=[],n=t.length;for(e=1;e<n;e++)r.push(t[e]-t[e-1]);return r},t.rank=function(t){var e,r=[],o={};for(e=0;e<t.length;e++){var a=t[e];o[a]?o[a]++:(o[a]=1,r.push(a))}var i=r.sort(n),s={},c=1;for(e=0;e<i.length;e++){var a=i[e],u=o[a],l=(c+(c+u-1))/2;s[a]=l,c+=u}return t.map(function(t){return s[t]})},t.mode=function(t){var e,r=t.length,o=t.slice().sort(n),a=1,i=0,s=0,c=[];for(e=0;e<r;e++)o[e]===o[e+1]?a++:(a>i?(c=[o[e]],i=a,s=0):a===i&&(c.push(o[e]),s++),a=1);return 0===s?c[0]:c},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,r){return t.sumsqerr(e)/(e.length-(r?1:0))},t.pooledvariance=function(e){return e.reduce(function(e,r){return e+t.sumsqerr(r)},0)/(e.reduce(function(t,e){return t+e.length},0)-e.length)},t.deviation=function(e){for(var r=t.mean(e),n=e.length,o=Array(n),a=0;a<n;a++)o[a]=e[a]-r;return o},t.stdev=function(r,n){return e.sqrt(t.variance(r,n))},t.pooledstdev=function(r){return e.sqrt(t.pooledvariance(r))},t.meandev=function(r){for(var n=t.mean(r),o=[],a=r.length-1;a>=0;a--)o.push(e.abs(r[a]-n));return t.mean(o)},t.meddev=function(r){for(var n=t.median(r),o=[],a=r.length-1;a>=0;a--)o.push(e.abs(r[a]-n));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var r=t.length,o=t.slice().sort(n);return[o[e.round(r/4)-1],o[e.round(r/2)-1],o[e.round(3*r/4)-1]]},t.quantiles=function(t,r,a,i){var s,c,u,l,f,h,p=t.slice().sort(n),d=[r.length],m=t.length;for(void 0===a&&(a=3/8),void 0===i&&(i=3/8),s=0;s<r.length;s++)u=a+(c=r[s])*(1-a-i),l=m*c+u,f=e.floor(o(l,1,m-1)),h=o(l-f,0,1),d[s]=(1-h)*p[f-1]+h*p[f];return d},t.percentile=function(t,e,r){var o=t.slice().sort(n),a=e*(o.length+(r?1:-1))+(r?0:1),i=parseInt(a);return i+1<o.length?o[i-1]+(a-i)*(o[i]-o[i-1]):o[i-1]},t.percentileOfScore=function(t,e,r){var n,o,a=0,i=t.length,s=!1;for("strict"===r&&(s=!0),o=0;o<i;o++)n=t[o],(s&&n<e||!s&&n<=e)&&a++;return a/i},t.histogram=function(r,n){n=n||4;var o,a=t.min(r),i=(t.max(r)-a)/n,s=r.length,c=[];for(o=0;o<n;o++)c[o]=0;for(o=0;o<s;o++)c[e.min(e.floor((r[o]-a)/i),n-1)]+=1;return c},t.covariance=function(e,r){var n,o=t.mean(e),a=t.mean(r),i=e.length,s=Array(i);for(n=0;n<i;n++)s[n]=(e[n]-o)*(r[n]-a);return t.sum(s)/(i-1)},t.corrcoeff=function(e,r){return t.covariance(e,r)/t.stdev(e,1)/t.stdev(r,1)},t.spearmancoeff=function(e,r){return e=t.rank(e),r=t.rank(r),t.corrcoeff(e,r)},t.stanMoment=function(r,n){for(var o=t.mean(r),a=t.stdev(r),i=r.length,s=0,c=0;c<i;c++)s+=e.pow((r[c]-o)/a,n);return s/r.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var a=t.prototype;(function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(n,o){var i=[],s=0,c=this;if(r(n)&&(o=n,n=!1),o)return setTimeout(function(){o.call(c,a[e].call(c,n))}),this;if(this.length>1){for(c=!0===n?this:this.transpose();s<c.length;s++)i[s]=t[e](c[s]);return i}return t[e](this[0],n)}}(e[n])})("cumsum cumprod".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(n,o){var i=[],s=0,c=this;if(r(n)&&(o=n,n=!1),o)return setTimeout(function(){o.call(c,a[e].call(c,n))}),this;if(this.length>1){for("sumrow"!==e&&(c=!0===n?this:this.transpose());s<c.length;s++)i[s]=t[e](c[s]);return!0===n?t[e](t.utils.toVector(i)):i}return t[e](this[0],n)}}(e[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){a[e]=function(){var n,o=[],i=0,s=this,c=Array.prototype.slice.call(arguments);if(r(c[c.length-1])){n=c[c.length-1];var u=c.slice(0,c.length-1);return setTimeout(function(){n.call(s,a[e].apply(s,u))}),this}n=void 0;var l=function(r){return t[e].apply(s,[r].concat(c))};if(this.length>1){for(s=s.transpose();i<s.length;i++)o[i]=l(s[i]);return o}return l(this[0])}}(e[n])}("quantiles percentileOfScore".split(" "))}(e,Math),t=Math,e.gammaln=function(e){var r,n,o=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-.000005395239384953],i=1.000000000190015;for(n=(r=e)+5.5,n-=(e+.5)*t.log(n);o<6;o++)i+=a[o]/++r;return t.log(2.5066282746310007*i/e)-n},e.loggam=function(e){var r,n,o,a,i,s,c,u=[.08333333333333333,-.002777777777777778,7936507936507937e-19,-.0005952380952380952,8417508417508418e-19,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(r=e,c=0,1==e||2==e)return 0;for(e<=7&&(c=t.floor(7-e),r=e+c),n=1/(r*r),o=2*t.PI,i=-1.3924322169059,s=8;s>=0;s--)i*=n,i+=u[s];if(a=i/r+.5*t.log(o)+(r-.5)*t.log(r)-r,e<=7)for(s=1;s<=c;s++)a-=t.log(r-1),r-=1;return a},e.gammafn=function(e){var r,n,o,a,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],c=!1,u=0,l=0,f=0,h=e;if(e>171.6243769536076)return 1/0;if(h<=0){if(!(a=h%1+36e-17))return 1/0;c=(1&h?-1:1)*t.PI/t.sin(t.PI*a),h=1-h}for(r=0,o=h,n=h<1?h++:(h-=u=(0|h)-1)-1;r<8;++r)f=(f+i[r])*n,l=l*n+s[r];if(a=f/l+1,o<h)a/=o;else if(o>h)for(r=0;r<u;++r)a*=h,h++;return c&&(a=c/a),a},e.gammap=function(t,r){return e.lowRegGamma(t,r)*e.gammafn(t)},e.lowRegGamma=function(r,n){var o,a=e.gammaln(r),i=r,s=1/r,c=s,u=n+1-r,l=1/1e-30,f=1/u,h=f,p=1,d=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);if(n<0||r<=0)return NaN;if(n<r+1){for(;p<=d;p++)s+=c*=n/++i;return s*t.exp(-n+r*t.log(n)-a)}for(;p<=d;p++)u+=2,h*=(f=1/(f=(o=-p*(p-r))*f+u))*(l=u+o/l);return 1-h*t.exp(-n+r*t.log(n)-a)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(r,n){return r>170||n>170?t.exp(e.combinationln(r,n)):e.factorial(r)/e.factorial(n)/e.factorial(r-n)},e.combinationln=function(t,r){return e.factorialln(t)-e.factorialln(r)-e.factorialln(t-r)},e.permutation=function(t,r){return e.factorial(t)/e.factorial(t-r)},e.betafn=function(r,n){if(!(r<=0)&&!(n<=0))return r+n>170?t.exp(e.betaln(r,n)):e.gammafn(r)*e.gammafn(n)/e.gammafn(r+n)},e.betaln=function(t,r){return e.gammaln(t)+e.gammaln(r)-e.gammaln(t+r)},e.betacf=function(e,r,n){var o,a,i,s,c=1,u=r+n,l=r+1,f=r-1,h=1,p=1-u*e/l;for(1e-30>t.abs(p)&&(p=1e-30),s=p=1/p;c<=100&&(o=2*c,p=1+(a=c*(n-c)*e/((f+o)*(r+o)))*p,1e-30>t.abs(p)&&(p=1e-30),h=1+a/h,1e-30>t.abs(h)&&(h=1e-30),s*=(p=1/p)*h,p=1+(a=-(r+c)*(u+c)*e/((r+o)*(l+o)))*p,1e-30>t.abs(p)&&(p=1e-30),h=1+a/h,1e-30>t.abs(h)&&(h=1e-30),s*=i=(p=1/p)*h,!(3e-7>t.abs(i-1)));c++);return s},e.gammapinv=function(r,n){var o,a,i,s,c,u,l=0,f=n-1,h=e.gammaln(n);if(r>=1)return t.max(100,n+100*t.sqrt(n));if(r<=0)return 0;for(n>1?(c=t.log(f),u=t.exp(f*(c-1)-h),s=r<.5?r:1-r,o=(2.30753+.27061*(a=t.sqrt(-2*t.log(s))))/(1+a*(.99229+.04481*a))-a,r<.5&&(o=-o),o=t.max(.001,n*t.pow(1-1/(9*n)-o/(3*t.sqrt(n)),3))):o=r<(a=1-n*(.253+.12*n))?t.pow(r/a,1/n):1-t.log(1-(r-a)/(1-a));l<12;l++){if(o<=0)return 0;if(i=(e.lowRegGamma(n,o)-r)/(a=n>1?u*t.exp(-(o-f)+f*(t.log(o)-c)):t.exp(-o+f*t.log(o)-h)),(o-=a=i/(1-.5*t.min(1,i*((n-1)/o-1))))<=0&&(o=.5*(o+a)),t.abs(a)<1e-8*o)break}return o},e.erf=function(e){var r,n,o,a,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,366839497852761e-18,42523324806907e-18,-.000020278578112534,-.000001624290004647,130365583558e-17,15626441722e-18,-.000000085238095915,6529054439e-18,5059343495e-18,-.000000000991364156,-.000000000227365122,96467911e-18,2394038e-18,-.000000000006886027,894487e-18,313092e-18,-.000000000000112708,381e-18,7106e-18,-.000000000000001523,-.000000000000000094,121e-18,-.000000000000000028],s=i.length-1,c=!1,u=0,l=0;for(e<0&&(e=-e,c=!0),n=4*(r=2/(2+e))-2;s>0;s--)o=u,u=n*u-l+i[s],l=o;return a=r*t.exp(-e*e+.5*(i[0]+n*u)-l),c?a-1:1-a},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(r){var n,o,a,i,s=0;if(r>=2)return -100;if(r<=0)return 100;for(i=r<1?r:2-r,n=-.70711*((2.30753+.27061*(a=t.sqrt(-2*t.log(i/2))))/(1+a*(.99229+.04481*a))-a);s<2;s++)o=e.erfc(n)-i,n+=o/(1.1283791670955126*t.exp(-n*n)-n*o);return r<1?n:-n},e.ibetainv=function(r,n,o){var a,i,s,c,u,l,f,h,p,d,m=n-1,g=o-1,v=0;if(r<=0)return 0;if(r>=1)return 1;for(n>=1&&o>=1?(s=r<.5?r:1-r,l=(2.30753+.27061*(c=t.sqrt(-2*t.log(s))))/(1+c*(.99229+.04481*c))-c,r<.5&&(l=-l),f=(l*l-3)/6,h=2/(1/(2*n-1)+1/(2*o-1)),p=l*t.sqrt(f+h)/h-(1/(2*o-1)-1/(2*n-1))*(f+5/6-2/(3*h)),l=n/(n+o*t.exp(2*p))):(a=t.log(n/(n+o)),i=t.log(o/(n+o)),p=(c=t.exp(n*a)/n)+(u=t.exp(o*i)/o),l=r<c/p?t.pow(n*p*r,1/n):1-t.pow(o*p*(1-r),1/o)),d=-e.gammaln(n)-e.gammaln(o)+e.gammaln(n+o);v<10&&0!==l&&1!==l&&(u=(e.ibeta(l,n,o)-r)/(c=t.exp(m*t.log(l)+g*t.log(1-l)+d)),(l-=c=u/(1-.5*t.min(1,u*(m/l-g/(1-l)))))<=0&&(l=.5*(l+c)),l>=1&&(l=.5*(l+c+1)),!(t.abs(c)<1e-8*l)||!(v>0));v++);return l},e.ibeta=function(r,n,o){var a=0===r||1===r?0:t.exp(e.gammaln(n+o)-e.gammaln(n)-e.gammaln(o)+n*t.log(r)+o*t.log(1-r));return!(r<0)&&!(r>1)&&(r<(n+1)/(n+o+2)?a*e.betacf(r,n,o)/n:1-a*e.betacf(1-r,o,n)/o)},e.randn=function(r,n){var o,a,i,s,c;if(n||(n=r),r)return e.create(r,n,function(){return e.randn()});do o=e._random_fn(),a=1.7156*(e._random_fn()-.5),c=(i=o-.449871)*i+(s=t.abs(a)+.386595)*(.196*s-.25472*i);while(c>.27597&&(c>.27846||a*a>-4*t.log(o)*o*o));return a/o},e.randg=function(r,n,o){var a,i,s,c,u,l,f=r;if(o||(o=n),r||(r=1),n)return(l=e.zeros(n,o)).alter(function(){return e.randg(r)}),l;r<1&&(r+=1),a=r-1/3,i=1/t.sqrt(9*a);do{do c=1+i*(u=e.randn());while(c<=0);c=c*c*c,s=e._random_fn()}while(s>1-.331*t.pow(u,4)&&t.log(s)>.5*u*u+a*(1-c+t.log(c)));if(r==f)return a*c;do s=e._random_fn();while(0===s);return t.pow(s,1/f)*a*c},function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e.map(this,function(r){return e[t](r)}))}}(t[r])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[r])}("randn".split(" ")),function(t,e){function r(t,r,n,o){for(var a,i=0,s=1,c=1,u=1,l=0,f=0;e.abs((c-f)/c)>o;)f=c,i=c+(a=-(r+l)*(r+n+l)*t/(r+2*l)/(r+2*l+1))*i,s=u+a*s,l+=1,c=i+(a=l*(n-l)*t/(r+2*l-1)/(r+2*l))*c,i/=u=s+a*u,s/=u,c/=u,u=1;return c/r}function n(r,n,o){var a=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],i=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*r;if(s>=8)return 1;var c=2*t.normal.cdf(s,0,1,1,0)-1;c=c>=e.exp(-50/o)?e.pow(c,o):0;for(var u=s,l=(8-s)/(y=r>3?2:3),f=u+l,h=0,p=o-1,d=1;d<=y;d++){for(var m=0,g=.5*(f+u),v=.5*(f-u),E=1;E<=12;E++){var y,N,R=g+v*(6<E?a[(N=12-E+1)-1]:-a[(N=E)-1]),T=R*R;if(T>60)break;var A=2*t.normal.cdf(R,0,1,1,0)*.5-2*t.normal.cdf(R,r,1,1,0)*.5;A>=e.exp(-30/p)&&(m+=A=i[N-1]*e.exp(-(.5*T))*e.pow(A,p))}m*=2*v*o/e.sqrt(2*e.PI),h+=m,u=f,f+=l}return(c+=h)<=e.exp(-30/n)?0:(c=e.pow(c,n))>=1?1:c}(function(e){for(var r=0;r<e.length;r++)!function(e){t[e]=function t(e,r,n){return this instanceof t?(this._a=e,this._b=r,this._c=n,this):new t(e,r,n)},t.fn[e]=function(r,n,o){var a=t[e](r,n,o);return a.data=this,a},t[e].prototype.sample=function(r){var n=this._a,o=this._b,a=this._c;return r?t.alter(r,function(){return t[e].sample(n,o,a)}):t[e].sample(n,o,a)},function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(n){var o=this._a,a=this._b,i=this._c;return(n||0===n||(n=this.data),"number"!=typeof n)?t.fn.map.call(n,function(n){return t[e][r](n,o,a,i)}):t[e][r](n,o,a,i)}}(r[n])}("pdf cdf inv".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(){return t[e][r](this._a,this._b,this._c)}}(r[n])}("mean median mode variance".split(" "))}(e[r])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(r,n,o){return r>1||r<0?0:1==n&&1==o?1:n<512&&o<512?e.pow(r,n-1)*e.pow(1-r,o-1)/t.betafn(n,o):e.exp((n-1)*e.log(r)+(o-1)*e.log(1-r)-t.betaln(n,o))},cdf:function(e,r,n){return e>1||e<0?(e>1)*1:t.ibeta(e,r,n)},inv:function(e,r,n){return t.ibetainv(e,r,n)},mean:function(t,e){return t/(t+e)},median:function(e,r){return t.ibetainv(.5,e,r)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,r){var n=t.randg(e);return n/(n+t.randg(r))},variance:function(t,r){return t*r/(e.pow(t+r,2)*(t+r+1))}}),t.extend(t.centralF,{pdf:function(r,n,o){var a,i;return r<0?0:n<=2?0===r&&n<2?1/0:0===r&&2===n?1:1/t.betafn(n/2,o/2)*e.pow(n/o,n/2)*e.pow(r,n/2-1)*e.pow(1+n/o*r,-(n+o)/2):(a=n*r/(o+r*n),i=o/(o+r*n),n*i/2*t.binomial.pdf((n-2)/2,(n+o-2)/2,a))},cdf:function(e,r,n){return e<0?0:t.ibeta(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/t.ibetainv(e,r/2,n/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,r){return 2*t.randg(e/2)/e/(2*t.randg(r/2)/r)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,r,n){return n<0?0:n/(e.pow(t-r,2)+e.pow(n,2))/e.PI},cdf:function(t,r,n){return e.atan((t-r)/n)/e.PI+.5},inv:function(t,r,n){return r+n*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(r,n){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*n+r}}),t.extend(t.chisquare,{pdf:function(r,n){return r<0?0:0===r&&2===n?.5:e.exp((n/2-1)*e.log(r)-r/2-n/2*e.log(2)-t.gammaln(n/2))},cdf:function(e,r){return e<0?0:t.lowRegGamma(r/2,e/2)},inv:function(e,r){return 2*t.gammapinv(e,.5*r)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,r){return t<0?0:r*e.exp(-r*t)},cdf:function(t,r){return t<0?0:1-e.exp(-r*t)},inv:function(t,r){return-e.log(1-t)/r},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(r){return -1/r*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(r,n,o){return r<0?0:0===r&&1===n?1/o:e.exp((n-1)*e.log(r)-r/o-t.gammaln(n)-n*e.log(o))},cdf:function(e,r,n){return e<0?0:t.lowRegGamma(r,e/n)},inv:function(e,r,n){return t.gammapinv(e,r)*n},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,r){return t.randg(e)*r},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(r,n,o){return r<=0?0:e.exp(-(n+1)*e.log(r)-o/r-t.gammaln(n)+n*e.log(o))},cdf:function(e,r,n){return e<=0?0:1-t.lowRegGamma(r,n/e)},inv:function(e,r,n){return n/t.gammapinv(1-e,r)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,r){return r/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,r,n){return 0===t&&1===r?n:1===t&&1===n?r:e.exp(e.log(r)+e.log(n)+(r-1)*e.log(t)+(n-1)*e.log(1-e.pow(t,r)))},cdf:function(t,r,n){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,r),n)},inv:function(t,r,n){return e.pow(1-e.pow(1-t,1/n),1/r)},mean:function(e,r){return r*t.gammafn(1+1/e)*t.gammafn(r)/t.gammafn(1+1/e+r)},median:function(t,r){return e.pow(1-e.pow(2,-1/r),1/t)},mode:function(t,r){if(t>=1&&r>=1&&1!==t&&1!==r)return e.pow((t-1)/(t*r-1),1/t)},variance:function(){throw Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,r,n){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(n)-e.pow(e.log(t)-r,2)/(2*n*n))},cdf:function(r,n,o){return r<0?0:.5+.5*t.erf((e.log(r)-n)/e.sqrt(2*o*o))},inv:function(r,n,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*r)+n)},mean:function(t,r){return e.exp(t+r*r/2)},median:function(t){return e.exp(t)},mode:function(t,r){return e.exp(t-r*r)},sample:function(r,n){return e.exp(t.randn()*n+r)},variance:function(t,r){return(e.exp(r*r)-1)*e.exp(2*t+r*r)}}),t.extend(t.noncentralt,{pdf:function(r,n,o){return 1e-14>e.abs(o)?t.studentt.pdf(r,n):1e-14>e.abs(r)?e.exp(t.gammaln((n+1)/2)-o*o/2-.5*e.log(e.PI*n)-t.gammaln(n/2)):n/r*(t.noncentralt.cdf(r*e.sqrt(1+2/n),n+2,o)-t.noncentralt.cdf(r,n,o))},cdf:function(r,n,o){if(1e-14>e.abs(o))return t.studentt.cdf(r,n);var a=!1;r<0&&(a=!0,o=-o);for(var i=t.normal.cdf(-o,0,1),s=1e-14+1,c=1e-14+1,u=r*r/(r*r+n),l=0,f=e.exp(-o*o/2),h=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;l<200||c>1e-14||s>1e-14;)c=s,l>0&&(f*=o*o/(2*l),h*=o*o/(2*(l+.5))),i+=.5*(s=f*t.beta.cdf(u,l+.5,n/2)+h*t.beta.cdf(u,l+1,n/2)),l++;return a?1-i:i}}),t.extend(t.normal,{pdf:function(t,r,n){return e.exp(-.5*e.log(2*e.PI)-e.log(n)-e.pow(t-r,2)/(2*n*n))},cdf:function(r,n,o){return .5*(1+t.erf((r-n)/e.sqrt(2*o*o)))},inv:function(e,r,n){return -1.4142135623730951*n*t.erfcinv(2*e)+r},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,r){return t.randn()*r+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,r,n){return t<r?0:n*e.pow(r,n)/e.pow(t,n+1)},cdf:function(t,r,n){return t<r?0:1-e.pow(r/t,n)},inv:function(t,r,n){return r/e.pow(1-t,1/n)},mean:function(t,r){if(!(r<=1))return r*e.pow(t,r)/(r-1)},median:function(t,r){return r*e.SQRT2*t},mode:function(t){return t},variance:function(t,r){if(!(r<=2))return t*t*r/(e.pow(r-1,2)*(r-2))}}),t.extend(t.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(e.sqrt(n)*t.betafn(.5,n/2))*e.pow(1+r*r/n,-((n+1)/2))},cdf:function(r,n){var o=n/2;return t.ibeta((r+e.sqrt(r*r+n))/(2*e.sqrt(r*r+n)),o,o)},inv:function(r,n){var o=t.ibetainv(2*e.min(r,1-r),.5*n,.5);return o=e.sqrt(n*(1-o)/o),r>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return t.randn()*e.sqrt(r/(2*t.randg(r/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,r,n){return t<0||r<0||n<0?0:n/r*e.pow(t/r,n-1)*e.exp(-e.pow(t/r,n))},cdf:function(t,r,n){return t<0?0:1-e.exp(-e.pow(t/r,n))},inv:function(t,r,n){return r*e.pow(-e.log(1-t),1/n)},mean:function(e,r){return e*t.gammafn(1+1/r)},median:function(t,r){return t*e.pow(e.log(2),1/r)},mode:function(t,r){return r<=1?0:t*e.pow((r-1)/r,1/r)},sample:function(r,n){return r*e.pow(-e.log(t._random_fn()),1/n)},variance:function(r,n){return r*r*t.gammafn(1+2/n)-e.pow(t.weibull.mean(r,n),2)}}),t.extend(t.uniform,{pdf:function(t,e,r){return t<e||t>r?0:1/(r-e)},cdf:function(t,e,r){return t<e?0:t<r?(t-e)/(r-e):1},inv:function(t,e,r){return e+t*(r-e)},mean:function(t,e){return .5*(t+e)},median:function(e,r){return t.mean(e,r)},mode:function(){throw Error("mode is not yet implemented")},sample:function(e,r){return e/2+r/2+(r/2-e/2)*(2*t._random_fn()-1)},variance:function(t,r){return e.pow(r-t,2)/12}}),t.extend(t.binomial,{pdf:function(r,n,o){return 0===o||1===o?n*o===r?1:0:t.combination(n,r)*e.pow(o,r)*e.pow(1-o,n-r)},cdf:function(n,o,a){if(n<0)return 0;if(n>=o)return 1;if(a<0||a>1||o<=0)return NaN;var i,s=(n=e.floor(n))+1,c=o-n,u=s+c,l=e.exp(t.gammaln(u)-t.gammaln(c)-t.gammaln(s)+s*e.log(a)+c*e.log(1-a));return i=a<(s+1)/(u+2)?l*r(a,s,c,1e-10):1-l*r(1-a,c,s,1e-10),e.round(1e10*(1-i))/1e10}}),t.extend(t.negbin,{pdf:function(r,n,o){return r===r>>>0&&(r<0?0:t.combination(r+n-1,n-1)*e.pow(1-o,r)*e.pow(o,n))},cdf:function(e,r,n){var o=0,a=0;if(e<0)return 0;for(;a<=e;a++)o+=t.negbin.pdf(a,r,n);return o}}),t.extend(t.hypgeom,{pdf:function(r,n,o,a){if(r!=r|0)return!1;if(r<0||r<o-(n-a)||r>a||r>o)return 0;if(2*o>n)return 2*a>n?t.hypgeom.pdf(n-o-a+r,n,n-o,n-a):t.hypgeom.pdf(a-r,n,n-o,a);if(2*a>n)return t.hypgeom.pdf(o-r,n,o,n-a);if(o<a)return t.hypgeom.pdf(r,n,a,o);for(var i=1,s=0,c=0;c<r;c++){for(;i>1&&s<a;)i*=1-o/(n-s),s++;i*=(a-c)*(o-c)/((c+1)*(n-o-a+c+1))}for(;s<a;s++)i*=1-o/(n-s);return e.min(1,e.max(0,i))},cdf:function(r,n,o,a){if(r<0||r<o-(n-a))return 0;if(r>=a||r>=o)return 1;if(2*o>n)return 2*a>n?t.hypgeom.cdf(n-o-a+r,n,n-o,n-a):1-t.hypgeom.cdf(a-r-1,n,n-o,a);if(2*a>n)return 1-t.hypgeom.cdf(o-r-1,n,o,n-a);if(o<a)return t.hypgeom.cdf(r,n,a,o);for(var i=1,s=1,c=0,u=0;u<r;u++){for(;i>1&&c<a;){var l=1-o/(n-c);s*=l,i*=l,c++}s*=(a-u)*(o-u)/((u+1)*(n-o-a+u+1)),i+=s}for(;c<a;c++)i*=1-o/(n-c);return e.min(1,e.max(0,i))}}),t.extend(t.poisson,{pdf:function(r,n){return n<0||r%1!=0||r<0?0:e.pow(n,r)*e.exp(-n)/t.factorial(r)},cdf:function(e,r){var n=[],o=0;if(e<0)return 0;for(;o<=e;o++)n.push(t.poisson.pdf(o,r));return t.sum(n)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(r){var n=1,o=0,a=e.exp(-r);do o++,n*=t._random_fn();while(n>a);return o-1},sampleLarge:function(r){var n,o,a,i,s,c,u,l,f,h;for(i=e.sqrt(r),s=e.log(r),c=-.059+.02483*(u=.931+2.53*i),l=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;)if(o=e.random()-.5,a=e.random(),h=.5-e.abs(o),n=e.floor((2*c/h+u)*o+r+.43),h>=.07&&a<=f||!(n<0)&&(!(h<.013)||!(a>h))&&e.log(a)+e.log(l)-e.log(c/(h*h)+u)<=-r+n*s-t.loggam(n+1))return n},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,r,n){return r<=e||n<e||n>r?NaN:t<e||t>r?0:t<n?2*(t-e)/((r-e)*(n-e)):t===n?2/(r-e):2*(r-t)/((r-e)*(r-n))},cdf:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=r?0:t>=n?1:t<=o?e.pow(t-r,2)/((n-r)*(o-r)):1-e.pow(n-t,2)/((n-r)*(n-o))},inv:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=(o-r)/(n-r)?r+(n-r)*e.sqrt((o-r)/(n-r)*t):r+(n-r)*(1-e.sqrt((1-t)*(1-(o-r)/(n-r))))},mean:function(t,e,r){return(t+e+r)/3},median:function(t,r,n){return n<=(t+r)/2?r-e.sqrt((r-t)*(r-n))/e.sqrt(2):n>(t+r)/2?t+e.sqrt((r-t)*(n-t))/e.sqrt(2):void 0},mode:function(t,e,r){return r},sample:function(r,n,o){var a=t._random_fn();return a<(o-r)/(n-r)?r+e.sqrt(a*(n-r)*(o-r)):n-e.sqrt((1-a)*(n-r)*(n-o))},variance:function(t,e,r){return(t*t+e*e+r*r-t*e-t*r-e*r)/18}}),t.extend(t.arcsine,{pdf:function(t,r,n){return n<=r?NaN:t<=r||t>=n?0:2/e.PI*e.pow(e.pow(n-r,2)-e.pow(2*t-r-n,2),-.5)},cdf:function(t,r,n){return t<r?0:t<n?2/e.PI*e.asin(e.sqrt((t-r)/(n-r))):1},inv:function(t,r,n){return r+(.5-.5*e.cos(e.PI*t))*(n-r)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,r){return r<=t?NaN:e.pow(r-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,r,n){return n<=0?0:e.exp(-e.abs(t-r)/n)/(2*n)},cdf:function(t,r,n){return n<=0?0:t<r?.5*e.exp((t-r)/n):1-.5*e.exp(-(t-r)/n)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(r,n){var o=t._random_fn()-.5;return r-o/e.abs(o)*n*e.log(1-2*e.abs(o))}}),t.extend(t.tukey,{cdf:function(r,o,a){var i=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],s=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(a<2||o<2)return NaN;if(!Number.isFinite(r))return 1;if(a>25e3)return n(r,1,o);var c=.5*a,u=c*e.log(a)-a*e.log(2)-t.gammaln(c),l=c-1,f=.25*a;d=a<=100?1:a<=800?.5:a<=5e3?.25:.125,u+=e.log(d);for(var h=0,p=1;p<=50;p++){for(var d,m,g,v=0,E=(2*p-1)*d,y=1;y<=16;y++)8<y?(m=y-8-1,g=u+l*e.log(E+i[m]*d)-(i[m]*d+E)*f):(m=y-1,g=u+l*e.log(E-i[m]*d)+(i[m]*d-E)*f),g>=-30&&(v+=n(8<y?r*e.sqrt((i[m]*d+E)*.5):r*e.sqrt((-(i[m]*d)+E)*.5),1,o)*s[m]*e.exp(g));if(p*d>=1&&v<=1e-14)break;h+=v}if(v>1e-14)throw Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(r,n,o){if(o<2||n<2||r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var a,i,s,c,u,l,f=(s=.5-.5*r,u=(c=e.sqrt(e.log(1/(s*s))))+((((-.0000453642210148*c+-.204231210125)*c+-.342242088547)*c+-1)*c+.322232421088)/((((.0038560700634*c+.10353775285)*c+.531103462366)*c+.588581570495)*c+.099348462606),o<120&&(u+=(u*u*u+u)/o/4),l=.8832-.2368*u,o<120&&(l+=-1.214/o+1.208*u/o),u*(l*e.log(n-1)+1.4142)),h=t.tukey.cdf(f,n,o)-r;a=h>0?e.max(0,f-1):f+1;for(var p=t.tukey.cdf(a,n,o)-r,d=1;d<50;d++)if(i=a-p*(a-f)/(p-h),h=p,f=a,i<0&&(i=0,p=-r),p=t.tukey.cdf(i,n,o)-r,a=i,1e-4>e.abs(a-f))return i;throw Error("tukey.inv failed to converge")}})}(e,Math),function(t,e){var r,n,o=Array.prototype.push,a=t.utils.isArray;function i(e){return a(e)||e instanceof t}t.extend({add:function(e,r){return i(r)?(i(r[0])||(r=[r]),t.map(e,function(t,e,n){return t+r[e][n]})):t.map(e,function(t){return t+r})},subtract:function(e,r){return i(r)?(i(r[0])||(r=[r]),t.map(e,function(t,e,n){return t-r[e][n]||0})):t.map(e,function(t){return t-r})},divide:function(e,r){return i(r)?(i(r[0])||(r=[r]),t.multiply(e,t.inv(r))):t.map(e,function(t){return t/r})},multiply:function(e,r){var n,o,a,s,c,u,l,f;if(void 0===e.length&&void 0===r.length)return e*r;if(c=e.length,u=e[0].length,l=t.zeros(c,a=i(r)?r[0].length:u),f=0,i(r)){for(;f<a;f++)for(n=0;n<c;n++){for(o=0,s=0;o<u;o++)s+=e[n][o]*r[o][f];l[n][f]=s}return 1===c&&1===f?l[0][0]:l}return t.map(e,function(t){return t*r})},outer:function(e,r){return t.multiply(e.map(function(t){return[t]}),[r])},dot:function(e,r){i(e[0])||(e=[e]),i(r[0])||(r=[r]);for(var n,o,a=1===e[0].length&&1!==e.length?t.transpose(e):e,s=1===r[0].length&&1!==r.length?t.transpose(r):r,c=[],u=0,l=a.length,f=a[0].length;u<l;u++){for(o=0,c[u]=[],n=0;o<f;o++)n+=a[u][o]*s[u][o];c[u]=n}return 1===c.length?c[0]:c},pow:function(r,n){return t.map(r,function(t){return e.pow(t,n)})},exp:function(r){return t.map(r,function(t){return e.exp(t)})},log:function(r){return t.map(r,function(t){return e.log(t)})},abs:function(r){return t.map(r,function(t){return e.abs(t)})},norm:function(t,r){var n=0,o=0;for(isNaN(r)&&(r=2),i(t[0])&&(t=t[0]);o<t.length;o++)n+=e.pow(e.abs(t[o]),r);return e.pow(n,1/r)},angle:function(r,n){return e.acos(t.dot(r,n)/(t.norm(r)*t.norm(n)))},aug:function(t,e){var r,n=[];for(r=0;r<t.length;r++)n.push(t[r].slice());for(r=0;r<n.length;r++)o.apply(n[r],e[r]);return n},inv:function(e){for(var r,n=e.length,o=e[0].length,a=t.identity(n,o),i=t.gauss_jordan(e,a),s=[],c=0;c<n;c++)for(s[c]=[],r=o;r<i[0].length;r++)s[c][r-o]=i[c][r];return s},det:function t(e){if(2===e.length)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(var r=0,n=0;n<e.length;n++){for(var o=[],a=1;a<e.length;a++){o[a-1]=[];for(var i=0;i<e.length;i++)i<n?o[a-1][i]=e[a][i]:i>n&&(o[a-1][i-1]=e[a][i])}var s=n%2?-1:1;r+=t(o)*e[0][n]*s}return r},gauss_elimination:function(r,n){var o,a,i,s,c=0,u=0,l=r.length,f=r[0].length,h=1,p=0,d=[];for(c=0,o=(r=t.aug(r,n))[0].length;c<l;c++){for(a=r[c][c],u=c,s=c+1;s<f;s++)a<e.abs(r[s][c])&&(a=r[s][c],u=s);if(u!=c)for(s=0;s<o;s++)i=r[c][s],r[c][s]=r[u][s],r[u][s]=i;for(u=c+1;u<l;u++)for(h=r[u][c]/r[c][c],s=c;s<o;s++)r[u][s]=r[u][s]-h*r[c][s]}for(c=l-1;c>=0;c--){for(p=0,u=c+1;u<=l-1;u++)p+=d[u]*r[c][u];d[c]=(r[c][o-1]-p)/r[c][c]}return d},gauss_jordan:function(r,n){var o,a,i,s=t.aug(r,n),c=s.length,u=s[0].length,l=0;for(a=0;a<c;a++){var f=a;for(i=a+1;i<c;i++)e.abs(s[i][a])>e.abs(s[f][a])&&(f=i);var h=s[a];for(s[a]=s[f],s[f]=h,i=a+1;i<c;i++)for(l=s[i][a]/s[a][a],o=a;o<u;o++)s[i][o]-=s[a][o]*l}for(a=c-1;a>=0;a--){for(i=0,l=s[a][a];i<a;i++)for(o=u-1;o>a-1;o--)s[i][o]-=s[a][o]*s[i][a]/l;for(s[a][a]/=l,o=c;o<u;o++)s[a][o]/=l}return s},triaUpSolve:function(e,r){var n,o=e[0].length,a=t.zeros(1,o)[0],i=!1;return(void 0!=r[0].length&&(r=r.map(function(t){return t[0]}),i=!0),t.arange(o-1,-1,-1).forEach(function(i){n=t.arange(i+1,o).map(function(t){return a[t]*e[i][t]}),a[i]=(r[i]-t.sum(n))/e[i][i]}),i)?a.map(function(t){return[t]}):a},triaLowSolve:function(e,r){var n,o=e[0].length,a=t.zeros(1,o)[0],i=!1;return(void 0!=r[0].length&&(r=r.map(function(t){return t[0]}),i=!0),t.arange(o).forEach(function(o){n=t.arange(o).map(function(t){return e[o][t]*a[t]}),a[o]=(r[o]-t.sum(n))/e[o][o]}),i)?a.map(function(t){return[t]}):a},lu:function(e){var r,n=e.length,o=t.identity(n),a=t.zeros(e.length,e[0].length);return t.arange(n).forEach(function(t){a[0][t]=e[0][t]}),t.arange(1,n).forEach(function(i){t.arange(i).forEach(function(n){r=t.arange(n).map(function(t){return o[i][t]*a[t][n]}),o[i][n]=(e[i][n]-t.sum(r))/a[n][n]}),t.arange(i,n).forEach(function(n){r=t.arange(i).map(function(t){return o[i][t]*a[t][n]}),a[i][n]=e[r.length][n]-t.sum(r)})}),[o,a]},cholesky:function(r){var n,o=r.length,a=t.zeros(r.length,r[0].length);return t.arange(o).forEach(function(i){n=t.arange(i).map(function(t){return e.pow(a[i][t],2)}),a[i][i]=e.sqrt(r[i][i]-t.sum(n)),t.arange(i+1,o).forEach(function(e){n=t.arange(i).map(function(t){return a[i][t]*a[e][t]}),a[e][i]=(r[i][e]-t.sum(n))/a[i][i]})}),a},gauss_jacobi:function(r,n,o,a){for(var i,s,c,u,l=0,f=0,h=r.length,p=[],d=[],m=[];l<h;l++)for(f=0,p[l]=[],d[l]=[],m[l]=[];f<h;f++)l>f?(p[l][f]=r[l][f],d[l][f]=m[l][f]=0):l<f?(d[l][f]=r[l][f],p[l][f]=m[l][f]=0):(m[l][f]=r[l][f],p[l][f]=d[l][f]=0);for(c=t.multiply(t.multiply(t.inv(m),t.add(p,d)),-1),s=t.multiply(t.inv(m),n),i=o,u=t.add(t.multiply(c,o),s),l=2;e.abs(t.norm(t.subtract(u,i)))>a;)i=u,u=t.add(t.multiply(c,i),s),l++;return u},gauss_seidel:function(r,n,o,a){for(var i,s,c,u,l,f=0,h=r.length,p=[],d=[],m=[];f<h;f++)for(i=0,p[f]=[],d[f]=[],m[f]=[];i<h;i++)f>i?(p[f][i]=r[f][i],d[f][i]=m[f][i]=0):f<i?(d[f][i]=r[f][i],p[f][i]=m[f][i]=0):(m[f][i]=r[f][i],p[f][i]=d[f][i]=0);for(u=t.multiply(t.multiply(t.inv(t.add(m,p)),d),-1),c=t.multiply(t.inv(t.add(m,p)),n),s=o,l=t.add(t.multiply(u,o),c),f=2;e.abs(t.norm(t.subtract(l,s)))>a;)s=l,l=t.add(t.multiply(u,s),c),f+=1;return l},SOR:function(r,n,o,a,i){for(var s,c,u,l,f,h=0,p=r.length,d=[],m=[],g=[];h<p;h++)for(s=0,d[h]=[],m[h]=[],g[h]=[];s<p;s++)h>s?(d[h][s]=r[h][s],m[h][s]=g[h][s]=0):h<s?(m[h][s]=r[h][s],d[h][s]=g[h][s]=0):(g[h][s]=r[h][s],d[h][s]=m[h][s]=0);for(l=t.multiply(t.inv(t.add(g,t.multiply(d,i))),t.subtract(t.multiply(g,1-i),t.multiply(m,i))),u=t.multiply(t.multiply(t.inv(t.add(g,t.multiply(d,i))),n),i),c=o,f=t.add(t.multiply(l,o),u),h=2;e.abs(t.norm(t.subtract(f,c)))>a;)c=f,f=t.add(t.multiply(l,c),u),h++;return f},householder:function(r){for(var n,o,a,i,s=r.length,c=r[0].length,u=0,l=[],f=[];u<s-1;u++){for(n=0,i=u+1;i<c;i++)n+=r[i][u]*r[i][u];for(n=(r[u+1][u]>0?-1:1)*e.sqrt(n),o=e.sqrt((n*n-r[u+1][u]*n)/2),(l=t.zeros(s,1))[u+1][0]=(r[u+1][u]-n)/(2*o),a=u+2;a<s;a++)l[a][0]=r[a][u]/(2*o);f=t.subtract(t.identity(s,c),t.multiply(t.multiply(l,t.transpose(l)),2)),r=t.multiply(f,t.multiply(r,f))}return r},QR:(r=t.sum,n=t.arange,function(o){var a,i,s,c=o.length,u=o[0].length,l=t.zeros(u,u);for(i=0,o=t.copy(o);i<u;i++){for(a=0,l[i][i]=e.sqrt(r(n(c).map(function(t){return o[t][i]*o[t][i]})));a<c;a++)o[a][i]=o[a][i]/l[i][i];for(s=i+1;s<u;s++)for(a=0,l[i][s]=r(n(c).map(function(t){return o[t][i]*o[t][s]}));a<c;a++)o[a][s]=o[a][s]-o[a][i]*l[i][s]}return[o,l]}),lstsq:function(e,r){var n,o,a,i=!1;void 0===r[0].length&&(r=r.map(function(t){return[t]}),i=!0);var s=t.QR(e),c=s[0],u=s[1],l=e[0].length,f=t.slice(c,{col:{end:l}}),h=(n=t.slice(u,{row:{end:l}}),o=(n=t.copy(n)).length,a=t.identity(o),t.arange(o-1,-1,-1).forEach(function(e){t.sliceAssign(a,{row:e},t.divide(t.slice(a,{row:e}),n[e][e])),t.sliceAssign(n,{row:e},t.divide(t.slice(n,{row:e}),n[e][e])),t.arange(e).forEach(function(r){var o=t.multiply(n[r][e],-1),i=t.slice(n,{row:r}),s=t.multiply(t.slice(n,{row:e}),o);t.sliceAssign(n,{row:r},t.add(i,s));var c=t.slice(a,{row:r}),u=t.multiply(t.slice(a,{row:e}),o);t.sliceAssign(a,{row:r},t.add(c,u))})}),a),p=t.transpose(f);void 0===p[0].length&&(p=[p]);var d=t.multiply(t.multiply(h,p),r);return(void 0===d.length&&(d=[[d]]),i)?d.map(function(t){return t[0]}):d},jacobi:function(r){for(var n,o,a,i,s,c,u,l=1,f=r.length,h=t.identity(f,f),p=[];1===l;){for(n=0,s=r[0][1],a=0,i=1;n<f;n++)for(o=0;o<f;o++)n!=o&&s<e.abs(r[n][o])&&(s=e.abs(r[n][o]),a=n,i=o);for(n=1,c=r[a][a]===r[i][i]?r[a][i]>0?e.PI/4:-e.PI/4:e.atan(2*r[a][i]/(r[a][a]-r[i][i]))/2,(u=t.identity(f,f))[a][a]=e.cos(c),u[a][i]=-e.sin(c),u[i][a]=e.sin(c),u[i][i]=e.cos(c),h=t.multiply(h,u),r=t.multiply(t.multiply(t.inv(u),r),u),l=0;n<f;n++)for(o=1;o<f;o++)n!=o&&e.abs(r[n][o])>.001&&(l=1)}for(n=0;n<f;n++)p.push(r[n][n]);return[h,p]},rungekutta:function(t,e,r,n,o,a){var i,s,c,u;if(2===a)for(;n<=r;)i=e*t(n,o),s=e*t(n+e,o+i),o+=(i+s)/2,n+=e;if(4===a)for(;n<=r;)i=e*t(n,o),s=e*t(n+e/2,o+i/2),c=e*t(n+e/2,o+s/2),u=e*t(n+e,o+c),o+=(i+2*s+2*c+u)/6,n+=e;return o},romberg:function(t,r,n,o){for(var a,i,s,c,u,l=0,f=(n-r)/2,h=[],p=[],d=[];l<o/2;){for(u=t(r),s=r,c=0;s<=n;s+=f,c++)h[c]=s;for(s=1,a=h.length;s<a-1;s++)u+=(s%2!=0?4:2)*t(h[s]);u=f/3*(u+t(n)),d[l]=u,f/=2,l++}for(i=d.length,a=1;1!==i;){for(s=0;s<i-1;s++)p[s]=(e.pow(4,a)*d[s+1]-d[s])/(e.pow(4,a)-1);i=p.length,d=p,p=[],a++}return d},richardson:function(t,r,n,o){function a(t,e){for(var r,n=0,o=t.length;n<o;n++)t[n]===e&&(r=n);return r}for(var i,s,c,u,l,f=e.abs(n-t[a(t,n)+1]),h=0,p=[],d=[];o>=f;)i=a(t,n+o),s=a(t,n),p[h]=(r[i]-2*r[s]+r[2*s-i])/(o*o),o/=2,h++;for(u=p.length,c=1;1!=u;){for(l=0;l<u-1;l++)d[l]=(e.pow(4,c)*p[l+1]-p[l])/(e.pow(4,c)-1);u=d.length,p=d,d=[],c++}return p},simpson:function(t,e,r,n){for(var o,a=(r-e)/n,i=t(e),s=[],c=e,u=0,l=1;c<=r;c+=a,u++)s[u]=c;for(o=s.length;l<o-1;l++)i+=(l%2!=0?4:2)*t(s[l]);return a/3*(i+t(r))},hermite:function(t,e,r,n){for(var o,a=t.length,i=0,s=0,c=[],u=[],l=[],f=[];s<a;s++){for(o=0,c[s]=1;o<a;o++)s!=o&&(c[s]*=(n-t[o])/(t[s]-t[o]));for(o=0,u[s]=0;o<a;o++)s!=o&&(u[s]+=1/(t[s]-t[o]));l[s]=(1-2*(n-t[s])*u[s])*(c[s]*c[s]),f[s]=(n-t[s])*(c[s]*c[s]),i+=l[s]*e[s]+f[s]*r[s]}return i},lagrange:function(t,e,r){for(var n,o,a=0,i=0,s=t.length;i<s;i++){for(n=0,o=e[i];n<s;n++)i!=n&&(o*=(r-t[n])/(t[i]-t[n]));a+=o}return a},cubic_spline:function(e,r,n){for(var o,a=e.length,i=0,s=[],c=[],u=[],l=[],f=[],h=[],p=[];i<a-1;i++)f[i]=e[i+1]-e[i];for(i=1,u[0]=0;i<a-1;i++)u[i]=3/f[i]*(r[i+1]-r[i])-3/f[i-1]*(r[i]-r[i-1]);for(i=1;i<a-1;i++)s[i]=[],c[i]=[],s[i][i-1]=f[i-1],s[i][i]=2*(f[i-1]+f[i]),s[i][i+1]=f[i],c[i][0]=u[i];for(o=0,l=t.multiply(t.inv(s),c);o<a-1;o++)h[o]=(r[o+1]-r[o])/f[o]-f[o]*(l[o+1][0]+2*l[o][0])/3,p[o]=(l[o+1][0]-l[o][0])/(3*f[o]);for(o=0;o<a&&!(e[o]>n);o++);return r[o-=1]+(n-e[o])*h[o]+t.sq(n-e[o])*l[o]+(n-e[o])*t.sq(n-e[o])*p[o]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented")},PCA:function(e){var r,n,o=e.length,a=e[0].length,i=0,s=[],c=[],u=[],l=[],f=[],h=[],p=[],d=[],m=[],g=[];for(i=0;i<o;i++)s[i]=t.sum(e[i])/a;for(i=0;i<a;i++)for(r=0,p[i]=[];r<o;r++)p[i][r]=e[r][i]-s[r];for(i=0,p=t.transpose(p);i<o;i++)for(r=0,d[i]=[];r<o;r++)d[i][r]=t.dot([p[i]],[p[r]])/(a-1);for(i=0,m=(u=t.jacobi(d))[0],c=u[1],g=t.transpose(m);i<c.length;i++)for(r=i;r<c.length;r++)c[i]<c[r]&&(n=c[i],c[i]=c[r],c[r]=n,l=g[i],g[i]=g[r],g[r]=l);for(i=0,h=t.transpose(p);i<o;i++)for(r=0,f[i]=[];r<h.length;r++)f[i][r]=t.dot([g[i]],[h[r]]);return[e,c,g,f]}}),function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(r,n){var o=this;return n?(setTimeout(function(){n.call(o,t.fn[e].call(o,r))},15),this):"number"==typeof t[e](this,r)?t[e](this,r):t(t[e](this,r))}}(e[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(e,Math),function(t,e){var r=[].slice,n=t.utils.isNumber,o=t.utils.isArray;function a(t,r,n,o){if(t>1||n>1||t<=0||n<=0)throw Error("Proportions should be greater than 0 and less than 1");var a=(t*r+n*o)/(r+o);return(t-n)/e.sqrt(a*(1-a)*(1/r+1/o))}t.extend({zscore:function(){var e=r.call(arguments);return n(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var n,a=r.call(arguments);return o(a[1])?(n=t.zscore(a[0],a[1],a[3]),1===a[2]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):a.length>2?(n=t.zscore(a[0],a[1],a[2]),1===a[3]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):(n=a[0],1===a[1]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(r,n,o){var a=e.abs(this.zscore(r,o));return 1===n?t.normal.cdf(-a,0,1):2*t.normal.cdf(-a,0,1)}}),t.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/e.sqrt(n[3])):(n[0]-t.mean(n[1]))/(t.stdev(n[1],!0)/e.sqrt(n[1].length))},ttest:function(){var o,a=r.call(arguments);return 5===a.length?(o=e.abs(t.tscore(a[0],a[1],a[2],a[3])),1===a[4]?t.studentt.cdf(-o,a[3]-1):2*t.studentt.cdf(-o,a[3]-1)):n(a[1])?(o=e.abs(a[0]),1==a[2]?t.studentt.cdf(-o,a[1]-1):2*t.studentt.cdf(-o,a[1]-1)):(o=e.abs(t.tscore(a[0],a[1])),1==a[2]?t.studentt.cdf(-o,a[1].length-1):2*t.studentt.cdf(-o,a[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(r,n){return 1===n?1-t.studentt.cdf(e.abs(this.tscore(r)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(r)),this.cols()-1)}}),t.extend({anovafscore:function(){var n,o,a,i,s,c,u,l,f=r.call(arguments);if(1===f.length){for(u=0,s=Array(f[0].length);u<f[0].length;u++)s[u]=f[0][u];f=s}for(u=0,o=[];u<f.length;u++)o=o.concat(f[u]);for(u=0,a=t.mean(o),n=0;u<f.length;u++)n+=f[u].length*e.pow(t.mean(f[u])-a,2);for(n/=f.length-1,c=0,u=0;u<f.length;u++)for(l=0,i=t.mean(f[u]);l<f[u].length;l++)c+=e.pow(f[u][l]-i,2);return n/(c/=o.length-f.length)},anovaftest:function(){var e,o,a,i,s=r.call(arguments);if(n(s[0]))return 1-t.centralF.cdf(s[0],s[1],s[2]);var c=t.anovafscore(s);for(i=0,e=s.length-1,a=0;i<s.length;i++)a+=s[i].length;return o=a-e-1,1-t.centralF.cdf(c,e,o)},ftest:function(e,r,n){return 1-t.centralF.cdf(e,r,n)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,r=0;for(e=0;e<this.length;e++)r+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,r-this.length)}}),t.extend({qscore:function(){var o,a,i,s,c,u=r.call(arguments);return n(u[0])?(o=u[0],a=u[1],i=u[2],s=u[3],c=u[4]):(o=t.mean(u[0]),a=t.mean(u[1]),i=u[0].length,s=u[1].length,c=u[2]),e.abs(o-a)/(c*e.sqrt((1/i+1/s)/2))},qtest:function(){var e,n=r.call(arguments);3===n.length?(e=n[0],n=n.slice(1)):7===n.length?(e=t.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(e=t.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],a=n[1];return 1-t.tukey.cdf(e,a,o-a)},tukeyhsd:function(e){for(var r=t.pooledstdev(e),n=e.map(function(e){return t.mean(e)}),o=e.reduce(function(t,e){return t+e.length},0),a=[],i=0;i<e.length;++i)for(var s=i+1;s<e.length;++s){var c=t.qtest(n[i],n[s],e[i].length,e[s].length,r,o,e.length);a.push([[i,s],c])}return a}}),t.extend({normalci:function(){var n,o=r.call(arguments),a=[,,];return n=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},tci:function(){var n,o=r.call(arguments),a=[,,];return n=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),a[0]=o[0]-n,a[1]=o[0]+n,a},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,r){return t.normalci(e,r,this.toArray())},tci:function(e,r){return t.tci(e,r,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,r,n,o){var i=a(e,r,n,o);return t.ztest(i,1)},twoSidedDifferenceOfProportions:function(e,r,n,o){var i=a(e,r,n,o);return t.ztest(i,2)}})}(e,Math),e.models=function(){function t(t,r){var n=t.length,o=r[0].length-1,a=e.lstsq(r,t),i=e.multiply(r,a.map(function(t){return[t]})).map(function(t){return t[0]}),s=e.subtract(t,i),c=e.mean(t),u=e.sum(i.map(function(t){return Math.pow(t-c,2)})),l=e.sum(t.map(function(t,e){return Math.pow(t-i[e],2)})),f=u+l;return{exog:r,endog:t,nobs:n,df_model:o,df_resid:n-o-1,coef:a,predict:i,resid:s,ybar:c,SST:f,SSE:u,SSR:l,R2:u/f}}return{ols:function(r,n){var o,a,i,s,c,u,l,f,h,p,d,m,g,v,E=t(r,n),y=(a=(o=E.exog)[0].length,i=e.arange(a).map(function(r){var n=e.arange(a).filter(function(t){return t!==r});return t(e.col(o,r).map(function(t){return t[0]}),e.col(o,n))}),s=Math.sqrt(E.SSR/E.df_resid),c=i.map(function(t){return s/Math.sqrt(t.SST*(1-t.R2))}),l=(u=E.coef.map(function(t,e){return(t-0)/c[e]})).map(function(t){var r=e.studentt.cdf(t,E.df_resid);return(r>.5?1-r:r)*2}),f=e.studentt.inv(.975,E.df_resid),h=E.coef.map(function(t,e){var r=f*c[e];return[t-r,t+r]}),{se:c,t:u,p:l,sigmaHat:s,interval95:h}),N=(v=1-(d=p=E.R2/E.df_model/((1-E.R2)/E.df_resid),m=E.df_model,g=E.df_resid,e.beta.cdf(d/(g/m+d),m/2,g/2)),{F_statistic:p,pvalue:v}),R=1-(1-E.R2)*((E.nobs-1)/E.df_resid);return E.t=y,E.f=N,E.adjust_R2=R,E}}}(),e.extend({buildxmatrix:function(){for(var t=Array(arguments.length),r=0;r<arguments.length;r++){var n=[1];t[r]=n.concat(arguments[r])}return e(t)},builddxmatrix:function(){for(var t=Array(arguments[0].length),r=0;r<arguments[0].length;r++){var n=[1];t[r]=n.concat(arguments[0][r])}return e(t)},buildjxmatrix:function(t){for(var r=Array(t.length),n=0;n<t.length;n++)r[n]=t[n];return e.builddxmatrix(r)},buildymatrix:function(t){return e(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,r){var n,o,a,i,s;if(t.cols()==r.rows()){if(r.rows()>1){for(n=0,i=[];n<t.rows();n++)for(o=0,i[n]=[];o<r.cols();o++){for(a=0,s=0;a<t.cols();a++)s+=t.toArray()[n][a]*r.toArray()[a][o];i[n][o]=s}return e(i)}for(n=0,i=[];n<t.rows();n++)for(o=0,i[n]=[];o<r.cols();o++){for(a=0,s=0;a<t.cols();a++)s+=t.toArray()[n][a]*r.toArray()[o];i[n][o]=s}return e(i)}},regress:function(t,r){var n=e.xtranspxinv(t),o=t.transpose(),a=e.matrixmult(e(n),o);return e.matrixmult(a,r)},regresst:function(t,r,n){var o,a,i,s=e.regress(t,r),c={};c.anova={};var u=e.jMatYBar(t,s);c.yBar=u;var l=r.mean();c.anova.residuals=e.residuals(r,u),c.anova.ssr=e.ssr(u,l),c.anova.msr=c.anova.ssr/(t[0].length-1),c.anova.sse=e.sse(r,u),c.anova.mse=c.anova.sse/(r.length-(t[0].length-1)-1),c.anova.sst=e.sst(r,l),c.anova.mst=c.anova.sst/(r.length-1),c.anova.r2=1-c.anova.sse/c.anova.sst,c.anova.r2<0&&(c.anova.r2=0),c.anova.fratio=c.anova.msr/c.anova.mse,c.anova.pvalue=e.anovaftest(c.anova.fratio,t[0].length-1,r.length-(t[0].length-1)-1),c.anova.rmse=Math.sqrt(c.anova.mse),c.anova.r2adj=1-c.anova.mse/c.anova.mst,c.anova.r2adj<0&&(c.anova.r2adj=0),c.stats=Array(t[0].length);for(var f=e.xtranspxinv(t),h=0;h<s.length;h++)o=Math.sqrt(c.anova.mse*Math.abs(f[h][h])),a=Math.abs(s[h]/o),i=e.ttest(a,r.length-t[0].length-1,n),c.stats[h]=[s[h],o,a,i];return c.regress=s,c},xtranspx:function(t){return e.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var r=e.matrixmult(t.transpose(),t);return e.inv(r)},jMatYBar:function(t,r){var n=e.matrixmult(t,r);return new e(n)},residuals:function(t,r){return e.matrixsubtract(t,r)},ssr:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},sse:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r},sst:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},matrixsubtract:function(t,r){for(var n=Array(t.length),o=0;o<t.length;o++){n[o]=Array(t[o].length);for(var a=0;a<t[o].length;a++)n[o][a]=t[o][a]-r[o][a]}return e(n)}}),e.jStat=e,e},t.exports=e()},25975:function(t,e){var r,n,o;"undefined"!=typeof self&&self,n=[],void 0!==(o="function"==typeof(r=function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx},t.prototype.pattern=function(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");var e=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(r,"global");break;case"i":s(r,"ignoreCase");break;case"m":s(r,"multiLine");break;case"u":s(r,"unicode");break;case"y":s(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:e,loc:this.loc(0)}},t.prototype.disjunction=function(){var t=[],e=this.idx;for(t.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(e)}},t.prototype.alternative=function(){for(var t=[],e=this.idx;this.isTerm();)t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(e)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}c(e);var e,r=this.disjunction();return this.consumeChar(")"),{type:e,value:r,loc:this.loc(t)}}(function(){throw Error("Internal Error - Should never get here!")})()},t.prototype.quantifier=function(t){var e=this.idx;switch(this.popChar()){case"*":r={atLeast:0,atMost:1/0};break;case"+":r={atLeast:1,atMost:1/0};break;case"?":r={atLeast:0,atMost:1};break;case"{":var r,n=this.integerIncludingZero();switch(this.popChar()){case"}":r={atLeast:n,atMost:n};break;case",":r=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===t&&void 0===r)return;c(r)}if(!0!==t||void 0!==r)return c(r),"?"===this.peekChar(0)?(this.consumeChar("?"),r.greedy=!1):r.greedy=!0,r.type="Quantifier",r.loc=this.loc(e),r},t.prototype.atom=function(){var t,e=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group()}return void 0===t&&this.isPatternCharacter()&&(t=this.patternCharacter()),c(t),t.loc=this.loc(e),this.isQuantifier()&&(t.quantifier=this.quantifier()),t},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},t.prototype.characterClassEscape=function(){var t,e=!1;switch(this.popChar()){case"d":t=u;break;case"D":t=u,e=!0;break;case"s":t=f;break;case"S":t=f,e=!0;break;case"w":t=l;break;case"W":t=l,e=!0}return c(t),{type:"Set",value:t,complement:e}},t.prototype.controlEscapeAtom=function(){var t;switch(this.popChar()){case"f":t=a("\f");break;case"n":t=a("\n");break;case"r":t=a("\r");break;case"t":t=a("	");break;case"v":t=a("\v")}return c(t),{type:"Character",value:t}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var t=this.popChar();if(!1===/[a-zA-Z]/.test(t))throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},t.prototype.characterClass=function(){var t=[],e=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),e=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");t.push({from:r.value,to:n.value})}else i(r.value,t),t.push(a("-")),i(n.value,t)}else i(r.value,t)}return this.consumeChar("]"),{type:"Set",complement:e,value:t}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var t=!0;(this.consumeChar("("),"?"===this.peekChar(0))?(this.consumeChar("?"),this.consumeChar(":"),t=!1):this.groupIdx++;var e=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:t,value:e};return t&&(r.idx=this.groupIdx),r},t.prototype.positiveInteger=function(){var t=this.popChar();if(!1===o.test(t))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.integerIncludingZero=function(){var t=this.popChar();if(!1===n.test(t))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.patternCharacter=function(){var t=this.popChar();switch(t){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(t)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},t.prototype.isDigit=function(){return n.test(this.peekChar(0))},t.prototype.isClassAtom=function(t){switch(void 0===t&&(t=0),this.peekChar(t)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},t.prototype.isQuantifier=function(){var t=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(t)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(t){for(var e="",n=0;n<t;n++){var o=this.popChar();if(!1===r.test(o))throw Error("Expecting a HexDecimal digits");e+=o}return{type:"Character",value:parseInt(e,16)}},t.prototype.peekChar=function(t){return void 0===t&&(t=0),this.input[this.idx+t]},t.prototype.popChar=function(){var t=this.peekChar(0);return this.consumeChar(),t},t.prototype.consumeChar=function(t){if(void 0!==t&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(t){return{begin:t,end:this.idx}};var e,r=/[0-9a-fA-F]/,n=/[0-9]/,o=/[1-9]/;function a(t){return t.charCodeAt(0)}function i(t,e){void 0!==t.length?t.forEach(function(t){e.push(t)}):e.push(t)}function s(t,e){if(!0===t[e])throw"duplicate flag "+e;t[e]=!0}function c(t){if(void 0===t)throw Error("Internal Error - Should never get here!")}var u=[];for(e=a("0");e<=a("9");e++)u.push(e);var l=[a("_")].concat(u);for(e=a("a");e<=a("z");e++)l.push(e);for(e=a("A");e<=a("Z");e++)l.push(e);var f=[a(" "),a("\f"),a("\n"),a("\r"),a("	"),a("\v"),a("	"),a("\xa0"),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a("\u2028"),a("\u2029"),a(" "),a(" "),a("　"),a("\uFEFF")];function h(){}return h.prototype.visitChildren=function(t){for(var e in t){var r=t[e];t.hasOwnProperty(e)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach(function(t){this.visit(t)},this))}},h.prototype.visit=function(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t)}this.visitChildren(t)},h.prototype.visitPattern=function(t){},h.prototype.visitFlags=function(t){},h.prototype.visitDisjunction=function(t){},h.prototype.visitAlternative=function(t){},h.prototype.visitStartAnchor=function(t){},h.prototype.visitEndAnchor=function(t){},h.prototype.visitWordBoundary=function(t){},h.prototype.visitNonWordBoundary=function(t){},h.prototype.visitLookahead=function(t){},h.prototype.visitNegativeLookahead=function(t){},h.prototype.visitCharacter=function(t){},h.prototype.visitSet=function(t){},h.prototype.visitGroup=function(t){},h.prototype.visitGroupBackReference=function(t){},h.prototype.visitQuantifier=function(t){},{RegExpParser:t,BaseRegExpVisitor:h,VERSION:"0.5.0"}})?r.apply(e,n):r)&&(t.exports=o)},76452:(t,e)=>{"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function r(t,e){var r=t.length;for(t.push(e);0<r;){var n=r-1>>>1,o=t[n];if(0<a(o,e))t[n]=e,t[r]=o,r=n;else break}}function n(t){return 0===t.length?null:t[0]}function o(t){if(0===t.length)return null;var e=t[0],r=t.pop();if(r!==e){t[0]=r;for(var n=0,o=t.length,i=o>>>1;n<i;){var s=2*(n+1)-1,c=t[s],u=s+1,l=t[u];if(0>a(c,r))u<o&&0>a(l,c)?(t[n]=l,t[u]=r,n=u):(t[n]=c,t[s]=r,n=s);else if(u<o&&0>a(l,r))t[n]=l,t[u]=r,n=u;else break}}return e}function a(t,e){var r=t.sortIndex-e.sortIndex;return 0!==r?r:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var i,s=performance;e.unstable_now=function(){return s.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var l=[],f=[],h=1,p=null,d=3,m=!1,g=!1,v=!1,E="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,N="undefined"!=typeof setImmediate?setImmediate:null;function R(t){for(var e=n(f);null!==e;){if(null===e.callback)o(f);else if(e.startTime<=t)o(f),e.sortIndex=e.expirationTime,r(l,e);else break;e=n(f)}}function T(t){if(v=!1,R(t),!g){if(null!==n(l))g=!0,_(A);else{var e=n(f);null!==e&&L(T,e.startTime-t)}}}function A(t,r){g=!1,v&&(v=!1,y(x),x=-1),m=!0;var a=d;try{for(R(r),p=n(l);null!==p&&(!(p.expirationTime>r)||t&&!b());){var i=p.callback;if("function"==typeof i){p.callback=null,d=p.priorityLevel;var s=i(p.expirationTime<=r);r=e.unstable_now(),"function"==typeof s?p.callback=s:p===n(l)&&o(l),R(r)}else o(l);p=n(l)}if(null!==p)var c=!0;else{var u=n(f);null!==u&&L(T,u.startTime-r),c=!1}return c}finally{p=null,d=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var M=!1,w=null,x=-1,I=5,O=-1;function b(){return!(e.unstable_now()-O<I)}function C(){if(null!==w){var t=e.unstable_now();O=t;var r=!0;try{r=w(!0,t)}finally{r?i():(M=!1,w=null)}}else M=!1}if("function"==typeof N)i=function(){N(C)};else if("undefined"!=typeof MessageChannel){var S=new MessageChannel,U=S.port2;S.port1.onmessage=C,i=function(){U.postMessage(null)}}else i=function(){E(C,0)};function _(t){w=t,M||(M=!0,i())}function L(t,r){x=E(function(){t(e.unstable_now())},r)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,_(A))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var r=d;d=e;try{return t()}finally{d=r}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var r=d;d=t;try{return e()}finally{d=r}},e.unstable_scheduleCallback=function(t,o,a){var i=e.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?i+a:i,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=a+s,t={id:h++,callback:o,priorityLevel:t,startTime:a,expirationTime:s,sortIndex:-1},a>i?(t.sortIndex=a,r(f,t),null===n(l)&&t===n(f)&&(v?(y(x),x=-1):v=!0,L(T,a-i))):(t.sortIndex=s,r(l,t),g||m||(g=!0,_(A))),t},e.unstable_shouldYield=b,e.unstable_wrapCallback=function(t){var e=d;return function(){var r=d;d=e;try{return t.apply(this,arguments)}finally{d=r}}}},79111:(t,e,r)=>{"use strict";t.exports=r(76452)},14887:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>eI});var n,o=r(10326),a=r(50384),i=r(29752),s=r(17577),c=r(94224),u=r(49034),l=r(19075),f=r(43810),h=r(31215),p=r(36283),d=r(29280),m=r(91664),g=r(59008),v=r(41190),E=r(74723),y=r(77506),N=r(56556),R=r(44099);r(24221);var T=r(35047),A=r(78292),M=r(98079),w=r(56627),x=r(48029),I=r.n(x),O=r(24661),b=r.n(O),C=r(79111),S=r(60962);let U=Symbol(),_=Symbol(),L="undefined"==typeof window||/ServerSideRendering/.test(window.navigator&&window.navigator.userAgent)?s.useEffect:s.useLayoutEffect,k=C.unstable_runWithPriority?t=>{try{(0,C.unstable_runWithPriority)(C.unstable_NormalPriority,t)}catch(e){if("Not implemented."===e.message)t();else throw e}}:t=>t(),P=t=>({value:e,children:r})=>{let n=(0,s.useRef)(e),o=(0,s.useRef)(0),[a,i]=(0,s.useState)(null);a&&(a(e),i(null));let c=(0,s.useRef)();if(!c.current){let t=new Set;c.current={[U]:{v:n,n:o,l:t,u:(e,r)=>{(0,S.unstable_batchedUpdates)(()=>{o.current+=1;let n={n:o.current};null!=r&&r.suspense&&(n.n*=-1,n.p=new Promise(t=>{i(()=>e=>{n.v=e,delete n.p,t(e)})})),t.forEach(t=>t(n)),e()})}}}}return L(()=>{n.current=e,o.current+=1,k(()=>{c.current[U].l.forEach(t=>{t({n:o.current,v:e})})})},[e]),(0,s.createElement)(t,{value:c.current},r)};function D(t,e){let{v:{current:r},n:{current:n},l:o}=(0,s.useContext)(t)[U],a=e(r),[i,c]=(0,s.useReducer)((t,o)=>{if(!o)return[r,a];if("p"in o)throw o.p;if(o.n===n)return Object.is(t[1],a)?t:[r,a];try{if("v"in o){if(Object.is(t[0],o.v))return t;let r=e(o.v);if(Object.is(t[1],r))return t;return[o.v,r]}}catch(t){}return[...t]},[r,a]);return Object.is(i[1],a)||c(),L(()=>(o.add(c),()=>{o.delete(c)}),[o]),i[1]}var B=function(t,e){return(B=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function F(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}B(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var j=function(){return(j=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function V(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function G(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function H(t,e,r){if(r||2==arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}var W="SET_DATA",Y="SET_CREATE_FORMULA_PARSER",q="SELECT_ENTIRE_ROW",K="SELECT_ENTIRE_COLUMN",z="SELECT_ENTIRE_WORKSHEET",X="SET_SELECTION",Q="SELECT",Z="ACTIVATE",J="SET_CELL_DATA",tt="SET_CELL_DIMENSIONS",te="COPY",tr="PASTE",tn="EDIT",to="VIEW",ta="BLUR",ti="KEY_PRESS",ts="KEY_DOWN",tc="DRAG_START",tu="DRAG_END",tl="COMMIT";function tf(t,e){return{type:J,payload:{active:t,data:e}}}function th(t,e){var r=e[t.row];if(void 0!==r)return r[t.column]}function tp(t,e,r){for(var n=[],o=e.column-t.column,a=t.row;a<=e.row;a++){var i=a-t.row;n[i]=n[i]||Array(o);for(var s=t.column;s<=e.column;s++)n[i][s-t.column]=th({row:a,column:s},r)}return n}function td(t,e,r){var n=H([],$(r),!1),o=r[0],a=o?H([],$(o),!1):[];a.length-1<t.column&&(a[t.column]=void 0,n[0]=a);var i=r[t.row]?H([],$(r[t.row]),!1):[];return i[t.column]=e,n[t.row]=i,n}function tm(t,e){if(!tv(t,e))return e;var r=H([],$(e),!1),n=H([],$(e[t.row]),!1);return n[t.column]=void 0,r[t.row]=n,r}function tg(t){var e,r,n,o,a,i,s,c,u,l,f,h,p,d;return V(this,function(m){switch(m.label){case 0:m.trys.push([0,11,12,13]),r=(e=G(t.entries())).next(),m.label=1;case 1:if(r.done)return[3,10];o=(n=$(r.value,2))[0],a=n[1],m.label=2;case 2:m.trys.push([2,7,8,9]),p=void 0,s=(i=G(a.entries())).next(),m.label=3;case 3:if(s.done)return[3,6];return u=(c=$(s.value,2))[0],l=c[1],[4,[{row:o,column:u},l]];case 4:m.sent(),m.label=5;case 5:return s=i.next(),[3,3];case 6:return[3,9];case 7:return p={error:m.sent()},[3,9];case 8:try{s&&!s.done&&(d=i.return)&&d.call(i)}finally{if(p)throw p.error}return[7];case 9:return r=e.next(),[3,1];case 10:return[3,13];case 11:return f={error:m.sent()},[3,13];case 12:try{r&&!r.done&&(h=e.return)&&h.call(e)}finally{if(f)throw f.error}return[7];case 13:return[2]}})}function tv(t,e){var r=e[0];return r&&t.row>=0&&t.column>=0&&Number.isInteger(t.row)&&Number.isInteger(t.column)&&t.column<r.length&&t.row<e.length}function tE(t){return{columns:tN(t),rows:ty(t)}}function ty(t){return t.length}function tN(t){var e=t[0];return e?e.length:0}function tR(t){var e=tE(t);return{row:e.rows-1,column:e.columns-1}}var tT=function(){function t(t,e){this.start={row:Math.min(t.row,e.row),column:Math.min(t.column,e.column)},this.end={row:Math.max(t.row,e.row),column:Math.max(t.column,e.column)}}return t.prototype[Symbol.iterator]=function(){var t,e;return V(this,function(r){switch(r.label){case 0:t=this.start.row,r.label=1;case 1:if(!(t<=this.end.row))return[3,6];e=this.start.column,r.label=2;case 2:if(!(e<=this.end.column))return[3,5];return[4,{row:t,column:e}];case 3:r.sent(),r.label=4;case 4:return e++,[3,2];case 5:return t++,[3,1];case 6:return[2]}})},t.prototype.size=function(){return(this.end.row+1-this.start.row)*(this.end.column+1-this.start.column)},t.prototype.has=function(t){return t.row>=this.start.row&&t.column>=this.start.column&&t.row<=this.end.row&&t.column<=this.end.column},t.prototype.mask=function(e){return new t({row:e.start.row>this.start.row?e.start.row:this.start.row,column:e.start.column>this.start.column?e.start.column:this.start.column},{row:e.end.row<this.end.row?e.end.row:this.end.row,column:e.end.column<this.end.column?e.end.column:this.end.column})},t.prototype.equals=function(t){return this.start.row===t.start.row&&this.start.column===t.start.column&&this.end.row===t.end.row&&this.end.column===t.end.column},t}(),tA={row:0,column:0},tM=function(){},tw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toRange=function(t){return null},e.prototype.normalizeTo=function(t){return this},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(){return 0},e.prototype.has=function(){return!1},e.prototype.equals=function(t){return t instanceof e},e}(tM),tx=function(t){function e(e){var r=t.call(this)||this;return r.range=e,r}return F(e,t),e.prototype.toRange=function(t){return this.range},e.prototype.normalizeTo=function(t){var r=tU(t);return new e(this.range.mask(r))},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(t){var e=this.toRange(t);return e?e.size():0},e.prototype.has=function(t,e){var r=this.toRange(t);return null!==r&&r.has(e)},e.prototype.equals=function(t){return t instanceof e&&this.range.equals(t.range)},e}(tM),tI=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e}(tM),tO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toRange=function(t){return tU(t)},e.prototype.normalizeTo=function(t){return this},e.prototype.hasEntireColumn=function(t){return!0},e.prototype.hasEntireRow=function(t){return!0},e.prototype.size=function(t){return tN(t)*ty(t)},e.prototype.has=function(t,e){return!0},e.prototype.equals=function(t){return t instanceof e},e}(tI),tb=function(t){function e(e,r){var n=this;if(!t_(e))throw new tL("start");if(!t_(r))throw new tL("end");return(n=t.call(this)||this).start=Math.min(e,r),n.end=Math.max(e,r),n}return F(e,t),e.prototype.equals=function(t){return t instanceof e&&this.constructor===t.constructor&&this.start===t.start&&this.end===t.end},e}(tI),tC=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toRange=function(t){var e=tR(t);return new tT({row:this.start,column:0},{row:this.end,column:e.column})},e.prototype.normalizeTo=function(t){var r=ty(t);return new e(Math.max(this.start,0),Math.min(this.end,r-1))},e.prototype.hasEntireRow=function(t){return t>=this.start&&t<=this.end},e.prototype.hasEntireColumn=function(t){return!1},e.prototype.size=function(t){return(this.end-this.start+1)*tN(t)},e.prototype.has=function(t,e){return e.row>=this.start&&e.row<=this.end},e}(tb),tS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toRange=function(t){var e=tR(t);return new tT({row:0,column:this.start},{row:e.row,column:this.end})},e.prototype.normalizeTo=function(t){var r=tN(t);return new e(Math.max(this.start,0),Math.min(this.end,r-1))},e.prototype.hasEntireRow=function(t){return!1},e.prototype.hasEntireColumn=function(t){return t>=this.start&&t<=this.end},e.prototype.size=function(t){return(this.end-this.start+1)*ty(t)},e.prototype.has=function(t,e){return e.column>=this.start&&e.column<=this.end},e}(tb);function tU(t){return new tT(tA,tR(t))}function t_(t){return Number.isInteger(t)&&t>=0}var tL=function(t){function e(e){return t.call(this,"".concat(e," is not a valid index. It must be 0 or a positive integer"))||this}return F(e,t),e}(Error),tk="text/plain";function tP(t,e,r){void 0===e&&(e=0),void 0===r&&(r=1);var n=[];if(-1===Math.sign(t-e)){for(var o=e;o>t;o-=r)n.push(o);return n}for(var o=e;o<t;o+=r)n.push(o);return n}function tD(t,e){return!!(t&&e.column===t.column&&e.row===t.row)}function tB(t){return{width:t.offsetWidth,height:t.offsetHeight,left:t.offsetLeft,top:t.offsetTop}}function tF(t,e,r){var n=e&&e[t.row],o=r&&r[t.column];return n&&o&&j(j({},n),o)}function tj(t,e,r){var n=tF(r.start,t,e),o=tF(r.end,t,e);return n&&o&&{width:o.left+o.width-n.left,height:o.top+o.height-n.top,top:n.top,left:n.left}}function tV(t,e){return null!==t&&"view"===e&&tG(t)}function tG(t){return t.matches(":focus-within")}function t$(t){return"".concat(t.row,",").concat(t.column)}function tH(t){var e=$(t.split(","),2),r=e[0],n=e[1];return{row:Number(r),column:Number(n)}}var tW=function(){function t(t){this.set=t}return t.from=function(e){var r,n,o=new Set;try{for(var a=G(e),i=a.next();!i.done;i=a.next()){var s=i.value;o.add(t$(s))}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new t(o)},t.prototype.has=function(t){return this.set.has(t$(t))},Object.defineProperty(t.prototype,"size",{get:function(){return this.set.size},enumerable:!1,configurable:!0}),t.prototype.add=function(e){var r=new Set(this.set);return r.add(t$(e)),new t(r)},t.prototype.delete=function(e){var r=new Set(this.set);return r.delete(t$(e))?new t(r):this},t.prototype.difference=function(t){var e,r,n=this;try{for(var o=G(t),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.delete(i)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype.union=function(t){var e,r,n=this;try{for(var o=G(t),a=o.next();!a.done;a=o.next()){var i=a.value;n=n.add(i)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype[Symbol.iterator]=function(){var t,e,r,n;return V(this,function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),e=(t=G(this.set)).next(),o.label=1;case 1:if(e.done)return[3,4];return[4,tH(e.value)];case 2:o.sent(),o.label=3;case 3:return e=t.next(),[3,1];case 4:return[3,7];case 5:return r={error:o.sent()},[3,7];case 6:try{e&&!e.done&&(n=t.return)&&n.call(t)}finally{if(r)throw r.error}return[7];case 7:return[2]}})},t}();function tY(t){return"string"==typeof t&&t.startsWith("=")&&t.length>1}function tq(t){return t.slice(1)}function tK(t,e){return new(b())(j(j({},e),{onCell:function(e){var r=th({row:e.row-1,column:e.col-1},t);return isNaN(null==r?void 0:r.value)?null==r?void 0:r.value:Number(null==r?void 0:r.value)},onRange:function(e){var r=tE(t);return function(t,e){for(var r=[],n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++){var a=t[n][o];r.push(e?e(a,{row:n,column:o}):a)}return r}(tp({row:e.from.row-1,column:e.from.col-1},{row:Math.min(e.to.row-1,r.rows-1),column:Math.min(e.to.col-1,r.columns-1)},t),function(t){return isNaN(null==t?void 0:t.value)?null==t?void 0:t.value:Number(null==t?void 0:t.value)})}}))}var tz=new O.DepParser;function tX(t,e,r){var n=tE(r),o=n.rows,a=n.columns;try{var i=tz.parse(t,tQ(e));return tW.from(i.flatMap(function(t){if("from"in t){var e=t.from,r=t.to,n={row:e.row-1,column:e.col-1},i={row:Math.min(r.row-1,o-1),column:Math.min(r.col-1,a-1)},s=new tT(n,i);return Array.from(s)}return{row:t.row-1,column:t.col-1}}))}catch(t){if(t instanceof O.FormulaError)return tW.from([]);throw t}}function tQ(t){return{row:t.row+1,col:t.column+1,sheet:"Sheet1"}}var tZ=function(){function t(t){void 0===t&&(t=new Map),this.forwards=t}return t.from=function(e){var r,n,o=new Map;try{for(var a=G(e),i=a.next();!i.done;i=a.next()){var s=$(i.value,2),c=s[0],u=s[1];o.set(t$(c),u)}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return new t(o)},t.prototype.set=function(e,r){var n=new t(new Map(this.forwards));return 0===r.size?n.forwards.delete(t$(e)):n.forwards.set(t$(e),r),n},t.prototype.get=function(t){return this.forwards.get(t$(t))||tW.from([])},t.prototype.getBackwards=function(t){var e,r,n=tW.from([]);try{for(var o=G(this.forwards),a=o.next();!a.done;a=o.next()){var i=$(a.value,2),s=i[0];i[1].has(t)&&(n=n.add(tH(s)))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.prototype.getBackwardsRecursive=function(t,e){void 0===e&&(e=tW.from([]));var r,n,o=this.getBackwards(t),a=e;try{for(var i=G(o),s=i.next();!s.done;s=i.next()){var c=s.value;a.has(c)||(a=a.add(c),o=o.union(this.getBackwardsRecursive(c,a)))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},t.prototype.hasCircularDependency=function(t){for(var e,r,n=tW.from([]),o=[t];o.length>0;){var a=o.pop();if(a){if(n.has(a))return!0;n=n.add(a);var i=this.get(a);if(i)try{for(var s=(e=void 0,G(i)),c=s.next();!c.done;c=s.next()){var u=c.value;o.push(u)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}}}return!1},t.prototype[Symbol.iterator]=function(){var t,e,r,n,o,a,i,s,c,u,l,f,h,p,d;return V(this,function(m){switch(m.label){case 0:t=new Set,m.label=1;case 1:m.trys.push([1,13,14,15]),r=(e=G(this.forwards)).next(),m.label=2;case 2:if(r.done)return[3,12];return o=(n=$(r.value,2))[0],a=n[1],i=tH(o),t.add(o),[4,[i,a]];case 3:m.sent(),m.label=4;case 4:m.trys.push([4,9,10,11]),p=void 0,c=(s=G(a)).next(),m.label=5;case 5:if(c.done)return[3,8];if(l=t$(u=c.value),!(!t.has(l)&&!this.forwards.has(l)))return[3,7];return t.add(l),[4,[u,tW.from([])]];case 6:m.sent(),m.label=7;case 7:return c=s.next(),[3,5];case 8:return[3,11];case 9:return p={error:m.sent()},[3,11];case 10:try{c&&!c.done&&(d=s.return)&&d.call(s)}finally{if(p)throw p.error}return[7];case 11:return r=e.next(),[3,2];case 12:return[3,15];case 13:return f={error:m.sent()},[3,15];case 14:try{r&&!r.done&&(h=e.return)&&h.call(e)}finally{if(f)throw f.error}return[7];case 15:return[2]}})},t.prototype.traverseBFSBackwards=function(){var t,e,r,n,o,a,i,s,c,u,l,f,h,p,d;return V(this,function(m){switch(m.label){case 0:t=tW.from([]),e=[];try{for(n=(r=G(this)).next();!n.done;n=r.next())a=(o=$(n.value,2))[0],i=o[1],0===i.size&&(t=t.add(a),e.push(a))}catch(t){f={error:t}}finally{try{n&&!n.done&&(h=r.return)&&h.call(r)}finally{if(f)throw f.error}}m.label=1;case 1:if(!(e.length>0))return[3,3];if(!(a=e.shift()))return[3,1];return[4,a];case 2:if(m.sent(),0===(s=this.getBackwards(a)).size)return[3,1];try{for(p=void 0,u=(c=G(s)).next();!u.done;u=c.next())l=u.value,t.has(l)||0!==this.get(l).difference(t).size||(e.push(l),t=t.add(l))}catch(t){p={error:t}}finally{try{u&&!u.done&&(d=c.return)&&d.call(c)}finally{if(p)throw p.error}}return[3,1];case 3:return[2]}})},t}(),tJ=function(t,e,r,n){this.createFormulaParser=t,this.data=e,this.referenceGraph=r||function(t){var e,r,n=[];try{for(var o=G(tg(t)),a=o.next();!a.done;a=o.next()){var i=$(a.value,2),s=i[0],c=i[1];if(c&&tY(c.value)){var u=tX(tq(c.value),s,t);n.push([s,u])}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return tZ.from(n)}(e),this.evaluatedData=n||function(t,e,r){var n,o,a=t,i=r(a);try{for(var s=G(e.traverseBFSBackwards()),c=s.next();!c.done;c=s.next()){var u=c.value,l=th(u,t);if(l&&tY(l.value)){var f=t0(l.value,u,i);a=td(u,j(j({},l),{value:f}),a),i=r(a)}}}catch(t){n={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return a}(e,this.referenceGraph,this.createFormulaParser)};function t0(t,e,r){var n=tq(t);try{return function(t,e,r){try{var n=tQ(e),o=r.parse(t,n);return o instanceof O.FormulaError?o.toString():o}catch(t){if(t instanceof O.FormulaError)return t.toString();throw t}}(n,e,r)}catch(t){return O.FormulaError.REF}}var t1={active:null,mode:"view",rowDimensions:{},columnDimensions:{},lastChanged:null,hasPasted:!1,cut:!1,dragging:!1,model:new tJ(tK,[]),selected:new tw,copied:null,lastCommit:null};function t2(t,e){var r,n,o,a,i,s;switch(e.type){case W:var c=e.payload.data,u=t.active&&tv(t.active,c)?t.active:null,l=t.selected.normalizeTo(c);return j(j({},t),{model:new tJ(t.model.createFormulaParser,c),active:u,selected:l});case Y:var f=e.payload.createFormulaParser;return j(j({},t),{model:new tJ(f,t.model.data)});case q:var h=e.payload,p=h.row,d=h.extend,m=t.active;return j(j({},t),{selected:d&&m?new tC(m.row,p):new tC(p,p),active:d&&m?m:j(j({},tA),{row:p}),mode:"view"});case K:var g=e.payload,v=g.column,d=g.extend,m=t.active;return j(j({},t),{selected:d&&m?new tS(m.column,v):new tS(v,v),active:d&&m?m:j(j({},tA),{column:v}),mode:"view"});case z:return j(j({},t),{selected:new tO,active:tA,mode:"view"});case X:var E=e.payload.selection,y=E.toRange(t.model.data),m=t.active&&E.has(t.model.data,t.active)?t.active:null==y?void 0:y.start;return j(j({},t),{selected:E,active:m||null,mode:"view"});case Q:var N=e.payload.point;if(t.active&&!tD(t.active,N))return j(j({},t),{selected:new tx(new tT(N,t.active)),mode:"view"});return t;case Z:var N=e.payload.point;return j(j({},t),{selected:new tx(new tT(N,N)),active:N,mode:tD(t.active,N)?"edit":"view"});case J:var R,T,A,M,w,x,I,b,C=e.payload,m=C.active,S=C.data;if(ei(t))return t;return j(j({},t),{model:(A=t.model,w=td(M=m,S,A.data),x=tY(S.value)?(R=A.referenceGraph,T=tX(tq(S.value),M,w),R.set(M,T)):A.referenceGraph,I=A.createFormulaParser(w),b=function(t,e,r,n,o,a){if(r.hasCircularDependency(n)){var i,s,c,u,l=tW.from([n]),f=td(n,j(j({},o),{value:O.FormulaError.REF}),t);try{for(var h=G(r.getBackwardsRecursive(n)),p=h.next();!p.done;p=h.next()){var d=p.value;if(l.has(d))break;l=l.add(d);var m=th(d,e);m&&(f=td(d,j(j({},m),{value:O.FormulaError.REF}),f))}}catch(t){i={error:t}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}return f}var g=t,v=tY(o.value)?t0(o.value,n,a):o.value;g=td(n,j(j({},o),{value:v}),g);try{for(var E=G(r.getBackwardsRecursive(n)),y=E.next();!y.done;y=E.next()){var d=y.value,m=th(d,e);if(m){var N=tY(m.value)?t0(m.value,n,a):m.value,R=j(j({},m),{value:N});g=td(d,R,g)}}}catch(t){c={error:t}}finally{try{y&&!y.done&&(u=E.return)&&u.call(E)}finally{if(c)throw c.error}}return g}(A.evaluatedData,w,x,M,S,I),new tJ(A.createFormulaParser,w,x,b)),lastChanged:m});case tt:var U=e.payload,N=U.point,_=U.dimensions,L=t.rowDimensions[N.row],k=t.columnDimensions[N.column];if(L&&k&&L.top===_.top&&L.height===_.height&&k.left===_.left&&k.width===_.width)return t;return j(j({},t),{rowDimensions:j(j({},t.rowDimensions),((r={})[N.row]={top:_.top,height:_.height},r)),columnDimensions:j(j({},t.columnDimensions),((n={})[N.column]={left:_.left,width:_.width},n))});case te:case"CUT":var P=t.selected.toRange(t.model.data);return j(j({},t),{copied:P,cut:"CUT"===e.type,hasPasted:!1});case tr:var D,B,F,V=e.payload.data,m=t.active;if(!m)return t;var tf=(D=function(t){return{value:t}},void 0===B&&(B="	"),void 0===F&&(F=/\r\n|\n|\r/),V.replace(/"([^"]*?)"/g,function(t,e){return e.replace(/\n/g,"\\n")}).split(F).map(function(t){return t.split(B).map(function(t){return t.replace(/\\n/g,"\n")}).map(D)})),tp=tE(tf),P=t.selected.toRange(t.model.data);if(P&&1===tp.rows&&1===tp.columns){var ty=th({row:0,column:0},tf),tN=t.cut&&t.copied?tm(t.copied.start,t.model.data):t.model.data,tR=[];try{for(var tM=G(P||[]),tw=tM.next();!tw.done;tw=tM.next()){var N=tw.value,tI=th(N,t.model.data);tR.push({prevCell:tI||null,nextCell:ty||null}),tN=td(N,ty,tN)}}catch(t){o={error:t}}finally{try{tw&&!tw.done&&(a=tM.return)&&a.call(tM)}finally{if(o)throw o.error}}return j(j({},t),{model:new tJ(tK,tN),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:tR})}var tb={rows:m.row+tp.rows,columns:m.column+tp.columns},tU=function(t,e){var r=tE(t),n=r.rows,o=r.columns;if(n>=e.rows&&o>=e.columns)return t;var a={rows:e.rows>n?e.rows:n,columns:e.columns>o?e.columns:o},i=H([],$(t),!1);if(a.columns>o){var s=a.columns-o;i=i.map(function(t){return H(H([],$(t),!1),$(Array(s).fill(void 0)),!1)})}if(a.rows>n){var c=a.rows-n,u=Array(a.columns).fill(void 0);i=H(H([],$(i),!1),$(Array(c).fill(u)),!1)}return i}(t.model.data,tb),t_={data:tU,commit:[]};try{for(var tL=G(tg(tf)),tk=tL.next();!tk.done;tk=tL.next()){var tP=$(tk.value,2),N=tP[0],ty=tP[1],tB=t_.commit||[],tF={row:N.row+m.row,column:N.column+m.column},tj=t_.data;if(t.cut){if(t.copied){var tV={row:N.row+t.copied.start.row,column:N.column+t.copied.start.column};tj=tm(tV,t_.data)}tB=H(H([],$(tB),!1),[{prevCell:ty||null,nextCell:null}],!1)}tv(tF,tU)||(t_={data:tj,commit:tB});var tI=th(tF,tj)||null;tB=H(H([],$(tB),!1),[{prevCell:tI,nextCell:ty||null}],!1),t_.data=td(tF,j(j({value:void 0},tI),ty),tj),t_.commit=tB}}catch(t){i={error:t}}finally{try{tk&&!tk.done&&(s=tL.return)&&s.call(tL)}finally{if(i)throw i.error}}return j(j({},t),{model:new tJ(tK,t_.data),selected:new tx(new tT(m,{row:m.row+tp.rows-1,column:m.column+tp.columns-1})),copied:null,cut:!1,hasPasted:!0,mode:"view",lastCommit:t_.commit});case tn:return t3(t);case to:return t6(t);case"CLEAR":return t4(t);case ta:return t5(t);case ti:var tG=e.payload.event;if(ei(t)||tG.metaKey)return t;if("view"===t.mode&&t.active)return t3(t);return t;case ts:var t$=e.payload.event,tH=ea(t,t$);if(tH)return j(j({},t),tH(t,t$));return t;case tc:return j(j({},t),{dragging:!0});case tu:return j(j({},t),{dragging:!1});case tl:var tz=e.payload.changes;return j(j({},t),t7(tz));default:throw Error("Unknown action")}}function t3(t){return ei(t)?t:j(j({},t),{mode:"edit"})}function t4(t){if(!t.active)return t;var e,r,n=t.selected.toRange(t.model.data),o=[],a=t.model.data;try{for(var i=G(n||[]),s=i.next();!s.done;s=i.next()){var c,u=s.value,l=th(u,t.model.data),f=(c=l)&&!c.readOnly?Object.assign({},c,{value:void 0}):c;o.push({prevCell:l||null,nextCell:f||null}),a=td(u,f,a)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return j(j(j({},t),{model:new tJ(tK,a)}),t7(o))}function t5(t){return j(j({},t),{active:null,selected:new tw})}function t6(t){return j(j({},t),{mode:"view"})}function t7(t){return{lastCommit:t}}var t9=function(t,e){return function(r){if(r.active){var n={row:r.active.row+t,column:r.active.column+e};return tv(n,r.model.data)?j(j({},r),{active:n,selected:new tx(new tT(n,n)),mode:"view"}):j(j({},r),{mode:"view"})}}},t8={ArrowUp:t9(-1,0),ArrowDown:t9(1,0),ArrowLeft:t9(0,-1),ArrowRight:t9(0,1),Tab:t9(0,1),Enter:t3,Backspace:t4,Delete:t4,Escape:t5},et={Escape:t6,Tab:t8.Tab,Enter:t8.ArrowDown},ee={Tab:t9(0,-1)};!function(t){t.Left="Left",t.Right="Right",t.Top="Top",t.Bottom="Bottom"}(n||(n={}));var er={ArrowUp:function(t){return j(j({},t),{selected:es(t.selected,t.active,t.model.data,n.Top)})},ArrowDown:function(t){return j(j({},t),{selected:es(t.selected,t.active,t.model.data,n.Bottom)})},ArrowLeft:function(t){return j(j({},t),{selected:es(t.selected,t.active,t.model.data,n.Left)})},ArrowRight:function(t){return j(j({},t),{selected:es(t.selected,t.active,t.model.data,n.Right)})},Tab:t9(0,-1)},en={},eo={};function ea(t,e){var r=e.key;return("edit"===t.mode?e.shiftKey?ee:et:e.shiftKey&&e.metaKey?en:e.shiftKey?er:e.metaKey?eo:t8)[r]}function ei(t){var e=t.active&&th(t.active,t.model.data)||null;return!!(null==e?void 0:e.readOnly)}function es(t,e,r,o){var a,i,s,c,u,l;return e?t instanceof tx?(i=o===n.Left||o===n.Right?"column":"row",c="start"==(s=o===n.Left||o===n.Top?"start":"end")?-1:1,u=t.range.has(j(j({},e),((a={})[i]=e[i]+-1*c,a))),l=new tT(t.range.start,t.range.end),l[u?"start"===s?"end":"start":s][i]+=c,new tx(l).normalizeTo(r)):t instanceof tS?function(t,e,r,o){if(o===n.Top||o===n.Bottom)return t;var a=o===n.Left?-1:1,i=o===n.Left?"start":"end",s="start"===i?"end":"start",c=j({},t);return(o===n.Left?t.end>e.row:t.start<e.row)?c[s]=t[s]+a:c[i]=t[i]+a,new tS(Math.max(c.start,0),Math.max(c.end,0)).normalizeTo(r)}(t,e,r,o):t instanceof tC?function(t,e,r,o){if(o===n.Left||o===n.Right)return t;var a=o===n.Top?-1:1,i=o===n.Top?"start":"end",s="start"===i?"end":"start",c=j({},t);return(o===n.Top?t.end>e.row:t.start<e.row)?c[s]=t[s]+a:c[i]=t[i]+a,new tC(Math.max(c.start,0),Math.max(c.end,0)).normalizeTo(r)}(t,e,r,o):t:t}var ec=function(t){let e=(0,s.createContext)({[U]:{v:{current:t},n:{current:-1},l:new Set,u:t=>t()}});return e[_]=e.Provider,e.Provider=P(e.Provider),delete e.Consumer,e}([t1,function(){}]),eu=function(t){var e=t.children,r=tP(t.columns+(t.hideColumnIndicators?0:1)).map(function(t){return s.createElement("col",{key:t})});return s.createElement("table",{className:"Spreadsheet__table"},s.createElement("colgroup",null,r),s.createElement("tbody",null,e))},el=function(t){return s.createElement("tr",j({},t))},ef=function(t){return s.createElement("tr",j({},t))};function eh(){return D(ec,function(t){var e=$(t,2);return e[0],e[1]})}function ep(t){return D(ec,function(e){return t($(e,1)[0])})}var ed=function(t){var e=t.selected,r=t.onSelect,n=s.useCallback(function(){r()},[r]);return s.createElement("th",{className:I()("Spreadsheet__header",{"Spreadsheet__header--selected":e}),onClick:n,tabIndex:0})},em=function(t){var e=t.column,r=t.label,n=t.selected,o=t.onSelect,a=s.useCallback(function(t){o(e,t.shiftKey)},[o,e]);return s.createElement("th",{className:I()("Spreadsheet__header",{"Spreadsheet__header--selected":n}),onClick:a,tabIndex:0},void 0!==r?r:function(t){for(var e="",r=t;r>=0;)e=String.fromCharCode(65+r%26)+e,r=Math.floor(r/26)-1;return e}(e))},eg=function(t){var e=t.row,r=t.label,n=t.selected,o=t.onSelect,a=s.useCallback(function(t){o(e,t.shiftKey)},[o,e]);return s.createElement("th",{className:I()("Spreadsheet__header",{"Spreadsheet__header--selected":n}),onClick:a,tabIndex:0},void 0!==r?r:e+1)},ev=function(t){var e=t.row,r=t.column,n=t.DataViewer,o=t.selected,a=t.active,i=t.dragging,c=t.mode,u=t.data,l=t.evaluatedData,f=t.select,h=t.activate,p=t.setCellDimensions,d=t.setCellData,m=s.useRef(null),g=s.useMemo(function(){return{row:e,column:r}},[e,r]),v=s.useCallback(function(t){"view"===c&&(p(g,tB(t.currentTarget)),t.shiftKey?f(g):h(g))},[c,p,g,f,h]),E=s.useCallback(function(t){i&&(p(g,tB(t.currentTarget)),f(g))},[p,f,i,g]);return s.useEffect(function(){var t=m.current;o&&t&&p(g,tB(t)),t&&a&&"view"===c&&t.focus()},[p,o,a,c,g,u]),u&&u.DataViewer&&(n=u.DataViewer),s.createElement("td",{ref:m,className:I()("Spreadsheet__cell",null==u?void 0:u.className,{"Spreadsheet__cell--readonly":null==u?void 0:u.readOnly}),onMouseOver:E,onMouseDown:v,tabIndex:0},s.createElement(n,{row:e,column:r,cell:u,evaluatedCell:l,setCellData:d}))},eE=function(t){var e,r,n,o,a=(e=t.cell,(o=null!==(n=null==(r=t.evaluatedCell)?void 0:r.value)&&void 0!==n?n:null==e?void 0:e.value)&&"object"==typeof o?o.toString():o);return"boolean"==typeof a?s.createElement("span",{className:"Spreadsheet__data-viewer Spreadsheet__data-viewer--boolean"},a?"TRUE":"FALSE"):s.createElement("span",{className:I()("Spreadsheet__data-viewer",{"Spreadsheet__data-viewer--preserve-breaks":"string"==typeof a&&a.includes("\n")})},a)},ey=function(t){var e,r=t.onChange,n=t.cell,o=s.useRef(null),a=s.useCallback(function(t){r(j(j({},n),{value:t.target.value}))},[r,n]);s.useEffect(function(){if(o.current){var t;(t=o.current).selectionStart=t.selectionEnd=t.value.length}},[o]);var i=null!==(e=null==n?void 0:n.value)&&void 0!==e?e:"";return s.createElement("div",{className:"Spreadsheet__data-editor"},s.createElement("input",{ref:o,type:"text",onChange:a,value:i,autoFocus:!0}))},eN=function(t){var e=s.useRef(null),r=eh(),n=s.useCallback(function(t,e){return r(tf(t,e))},[r]),o=s.useCallback(function(){return r({type:tn})},[r]),a=s.useCallback(function(t){return r({type:tl,payload:{changes:t}})},[r]),i=s.useCallback(function(){r({type:to})},[r]),c=ep(function(t){return t.active}),u=ep(function(t){return t.mode}),l=ep(function(t){return t.active?th(t.active,t.model.data):void 0}),f=ep(function(t){return c?tF(c,t.rowDimensions,t.columnDimensions):void 0}),h=s.useMemo(function(){return!c||!f},[c,f]),p=s.useRef(void 0),d=s.useRef(null),m=s.useRef(void 0),g=s.useCallback(function(t){c&&n(c,t)},[n,c]);s.useEffect(function(){var t=e.current;!h&&t&&t.focus()},[e,h]),s.useEffect(function(){var t=d.current,e=m.current;if(d.current=c,m.current=l,t&&e){var r=(null==c?void 0:c.row)!==t.row||(null==c?void 0:c.column)!==t.column;if(r||"edit"!==u){var n=p.current;e!==n?a([{prevCell:n||null,nextCell:e}]):r||l===e||a([{prevCell:e,nextCell:l||null}]),p.current=l}}});var v=l&&l.DataEditor||t.DataEditor,E=l&&l.readOnly;return h?null:s.createElement("div",{ref:e,className:I()("Spreadsheet__active-cell","Spreadsheet__active-cell--".concat(u)),style:f,onClick:"view"!==u||E?void 0:o,tabIndex:0},"edit"===u&&c&&s.createElement(v,{row:c.row,column:c.column,cell:l,onChange:g,exitEditMode:i}))},eR=function(t){var e,r=t.dimensions,n=t.dragging,o=t.hidden,a=t.variant,i=r||{},c=i.width,u=i.height,l=i.top,f=i.left;return s.createElement("div",{className:I()("Spreadsheet__floating-rect",((e={})["Spreadsheet__floating-rect--".concat(a)]=a,e["Spreadsheet__floating-rect--dragging"]=n,e["Spreadsheet__floating-rect--hidden"]=o,e)),style:{width:c,height:u,top:l,left:f}})},eT=function(){var t=ep(function(t){return t.selected}),e=ep(function(e){var r,n,o,a;return t&&(r=e.rowDimensions,n=e.columnDimensions,o=e.model.data,(a=e.selected.toRange(o))?tj(r,n,a):void 0)}),r=ep(function(t){return t.dragging}),n=ep(function(t){return 2>t.selected.size(t.model.data)});return s.createElement(eR,{variant:"selected",dimensions:e,dragging:r,hidden:n})},eA=function(){var t=ep(function(t){return t.copied}),e=ep(function(e){return t&&tj(e.rowDimensions,e.columnDimensions,t)}),r=null===t;return s.createElement(eR,{variant:"copied",dimensions:e,hidden:r,dragging:!1})};!function(t,e){void 0===e&&(e={});var r=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}(".Spreadsheet {\n  --background-color: white;\n  --text-color: black;\n  --readonly-text-color: rgba(0, 0, 0, 0.4);\n  --outline-color: #4285f4;\n  --outline-background-color: rgba(160, 195, 255, 0.2);\n  --border-color: hsl(2deg, 0%, 91%);\n  --header-background-color: rgba(0, 0, 0, 0.04);\n  --elevation: 0 2px 5px rgba(0, 0, 0, 0.4);\n\n  position: relative;\n  overflow: visible;\n  background: var(--background-color);\n  color: var(--text-color);\n  display: inline-block;\n}\n\n.Spreadsheet--dark-mode {\n  --background-color: black;\n  --text-color: white;\n  --readonly-text-color: rgba(255, 255, 255, 0.4);\n  --header-background-color: rgba(255, 255, 255, 0.04);\n  --border-color: hsl(2deg, 0%, 19%);\n}\n\n.Spreadsheet__active-cell {\n  position: absolute;\n  border: 2px solid var(--outline-color);\n  box-sizing: border-box;\n}\n\n.Spreadsheet__active-cell--edit {\n  background: var(--background-color);\n  box-shadow: var(--elevation);\n}\n\n.Spreadsheet__table {\n  border-collapse: collapse;\n  table-layout: fixed;\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__active-cell {\n  cursor: cell;\n}\n\n.Spreadsheet__cell {\n  outline: none;\n}\n\n.Spreadsheet__cell--readonly {\n  color: var(--readonly-text-color);\n}\n\n.Spreadsheet__cell,\n.Spreadsheet__header {\n  min-width: 6em;\n  min-height: 1.9em;\n  height: 1.9em;\n  max-height: 1.9em;\n  border: 1px solid var(--border-color);\n  overflow: hidden;\n  word-break: keep-all;\n  white-space: nowrap;\n  text-align: left;\n  box-sizing: border-box;\n  user-select: none;\n}\n\n.Spreadsheet__header {\n  background: var(--header-background-color);\n  color: var(--readonly-text-color);\n  text-align: center;\n  font: inherit;\n}\n\n.Spreadsheet__header--selected {\n  background: #5f6268;\n  color: #fff;\n}\n\n.Spreadsheet__header,\n.Spreadsheet__data-viewer,\n.Spreadsheet__data-editor input {\n  padding: 4px;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__data-viewer--preserve-breaks {\n  white-space: pre-wrap;\n}\n\n.Spreadsheet__data-editor,\n.Spreadsheet__data-editor input {\n  width: 100%;\n  height: 100%;\n}\n\n.Spreadsheet__data-editor input {\n  font: inherit;\n  color: inherit;\n  background: none;\n  border: none;\n  outline: none;\n  margin: 0;\n}\n\n.Spreadsheet__data-viewer--boolean {\n  text-align: center;\n}\n\n.Spreadsheet__floating-rect {\n  position: absolute;\n  pointer-events: none;\n  box-sizing: border-box;\n}\n\n.Spreadsheet__floating-rect--hidden {\n  display: none;\n}\n\n.Spreadsheet__floating-rect--selected {\n  background: var(--outline-background-color);\n  border: 2px var(--outline-color) solid;\n}\n\n.Spreadsheet__floating-rect--dragging {\n  border: none;\n}\n\n.Spreadsheet__floating-rect--copied {\n  border: 2px var(--outline-color) dashed;\n}\n");var eM=function(t){var e=t.className,r=t.darkMode,n=t.columnLabels,o=t.rowLabels,a=t.hideColumnIndicators,i=t.hideRowIndicators,c=t.onKeyDown,u=t.Table,l=void 0===u?eu:u,f=t.Row,h=void 0===f?el:f,p=t.HeaderRow,d=void 0===p?ef:p,m=t.DataEditor,g=void 0===m?ey:m,v=t.DataViewer,E=void 0===v?eE:v,y=t.onChange,N=void 0===y?function(){}:y,R=t.onModeChange,T=void 0===R?function(){}:R,A=t.onSelect,M=void 0===A?function(){}:A,w=t.onActivate,x=void 0===w?function(){}:w,O=t.onBlur,b=void 0===O?function(){}:O,C=t.onCellCommit,S=void 0===C?function(){}:C,U=s.useMemo(function(){var e=new tJ(t.createFormulaParser||tK,t.data);return j(j({},t1),{model:e,selected:t.selected||t1.selected})},[t.createFormulaParser,t.data,t.selected]),_=s.useReducer(t2,U),L=$(_,2),k=L[0],P=L[1],D=s.useMemo(function(){var t,e,r;return e=(t=tE(k.model.data)).columns,r=t.rows,{rows:o?Math.max(r,o.length):r,columns:n?Math.max(e,n.length):e}},[k.model.data,o,n]),B=k.mode,F=s.useRef(null),V=s.useCallback(function(){return P({type:te})},[P]),H=s.useCallback(function(){return P({type:"CUT"})},[P]),J=s.useCallback(function(t){return P({type:tr,payload:{data:t}})},[P]),tn=s.useCallback(function(t){return P({type:ts,payload:{event:t}})},[P]),to=s.useCallback(function(t){return P({type:ti,payload:{event:t}})},[P]),tl=s.useCallback(function(){return P({type:tc})},[P]),td=s.useCallback(function(){return P({type:tu})},[P]),tm=s.useCallback(function(t){return P({type:W,payload:{data:t}})},[P]),tv=s.useCallback(function(t){return P({type:Y,payload:{createFormulaParser:t}})},[P]),ty=s.useCallback(function(){return P({type:ta})},[P]),tN=s.useCallback(function(t){return P({type:X,payload:{selection:t}})},[P]),tR=s.useRef(k.active);s.useEffect(function(){if(k.active!==tR.current){if(k.active)x(k.active);else{var t=F.current;t&&tG(t)&&document.activeElement&&document.activeElement.blur(),b()}}tR.current=k.active},[x,b,k.active]);var tT=s.useRef(k.model.data);s.useEffect(function(){k.model.data!==tT.current&&k.model.data!==t.data&&N(k.model.data),tT.current=k.model.data},[k.model.data,N,t.data]);var tA=s.useRef(k.selected);s.useEffect(function(){k.selected.equals(tA.current)||t.selected&&k.selected.equals(t.selected)||M(k.selected),tA.current=k.selected},[k.selected,M,t.selected]);var tM=s.useRef(k.mode);s.useEffect(function(){k.mode!==tM.current&&T(k.mode),tM.current=k.mode},[k.mode,T]);var tw=s.useRef(k.lastCommit);s.useEffect(function(){var t,e;if(k.lastCommit&&k.lastCommit!==tw.current)try{for(var r=G(k.lastCommit),n=r.next();!n.done;n=r.next()){var o=n.value;S(o.prevCell,o.nextCell,k.lastChanged)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},[S,k.lastChanged,k.lastCommit]);var tx=s.useRef(t.selected);s.useEffect(function(){t.selected&&tx.current&&!t.selected.equals(tx.current)&&tN(t.selected),tx.current=t.selected},[t.selected,tN]);var tI=s.useRef(t.data);s.useEffect(function(){t.data!==tI.current&&tm(t.data),tI.current=t.data},[t.data,tm]);var tb=s.useRef(t.createFormulaParser);s.useEffect(function(){t.createFormulaParser!==tb.current&&t.createFormulaParser&&tv(t.createFormulaParser),tb.current=t.createFormulaParser},[t.createFormulaParser,tv]);var tC=s.useCallback(function(t){var e=k.model,r=k.selected,n=e.data,o=r.toRange(n);if(o){var a,i=function(t,e,r){void 0===e&&(e="	"),void 0===r&&(r="\n");for(var n="",o=tE(t),a=o.rows,i=o.columns,s=0;s<a;s++){s&&(n+=r);for(var c=0;c<i;c++)c&&(n+=e),t[s]&&c in t[s]&&(n+=String(t[s][c]))}return n}(function(t,e){var r,n,o=[];try{for(var a=G(tg(e)),i=a.next();!i.done;i=a.next()){var s=$(i.value,2),c=s[0],u=s[1];!function(t,e,r){var n=r[0];n||(n=[],r[0]=n),t.row in r||(r[t.row]=[]),t.column in n||(n[t.column]=void 0),r[t.row][t.column]=e}(c,t(u,c),o)}}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}(function(t){return(null==t?void 0:t.value)||""},tp(o.start,o.end,n)));null===(a=t.clipboardData)||void 0===a||a.setData(tk,i)}},[k]),tS=s.useCallback(function(t){tV(F.current,B)&&(t.preventDefault(),t.stopPropagation(),tC(t),H())},[B,tC,H]),tU=s.useCallback(function(t){tV(F.current,B)&&(t.preventDefault(),t.stopPropagation(),tC(t),V())},[B,tC,V]),t_=s.useCallback(function(t){tV(F.current,B)&&(t.preventDefault(),t.stopPropagation(),t.clipboardData)&&J(window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):t.clipboardData&&t.clipboardData.getData?t.clipboardData.getData(tk):"")},[B,J]),tL=s.useCallback(function(t){t.persist(),c&&c(t),t.defaultPrevented||(void 0!==ea(k,t)&&t.nativeEvent.preventDefault(),tn(t))},[k,c,tn]),tB=s.useCallback(function(){td(),document.removeEventListener("mouseup",tB)},[td]),tF=s.useCallback(function(t){k.dragging||1!==t.buttons||(tl(),document.addEventListener("mouseup",tB))},[k,tl,tB]),tj=s.useCallback(function(t){t.currentTarget.contains(t.relatedTarget)||ty()},[ty]),t$=s.useMemo(function(){var e;return e=t.Cell||ev,function(t){var r=t.row,n=t.column,o=eh(),a=s.useMemo(function(){return{row:r,column:n}},[r,n]),i=s.useCallback(function(t){return o(tf(a,t))},[o,a]),c=s.useCallback(function(t){return o({type:Q,payload:{point:t}})},[o]),u=s.useCallback(function(t){return o({type:Z,payload:{point:t}})},[o]),l=s.useCallback(function(t,e){return o({type:tt,payload:{point:t,dimensions:e}})},[o]),f=ep(function(t){return tD(t.active,a)}),h=ep(function(t){return f?t.mode:"view"}),p=ep(function(t){return th(a,t.model.data)}),d=ep(function(t){return th(a,t.model.evaluatedData)}),m=ep(function(t){return t.selected.has(t.model.data,a)}),g=ep(function(t){return t.dragging}),v=ep(function(t){var e;return(null===(e=t.copied)||void 0===e?void 0:e.has(a))||!1});return s.createElement(e,j({},t,{selected:m,active:f,copied:v,dragging:g,mode:h,evaluatedData:d,data:p,select:c,activate:u,setCellDimensions:l,setCellData:i}))}},[t.Cell]),tH=s.useMemo(function(){var e;return e=t.CornerIndicator||ed,function(t){var r=eh(),n=s.useCallback(function(){return r({type:z})},[r]),o=ep(function(t){return t.selected instanceof tO});return s.createElement(e,j({},t,{selected:o,onSelect:n}))}},[t.CornerIndicator]),tW=s.useMemo(function(){var e;return e=t.RowIndicator||eg,function(t){var r=eh(),n=ep(function(e){return e.selected.hasEntireRow(t.row)}),o=s.useCallback(function(t,e){return r({type:q,payload:{row:t,extend:e}})},[r]);return s.createElement(e,j({},t,{selected:n,onSelect:o}))}},[t.RowIndicator]),tY=s.useMemo(function(){var e;return e=t.ColumnIndicator||em,function(t){var r=eh(),n=s.useCallback(function(t,e){return r({type:K,payload:{column:t,extend:e}})},[r]),o=ep(function(e){return e.selected.hasEntireColumn(t.column)});return s.createElement(e,j({},t,{selected:o,onSelect:n}))}},[t.ColumnIndicator]);s.useEffect(function(){return document.addEventListener("cut",tS),document.addEventListener("copy",tU),document.addEventListener("paste",t_),function(){document.removeEventListener("cut",tS),document.removeEventListener("copy",tU),document.removeEventListener("paste",t_)}},[tS,tU,t_]);var tq=s.useMemo(function(){return s.createElement(l,{columns:D.columns,hideColumnIndicators:a},s.createElement(d,null,!i&&!a&&s.createElement(tH,null),!a&&tP(D.columns).map(function(t){return n?s.createElement(tY,{key:t,column:t,label:t in n?n[t]:null}):s.createElement(tY,{key:t,column:t})})),tP(D.rows).map(function(t){return s.createElement(h,{key:t,row:t},!i&&(o?s.createElement(tW,{key:t,row:t,label:t in o?o[t]:null}):s.createElement(tW,{key:t,row:t})),tP(D.columns).map(function(e){return s.createElement(t$,{key:e,row:t,column:e,DataViewer:E})}))}))},[l,D.rows,D.columns,a,h,d,i,tH,n,tY,o,tW,t$,E]),tz=s.useMemo(function(){return s.createElement(eN,{DataEditor:g})},[g]),tX=s.useMemo(function(){return s.createElement("div",{ref:F,className:I()("Spreadsheet",e,{"Spreadsheet--dark-mode":r}),onKeyPress:to,onKeyDown:tL,onMouseMove:tF,onBlur:tj},tq,tz,s.createElement(eT,null),s.createElement(eA,null))},[e,r,to,tL,tF,tj,tq,tz]);return s.createElement(ec.Provider,{value:_},tX)};let ew=()=>o.jsx("div",{className:"w-full h-full ",children:o.jsx(eM,{className:"w-full h-full",data:[[{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Chocolate"}],[{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Chocolate"}],[{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Chocolate"}],[{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Chocolate"}],[{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Vanilla"},{value:"Chocolate"}],[{value:"Strawberry"},{value:"Cookies"},{value:"Cookies"},{value:"Cookies"},{value:"Cookies"}]],columnLabels:["Flavour","Food"],rowLabels:["Item 1","Item 2","Item 2","Item 2","Item 2","Item 2"]})});var ex=r(46226);let eI=function(){let[t,e]=(0,s.useState)(!1),[r,n]=(0,s.useState)(""),[x,I]=(0,s.useState)(""),[O,b]=(0,s.useState)(""),[C,S]=(0,s.useState)(""),[U,_]=(0,s.useState)(""),[L,k]=(0,s.useState)(),[P,D]=(0,s.useState)(""),[B,F]=(0,s.useState)(!1),[j,V]=(0,s.useState)(!1),[G,$]=(0,s.useState)(!0),{toast:H}=(0,w.pm)(),W=async t=>{console.log(t),F(!0);try{let e=await R.Z.post("http://98.70.9.194:8000/api/finance_agent",{ticker:t.ticker,value_proposition:t.value_proposition},{headers:{"Content-Type":"application/json"}});console.log(e.data),n(e.data.industry_landscape),I(e.data.msgp),b(e.data.tt),S(e.data.in),_(e.data.file),k(e.data.data),D(e.data.type)}catch(t){H({title:"ERROR API CALL",description:"There is an error in making the call",variant:"destructive"}),console.error("Error fetching data:",t)}F(!1),$(!1)},Y=["Initializing model...","Fetching information...","Analysing gathered information...","Synthesizing information...","Refining output quality...","Finalizing analysis...","Almost ready with your response..."],q=(0,E.cI)({defaultValues:{language:"english",year:"2020",model:"llama3-70b-8192",ticker:"",value_proposition:""}});(0,T.useRouter)();let K=t=>{navigator.clipboard.writeText(t).then(()=>{alert("Content copied to clipboard")}).catch(t=>{H({title:"Copy Error",description:"Could not copy text"}),console.error("Could not copy text: ",t)})},[z,X]=(0,s.useState)(!1),[Q,Z]=(0,s.useState)(!1),[J,tt]=(0,s.useState)(""),te=()=>{Z(!1),X(!0)};return o.jsx(M.Z,{children:o.jsx("div",{className:"w-full h-screen flex overflow-hidden ",children:(0,o.jsxs)("div",{className:"w-full",children:[o.jsx("div",{className:"py-5 w-full border-b-2 border-zinc-100",children:" "}),(0,o.jsxs)("div",{className:"w-full  h-full flex  text-base text-zinc-800 overflow-hidden",children:[G?o.jsx(o.Fragment,{children:(0,o.jsxs)("div",{className:`leftDiv w-1/2 h-full flex flex-col ${G?"inline":"block"}`,children:[(0,o.jsxs)("div",{className:"py-4 text-zinc-900 font-bold text-3xl ml-6 mb-6 bg-white",children:["Financial Research Agent"," "]}),o.jsx("div",{className:"p-6 mt-2 flex-1 overflow-hidden",children:o.jsx(g.l0,{...q,children:(0,o.jsxs)("form",{onSubmit:q.handleSubmit(W),className:"space-y-6",children:[o.jsx(g.Wi,{name:"ticker",control:q.control,render:({field:t})=>(0,o.jsxs)(g.xJ,{children:[o.jsx(g.lX,{className:"mb-2  text-2xl font-bold text-zinc-800",children:"Ticker symbol"}),o.jsx(v.I,{className:"overflow-y-auto mt-2 border border-zinc-400",...t}),o.jsx(g.zG,{})]})}),o.jsx(g.Wi,{name:"value_proposition",control:q.control,render:({field:t})=>(0,o.jsxs)(g.xJ,{children:[o.jsx(g.lX,{className:"text-lg font-semibold",children:"Value Proposition"}),o.jsx(v.I,{className:"h-24  border border-zinc-400 rounded w-full px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",...t}),o.jsx(g.zG,{})]})}),o.jsx(N.UQ,{className:"border border-gray-400 ",type:"single",collapsible:!0,children:(0,o.jsxs)(N.Qd,{value:"item-1",children:[o.jsx(N.o4,{className:"text-lg p-4",children:"Advanced Options"}),o.jsx(N.vF,{className:"border-t  border-gray-300",children:(0,o.jsxs)("div",{className:"flex items-center justify-center gap-4 p-2",children:[o.jsx(g.Wi,{name:"language",control:q.control,render:({field:t})=>(0,o.jsxs)(g.xJ,{children:[o.jsx(g.lX,{className:"text-sm font-semibold mb-2",children:"Language"}),o.jsx(E.Qr,{name:"language",control:q.control,render:({field:t})=>(0,o.jsxs)(d.Ph,{onValueChange:t.onChange,value:t.value,children:[o.jsx(d.i4,{className:"w-[120px] bg-gray-50 border border-gray-300 rounded-md",children:o.jsx(d.ki,{placeholder:"Select Language"})}),(0,o.jsxs)(d.Bw,{children:[o.jsx(d.Ql,{value:"english",children:"English (US)"}),o.jsx(d.Ql,{value:"hindi",children:"Hindi"}),o.jsx(d.Ql,{value:"german",children:"German"})]})]})}),o.jsx(g.zG,{})]})}),o.jsx(g.Wi,{name:"model",control:q.control,render:({field:t})=>(0,o.jsxs)(g.xJ,{children:[o.jsx(g.lX,{className:"text-sm font-semibold mb-2",children:"Model"}),o.jsx(E.Qr,{name:"model",control:q.control,render:({field:t})=>(0,o.jsxs)(d.Ph,{onValueChange:t.onChange,value:t.value,children:[o.jsx(d.i4,{className:"w-[120px] bg-gray-50 border border-gray-300 rounded-md",children:o.jsx(d.ki,{placeholder:"Select Model"})}),(0,o.jsxs)(d.Bw,{children:[o.jsx(d.Ql,{value:"llama3-70b-8192",children:"KareAI"}),o.jsx(d.Ql,{value:"gpt-4o",children:"OpenAI|GPT-4o"}),o.jsx(d.Ql,{value:"gemini-1.5-pro",children:"Google|Gemini"})]})]})}),o.jsx(g.zG,{})]})}),o.jsx(g.Wi,{name:"year",control:q.control,render:({field:t})=>(0,o.jsxs)(g.xJ,{children:[o.jsx(g.lX,{className:"text-sm font-semibold mb-2",children:"Year"}),o.jsx(E.Qr,{name:"year",control:q.control,render:({field:t})=>(0,o.jsxs)(d.Ph,{onValueChange:t.onChange,value:t.value,children:[o.jsx(d.i4,{className:"w-[120px] bg-gray-50 border border-gray-300 rounded-md",children:o.jsx(d.ki,{placeholder:"Select Year"})}),(0,o.jsxs)(d.Bw,{children:[o.jsx(d.Ql,{value:"2020",children:"2020"}),o.jsx(d.Ql,{value:"2021",children:"2021"}),o.jsx(d.Ql,{value:"2022",children:"2022"}),o.jsx(d.Ql,{value:"2023",children:"2023"}),o.jsx(d.Ql,{value:"2024",children:"2024"})]})]})}),o.jsx(g.zG,{})]})})]})})]})}),o.jsx(m.z,{type:"submit",className:"w-full bg-gradient-to-r from-purple-700 to-[#540F66]",disabled:B,children:B?(0,o.jsxs)(o.Fragment,{children:[o.jsx(y.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait"]}):(0,o.jsxs)(o.Fragment,{children:[o.jsx(u.Z,{className:"m-2"}),"Run Agent"]})})]})})})]})}):"",(0,o.jsxs)("div",{className:"w-full   h-full border-l-2  border-zinc-100 flex justify-center text-zinc-900  py-2 overflow-hidden",children:[(0,o.jsxs)(a.mQ,{className:"w-full bg--200 ",defaultValue:"Balance sheet",children:[(0,o.jsxs)(a.dr,{className:"flex w-full  justify-evenly gap-2   text-zinc-900",children:[o.jsx(a.SP,{value:"Balance sheet",children:"Balance sheet"}),o.jsx(a.SP,{value:"Income Statement",children:"Income Statement"}),o.jsx(a.SP,{value:"Cash flow",children:"Cash flow"}),o.jsx(a.SP,{value:"Insights",children:"Insights"})]}),o.jsx(a.nU,{className:"flex-1 overflow-hidden",value:"Balance sheet",children:(0,o.jsxs)(i.Zb,{className:"h-full",children:[(0,o.jsxs)(i.Ol,{children:[(0,o.jsxs)("div",{className:"flex justify-between  ",children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Balance sheet"}),o.jsx(l.Z,{onClick:()=>{$(!G)},className:"cursor-pointer"})]}),o.jsx(i.SZ,{children:"Overview of the industry landscape."})]}),o.jsx("div",{className:"sample",onMouseUp:t=>{t.preventDefault();let e=window.getSelection()?.toString()||"";tt(e),e.length>0&&Z(!0)},children:o.jsx(i.aY,{className:"h-full overflow-hidden",id:"content1",children:B?o.jsx(c.Z,{messages:Y}):(0,o.jsxs)(o.Fragment,{children:[o.jsx(ew,{}),(0,o.jsxs)("div",{className:"  mt-6  flex  gap-2",children:[(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(f.Z,{className:"w-5 cursor-pointer hover:text-blue-500",onClick:()=>K(r)}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Copy"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(h.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"PDF"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(p.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Word"})]})]})]})})})]})}),o.jsx(a.nU,{className:"flex-1 overflow-hidden",value:"Income Statement",children:(0,o.jsxs)(i.Zb,{className:"h-full",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Income Statement"}),o.jsx(i.SZ,{children:"Current and expected growth of the market."})]}),o.jsx(i.aY,{className:"h-full overflow-hidden",id:"content2",children:B?o.jsx(c.Z,{messages:Y}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(d.Ph,{children:[o.jsx(d.i4,{className:"w-[180px] bg-gray-50 border border-gray-300 rounded-md",children:o.jsx(d.ki,{placeholder:"Select year"})}),(0,o.jsxs)(d.Bw,{children:[o.jsx(d.Ql,{value:"english",children:"2024"}),o.jsx(d.Ql,{value:"hindi",children:"2023"}),o.jsx(d.Ql,{value:"german",children:"2022"}),o.jsx(d.Ql,{value:"german",children:"2021"}),o.jsx(d.Ql,{value:"german",children:"2020"})]})]}),(0,o.jsxs)("div",{className:"  mt-6  flex  gap-2",children:[(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(f.Z,{className:"w-5 cursor-pointer hover:text-blue-500",onClick:()=>K(x)}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Copy"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(h.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"PDF"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(p.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Word"})]})]})]})})]})}),o.jsx(a.nU,{className:"flex-1 overflow-hidden",value:"Cash flow",children:(0,o.jsxs)(i.Zb,{className:"h-full ",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Cash flow"}),o.jsx(i.SZ,{children:"Graph of the market size and projections."})]}),o.jsx(i.aY,{className:" h-full overflow-hidden",children:B?o.jsx(c.Z,{messages:Y}):o.jsx(o.Fragment,{children:o.jsx("div",{className:"data"})})})]})}),o.jsx(a.nU,{className:"flex-1 overflow-hidden",value:"profile",children:(0,o.jsxs)(i.Zb,{className:"h-full",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Tech Trends"}),o.jsx(i.SZ,{children:"Overview of technological trends in the industry."})]}),o.jsx(i.aY,{className:"h-full overflow-hidden",id:"content3",children:B?o.jsx(c.Z,{messages:Y}):o.jsx(o.Fragment,{children:(0,o.jsxs)("div",{className:" py-2   flex  gap-2",children:[(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(f.Z,{className:"w-5 cursor-pointer hover:text-blue-500",onClick:()=>K(O)}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Copy"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(h.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"PDF"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(p.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Word"})]})]})})})]})}),o.jsx(a.nU,{className:"flex-1 overflow-hidden",value:"Insights",children:(0,o.jsxs)(i.Zb,{className:"h-full",children:[(0,o.jsxs)(i.Ol,{children:[o.jsx(i.ll,{className:"text-zinc-900",children:"Insights"}),o.jsx(i.SZ,{children:"Latest news in the industry."})]}),o.jsx(i.aY,{className:"h-full overflow-hidden",id:"content4",children:B?o.jsx(c.Z,{messages:Y}):o.jsx(o.Fragment,{children:(0,o.jsxs)("div",{className:" py-2   flex  gap-2",children:[(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(f.Z,{className:"w-5 cursor-pointer hover:text-blue-500",onClick:()=>K(C)}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Copy"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(h.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"PDF"})]}),(0,o.jsxs)("div",{className:"relative group",children:[o.jsx(p.Z,{className:"w-5 cursor-pointer hover:text-blue-500"}),o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -translate-y-12 w-max p-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:"Word"})]})]})})})]})})]}),Q&&o.jsx("div",{className:"fixed top-[20%] right-0  bg-white cursor-pointer shadow-lg rounded-lg transition-all ease-in-out animate-slide-in",children:o.jsx(m.z,{onClick:te,className:" bg-white rounded-full focus:outline-none",children:o.jsx(ex.default,{width:10,height:8,src:"/logo2.jpg",className:"object-fill w-full h-full",alt:"Chat Logo",onClick:te})})}),o.jsx(A.Z,{isOpen:z,selectedText:J,handleClose:()=>{X(!1)}})]})]})]})})})}},74283:(t,e,r)=>{"use strict";r.r(e),r.d(e,{$$typeof:()=>i,__esModule:()=>a,default:()=>s});var n=r(68570);let o=(0,n.createProxy)(String.raw`C:\Users\progr\OneDrive\Desktop\KareAI MP\finalkare\src\app\financial_research_agent\page.tsx`),{__esModule:a,$$typeof:i}=o;o.default;let s=(0,n.createProxy)(String.raw`C:\Users\progr\OneDrive\Desktop\KareAI MP\finalkare\src\app\financial_research_agent\page.tsx#default`)},48029:(t,e)=>{var r;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var t="",e=0;e<arguments.length;e++){var r=arguments[e];r&&(t=a(t,function(t){if("string"==typeof t||"number"==typeof t)return t;if("object"!=typeof t)return"";if(Array.isArray(t))return o.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var e="";for(var r in t)n.call(t,r)&&t[r]&&(e=a(e,r));return e}(r)))}return t}function a(t,e){return e?t?t+" "+e:t+e:t}t.exports?(o.default=o,t.exports=o):void 0!==(r=(function(){return o}).apply(e,[]))&&(t.exports=r)}()}};var e=require("../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),n=e.X(0,[948,922,986,554,893,761],()=>r(9913));module.exports=n})();